module.exports=function(t){var e={};function i(r){if(e[r])return e[r].exports;var n=e[r]={i:r,l:!1,exports:{}};return t[r].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=t,i.c=e,i.d=function(t,e,r){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(r,n,function(e){return t[e]}.bind(null,n));return r},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),i(1),i(2),i(5);var a=i(6),s=i(7),o=function(t){function e(){var i=t.call(this)||this;return e.dino=new s.default(h.dinoConfig),i.addChild(e.dino),i}return n(e,t),e}(egret.DisplayObjectContainer);window.EgretMain=o;var h=function(){function t(e){return t.isHasNew?(t.dino.reset(e),t.dino):(t.dinoConfig=e,a.default({width:e.width,height:e.height,el:e.el})?(egret.registerClass(o,"EgretMain"),t.dino=this,t.$el=window.document.getElementById("egret-player"),void(t.isHasNew=!0)):null)}return t.prototype.playAnimationOnce=function(t,e,i){o.dino.filterAnimName(t)&&o.dino.playOnce(t,i,e)},t.prototype.play=function(t){o.dino.play(t)},t.prototype.showDino=function(){o.dino._armatureDisplay?o.dino.addChild(o.dino._armatureDisplay):o.dino.initConfig.errorHandle({msg:"骨骼实例为空"})},t.prototype.playAnimationList=function(t,e){o.dino.initAnimList(t),o.dino.playAnimList(t,e)},t.prototype.restAnimNames=function(t){o.dino.initConfig.initAnimNames=t,o.dino.initConfig.initAnimNames.normalAnim=-1!==o.dino.animationNames.indexOf(o.dino.initConfig.initAnimNames.normalAnim)?o.dino.initConfig.initAnimNames.normalAnim:"global_standard"},t.prototype.loopRandomAnim=function(t,e){o.dino.filterAnimName(t)&&o.dino.loopRandomAnim(t,e)},t.prototype.clearLoopRandomAnim=function(){o.dino.clearLoopRandomAnim()},t.prototype.clearAnim=function(){o.dino.clearAnim(!0)},t.prototype.replaceSkin=function(t,e){o.dino.dinoReplaceSkin._replaceSkin(t,e)},t.prototype.removeSkin=function(t){o.dino.dinoReplaceSkin._removeSkin(t)},t.prototype.removeAllSkins=function(){o.dino.dinoReplaceSkin._removeAllSkins()},t.prototype.hideDino=function(){o.dino&&(o.dino.clearLoopRandomAnim(),o.dino.clearAnim(!0),o.dino._armatureDisplay.animation.reset(),o.dino._armatureDisplay.parent&&o.dino._armatureDisplay.parent.removeChild(o.dino._armatureDisplay),RES.destroyRes("preload"),t.$el.parentNode.removeChild(t.$el))},t.prototype.reset=function(e){if(o.dino._armatureDisplay.parent&&o.dino._armatureDisplay.parent.removeChild(o.dino._armatureDisplay),e.el&&t.$el){e.el.appendChild(t.$el);var i=t.$el.getElementsByClassName("egret-player")[0];i.setAttribute("style","margin: auto; width: "+e.width+"px; height: "+e.height+"px; overflow: hidden; position: absolute;"),i.setAttribute("data-content-width",e.width+""),i.setAttribute("data-content-height",e.height+""),o.dino.doStart(e,!0)}},t}();e.default=h,window.DinoAnim=h},function(t,e){var i=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},r=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);i.prototype=e.prototype,t.prototype=new i};if(void 0===n)var n=window;if(void 0===a)var a=n;this&&this.__define,function(t){t.$hashCount=1;var e=function(){function e(){this.$hashCode=t.$hashCount++}return Object.defineProperty(e.prototype,"hashCode",{get:function(){return this.$hashCode},enumerable:!0,configurable:!0}),e}();t.HashObject=e,i(e.prototype,"egret.HashObject",["egret.IHashObject"])}(f||(f={})),function(t){var e=[],n=function(i){function n(t){void 0===t&&(t=null);var e=i.call(this)||this;return e.$EventDispatcher={0:t||e,1:{},2:{},3:0},e}return r(n,i),n.prototype.$getEventMap=function(t){var e=this.$EventDispatcher;return t?e[2]:e[1]},n.prototype.addEventListener=function(t,e,i,r,n){this.$addListener(t,e,i,r,n)},n.prototype.once=function(t,e,i,r,n){this.$addListener(t,e,i,r,n,!0)},n.prototype.$addListener=function(e,i,r,n,a,s){i||t.$error(1003,"listener");var o=this.$EventDispatcher,h=n?o[2]:o[1],l=h[e];l?0!==o[3]&&(h[e]=l=l.concat()):l=h[e]=[],this.$insertEventBin(l,e,i,r,n,a,s)},n.prototype.$insertEventBin=function(t,e,i,r,n,a,s){a=0|+a;for(var o=-1,h=t.length,l=0;l<h;l++){var u=t[l];if(u.listener==i&&u.thisObject==r&&u.target==this)return!1;-1==o&&u.priority<a&&(o=l)}var c={type:e,listener:i,thisObject:r,priority:a,target:this,useCapture:n,dispatchOnce:!!s};return-1!==o?t.splice(o,0,c):t.push(c),!0},n.prototype.removeEventListener=function(t,e,i,r){var n=this.$EventDispatcher,a=r?n[2]:n[1],s=a[t];s&&(0!==n[3]&&(a[t]=s=s.concat()),this.$removeEventBin(s,e,i),0==s.length&&(a[t]=null))},n.prototype.$removeEventBin=function(t,e,i){for(var r=t.length,n=0;n<r;n++){var a=t[n];if(a.listener==e&&a.thisObject==i&&a.target==this)return t.splice(n,1),!0}return!1},n.prototype.hasEventListener=function(t){var e=this.$EventDispatcher;return!(!e[1][t]&&!e[2][t])},n.prototype.willTrigger=function(t){return this.hasEventListener(t)},n.prototype.dispatchEvent=function(t){return t.$currentTarget=this.$EventDispatcher[0],t.$setTarget(t.$currentTarget),this.$notifyListener(t,!1)},n.prototype.$notifyListener=function(t,i){var r=this.$EventDispatcher,n=(i?r[2]:r[1])[t.$type];if(!n)return!0;var a=n.length;if(0==a)return!0;var s=e;r[3]++;for(var o=0;o<a&&((h=n[o]).listener.call(h.thisObject,t),h.dispatchOnce&&s.push(h),!t.$isPropagationImmediateStopped);o++);for(r[3]--;s.length;){var h;(h=s.pop()).target.removeEventListener(h.type,h.listener,h.thisObject,h.useCapture)}return!t.$isDefaultPrevented},n.prototype.dispatchEventWith=function(e,i,r,n){if(i||this.hasEventListener(e)){var a=t.Event.create(t.Event,e,i,n);a.data=r;var s=this.dispatchEvent(a);return t.Event.release(a),s}return!0},n}(t.HashObject);t.EventDispatcher=n,i(n.prototype,"egret.EventDispatcher",["egret.IEventDispatcher"])}(f||(f={})),function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.type=null,i.$id=null,i.paddingTop=0,i.paddingBottom=0,i.paddingLeft=0,i.paddingRight=0,i.$uniforms={},t.nativeRender&&egret_native.NativeDisplayObject.createFilter(i),i}return r(i,e),i.prototype.$toJson=function(){return""},i.prototype.updatePadding=function(){},i.prototype.onPropertyChange=function(){this.updatePadding(),t.nativeRender&&(egret_native.NativeDisplayObject.setFilterPadding(this.$id,this.paddingTop,this.paddingBottom,this.paddingLeft,this.paddingRight),egret_native.NativeDisplayObject.setDataToFilter(this))},i}(t.HashObject);t.Filter=e,i(e.prototype,"egret.Filter")}(f||(f={})),function(t){function e(t){return(t%=360)>180?t-=360:t<-180&&(t+=360),t}var n=function(i){function n(){var e=i.call(this)||this;return e.$children=null,e.$name="",e.$parent=null,e.$stage=null,e.$nestLevel=0,e.$useTranslate=!1,e.$matrix=new t.Matrix,e.$matrixDirty=!1,e.$x=0,e.$y=0,e.$scaleX=1,e.$scaleY=1,e.$rotation=0,e.$skewX=0,e.$skewXdeg=0,e.$skewY=0,e.$skewYdeg=0,e.$explicitWidth=NaN,e.$explicitHeight=NaN,e.$anchorOffsetX=0,e.$anchorOffsetY=0,e.$visible=!0,e.$displayList=null,e.$cacheAsBitmap=!1,e.$cacheDirty=!1,e.$alpha=1,e.$touchEnabled=n.defaultTouchEnabled,e.$scrollRect=null,e.$blendMode=0,e.$maskedObject=null,e.$mask=null,e.$maskRect=null,e.$parentDisplayList=null,e.$renderNode=null,e.$renderDirty=!1,e.$renderMode=null,t.nativeRender&&e.createNativeDisplayObject(),e}return r(n,i),n.prototype.createNativeDisplayObject=function(){this.$nativeDisplayObject=new egret_native.NativeDisplayObject(0)},Object.defineProperty(n.prototype,"name",{get:function(){return this.$name},set:function(t){this.$name=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"parent",{get:function(){return this.$parent},enumerable:!0,configurable:!0}),n.prototype.$setParent=function(t){this.$parent=t},n.prototype.$onAddToStage=function(e,i){this.$stage=e,this.$nestLevel=i,this.$hasAddToStage=!0,t.Sprite.$EVENT_ADD_TO_STAGE_LIST.push(this)},n.prototype.$onRemoveFromStage=function(){this.$nestLevel=0,t.Sprite.$EVENT_REMOVE_FROM_STAGE_LIST.push(this)},n.prototype.$updateUseTransform=function(){1==this.$scaleX&&1==this.$scaleY&&0==this.$skewX&&0==this.$skewY?this.$useTranslate=!1:this.$useTranslate=!0},Object.defineProperty(n.prototype,"stage",{get:function(){return this.$stage},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"matrix",{get:function(){return this.$getMatrix().clone()},set:function(t){this.$setMatrix(t)},enumerable:!0,configurable:!0}),n.prototype.$getMatrix=function(){return this.$matrixDirty&&(this.$matrixDirty=!1,this.$matrix.$updateScaleAndRotation(this.$scaleX,this.$scaleY,this.$skewX,this.$skewY)),this.$matrix.tx=this.$x,this.$matrix.ty=this.$y,this.$matrix},n.prototype.$setMatrix=function(i,r){void 0===r&&(r=!0);var n=this.$matrix;n.a=i.a,n.b=i.b,n.c=i.c,n.d=i.d,this.$x=i.tx,this.$y=i.ty,this.$matrixDirty=!1,1==n.a&&0==n.b&&0==n.c&&1==n.d?this.$useTranslate=!1:this.$useTranslate=!0,r&&(this.$scaleX=n.$getScaleX(),this.$scaleY=n.$getScaleY(),this.$skewX=i.$getSkewX(),this.$skewY=i.$getSkewY(),this.$skewXdeg=e(180*this.$skewX/Math.PI),this.$skewYdeg=e(180*this.$skewY/Math.PI),this.$rotation=e(180*this.$skewY/Math.PI)),t.nativeRender&&this.$nativeDisplayObject.setMatrix(i.a,i.b,i.c,i.d,i.tx,i.ty)},n.prototype.$getConcatenatedMatrix=function(){var e=this.$concatenatedMatrix;e||(e=this.$concatenatedMatrix=new t.Matrix),this.$parent?this.$parent.$getConcatenatedMatrix().$preMultiplyInto(this.$getMatrix(),e):e.copyFrom(this.$getMatrix());var i=this.$anchorOffsetX,r=this.$anchorOffsetY,n=this.$scrollRect;return n?e.$preMultiplyInto(t.$TempMatrix.setTo(1,0,0,1,-n.x-i,-n.y-r),e):0==i&&0==r||e.$preMultiplyInto(t.$TempMatrix.setTo(1,0,0,1,-i,-r),e),this.$concatenatedMatrix},n.prototype.$getInvertedConcatenatedMatrix=function(){return this.$invertedConcatenatedMatrix||(this.$invertedConcatenatedMatrix=new t.Matrix),this.$getConcatenatedMatrix().$invertInto(this.$invertedConcatenatedMatrix),this.$invertedConcatenatedMatrix},Object.defineProperty(n.prototype,"x",{get:function(){return this.$getX()},set:function(t){this.$setX(t)},enumerable:!0,configurable:!0}),n.prototype.$getX=function(){return this.$x},n.prototype.$setX=function(e){if(this.$x==e)return!1;if(this.$x=e,t.nativeRender)this.$nativeDisplayObject.setX(e);else{var i=this.$parent;i&&!i.$cacheDirty&&(i.$cacheDirty=!0,i.$cacheDirtyUp());var r=this.$maskedObject;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp())}return!0},Object.defineProperty(n.prototype,"y",{get:function(){return this.$getY()},set:function(t){this.$setY(t)},enumerable:!0,configurable:!0}),n.prototype.$getY=function(){return this.$y},n.prototype.$setY=function(e){if(this.$y==e)return!1;if(this.$y=e,t.nativeRender)this.$nativeDisplayObject.setY(e);else{var i=this.$parent;i&&!i.$cacheDirty&&(i.$cacheDirty=!0,i.$cacheDirtyUp());var r=this.$maskedObject;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp())}return!0},Object.defineProperty(n.prototype,"scaleX",{get:function(){return this.$getScaleX()},set:function(t){this.$setScaleX(t)},enumerable:!0,configurable:!0}),n.prototype.$getScaleX=function(){return this.$scaleX},n.prototype.$setScaleX=function(e){if(this.$scaleX=e,this.$matrixDirty=!0,this.$updateUseTransform(),t.nativeRender)this.$nativeDisplayObject.setScaleX(e);else{var i=this.$parent;i&&!i.$cacheDirty&&(i.$cacheDirty=!0,i.$cacheDirtyUp());var r=this.$maskedObject;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp())}},Object.defineProperty(n.prototype,"scaleY",{get:function(){return this.$getScaleY()},set:function(t){this.$setScaleY(t)},enumerable:!0,configurable:!0}),n.prototype.$getScaleY=function(){return this.$scaleY},n.prototype.$setScaleY=function(e){if(this.$scaleY=e,this.$matrixDirty=!0,this.$updateUseTransform(),t.nativeRender)this.$nativeDisplayObject.setScaleY(e);else{var i=this.$parent;i&&!i.$cacheDirty&&(i.$cacheDirty=!0,i.$cacheDirtyUp());var r=this.$maskedObject;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp())}},Object.defineProperty(n.prototype,"rotation",{get:function(){return this.$getRotation()},set:function(t){this.$setRotation(t)},enumerable:!0,configurable:!0}),n.prototype.$getRotation=function(){return this.$rotation},n.prototype.$setRotation=function(i){if((i=e(i))!=this.$rotation){var r=(i-this.$rotation)/180*Math.PI;if(this.$skewX+=r,this.$skewY+=r,this.$rotation=i,this.$matrixDirty=!0,this.$updateUseTransform(),t.nativeRender)this.$nativeDisplayObject.setRotation(i);else{var n=this.$parent;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp());var a=this.$maskedObject;a&&!a.$cacheDirty&&(a.$cacheDirty=!0,a.$cacheDirtyUp())}}},Object.defineProperty(n.prototype,"skewX",{get:function(){return this.$skewXdeg},set:function(t){this.$setSkewX(t)},enumerable:!0,configurable:!0}),n.prototype.$setSkewX=function(i){if(i!=this.$skewXdeg)if(this.$skewXdeg=i,i=(i=e(i))/180*Math.PI,this.$skewX=i,this.$matrixDirty=!0,this.$updateUseTransform(),t.nativeRender)this.$nativeDisplayObject.setSkewX(this.$skewXdeg);else{var r=this.$parent;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp());var n=this.$maskedObject;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp())}},Object.defineProperty(n.prototype,"skewY",{get:function(){return this.$skewYdeg},set:function(t){this.$setSkewY(t)},enumerable:!0,configurable:!0}),n.prototype.$setSkewY=function(i){if(i!=this.$skewYdeg)if(this.$skewYdeg=i,i=(i=e(i))/180*Math.PI,this.$skewY=i,this.$matrixDirty=!0,this.$updateUseTransform(),t.nativeRender)this.$nativeDisplayObject.setSkewY(this.$skewYdeg);else{var r=this.$parent;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp());var n=this.$maskedObject;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp())}},Object.defineProperty(n.prototype,"width",{get:function(){return this.$getWidth()},set:function(t){this.$setWidth(t)},enumerable:!0,configurable:!0}),n.prototype.$getWidth=function(){return isNaN(this.$explicitWidth)?this.$getOriginalBounds().width:this.$explicitWidth},n.prototype.$setWidth=function(t){this.$explicitWidth=isNaN(t)?NaN:t},Object.defineProperty(n.prototype,"height",{get:function(){return this.$getHeight()},set:function(t){this.$setHeight(t)},enumerable:!0,configurable:!0}),n.prototype.$getHeight=function(){return isNaN(this.$explicitHeight)?this.$getOriginalBounds().height:this.$explicitHeight},n.prototype.$setHeight=function(t){this.$explicitHeight=isNaN(t)?NaN:t},Object.defineProperty(n.prototype,"measuredWidth",{get:function(){return this.$getOriginalBounds().width},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"measuredHeight",{get:function(){return this.$getOriginalBounds().height},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"anchorOffsetX",{get:function(){return this.$anchorOffsetX},set:function(t){this.$setAnchorOffsetX(t)},enumerable:!0,configurable:!0}),n.prototype.$setAnchorOffsetX=function(e){this.$anchorOffsetX=e,t.nativeRender&&this.$nativeDisplayObject.setAnchorOffsetX(e)},Object.defineProperty(n.prototype,"anchorOffsetY",{get:function(){return this.$anchorOffsetY},set:function(t){this.$setAnchorOffsetY(t)},enumerable:!0,configurable:!0}),n.prototype.$setAnchorOffsetY=function(e){this.$anchorOffsetY=e,t.nativeRender&&this.$nativeDisplayObject.setAnchorOffsetY(e)},Object.defineProperty(n.prototype,"visible",{get:function(){return this.$visible},set:function(t){this.$setVisible(t)},enumerable:!0,configurable:!0}),n.prototype.$setVisible=function(e){if(this.$visible=e,t.nativeRender)this.$nativeDisplayObject.setVisible(e);else{this.$updateRenderMode();var i=this.$parent;i&&!i.$cacheDirty&&(i.$cacheDirty=!0,i.$cacheDirtyUp());var r=this.$maskedObject;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp())}},Object.defineProperty(n.prototype,"cacheAsBitmap",{get:function(){return this.$cacheAsBitmap},set:function(e){this.$cacheAsBitmap=e,t.nativeRender?this.$nativeDisplayObject.setCacheAsBitmap(e):this.$setHasDisplayList(e)},enumerable:!0,configurable:!0}),n.prototype.$setHasDisplayList=function(e){if(!!this.$displayList!=e)if(e){var i=t.sys.DisplayList.create(this);i&&(this.$displayList=i,this.$cacheDirty=!0)}else this.$displayList=null},n.prototype.$cacheDirtyUp=function(){var t=this.$parent;t&&!t.$cacheDirty&&(t.$cacheDirty=!0,t.$cacheDirtyUp())},Object.defineProperty(n.prototype,"alpha",{get:function(){return this.$alpha},set:function(t){this.$setAlpha(t)},enumerable:!0,configurable:!0}),n.prototype.$setAlpha=function(e){if(this.$alpha=e,t.nativeRender)this.$nativeDisplayObject.setAlpha(e);else{this.$updateRenderMode();var i=this.$parent;i&&!i.$cacheDirty&&(i.$cacheDirty=!0,i.$cacheDirtyUp());var r=this.$maskedObject;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp())}},Object.defineProperty(n.prototype,"touchEnabled",{get:function(){return this.$getTouchEnabled()},set:function(t){this.$setTouchEnabled(t)},enumerable:!0,configurable:!0}),n.prototype.$getTouchEnabled=function(){return this.$touchEnabled},n.prototype.$setTouchEnabled=function(t){this.$touchEnabled=t},Object.defineProperty(n.prototype,"scrollRect",{get:function(){return this.$scrollRect},set:function(t){this.$setScrollRect(t)},enumerable:!0,configurable:!0}),n.prototype.$setScrollRect=function(e){e||this.$scrollRect?(e?(this.$scrollRect||(this.$scrollRect=new t.Rectangle),this.$scrollRect.copyFrom(e),t.nativeRender&&this.$nativeDisplayObject.setScrollRect(e.x,e.y,e.width,e.height)):(this.$scrollRect=null,t.nativeRender&&this.$nativeDisplayObject.setScrollRect(0,0,0,0)),t.nativeRender||this.$updateRenderMode()):this.$updateRenderMode()},Object.defineProperty(n.prototype,"blendMode",{get:function(){return t.sys.numberToBlendMode(this.$blendMode)},set:function(e){var i=t.sys.blendModeToNumber(e);if(this.$blendMode=i,t.nativeRender)this.$nativeDisplayObject.setBlendMode(i);else{this.$updateRenderMode();var r=this.$parent;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp());var n=this.$maskedObject;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp())}},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"mask",{get:function(){return this.$mask?this.$mask:this.$maskRect},set:function(e){if(e!==this){if(e)if(e instanceof n){if(e==this.$mask)return;e.$maskedObject&&(e.$maskedObject.mask=null),e.$maskedObject=this,this.$mask=e,t.nativeRender||e.$updateRenderMode(),this.$maskRect&&(t.nativeRender&&this.$nativeDisplayObject.setMaskRect(0,0,0,0),this.$maskRect=null),t.nativeRender&&this.$nativeDisplayObject.setMask(e.$nativeDisplayObject.id)}else this.$maskRect||(this.$maskRect=new t.Rectangle),this.$maskRect.copyFrom(e),t.nativeRender&&this.$nativeDisplayObject.setMaskRect(e.x,e.y,e.width,e.height),this.$mask&&(this.$mask.$maskedObject=null,t.nativeRender||this.$mask.$updateRenderMode()),this.mask&&(t.nativeRender&&this.$nativeDisplayObject.setMask(-1),this.$mask=null);else this.$mask&&(this.$mask.$maskedObject=null,t.nativeRender||this.$mask.$updateRenderMode()),this.mask&&(t.nativeRender&&this.$nativeDisplayObject.setMask(-1),this.$mask=null),this.$maskRect&&(t.nativeRender&&this.$nativeDisplayObject.setMaskRect(0,0,0,0),this.$maskRect=null);t.nativeRender||this.$updateRenderMode()}},enumerable:!0,configurable:!0}),n.prototype.$setMaskRect=function(e){(e||this.$maskRect)&&(e?(this.$maskRect||(this.$maskRect=new t.Rectangle),this.$maskRect.copyFrom(e)):this.$maskRect=null)},Object.defineProperty(n.prototype,"filters",{get:function(){return this.$filters},set:function(e){var i,r;this.$filters||e?(e&&e.length?(e=e.concat(),this.$filters=e,t.nativeRender&&this.$nativeDisplayObject.setFilters(e)):(this.$filters=e,t.nativeRender&&this.$nativeDisplayObject.setFilters(null)),t.nativeRender||(this.$updateRenderMode(),(i=this.$parent)&&!i.$cacheDirty&&(i.$cacheDirty=!0,i.$cacheDirtyUp()),(r=this.$maskedObject)&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp()))):(this.$filters=e,t.nativeRender?this.$nativeDisplayObject.setFilters(null):(this.$updateRenderMode(),(i=this.$parent)&&!i.$cacheDirty&&(i.$cacheDirty=!0,i.$cacheDirtyUp()),(r=this.$maskedObject)&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp())))},enumerable:!0,configurable:!0}),n.prototype.getTransformedBounds=function(t,e){return t=t||this,this.$getTransformedBounds(t,e)},n.prototype.getBounds=function(t,e){return void 0===e&&(e=!0),t=this.$getTransformedBounds(this,t),e&&(0!=this.$anchorOffsetX&&(t.x-=this.$anchorOffsetX),0!=this.$anchorOffsetY&&(t.y-=this.$anchorOffsetY)),t},n.prototype.$getTransformedBounds=function(e,i){var r,n=this.$getOriginalBounds();return i||(i=new t.Rectangle),i.copyFrom(n),e==this?i:(e?(r=t.$TempMatrix,e.$getInvertedConcatenatedMatrix().$preMultiplyInto(this.$getConcatenatedMatrix(),r)):r=this.$getConcatenatedMatrix(),r.$transformBounds(i),i)},n.prototype.globalToLocal=function(e,i,r){if(void 0===e&&(e=0),void 0===i&&(i=0),t.nativeRender){egret_native.updateNativeRender();var n=egret_native.nrGlobalToLocal(this.$nativeDisplayObject.id,e,i).split(","),a=parseFloat(n[0]),s=parseFloat(n[1]);return r?r.setTo(a,s):r=new t.Point(a,s),r}return this.$getInvertedConcatenatedMatrix().transformPoint(e,i,r)},n.prototype.localToGlobal=function(e,i,r){if(void 0===e&&(e=0),void 0===i&&(i=0),t.nativeRender){egret_native.updateNativeRender();var n=egret_native.nrLocalToGlobal(this.$nativeDisplayObject.id,e,i).split(","),a=parseFloat(n[0]),s=parseFloat(n[1]);return r?r.setTo(a,s):r=new t.Point(a,s),r}return this.$getConcatenatedMatrix().transformPoint(e,i,r)},n.prototype.$getOriginalBounds=function(){var t=this.$getContentBounds();this.$measureChildBounds(t);var e=this.$measureFiltersOffset(!1);return e&&(t.x+=e.minX,t.y+=e.minY,t.width+=-e.minX+e.maxX,t.height+=-e.minY+e.maxY),t},n.prototype.$measureChildBounds=function(t){},n.prototype.$getContentBounds=function(){var e=t.$TempRectangle;return e.setEmpty(),this.$measureContentBounds(e),e},n.prototype.$measureContentBounds=function(t){},n.prototype.$getRenderNode=function(){var t=this.$renderNode;return t?(this.$renderDirty&&(t.cleanBeforeRender(),this.$updateRenderNode(),this.$renderDirty=!1,t=this.$renderNode),t):null},n.prototype.$updateRenderMode=function(){!this.$visible||this.$alpha<=0||this.$maskedObject?this.$renderMode=1:this.filters&&this.filters.length>0?this.$renderMode=2:0!==this.$blendMode||this.$mask&&this.$mask.$stage?this.$renderMode=3:this.$scrollRect||this.$maskRect?this.$renderMode=4:this.$renderMode=null},n.prototype.$measureFiltersOffset=function(e){for(var i=this,r=0,n=0,a=0,s=0;i;){var o=i.$filters;if(o&&o.length)for(var h=o.length,l=0;l<h;l++){var u=o[l];if("blur"==u.type)r-=c=u.blurX,n-=p=u.blurY,a+=c,s+=p;else if("glow"==u.type){var c,p;r-=c=u.blurX,n-=p=u.blurY,a+=c,s+=p;var f=u.distance||0,d=u.angle||0,m=0,g=0;0!=f&&(r+=m=(m=f*t.NumberUtils.cos(d))>0?Math.ceil(m):Math.floor(m),a+=m,n+=g=(g=f*t.NumberUtils.sin(d))>0?Math.ceil(g):Math.floor(g),s+=g)}else if("custom"==u.type){var y=u.padding;r-=y,n-=y,a+=y,s+=y}}i=e?i.$parent:null}return{minX:r=Math.min(r,0),minY:n=Math.min(n,0),maxX:a=Math.max(a,0),maxY:s=Math.max(s,0)}},n.prototype.$getConcatenatedMatrixAt=function(e,i){var r=e.$getInvertedConcatenatedMatrix();if(0===r.a||0===r.d){var n=this,a=e.$nestLevel;for(i.identity();n.$nestLevel>a;){var s=n.$scrollRect;s&&i.concat(t.$TempMatrix.setTo(1,0,0,1,-s.x,-s.y)),i.concat(n.$getMatrix()),n=n.$parent}}else r.$preMultiplyInto(i,i)},n.prototype.$updateRenderNode=function(){},n.prototype.$hitTest=function(e,i){if(!t.nativeRender&&!this.$renderNode||!this.$visible||0==this.$scaleX||0==this.$scaleY)return null;var r=this.$getInvertedConcatenatedMatrix();if(0==r.a&&0==r.b&&0==r.c&&0==r.d)return null;var n=this.$getContentBounds(),a=r.a*e+r.c*i+r.tx,s=r.b*e+r.d*i+r.ty;if(n.contains(a,s)){if(!this.$children){var o=this.$scrollRect?this.$scrollRect:this.$maskRect;if(o&&!o.contains(a,s))return null;if(this.$mask&&!this.$mask.$hitTest(e,i))return null}return this}return null},n.prototype.hitTestPoint=function(e,i,r){if(r){u=(h=this.$getInvertedConcatenatedMatrix()).a*e+h.c*i+h.tx,c=h.b*e+h.d*i+h.ty;var n=void 0;if(t.nativeRender){(s=t.sys.customHitTestBuffer).resize(3,3),egret_native.forHitTest=!0,egret_native.activateBuffer(s),egret_native.updateNativeRender(),egret_native.nrRenderDisplayObject2(this.$nativeDisplayObject.id,1-u,1-c,!0);try{n=new Uint8Array(4),egret_native.nrGetPixels(1,1,1,1,n)}catch(e){throw new Error(t.sys.tr(1039))}return egret_native.activateBuffer(null),egret_native.forHitTest=!1,0!==n[3]}var a=this.$displayList;if(a){var s=a.renderBuffer;try{n=s.getPixels(u-a.offsetX,c-a.offsetY)}catch(e){throw new Error(t.sys.tr(1039))}}else{(s=t.sys.customHitTestBuffer).resize(3,3);var o=t.Matrix.create();o.identity(),o.translate(1-u,1-c),t.sys.systemRenderer.render(this,s,o,!0),t.Matrix.release(o);try{n=s.getPixels(1,1)}catch(e){throw new Error(t.sys.tr(1039))}}return 0!==n[3]}if(0==this.$scaleX||0==this.$scaleY)return!1;var h=this.$getInvertedConcatenatedMatrix(),l=this.getBounds(null,!1),u=h.a*e+h.c*i+h.tx,c=h.b*e+h.d*i+h.ty;if(l.contains(u,c)){var p=this.$scrollRect?this.$scrollRect:this.$maskRect;return!(p&&!p.contains(u,c))}return!1},n.prototype.$addListener=function(e,r,a,s,o,h){i.prototype.$addListener.call(this,e,r,a,s,o,h);var l=e==t.Event.ENTER_FRAME;if(l||e==t.Event.RENDER){var u=l?n.$enterFrameCallBackList:n.$renderCallBackList;-1==u.indexOf(this)&&u.push(this)}},n.prototype.removeEventListener=function(e,r,a,s){i.prototype.removeEventListener.call(this,e,r,a,s);var o=e==t.Event.ENTER_FRAME;if((o||e==t.Event.RENDER)&&!this.hasEventListener(e)){var h=o?n.$enterFrameCallBackList:n.$renderCallBackList,l=h.indexOf(this);-1!==l&&h.splice(l,1)}},n.prototype.dispatchEvent=function(t){if(!t.$bubbles)return i.prototype.dispatchEvent.call(this,t);var e=this.$getPropagationList(this),r=.5*e.length;return t.$setTarget(this),this.$dispatchPropagationEvent(t,e,r),!t.$isDefaultPrevented},n.prototype.$getPropagationList=function(t){for(var e=[];t;)e.push(t),t=t.$parent;var i=e.concat();return i.reverse(),i.concat(e)},n.prototype.$dispatchPropagationEvent=function(t,e,i){for(var r=e.length,n=i-1,a=0;a<r;a++){var s=e[a];if(t.$currentTarget=s,t.$eventPhase=a<n?1:a==i||a==n?2:3,s.$notifyListener(t,a<i),t.$isPropagationStopped||t.$isPropagationImmediateStopped)return}},n.prototype.willTrigger=function(t){for(var e=this;e;){if(e.hasEventListener(t))return!0;e=e.$parent}return!1},n.defaultTouchEnabled=!1,n.$enterFrameCallBackList=[],n.$renderCallBackList=[],n}(t.EventDispatcher);t.DisplayObject=n,i(n.prototype,"egret.DisplayObject")}(f||(f={})),function(t){t.$TextureScaleFactor=1;var e=function(e){function i(){var t=e.call(this)||this;return t.disposeBitmapData=!0,t.$bitmapX=0,t.$bitmapY=0,t.$bitmapWidth=0,t.$bitmapHeight=0,t.$offsetX=0,t.$offsetY=0,t.$textureWidth=0,t.$textureHeight=0,t.$sourceWidth=0,t.$sourceHeight=0,t.$bitmapData=null,t.$rotated=!1,t}return r(i,e),Object.defineProperty(i.prototype,"textureWidth",{get:function(){return this.$getTextureWidth()},enumerable:!0,configurable:!0}),i.prototype.$getTextureWidth=function(){return this.$textureWidth},Object.defineProperty(i.prototype,"textureHeight",{get:function(){return this.$getTextureHeight()},enumerable:!0,configurable:!0}),i.prototype.$getTextureHeight=function(){return this.$textureHeight},i.prototype.$getScaleBitmapWidth=function(){return this.$bitmapWidth*t.$TextureScaleFactor},i.prototype.$getScaleBitmapHeight=function(){return this.$bitmapHeight*t.$TextureScaleFactor},Object.defineProperty(i.prototype,"bitmapData",{get:function(){return this.$bitmapData},set:function(t){this._setBitmapData(t)},enumerable:!0,configurable:!0}),i.prototype._setBitmapData=function(e){this.$bitmapData=e;var i=t.$TextureScaleFactor,r=e.width*i,n=e.height*i;this.$initData(0,0,r,n,0,0,r,n,e.width,e.height)},i.prototype.$initData=function(e,i,r,n,a,s,o,h,l,u,c){void 0===c&&(c=!1);var p=t.$TextureScaleFactor;this.$bitmapX=e/p,this.$bitmapY=i/p,this.$bitmapWidth=r/p,this.$bitmapHeight=n/p,this.$offsetX=a,this.$offsetY=s,this.$textureWidth=o,this.$textureHeight=h,this.$sourceWidth=l,this.$sourceHeight=u,this.$rotated=c,t.BitmapData.$invalidate(this.$bitmapData)},i.prototype.getPixel32=function(t,e){throw new Error},i.prototype.getPixels=function(t,e,i,r){throw void 0===i&&(i=1),void 0===r&&(r=1),new Error},i.prototype.toDataURL=function(t,e,i){throw new Error},i.prototype.saveToFile=function(t,e,i){throw new Error},i.prototype.dispose=function(){this.$bitmapData&&(this.disposeBitmapData&&this.$bitmapData.$dispose(),this.$bitmapData=null),t.nativeRender&&egret_native.NativeDisplayObject.disposeTexture(this)},i}(t.HashObject);t.Texture=e,i(e.prototype,"egret.Texture")}(f||(f={})),function(t){var e=function(t){function e(e,i,r,n){var a=t.call(this)||this;return a.$eventPhase=2,a.$currentTarget=null,a.$target=null,a.$isDefaultPrevented=!1,a.$isPropagationStopped=!1,a.$isPropagationImmediateStopped=!1,a.$type=e,a.$bubbles=!!i,a.$cancelable=!!r,a.data=n,a}return r(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this.$type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bubbles",{get:function(){return this.$bubbles},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cancelable",{get:function(){return this.$cancelable},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"eventPhase",{get:function(){return this.$eventPhase},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentTarget",{get:function(){return this.$currentTarget},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"target",{get:function(){return this.$target},enumerable:!0,configurable:!0}),e.prototype.$setTarget=function(t){return this.$target=t,!0},e.prototype.isDefaultPrevented=function(){return this.$isDefaultPrevented},e.prototype.preventDefault=function(){this.$cancelable&&(this.$isDefaultPrevented=!0)},e.prototype.stopPropagation=function(){this.$bubbles&&(this.$isPropagationStopped=!0)},e.prototype.stopImmediatePropagation=function(){this.$bubbles&&(this.$isPropagationImmediateStopped=!0)},e.prototype.clean=function(){this.data=this.$currentTarget=null,this.$setTarget(null)},e.dispatchEvent=function(t,i,r,n){void 0===r&&(r=!1);var a=e.create(e,i,r),s=e._getPropertyData(e);void 0!=n&&(s.data=n);var o=t.dispatchEvent(a);return e.release(a),o},e._getPropertyData=function(t){var e=t._props;return e||(e=t._props={}),e},e.create=function(t,e,i,r){var n;if(t.hasOwnProperty("eventPool")&&(n=t.eventPool),n||(n=t.eventPool=[]),n.length){var a=n.pop();return a.$type=e,a.$bubbles=!!i,a.$cancelable=!!r,a.$isDefaultPrevented=!1,a.$isPropagationStopped=!1,a.$isPropagationImmediateStopped=!1,a.$eventPhase=2,a}return new t(e,i,r)},e.release=function(t){t.clean(),Object.getPrototypeOf(t).constructor.eventPool.push(t)},e.ADDED_TO_STAGE="addedToStage",e.REMOVED_FROM_STAGE="removedFromStage",e.ADDED="added",e.REMOVED="removed",e.ENTER_FRAME="enterFrame",e.RENDER="render",e.RESIZE="resize",e.CHANGE="change",e.CHANGING="changing",e.COMPLETE="complete",e.LOOP_COMPLETE="loopComplete",e.FOCUS_IN="focusIn",e.FOCUS_OUT="focusOut",e.ENDED="ended",e.ACTIVATE="activate",e.DEACTIVATE="deactivate",e.CLOSE="close",e.CONNECT="connect",e.LEAVE_STAGE="leaveStage",e.SOUND_COMPLETE="soundComplete",e}(t.HashObject);t.Event=e,i(e.prototype,"egret.Event")}(f||(f={})),n.DEBUG=!0,n.RELEASE=!1,function(t){t.getString=function(e){for(var i=[],r=1;r<arguments.length;r++)i[r-1]=arguments[r];return t.sys.tr.apply(t.sys,arguments)},t.$error=function(e){for(var i=[],r=1;r<arguments.length;r++)i[r-1]=arguments[r];var n=t.sys.tr.apply(null,arguments);throw t.sys.$errorToFPS("Error #"+e+": "+n),new Error("#"+e+": "+n)},t.$warn=function(e){for(var i=[],r=1;r<arguments.length;r++)i[r-1]=arguments[r];var n=t.sys.tr.apply(null,arguments);t.sys.$warnToFPS("Warning #"+e+": "+n),t.warn("Warning #"+e+": "+n)},t.$markCannotUse=function(e,i,r){Object.defineProperty(e.prototype,i,{get:function(){return t.$warn(1009,t.getQualifiedClassName(e),i),r},set:function(r){t.$error(1009,t.getQualifiedClassName(e),i)},enumerable:!0,configurable:!0})}}(f||(f={})),function(t){var e=[],n=Math.PI/180,a=function(i){function a(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var r=i.call(this)||this;return r.x=t,r.y=e,r}return r(a,i),a.release=function(t){t&&e.push(t)},a.create=function(t,i){var r=e.pop();return r||(r=new a),r.setTo(t,i)},Object.defineProperty(a.prototype,"length",{get:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},enumerable:!0,configurable:!0}),a.prototype.setTo=function(t,e){return this.x=t,this.y=e,this},a.prototype.clone=function(){return new a(this.x,this.y)},a.prototype.equals=function(t){return this.x==t.x&&this.y==t.y},a.distance=function(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))},a.prototype.copyFrom=function(t){this.x=t.x,this.y=t.y},a.prototype.add=function(t){return new a(this.x+t.x,this.y+t.y)},a.interpolate=function(t,e,i){var r=1-i;return new a(t.x*i+e.x*r,t.y*i+e.y*r)},a.prototype.normalize=function(t){if(0!=this.x||0!=this.y){var e=t/this.length;this.x*=e,this.y*=e}},a.prototype.offset=function(t,e){this.x+=t,this.y+=e},a.polar=function(e,i){return new a(e*t.NumberUtils.cos(i/n),e*t.NumberUtils.sin(i/n))},a.prototype.subtract=function(t){return new a(this.x-t.x,this.y-t.y)},a.prototype.toString=function(){return"(x="+this.x+", y="+this.y+")"},a}(t.HashObject);t.Point=a,i(a.prototype,"egret.Point"),t.$TempPoint=new a}(f||(f={})),function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.$touchChildren=!0,t.$children=[],t}return r(i,e),Object.defineProperty(i.prototype,"numChildren",{get:function(){return this.$children.length},enumerable:!0,configurable:!0}),i.prototype.addChild=function(t){var e=this.$children.length;return t.$parent==this&&e--,this.$doAddChild(t,e)},i.prototype.addChildAt=function(t,e){return((e=0|+e)<0||e>=this.$children.length)&&(e=this.$children.length,t.$parent==this&&e--),this.$doAddChild(t,e)},i.prototype.$doAddChild=function(e,r,n){void 0===n&&(n=!0),e==this?t.$error(1005):e instanceof t.DisplayObjectContainer&&e.contains(this)&&t.$error(1004);var a=e.$parent;if(a==this)return this.doSetChildIndex(e,r),e;a&&a.removeChild(e),this.$children.splice(r,0,e),e.$setParent(this),t.nativeRender&&this.$nativeDisplayObject.addChildAt(e.$nativeDisplayObject.id,r);var s=this.$stage;if(s&&e.$onAddToStage(s,this.$nestLevel+1),n&&e.dispatchEventWith(t.Event.ADDED,!0),s)for(var o=i.$EVENT_ADD_TO_STAGE_LIST;o.length;){var h=o.shift();h.$stage&&n&&h.dispatchEventWith(t.Event.ADDED_TO_STAGE)}if(!t.nativeRender&&(e.$maskedObject&&e.$maskedObject.$updateRenderMode(),!this.$cacheDirty)){this.$cacheDirty=!0;var l=this.$parent;l&&!l.$cacheDirty&&(l.$cacheDirty=!0,l.$cacheDirtyUp());var u=this.$maskedObject;u&&!u.$cacheDirty&&(u.$cacheDirty=!0,u.$cacheDirtyUp())}return this.$childAdded(e,r),e},i.prototype.contains=function(t){for(;t;){if(t==this)return!0;t=t.$parent}return!1},i.prototype.getChildAt=function(e){return(e=0|+e)>=0&&e<this.$children.length?this.$children[e]:(t.$error(1007),null)},i.prototype.getChildIndex=function(t){return this.$children.indexOf(t)},i.prototype.getChildByName=function(t){for(var e,i=this.$children,r=i.length,n=0;n<r;n++)if((e=i[n]).name==t)return e;return null},i.prototype.removeChild=function(e){var i=this.$children.indexOf(e);return i>=0?this.$doRemoveChild(i):(t.$error(1006),null)},i.prototype.removeChildAt=function(e){return(e=0|+e)>=0&&e<this.$children.length?this.$doRemoveChild(e):(t.$error(1007),null)},i.prototype.$doRemoveChild=function(e,r){void 0===r&&(r=!0),e=0|+e;var n=this.$children,a=n[e];if(this.$childRemoved(a,e),r&&a.dispatchEventWith(t.Event.REMOVED,!0),this.$stage){a.$onRemoveFromStage();for(var s=i.$EVENT_REMOVE_FROM_STAGE_LIST;s.length>0;){var o=s.shift();r&&o.$hasAddToStage&&(o.$hasAddToStage=!1,o.dispatchEventWith(t.Event.REMOVED_FROM_STAGE)),o.$hasAddToStage=!1,o.$stage=null}}this.$displayList||this.$parentDisplayList,a.$setParent(null);var h=n.indexOf(a);if(-1!=h&&n.splice(h,1),t.nativeRender)this.$nativeDisplayObject.removeChild(a.$nativeDisplayObject.id);else if(a.$maskedObject&&a.$maskedObject.$updateRenderMode(),!this.$cacheDirty){this.$cacheDirty=!0;var l=this.$parent;l&&!l.$cacheDirty&&(l.$cacheDirty=!0,l.$cacheDirtyUp());var u=this.$maskedObject;u&&!u.$cacheDirty&&(u.$cacheDirty=!0,u.$cacheDirtyUp())}return a},i.prototype.setChildIndex=function(t,e){((e=0|+e)<0||e>=this.$children.length)&&(e=this.$children.length-1),this.doSetChildIndex(t,e)},i.prototype.doSetChildIndex=function(e,i){var r=this.$children.indexOf(e);if(r<0&&t.$error(1006),r!=i)if(this.$childRemoved(e,r),this.$children.splice(r,1),this.$children.splice(i,0,e),this.$childAdded(e,i),t.nativeRender)this.$nativeDisplayObject.removeChild(e.$nativeDisplayObject.id),this.$nativeDisplayObject.addChildAt(e.$nativeDisplayObject.id,i);else if(!this.$cacheDirty){this.$cacheDirty=!0;var n=this.$parent;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp());var a=this.$maskedObject;a&&!a.$cacheDirty&&(a.$cacheDirty=!0,a.$cacheDirtyUp())}},i.prototype.swapChildrenAt=function(e,i){i=0|+i,(e=0|+e)>=0&&e<this.$children.length&&i>=0&&i<this.$children.length?this.doSwapChildrenAt(e,i):t.$error(1007)},i.prototype.swapChildren=function(e,i){var r=this.$children.indexOf(e),n=this.$children.indexOf(i);-1==r||-1==n?t.$error(1006):this.doSwapChildrenAt(r,n)},i.prototype.doSwapChildrenAt=function(e,i){if(e>i){var r=i;i=e,e=r}else if(e==i)return;var n=this.$children,a=n[e],s=n[i];if(this.$childRemoved(a,e),this.$childRemoved(s,i),n[e]=s,n[i]=a,this.$childAdded(s,e),this.$childAdded(a,i),t.nativeRender)this.$nativeDisplayObject.swapChild(e,i);else if(!this.$cacheDirty){this.$cacheDirty=!0;var o=this.$parent;o&&!o.$cacheDirty&&(o.$cacheDirty=!0,o.$cacheDirtyUp());var h=this.$maskedObject;h&&!h.$cacheDirty&&(h.$cacheDirty=!0,h.$cacheDirtyUp())}},i.prototype.removeChildren=function(){for(var t=this.$children.length-1;t>=0;t--)this.$doRemoveChild(t)},i.prototype.$childAdded=function(t,e){},i.prototype.$childRemoved=function(t,e){},i.prototype.$onAddToStage=function(t,i){e.prototype.$onAddToStage.call(this,t,i);var r=this.$children.length;i++;for(var n=0;n<r;n++){var a=this.$children[n];a.$onAddToStage(t,i),a.$maskedObject&&a.$maskedObject.$updateRenderMode()}},i.prototype.$onRemoveFromStage=function(){e.prototype.$onRemoveFromStage.call(this);for(var t=this.$children,i=t.length,r=0;r<i;r++)t[r].$onRemoveFromStage()},i.prototype.$measureChildBounds=function(e){var i=this.$children,r=i.length;if(0!=r){for(var n=0,a=0,s=0,o=0,h=!1,l=-1;l<r;l++){var u=void 0;-1==l?u=e:(i[l].getBounds(t.$TempRectangle),i[l].$getMatrix().$transformBounds(t.$TempRectangle),u=t.$TempRectangle),u.isEmpty()||(h?(n=Math.min(n,u.x),a=Math.max(a,u.x+u.width),s=Math.min(s,u.y),o=Math.max(o,u.y+u.height)):(h=!0,a=(n=u.x)+u.width,o=(s=u.y)+u.height))}e.setTo(n,s,a-n,o-s)}},Object.defineProperty(i.prototype,"touchChildren",{get:function(){return this.$getTouchChildren()},set:function(t){this.$setTouchChildren(!!t)},enumerable:!0,configurable:!0}),i.prototype.$getTouchChildren=function(){return this.$touchChildren},i.prototype.$setTouchChildren=function(t){return this.$touchChildren!=t&&(this.$touchChildren=t,!0)},i.prototype.$hitTest=function(t,i){if(!this.$visible)return null;var r=this.$getInvertedConcatenatedMatrix(),n=r.a*t+r.c*i+r.tx,a=r.b*t+r.d*i+r.ty,s=this.$scrollRect?this.$scrollRect:this.$maskRect;if(s&&!s.contains(n,a))return null;if(this.$mask&&!this.$mask.$hitTest(t,i))return null;for(var o=this.$children,h=!1,l=null,u=o.length-1;u>=0;u--){var c=o[u];if(!c.$maskedObject&&(l=c.$hitTest(t,i))){if(h=!0,l.$touchEnabled)break;l=null}}return l?this.$touchChildren?l:this:h?this:e.prototype.$hitTest.call(this,t,i)},i.$EVENT_ADD_TO_STAGE_LIST=[],i.$EVENT_REMOVE_FROM_STAGE_LIST=[],i}(t.DisplayObject);t.DisplayObjectContainer=e,i(e.prototype,"egret.DisplayObjectContainer")}(f||(f={})),function(t){var e=function(e){function i(i){var r=e.call(this)||this;return r._bitmapX=0,r._bitmapY=0,r._textureMap=t.createMap(),r.$texture=i,r._bitmapX=i.$bitmapX-i.$offsetX,r._bitmapY=i.$bitmapY-i.$offsetY,r}return r(i,e),i.prototype.getTexture=function(t){return this._textureMap[t]},i.prototype.createTexture=function(e,i,r,n,a,s,o,h,l){void 0===s&&(s=0),void 0===o&&(o=0),void 0===h&&(h=s+n),void 0===l&&(l=o+a);var u=new t.Texture;return u.disposeBitmapData=!1,u.$bitmapData=this.$texture.$bitmapData,u.$initData(this._bitmapX+i,this._bitmapY+r,n,a,s,o,h,l,this.$texture.$sourceWidth,this.$texture.$sourceHeight),this._textureMap[e]=u,u},i.prototype.dispose=function(){this.$texture&&this.$texture.dispose()},i}(t.HashObject);t.SpriteSheet=e,i(e.prototype,"egret.SpriteSheet")}(f||(f={})),function(t){t.$locale_strings=t.$locale_strings||{},t.$language="en_US"}(f||(f={})),function(t){(t.sys||(t.sys={})).tr=function(e){for(var i=[],r=1;r<arguments.length;r++)i[r-1]=arguments[r];var n=t.$locale_strings[t.$language][e];if(!n)return"{"+e+"}";for(var a=i.length,s=0;s<a;s++)n=n.replace("{"+s+"}",i[s]);return n}}(f||(f={})),function(t){var e=function(e){function i(r){var n=e.call(this)||this;return n.$texture=null,n.$bitmapData=null,n.$bitmapX=0,n.$bitmapY=0,n.$bitmapWidth=0,n.$bitmapHeight=0,n.$offsetX=0,n.$offsetY=0,n.$textureWidth=0,n.$textureHeight=0,n.$sourceWidth=0,n.$sourceHeight=0,n.$smoothing=i.defaultSmoothing,n.$explicitBitmapWidth=NaN,n.$explicitBitmapHeight=NaN,n.$scale9Grid=null,n.$fillMode="scale",n._pixelHitTest=!1,n.$renderNode=new t.sys.NormalBitmapNode,n.$setTexture(r),r&&(n.$renderNode.rotated=r.$rotated),n}return r(i,e),i.prototype.createNativeDisplayObject=function(){this.$nativeDisplayObject=new egret_native.NativeDisplayObject(1)},i.prototype.$onAddToStage=function(i,r){e.prototype.$onAddToStage.call(this,i,r);var n=this.$texture;n&&n.$bitmapData&&t.BitmapData.$addDisplayObject(this,n.$bitmapData)},i.prototype.$onRemoveFromStage=function(){e.prototype.$onRemoveFromStage.call(this);var i=this.$texture;i&&t.BitmapData.$removeDisplayObject(this,i.$bitmapData)},Object.defineProperty(i.prototype,"texture",{get:function(){return this.$texture},set:function(t){this.$setTexture(t),t&&this.$renderNode&&(this.$renderNode.rotated=t.$rotated)},enumerable:!0,configurable:!0}),i.prototype.$setTexture=function(e){var i=this.$texture;if(e==i)return!1;if(this.$texture=e,!e){i&&t.BitmapData.$removeDisplayObject(this,i.$bitmapData),this.setImageData(null,0,0,0,0,0,0,0,0,0,0),this.$renderDirty=!0;var r=this.$parent;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp());var n=this.$maskedObject;return n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp()),t.nativeRender&&this.setBitmapDataToWasm(null),!0}if(this.$refreshImageData(),this.$stage){if(i&&i.$bitmapData){if(i.$bitmapData.hashCode==(e.$bitmapData?e.$bitmapData.hashCode:-1)){this.$renderDirty=!0;var a=this.$parent;a&&!a.$cacheDirty&&(a.$cacheDirty=!0,a.$cacheDirtyUp());var s=this.$maskedObject;return s&&!s.$cacheDirty&&(s.$cacheDirty=!0,s.$cacheDirtyUp()),!0}t.BitmapData.$removeDisplayObject(this,i.$bitmapData)}t.BitmapData.$addDisplayObject(this,e.$bitmapData)}this.$renderDirty=!0;var o=this.$parent;o&&!o.$cacheDirty&&(o.$cacheDirty=!0,o.$cacheDirtyUp());var h=this.$maskedObject;return h&&!h.$cacheDirty&&(h.$cacheDirty=!0,h.$cacheDirtyUp()),!0},i.prototype.$setBitmapData=function(t){this.$setTexture(t)},i.prototype.setBitmapDataToWasm=function(t){this.$nativeDisplayObject.setBitmapData(t)},i.prototype.$refreshImageData=function(){var e=this.$texture;e?(t.nativeRender&&this.setBitmapDataToWasm(e),this.setImageData(e.$bitmapData,e.$bitmapX,e.$bitmapY,e.$bitmapWidth,e.$bitmapHeight,e.$offsetX,e.$offsetY,e.$getTextureWidth(),e.$getTextureHeight(),e.$sourceWidth,e.$sourceHeight)):t.nativeRender&&this.setBitmapDataToWasm(null)},i.prototype.setImageData=function(t,e,i,r,n,a,s,o,h,l,u){this.$bitmapData=t,this.$bitmapX=e,this.$bitmapY=i,this.$bitmapWidth=r,this.$bitmapHeight=n,this.$offsetX=a,this.$offsetY=s,this.$textureWidth=o,this.$textureHeight=h,this.$sourceWidth=l,this.$sourceHeight=u},Object.defineProperty(i.prototype,"scale9Grid",{get:function(){return this.$scale9Grid},set:function(t){this.$setScale9Grid(t)},enumerable:!0,configurable:!0}),i.prototype.$setScale9Grid=function(e){if(this.$scale9Grid=e,this.$renderDirty=!0,t.nativeRender)e?this.$nativeDisplayObject.setScale9Grid(e.x,e.y,e.width,e.height):this.$nativeDisplayObject.setScale9Grid(0,0,-1,-1);else{var i=this.$parent;i&&!i.$cacheDirty&&(i.$cacheDirty=!0,i.$cacheDirtyUp());var r=this.$maskedObject;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp())}},Object.defineProperty(i.prototype,"fillMode",{get:function(){return this.$fillMode},set:function(t){this.$setFillMode(t)},enumerable:!0,configurable:!0}),i.prototype.$setFillMode=function(e){if(e==this.$fillMode)return!1;if(this.$fillMode=e,t.nativeRender)this.$nativeDisplayObject.setBitmapFillMode(this.$fillMode);else{this.$renderDirty=!0;var i=this.$parent;i&&!i.$cacheDirty&&(i.$cacheDirty=!0,i.$cacheDirtyUp());var r=this.$maskedObject;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp())}return!0},Object.defineProperty(i.prototype,"smoothing",{get:function(){return this.$smoothing},set:function(t){t!=this.$smoothing&&(this.$smoothing=t,this.$renderNode.smoothing=t)},enumerable:!0,configurable:!0}),i.prototype.$setWidth=function(e){if(e<0||e==this.$explicitBitmapWidth)return!1;if(this.$explicitBitmapWidth=e,this.$renderDirty=!0,t.nativeRender)this.$nativeDisplayObject.setWidth(e);else{var i=this.$parent;i&&!i.$cacheDirty&&(i.$cacheDirty=!0,i.$cacheDirtyUp());var r=this.$maskedObject;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp())}return!0},i.prototype.$setHeight=function(e){if(e<0||e==this.$explicitBitmapHeight)return!1;if(this.$explicitBitmapHeight=e,this.$renderDirty=!0,t.nativeRender)this.$nativeDisplayObject.setHeight(e);else{var i=this.$parent;i&&!i.$cacheDirty&&(i.$cacheDirty=!0,i.$cacheDirtyUp());var r=this.$maskedObject;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp())}return!0},i.prototype.$getWidth=function(){return isNaN(this.$explicitBitmapWidth)?this.$getContentBounds().width:this.$explicitBitmapWidth},i.prototype.$getHeight=function(){return isNaN(this.$explicitBitmapHeight)?this.$getContentBounds().height:this.$explicitBitmapHeight},i.prototype.$measureContentBounds=function(t){if(this.$bitmapData){var e=isNaN(this.$explicitBitmapWidth)?this.$textureWidth:this.$explicitBitmapWidth,i=isNaN(this.$explicitBitmapHeight)?this.$textureHeight:this.$explicitBitmapHeight;t.setTo(0,0,e,i)}else e=isNaN(this.$explicitBitmapWidth)?0:this.$explicitBitmapWidth,i=isNaN(this.$explicitBitmapHeight)?0:this.$explicitBitmapHeight,t.setTo(0,0,e,i)},i.prototype.$updateRenderNode=function(){if(this.$texture){var e=isNaN(this.$explicitBitmapWidth)?this.$textureWidth:this.$explicitBitmapWidth,i=isNaN(this.$explicitBitmapHeight)?this.$textureHeight:this.$explicitBitmapHeight,r=this.scale9Grid||this.$texture.scale9Grid;r?(this.$renderNode instanceof t.sys.NormalBitmapNode&&(this.$renderNode=new t.sys.BitmapNode),t.sys.BitmapNode.$updateTextureDataWithScale9Grid(this.$renderNode,this.$bitmapData,r,this.$bitmapX,this.$bitmapY,this.$bitmapWidth,this.$bitmapHeight,this.$offsetX,this.$offsetY,this.$textureWidth,this.$textureHeight,e,i,this.$sourceWidth,this.$sourceHeight,this.$smoothing)):(this.fillMode==t.BitmapFillMode.REPEAT&&this.$renderNode instanceof t.sys.NormalBitmapNode&&(this.$renderNode=new t.sys.BitmapNode),t.sys.BitmapNode.$updateTextureData(this.$renderNode,this.$bitmapData,this.$bitmapX,this.$bitmapY,this.$bitmapWidth,this.$bitmapHeight,this.$offsetX,this.$offsetY,this.$textureWidth,this.$textureHeight,e,i,this.$sourceWidth,this.$sourceHeight,this.$fillMode,this.$smoothing))}},Object.defineProperty(i.prototype,"pixelHitTest",{get:function(){return this._pixelHitTest},set:function(t){this._pixelHitTest=!!t},enumerable:!0,configurable:!0}),i.prototype.$hitTest=function(t,i){var r=e.prototype.$hitTest.call(this,t,i);return r&&this._pixelHitTest&&(this.hitTestPoint(t,i,!0)||(r=null)),r},i.defaultSmoothing=!0,i}(t.DisplayObject);t.Bitmap=e,i(e.prototype,"egret.Bitmap")}(f||(f={})),function(t){!function(t){var e=function(){function t(){this.type=0,this.drawData=[],this.renderCount=0}return t.prototype.cleanBeforeRender=function(){this.drawData.length=0,this.renderCount=0},t.prototype.$getRenderCount=function(){return this.renderCount},t}();t.RenderNode=e,i(e.prototype,"egret.sys.RenderNode")}(t.sys||(t.sys={}))}(f||(f={})),function(t){!function(t){var e=function(){function t(){this.type=0,this.$commands=[],this.$data=[],this.commandPosition=0,this.dataPosition=0,this.$lastX=0,this.$lastY=0}return t.prototype.moveTo=function(t,e){this.$commands[this.commandPosition++]=1;var i=this.dataPosition;this.$data[i++]=t,this.$data[i++]=e,this.dataPosition=i},t.prototype.lineTo=function(t,e){this.$commands[this.commandPosition++]=2;var i=this.dataPosition;this.$data[i++]=t,this.$data[i++]=e,this.dataPosition=i},t.prototype.curveTo=function(t,e,i,r){this.$commands[this.commandPosition++]=3;var n=this.dataPosition;this.$data[n++]=t,this.$data[n++]=e,this.$data[n++]=i,this.$data[n++]=r,this.dataPosition=n},t.prototype.cubicCurveTo=function(t,e,i,r,n,a){this.$commands[this.commandPosition++]=4;var s=this.dataPosition;this.$data[s++]=t,this.$data[s++]=e,this.$data[s++]=i,this.$data[s++]=r,this.$data[s++]=n,this.$data[s++]=a,this.dataPosition=s},t.prototype.drawRect=function(t,e,i,r){var n=t+i,a=e+r;this.moveTo(t,e),this.lineTo(n,e),this.lineTo(n,a),this.lineTo(t,a),this.lineTo(t,e)},t.prototype.drawRoundRect=function(t,e,i,r,n,a){var s=.5*n|0,o=a?.5*a|0:s;if(s&&o){var h=.5*i,l=.5*r;if(s>h&&(s=h),o>l&&(o=l),h!==s||l!==o){var u=t+i,c=e+r,p=t+s,f=u-s,d=e+o,m=c-o;this.moveTo(u,m),this.curveTo(u,c,f,c),this.lineTo(p,c),this.curveTo(t,c,t,m),this.lineTo(t,d),this.curveTo(t,e,p,e),this.lineTo(f,e),this.curveTo(u,e,u,d),this.lineTo(u,m)}else s===o?this.drawCircle(t+s,e+o,s):this.drawEllipse(t,e,2*s,2*o)}else this.drawRect(t,e,i,r)},t.prototype.drawCircle=function(t,e,i){this.arcToBezier(t,e,i,i,0,2*Math.PI)},t.prototype.drawEllipse=function(t,e,i,r){var n=.5*i,a=.5*r;t+=n,e+=a,this.arcToBezier(t,e,n,a,0,2*Math.PI)},t.prototype.drawArc=function(t,e,i,r,n,a){a?n>=r&&(n-=2*Math.PI):n<=r&&(n+=2*Math.PI),this.arcToBezier(t,e,i,i,r,n,a)},t.prototype.arcToBezier=function(t,e,i,r,n,a,s){var o=.5*Math.PI,h=n,l=h;s?(l+=-o-h%o)<a&&(l=a):(l+=o-h%o)>a&&(l=a);var u=t+Math.cos(h)*i,c=e+Math.sin(h)*r;this.$lastX==u&&this.$lastY==c||this.moveTo(u,c);for(var p=Math.cos(h),f=Math.sin(h),d=0;d<4;d++){var m=l-h,g=4*Math.tan(m/4)/3,y=u-f*g*i,_=c+p*g*r,v=(u=t+(p=Math.cos(l))*i)+(f=Math.sin(l))*g*i,b=(c=e+f*r)-p*g*r;if(this.cubicCurveTo(y,_,v,b,u,c),l===a)break;h=l,s?(l=h-o)<a&&(l=a):(l=h+o)>a&&(l=a)}},t}();t.Path2D=e,i(e.prototype,"egret.sys.Path2D")}(t.sys||(t.sys={}))}(f||(f={})),(f||(f={})).fontMapping={},(f||(f={})).createMap=function(){var t=Object.create(null);return t.__v8__=void 0,delete t.__v8__,t},function(t){var e=function(t){function e(e,i,r,n,a,s,o,h){void 0===e&&(e=16711680),void 0===i&&(i=1),void 0===r&&(r=6),void 0===n&&(n=6),void 0===a&&(a=2),void 0===s&&(s=1),void 0===o&&(o=!1),void 0===h&&(h=!1);var l=t.call(this)||this,u=l;return u.type="glow",u.$color=e,u.$blue=255&e,u.$green=(65280&e)>>8,u.$red=e>>16,u.$alpha=i,u.$blurX=r,u.$blurY=n,u.$strength=a,u.$quality=s,u.$inner=o,u.$knockout=h,u.$uniforms.color={x:l.$red/255,y:l.$green/255,z:l.$blue/255,w:1},u.$uniforms.alpha=i,u.$uniforms.blurX=r,u.$uniforms.blurY=n,u.$uniforms.strength=a,u.$uniforms.inner=o?1:0,u.$uniforms.knockout=h?0:1,u.$uniforms.dist=0,u.$uniforms.angle=0,u.$uniforms.hideObject=0,u.onPropertyChange(),l}return r(e,t),Object.defineProperty(e.prototype,"color",{get:function(){return this.$color},set:function(t){this.$color!=t&&(this.$color=t,this.$blue=255&t,this.$green=(65280&t)>>8,this.$red=t>>16,this.$uniforms.color.x=this.$red/255,this.$uniforms.color.y=this.$green/255,this.$uniforms.color.z=this.$blue/255)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this.$alpha},set:function(t){this.$alpha!=t&&(this.$alpha=t,this.$uniforms.alpha=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"blurX",{get:function(){return this.$blurX},set:function(t){this.$blurX!=t&&(this.$blurX=t,this.$uniforms.blurX=t,this.onPropertyChange())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"blurY",{get:function(){return this.$blurY},set:function(t){this.$blurY!=t&&(this.$blurY=t,this.$uniforms.blurY=t,this.onPropertyChange())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"strength",{get:function(){return this.$strength},set:function(t){this.$strength!=t&&(this.$strength=t,this.$uniforms.strength=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"quality",{get:function(){return this.$quality},set:function(t){this.$quality!=t&&(this.$quality=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inner",{get:function(){return this.$inner},set:function(t){this.$inner!=t&&(this.$inner=t,this.$uniforms.inner=t?1:0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"knockout",{get:function(){return this.$knockout},set:function(t){this.$knockout!=t&&(this.$knockout=t,this.$uniforms.knockout=t?0:1)},enumerable:!0,configurable:!0}),e.prototype.$toJson=function(){return'{"color": '+this.$color+', "red": '+this.$red+', "green": '+this.$green+', "blue": '+this.$blue+', "alpha": '+this.$alpha+', "blurX": '+this.$blurX+', "blurY": '+this.blurY+', "strength": '+this.$strength+', "quality": '+this.$quality+', "inner": '+this.$inner+', "knockout": '+this.$knockout+"}"},e.prototype.updatePadding=function(){this.paddingLeft=this.blurX,this.paddingRight=this.blurX,this.paddingTop=this.blurY,this.paddingBottom=this.blurY},e}(t.Filter);t.GlowFilter=e,i(e.prototype,"egret.GlowFilter")}(f||(f={})),function(t){var e=function(){function t(){}return t.NORMAL="normal",t.ADD="add",t.ERASE="erase",t}();t.BlendMode=e,i(e.prototype,"egret.BlendMode")}(f||(f={})),function(t){!function(t){for(var e=["normal","add","erase"],i={},r=e.length,n=0;n<r;n++){i[e[n]]=n}t.blendModeToNumber=function(t){var e=i[t];return void 0===e?0:e},t.numberToBlendMode=function(t){var i=e[t];return void 0===i?"normal":i}}(t.sys||(t.sys={}))}(f||(f={})),(f||(f={})).CapsStyle={NONE:"none",ROUND:"round",SQUARE:"square"},function(t){var e=function(){function e(){}return e.compileProgram=function(i,r,n){var a=e.compileFragmentShader(i,n),s=e.compileVertexShader(i,r),o=i.createProgram();return i.attachShader(o,s),i.attachShader(o,a),i.linkProgram(o),i.getProgramParameter(o,i.LINK_STATUS)||t.$warn(1020),o},e.compileFragmentShader=function(t,i){return e._compileShader(t,i,t.FRAGMENT_SHADER)},e.compileVertexShader=function(t,i){return e._compileShader(t,i,t.VERTEX_SHADER)},e._compileShader=function(t,e,i){var r=t.createShader(i);return t.shaderSource(r,e),t.compileShader(r),t.getShaderParameter(r,t.COMPILE_STATUS)?r:null},e.checkCanUseWebGL=function(){if(void 0==e.canUseWebGL)try{var t=document.createElement("canvas");e.canUseWebGL=!(!window.WebGLRenderingContext||!t.getContext("webgl")&&!t.getContext("experimental-webgl"))}catch(t){e.canUseWebGL=!1}return e.canUseWebGL},e.deleteWebGLTexture=function(t){if(t){var e=t.glContext;e&&e.deleteTexture(t)}},e}();t.WebGLUtils=e,i(e.prototype,"egret.WebGLUtils")}(f||(f={})),function(t){var e=function(t){function e(e,i,r){return void 0===i&&(i=!1),void 0===r&&(r=!1),t.call(this,e,i,r)||this}return r(e,t),e.FOCUS_IN="focusIn",e.FOCUS_OUT="focusOut",e}(t.Event);t.FocusEvent=e,i(e.prototype,"egret.FocusEvent")}(f||(f={})),function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.PERMISSION_DENIED="permissionDenied",e.UNAVAILABLE="unavailable",e}(t.Event);t.GeolocationEvent=e,i(e.prototype,"egret.GeolocationEvent")}(f||(f={})),function(t){var e=function(e){function i(t,i,r){void 0===i&&(i=!1),void 0===r&&(r=!1);var n=e.call(this,t,i,r)||this;return n._status=0,n}return r(i,e),Object.defineProperty(i.prototype,"status",{get:function(){return this._status},enumerable:!0,configurable:!0}),i.dispatchHTTPStatusEvent=function(e,r){var n=t.Event.create(i,i.HTTP_STATUS);n._status=r;var a=e.dispatchEvent(n);return t.Event.release(n),a},i.HTTP_STATUS="httpStatus",i}(t.Event);t.HTTPStatusEvent=e,i(e.prototype,"egret.HTTPStatusEvent")}(f||(f={})),function(t){var e=function(e){function i(t,i,r){return void 0===i&&(i=!1),void 0===r&&(r=!1),e.call(this,t,i,r)||this}return r(i,e),i.dispatchIOErrorEvent=function(e){var r=t.Event.create(i,i.IO_ERROR),n=e.dispatchEvent(r);return t.Event.release(r),n},i.IO_ERROR="ioError",i}(t.Event);t.IOErrorEvent=e,i(e.prototype,"egret.IOErrorEvent")}(f||(f={})),function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e}(t.Event);t.MotionEvent=e,i(e.prototype,"egret.MotionEvent")}(f||(f={})),function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e}(t.Event);t.OrientationEvent=e,i(e.prototype,"egret.OrientationEvent")}(f||(f={})),function(t){var e=function(e){function i(t,i,r,n,a){void 0===i&&(i=!1),void 0===r&&(r=!1),void 0===n&&(n=0),void 0===a&&(a=0);var s=e.call(this,t,i,r)||this;return s.bytesLoaded=0,s.bytesTotal=0,s.bytesLoaded=n,s.bytesTotal=a,s}return r(i,e),i.dispatchProgressEvent=function(e,r,n,a){void 0===n&&(n=0),void 0===a&&(a=0);var s=t.Event.create(i,r);s.bytesLoaded=n,s.bytesTotal=a;var o=e.dispatchEvent(s);return t.Event.release(s),o},i.PROGRESS="progress",i.SOCKET_DATA="socketData",i}(t.Event);t.ProgressEvent=e,i(e.prototype,"egret.ProgressEvent")}(f||(f={})),function(t){var e=function(e){function i(t,i,r){return void 0===i&&(i=!1),void 0===r&&(r=!1),e.call(this,t,i,r)||this}return r(i,e),i.dispatchStageOrientationEvent=function(e,r){var n=t.Event.create(i,r),a=e.dispatchEvent(n);return t.Event.release(n),a},i.ORIENTATION_CHANGE="orientationChange",i}(t.Event);t.StageOrientationEvent=e,i(e.prototype,"egret.StageOrientationEvent")}(f||(f={})),function(t){var e=function(e){function i(t,i,r,n){void 0===i&&(i=!1),void 0===r&&(r=!1),void 0===n&&(n="");var a=e.call(this,t,i,r)||this;return a.text=n,a}return r(i,e),i.dispatchTextEvent=function(e,r,n){var a=t.Event.create(i,r);a.text=n;var s=e.dispatchEvent(a);return t.Event.release(a),s},i.LINK="link",i}(t.Event);t.TextEvent=e,i(e.prototype,"egret.TextEvent")}(f||(f={})),function(t){var e=function(e){function i(t,i,r){return e.call(this,t,i,r)||this}return r(i,e),i.prototype.updateAfterEvent=function(){t.sys.$requestRenderingFlag=!0},i.dispatchTimerEvent=function(e,r,n,a){var s=t.Event.create(i,r,n,a),o=e.dispatchEvent(s);return t.Event.release(s),o},i.TIMER="timer",i.TIMER_COMPLETE="timerComplete",i}(t.Event);t.TimerEvent=e,i(e.prototype,"egret.TimerEvent")}(f||(f={})),function(t){var e=function(e){function i(t){var i=e.call(this)||this;return i.format="image",i.$deleteSource=!0,i.source=t,i.width=t.width,i.height=t.height,i}return r(i,e),i.create=function(e,r,n){var a="",s="image/png";"/"===(a="arraybuffer"===e?t.Base64Util.encode(r):r).charAt(0)?s="image/jpeg":"R"===a.charAt(0)?s="image/gif":"i"===a.charAt(0)&&(s="image/png");var o=new Image;o.src="data:"+s+";base64,"+a,o.crossOrigin="*";var h=new i(o);return o.onload=function(){o.onload=void 0,h.source=o,h.height=o.height,h.width=o.width,n&&n(h)},h},i.prototype.$dispose=function(){"webgl"==t.Capabilities.renderMode&&this.webGLTexture&&(t.WebGLUtils.deleteWebGLTexture(this.webGLTexture),this.webGLTexture=null),this.source&&this.source.dispose&&this.source.dispose(),this.source=null,i.$dispose(this)},i.$addDisplayObject=function(t,e){if(e){var r=e.hashCode;if(r)if(i._displayList[r]){var n=i._displayList[r];n.indexOf(t)<0&&n.push(t)}else i._displayList[r]=[t]}},i.$removeDisplayObject=function(t,e){if(e){var r=e.hashCode;if(r&&i._displayList[r]){var n=i._displayList[r],a=n.indexOf(t);a>=0&&n.splice(a,1)}}},i.$invalidate=function(e){if(e){var r=e.hashCode;if(r&&i._displayList[r])for(var n=i._displayList[r],a=0;a<n.length;a++){n[a]instanceof t.Bitmap&&n[a].$refreshImageData();var s=n[a];s.$renderDirty=!0;var o=s.$parent;o&&!o.$cacheDirty&&(o.$cacheDirty=!0,o.$cacheDirtyUp());var h=s.$maskedObject;h&&!h.$cacheDirty&&(h.$cacheDirty=!0,h.$cacheDirtyUp())}}},i.$dispose=function(e){if(e){var r=e.hashCode;if(r&&i._displayList[r]){for(var n=0,a=i._displayList[r];n<a.length;n++){var s=a[n];s instanceof t.Bitmap&&(s.$bitmapData=null),s.$renderDirty=!0;var o=s.$parent;o&&!o.$cacheDirty&&(o.$cacheDirty=!0,o.$cacheDirtyUp());var h=s.$maskedObject;h&&!h.$cacheDirty&&(h.$cacheDirty=!0,h.$cacheDirtyUp())}t.nativeRender&&egret_native.NativeDisplayObject.disposeBitmapData(e),delete i._displayList[r]}}},i._displayList=t.createMap(),i}(t.HashObject);t.BitmapData=e,i(e.prototype,"egret.BitmapData")}(f||(f={})),function(t){var e=new t.Point,n=function(i){function n(t,e,r,n,a,s){var o=i.call(this,t,e,r)||this;return o.targetChanged=!0,o.touchDown=!1,o.$initTo(n,a,s),o}return r(n,i),n.prototype.$initTo=function(t,e,i){this.touchPointID=+i||0,this.$stageX=+t||0,this.$stageY=+e||0},Object.defineProperty(n.prototype,"stageX",{get:function(){return this.$stageX},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"stageY",{get:function(){return this.$stageY},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"localX",{get:function(){return this.targetChanged&&this.getLocalXY(),this._localX},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"localY",{get:function(){return this.targetChanged&&this.getLocalXY(),this._localY},enumerable:!0,configurable:!0}),n.prototype.getLocalXY=function(){this.targetChanged=!1,this.$target.$getInvertedConcatenatedMatrix().transformPoint(this.$stageX,this.$stageY,e),this._localX=e.x,this._localY=e.y},n.prototype.$setTarget=function(t){return this.$target=t,this.targetChanged=!!t,!0},n.prototype.updateAfterEvent=function(){t.sys.$requestRenderingFlag=!0},n.dispatchTouchEvent=function(e,i,r,a,s,o,h,l){if(void 0===l&&(l=!1),!r&&!e.hasEventListener(i))return!0;var u=t.Event.create(n,i,r,a);u.$initTo(s,o,h),u.touchDown=l;var c=e.dispatchEvent(u);return t.Event.release(u),c},n.TOUCH_MOVE="touchMove",n.TOUCH_BEGIN="touchBegin",n.TOUCH_END="touchEnd",n.TOUCH_CANCEL="touchCancel",n.TOUCH_TAP="touchTap",n.TOUCH_RELEASE_OUTSIDE="touchReleaseOutside",n}(t.Event);t.TouchEvent=n,i(n.prototype,"egret.TouchEvent")}(f||(f={})),f||(f={}),function(t){var e=function(e){function i(t,i,r){void 0===t&&(t=4),void 0===i&&(i=4),void 0===r&&(r=1);var s=e.call(this)||this,o=s;return o.type="blur",o.$blurX=t,o.$blurY=i,o.$quality=r,o.blurXFilter=new n(t),o.blurYFilter=new a(i),o.onPropertyChange(),s}return r(i,e),Object.defineProperty(i.prototype,"blurX",{get:function(){return this.$blurX},set:function(t){this.$blurX!=t&&(this.$blurX=t,this.blurXFilter.blurX=t,this.onPropertyChange())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"blurY",{get:function(){return this.$blurY},set:function(t){this.$blurY!=t&&(this.$blurY=t,this.blurYFilter.blurY=t,this.onPropertyChange())},enumerable:!0,configurable:!0}),i.prototype.$toJson=function(){return'{"blurX": '+this.$blurX+', "blurY": '+this.$blurY+', "quality": 1}'},i.prototype.updatePadding=function(){this.paddingLeft=this.blurX,this.paddingRight=this.blurX,this.paddingTop=this.blurY,this.paddingBottom=this.blurY},i.prototype.onPropertyChange=function(){this.updatePadding(),t.nativeRender&&(egret_native.NativeDisplayObject.setFilterPadding(this.blurXFilter.$id,0,0,this.paddingLeft,this.paddingRight),egret_native.NativeDisplayObject.setFilterPadding(this.blurYFilter.$id,this.paddingTop,this.paddingBottom,0,0),egret_native.NativeDisplayObject.setDataToFilter(this))},i}(t.Filter);t.BlurFilter=e,i(e.prototype,"egret.BlurFilter");var n=function(e){function i(i){void 0===i&&(i=4);var r=e.call(this)||this;return t.nativeRender?r.type="blur":r.type="blurX",r.$uniforms.blur={x:i,y:0},r.onPropertyChange(),r}return r(i,e),Object.defineProperty(i.prototype,"blurX",{get:function(){return this.$uniforms.blur.x},set:function(t){this.$uniforms.blur.x=t},enumerable:!0,configurable:!0}),i}(t.Filter);i(n.prototype,"BlurXFilter",["egret.IBlurXFilter"]);var a=function(e){function i(i){void 0===i&&(i=4);var r=e.call(this)||this;return t.nativeRender?r.type="blur":r.type="blurY",r.$uniforms.blur={x:0,y:i},r.onPropertyChange(),r}return r(i,e),Object.defineProperty(i.prototype,"blurY",{get:function(){return this.$uniforms.blur.y},set:function(t){this.$uniforms.blur.y=t},enumerable:!0,configurable:!0}),i}(t.Filter);i(a.prototype,"BlurYFilter",["egret.IBlurYFilter"])}(f||(f={})),function(t){var e=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this)||this;return i.$matrix=[],i.matrix2=[],i.type="colorTransform",i.$uniforms.matrix=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],i.$uniforms.colorAdd={x:0,y:0,z:0,w:0},i.setMatrix(e),i.onPropertyChange(),i}return r(e,t),Object.defineProperty(e.prototype,"matrix",{get:function(){for(var t=0;t<20;t++)this.matrix2[t]=this.$matrix[t];return this.matrix2},set:function(t){this.setMatrix(t)},enumerable:!0,configurable:!0}),e.prototype.setMatrix=function(t){if(t)for(var e=0;e<20;e++)this.$matrix[e]=t[e];else for(e=0;e<20;e++)this.$matrix[e]=0==e||6==e||12==e||18==e?1:0;for(var i=this.$matrix,r=this.$uniforms.matrix,n=this.$uniforms.colorAdd,a=(e=0,0);e<i.length;e++)4===e?n.x=i[e]/255:9===e?n.y=i[e]/255:14===e?n.z=i[e]/255:19===e?n.w=i[e]/255:(r[a]=i[e],a++);this.onPropertyChange()},e.prototype.$toJson=function(){return'{"matrix": ['+this.$matrix.toString()+"]}"},e}(t.Filter);t.ColorMatrixFilter=e,i(e.prototype,"egret.ColorMatrixFilter")}(f||(f={})),function(t){var e,n={},a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),s=new Array(36),o=0,h=function(){for(var t=0;t<36;t++)8===t||13===t||18===t||23===t?s[t]="-":14===t?s[t]="4":(o<=2&&(o=33554432+16777216*Math.random()|0),e=15&o,o>>=4,s[t]=a[19===t?3&e|8:e]);return s.join("")},l=function(e){function i(t,i,r){void 0===r&&(r={});var a=e.call(this)||this;a.$padding=0,a.$vertexSrc=t,a.$fragmentSrc=i;var s=t+i;return n[s]||(n[s]=h()),a.$shaderKey=n[s],a.$uniforms=r,a.type="custom",a}return r(i,e),Object.defineProperty(i.prototype,"padding",{get:function(){return this.$padding},set:function(t){this.$padding!=t&&(this.$padding=t,this.onPropertyChange())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"uniforms",{get:function(){return this.$uniforms},enumerable:!0,configurable:!0}),i.prototype.onPropertyChange=function(){t.nativeRender&&(egret_native.NativeDisplayObject.setFilterPadding(this.$id,this.$padding,this.$padding,this.$padding,this.$padding),egret_native.NativeDisplayObject.setDataToFilter(this))},i}(t.Filter);t.CustomFilter=l,i(l.prototype,"egret.CustomFilter")}(f||(f={})),function(t){var e=function(e){function i(t,i,r,n,a,s,o,h,l,u,c){void 0===t&&(t=4),void 0===i&&(i=45),void 0===r&&(r=0),void 0===n&&(n=1),void 0===a&&(a=4),void 0===s&&(s=4),void 0===o&&(o=1),void 0===h&&(h=1),void 0===l&&(l=!1),void 0===u&&(u=!1),void 0===c&&(c=!1);var p=e.call(this,r,n,a,s,o,h,l,u)||this,f=p;return f.$distance=t,f.$angle=i,f.$hideObject=c,f.$uniforms.dist=t,f.$uniforms.angle=i/180*Math.PI,f.$uniforms.hideObject=c?1:0,f.onPropertyChange(),p}return r(i,e),Object.defineProperty(i.prototype,"distance",{get:function(){return this.$distance},set:function(t){this.$distance!=t&&(this.$distance=t,this.$uniforms.dist=t,this.onPropertyChange())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"angle",{get:function(){return this.$angle},set:function(t){this.$angle!=t&&(this.$angle=t,this.$uniforms.angle=t/180*Math.PI,this.onPropertyChange())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"hideObject",{get:function(){return this.$hideObject},set:function(t){this.$hideObject!=t&&(this.$hideObject=t,this.$uniforms.hideObject=t?1:0)},enumerable:!0,configurable:!0}),i.prototype.$toJson=function(){return'{"distance": '+this.$distance+', "angle": '+this.$angle+', "color": '+this.$color+', "red": '+this.$red+', "green": '+this.$green+', "blue": '+this.$blue+', "alpha": '+this.$alpha+', "blurX": '+this.$blurX+', "blurY": '+this.blurY+', "strength": '+this.$strength+', "quality": '+this.$quality+', "inner": '+this.$inner+', "knockout": '+this.$knockout+', "hideObject": '+this.$hideObject+"}"},i.prototype.updatePadding=function(){this.paddingLeft=this.blurX,this.paddingRight=this.blurX,this.paddingTop=this.blurY,this.paddingBottom=this.blurY;var e=this.distance||0,i=this.angle||0,r=0,n=0;0!=e&&(r=(r=e*t.NumberUtils.cos(i))>0?Math.ceil(r):Math.floor(r),n=(n=e*t.NumberUtils.sin(i))>0?Math.ceil(n):Math.floor(n),this.paddingLeft+=r,this.paddingRight+=r,this.paddingTop+=n,this.paddingBottom+=n)},i}(t.GlowFilter);t.DropShadowFilter=e,i(e.prototype,"egret.DropShadowFilter")}(f||(f={})),function(t){var e=function(){function t(){}return t.LINEAR="linear",t.RADIAL="radial",t}();t.GradientType=e,i(e.prototype,"egret.GradientType")}(f||(f={})),function(t){function e(t){return(t%=2*Math.PI)<0&&(t+=2*Math.PI),t}function n(t,e){for(var i=[],r=0;r<e;r++){var n=a(t,r/e);n&&i.push(n)}return i}function a(e,i){var r=0,n=0,a=0,h=e.length;if(h/2==3){var l=e[r++],u=e[r++],c=e[r++],p=e[r++],f=e[r++],d=e[r++];n=s(l,c,f,i),a=s(u,p,d,i)}else if(h/2==4){l=e[r++],u=e[r++],c=e[r++],p=e[r++],f=e[r++],d=e[r++];var m=e[r++],g=e[r++];n=o(l,c,f,m,i),a=o(u,p,d,g,i)}return t.Point.create(n,a)}function s(t,e,i,r){return Math.pow(1-r,2)*t+2*r*(1-r)*e+Math.pow(r,2)*i}function o(t,e,i,r,n){return Math.pow(1-n,3)*t+3*n*Math.pow(1-n,2)*e+3*(1-n)*Math.pow(n,2)*i+Math.pow(n,3)*r}var h=function(i){function a(){var e=i.call(this)||this;return e.lastX=0,e.lastY=0,e.fillPath=null,e.strokePath=null,e.topLeftStrokeWidth=0,e.bottomRightStrokeWidth=0,e.minX=1/0,e.minY=1/0,e.maxX=-1/0,e.maxY=-1/0,e.includeLastPosition=!0,e.$renderNode=new t.sys.GraphicsNode,e}return r(a,i),a.prototype.$setTarget=function(e){this.$targetDisplay&&(this.$targetDisplay.$renderNode=null),e.$renderNode=this.$renderNode,this.$targetDisplay=e,this.$targetIsSprite=e instanceof t.Sprite},a.prototype.setStrokeWidth=function(t){switch(t){case 1:this.topLeftStrokeWidth=0,this.bottomRightStrokeWidth=1;break;case 3:this.topLeftStrokeWidth=1,this.bottomRightStrokeWidth=2;break;default:var e=0|Math.ceil(.5*t);this.topLeftStrokeWidth=e,this.bottomRightStrokeWidth=e}},a.prototype.beginFill=function(e,i){void 0===i&&(i=1),e=+e||0,i=+i||0,t.nativeRender&&this.$targetDisplay.$nativeDisplayObject.setBeginFill(e,i),this.fillPath=this.$renderNode.beginFill(e,i,this.strokePath),this.$renderNode.drawData.length>1&&this.fillPath.moveTo(this.lastX,this.lastY)},a.prototype.beginGradientFill=function(e,i,r,n,a){void 0===a&&(a=null),t.nativeRender&&this.$targetDisplay.$nativeDisplayObject.setBeginGradientFill(e,i,r,n,a),this.fillPath=this.$renderNode.beginGradientFill(e,i,r,n,a,this.strokePath),this.$renderNode.drawData.length>1&&this.fillPath.moveTo(this.lastX,this.lastY)},a.prototype.endFill=function(){t.nativeRender&&this.$targetDisplay.$nativeDisplayObject.setEndFill(),this.fillPath=null},a.prototype.lineStyle=function(e,i,r,n,a,s,o,h,l){void 0===e&&(e=NaN),void 0===i&&(i=0),void 0===r&&(r=1),void 0===n&&(n=!1),void 0===a&&(a="normal"),void 0===s&&(s=null),void 0===o&&(o=null),void 0===h&&(h=3),e=+e||0,i=+i||0,r=+r||0,h=+h||0,t.nativeRender&&this.$targetDisplay.$nativeDisplayObject.setLineStyle(e,i,r,n,a,s,o,h),e<=0?(this.strokePath=null,this.setStrokeWidth(0)):(this.setStrokeWidth(e),this.strokePath=this.$renderNode.lineStyle(e,i,r,s,o,h,l),this.$renderNode.drawData.length>1&&this.strokePath.moveTo(this.lastX,this.lastY))},a.prototype.drawRect=function(e,i,r,n){e=+e||0,i=+i||0,r=+r||0,n=+n||0,t.nativeRender&&this.$targetDisplay.$nativeDisplayObject.setDrawRect(e,i,r,n);var a=this.fillPath,s=this.strokePath;a&&a.drawRect(e,i,r,n),s&&s.drawRect(e,i,r,n),this.extendBoundsByPoint(e+r,i+n),this.updatePosition(e,i),this.dirty()},a.prototype.drawRoundRect=function(e,i,r,n,a,s){e=+e||0,i=+i||0,r=+r||0,n=+n||0,a=+a||0,s=+s||0,t.nativeRender&&this.$targetDisplay.$nativeDisplayObject.setDrawRoundRect(e,i,r,n,a,s);var o=this.fillPath,h=this.strokePath;o&&o.drawRoundRect(e,i,r,n,a,s),h&&h.drawRoundRect(e,i,r,n,a,s);var l=e+r,u=i+n,c=u-(s?.5*s|0:.5*a|0);this.extendBoundsByPoint(e,i),this.extendBoundsByPoint(l,u),this.updatePosition(l,c),this.dirty()},a.prototype.drawCircle=function(e,i,r){e=+e||0,i=+i||0,r=+r||0,t.nativeRender&&this.$targetDisplay.$nativeDisplayObject.setDrawCircle(e,i,r);var n=this.fillPath,a=this.strokePath;n&&n.drawCircle(e,i,r),a&&a.drawCircle(e,i,r),this.extendBoundsByPoint(e-r-1,i-r-1),this.extendBoundsByPoint(e+r+2,i+r+2),this.updatePosition(e+r,i),this.dirty()},a.prototype.drawEllipse=function(e,i,r,n){e=+e||0,i=+i||0,r=+r||0,n=+n||0,t.nativeRender&&this.$targetDisplay.$nativeDisplayObject.setDrawEllipse(e,i,r,n);var a=this.fillPath,s=this.strokePath;a&&a.drawEllipse(e,i,r,n),s&&s.drawEllipse(e,i,r,n),this.extendBoundsByPoint(e-1,i-1),this.extendBoundsByPoint(e+r+2,i+n+2),this.updatePosition(e+r,i+.5*n),this.dirty()},a.prototype.moveTo=function(e,i){e=+e||0,i=+i||0,t.nativeRender&&this.$targetDisplay.$nativeDisplayObject.setMoveTo(e,i);var r=this.fillPath,n=this.strokePath;r&&r.moveTo(e,i),n&&n.moveTo(e,i),this.includeLastPosition=!1,this.lastX=e,this.lastY=i,this.dirty()},a.prototype.lineTo=function(e,i){e=+e||0,i=+i||0,t.nativeRender&&this.$targetDisplay.$nativeDisplayObject.setLineTo(e,i);var r=this.fillPath,n=this.strokePath;r&&r.lineTo(e,i),n&&n.lineTo(e,i),this.updatePosition(e,i),this.dirty()},a.prototype.curveTo=function(e,i,r,a){e=+e||0,i=+i||0,r=+r||0,a=+a||0,t.nativeRender&&this.$targetDisplay.$nativeDisplayObject.setCurveTo(e,i,r,a);var s=this.fillPath,o=this.strokePath;s&&s.curveTo(e,i,r,a),o&&o.curveTo(e,i,r,a);for(var h=n([this.lastX||0,this.lastY||0,e,i,r,a],50),l=0;l<h.length;l++){var u=h[l];this.extendBoundsByPoint(u.x,u.y),t.Point.release(u)}this.extendBoundsByPoint(r,a),this.updatePosition(r,a),this.dirty()},a.prototype.cubicCurveTo=function(e,i,r,a,s,o){e=+e||0,i=+i||0,r=+r||0,a=+a||0,s=+s||0,o=+o||0,t.nativeRender&&this.$targetDisplay.$nativeDisplayObject.setCubicCurveTo(e,i,r,a,s,o);var h=this.fillPath,l=this.strokePath;h&&h.cubicCurveTo(e,i,r,a,s,o),l&&l.cubicCurveTo(e,i,r,a,s,o);for(var u=n([this.lastX||0,this.lastY||0,e,i,r,a,s,o],50),c=0;c<u.length;c++){var p=u[c];this.extendBoundsByPoint(p.x,p.y),t.Point.release(p)}this.extendBoundsByPoint(s,o),this.updatePosition(s,o),this.dirty()},a.prototype.drawArc=function(i,r,n,a,s,o){if(!(n<0||a===s)){i=+i||0,r=+r||0,n=+n||0,a=+a||0,s=+s||0,o=!!o,a=e(a),s=e(s),t.nativeRender&&this.$targetDisplay.$nativeDisplayObject.setDrawArc(i,r,n,a,s,o);var h=this.fillPath,l=this.strokePath;h&&(h.$lastX=this.lastX,h.$lastY=this.lastY,h.drawArc(i,r,n,a,s,o)),l&&(l.$lastX=this.lastX,l.$lastY=this.lastY,l.drawArc(i,r,n,a,s,o)),o?this.arcBounds(i,r,n,s,a):this.arcBounds(i,r,n,a,s);var u=i+Math.cos(s)*n,c=r+Math.sin(s)*n;this.updatePosition(u,c),this.dirty()}},a.prototype.dirty=function(){if(this.$renderNode.dirtyRender=!0,!t.nativeRender){var e=this.$targetDisplay;e.$cacheDirty=!0;var i=e.$parent;i&&!i.$cacheDirty&&(i.$cacheDirty=!0,i.$cacheDirtyUp());var r=e.$maskedObject;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp())}},a.prototype.arcBounds=function(t,e,i,r,n){var a=Math.PI;if(Math.abs(r-n)<.01)return this.extendBoundsByPoint(t-i,e-i),void this.extendBoundsByPoint(t+i,e+i);r>n&&(n+=2*a);for(var s=Math.cos(r)*i,o=Math.cos(n)*i,h=Math.min(s,o),l=Math.max(s,o),u=Math.sin(r)*i,c=Math.sin(n)*i,p=Math.min(u,c),f=Math.max(u,c),d=r/(.5*a),m=n/(.5*a),g=Math.ceil(d);g<=m;g++)switch(g%4){case 0:l=i;break;case 1:f=i;break;case 2:h=-i;break;case 3:p=-i}h=Math.floor(h),p=Math.floor(p),l=Math.ceil(l),f=Math.ceil(f),this.extendBoundsByPoint(h+t,p+e),this.extendBoundsByPoint(l+t,f+e)},a.prototype.clear=function(){t.nativeRender&&this.$targetDisplay.$nativeDisplayObject.setGraphicsClear(),this.$renderNode.clear(),this.updatePosition(0,0),this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.dirty()},a.prototype.extendBoundsByPoint=function(t,e){this.extendBoundsByX(t),this.extendBoundsByY(e)},a.prototype.extendBoundsByX=function(t){this.minX=Math.min(this.minX,t-this.topLeftStrokeWidth),this.maxX=Math.max(this.maxX,t+this.bottomRightStrokeWidth),this.updateNodeBounds()},a.prototype.extendBoundsByY=function(t){this.minY=Math.min(this.minY,t-this.topLeftStrokeWidth),this.maxY=Math.max(this.maxY,t+this.bottomRightStrokeWidth),this.updateNodeBounds()},a.prototype.updateNodeBounds=function(){var t=this.$renderNode;t.x=this.minX,t.y=this.minY,t.width=Math.ceil(this.maxX-this.minX),t.height=Math.ceil(this.maxY-this.minY)},a.prototype.updatePosition=function(t,e){this.includeLastPosition||(this.extendBoundsByPoint(this.lastX,this.lastY),this.includeLastPosition=!0),this.lastX=t,this.lastY=e,this.extendBoundsByPoint(t,e)},a.prototype.$measureContentBounds=function(t){this.minX===1/0?t.setEmpty():t.setTo(this.minX,this.minY,this.maxX-this.minX,this.maxY-this.minY)},a.prototype.$hitTest=function(e,i){var r=this.$targetDisplay,n=r.$getInvertedConcatenatedMatrix(),a=n.a*e+n.c*i+n.tx,s=n.b*e+n.d*i+n.ty,o=t.sys.canvasHitTestBuffer;o.resize(3,3);var h=this.$renderNode,l=t.Matrix.create();l.identity(),l.translate(1-a,1-s),t.sys.canvasRenderer.drawNodeToBuffer(h,o,l,!0),t.Matrix.release(l);try{if(0===o.getPixels(1,1)[3])return null}catch(e){throw new Error(t.sys.tr(1039))}return r},a.prototype.$onRemoveFromStage=function(){this.$renderNode&&this.$renderNode.clean(),t.nativeRender&&egret_native.NativeDisplayObject.disposeGraphicData(this)},a}(t.HashObject);t.Graphics=h,i(h.prototype,"egret.Graphics")}(f||(f={})),function(t){var e=Math.PI,n=2*e,a=e/180,s=[],o=function(i){function o(t,e,r,n,a,s){void 0===t&&(t=1),void 0===e&&(e=0),void 0===r&&(r=0),void 0===n&&(n=1),void 0===a&&(a=0),void 0===s&&(s=0);var o=i.call(this)||this;return o.a=t,o.b=e,o.c=r,o.d=n,o.tx=a,o.ty=s,o}return r(o,i),o.release=function(t){t&&s.push(t)},o.create=function(){var t=s.pop();return t||(t=new o),t},o.prototype.clone=function(){return new o(this.a,this.b,this.c,this.d,this.tx,this.ty)},o.prototype.concat=function(t){var e=this.a*t.a,i=0,r=0,n=this.d*t.d,a=this.tx*t.a+t.tx,s=this.ty*t.d+t.ty;0===this.b&&0===this.c&&0===t.b&&0===t.c||(e+=this.b*t.c,n+=this.c*t.b,i+=this.a*t.b+this.b*t.d,r+=this.c*t.a+this.d*t.c,a+=this.ty*t.c,s+=this.tx*t.b),this.a=e,this.b=i,this.c=r,this.d=n,this.tx=a,this.ty=s},o.prototype.copyFrom=function(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},o.prototype.identity=function(){this.a=this.d=1,this.b=this.c=this.tx=this.ty=0},o.prototype.invert=function(){this.$invertInto(this)},o.prototype.$invertInto=function(t){var e=this.a,i=this.b,r=this.c,n=this.d,a=this.tx,s=this.ty;if(0==i&&0==r)return t.b=t.c=0,void(0==e||0==n?t.a=t.d=t.tx=t.ty=0:(e=t.a=1/e,n=t.d=1/n,t.tx=-e*a,t.ty=-n*s));var o=e*n-i*r;if(0!=o){o=1/o;var h=t.a=n*o;i=t.b=-i*o,r=t.c=-r*o,n=t.d=e*o,t.tx=-(h*a+r*s),t.ty=-(i*a+n*s)}else t.identity()},o.prototype.rotate=function(e){if(0!=(e=+e)){e/=a;var i=t.NumberUtils.cos(e),r=t.NumberUtils.sin(e),n=this.a,s=this.b,o=this.c,h=this.d,l=this.tx,u=this.ty;this.a=n*i-s*r,this.b=n*r+s*i,this.c=o*i-h*r,this.d=o*r+h*i,this.tx=l*i-u*r,this.ty=l*r+u*i}},o.prototype.scale=function(t,e){1!==t&&(this.a*=t,this.c*=t,this.tx*=t),1!==e&&(this.b*=e,this.d*=e,this.ty*=e)},o.prototype.setTo=function(t,e,i,r,n,a){return this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=a,this},o.prototype.transformPoint=function(e,i,r){var n=this.a*e+this.c*i+this.tx,a=this.b*e+this.d*i+this.ty;return r?(r.setTo(n,a),r):new t.Point(n,a)},o.prototype.translate=function(t,e){this.tx+=t,this.ty+=e},o.prototype.equals=function(t){return this.a==t.a&&this.b==t.b&&this.c==t.c&&this.d==t.d&&this.tx==t.tx&&this.ty==t.ty},o.prototype.prepend=function(t,e,i,r,n,a){var s=this.tx;if(1!=t||0!=e||0!=i||1!=r){var o=this.a,h=this.c;this.a=o*t+this.b*i,this.b=o*e+this.b*r,this.c=h*t+this.d*i,this.d=h*e+this.d*r}return this.tx=s*t+this.ty*i+n,this.ty=s*e+this.ty*r+a,this},o.prototype.append=function(t,e,i,r,n,a){var s=this.a,o=this.b,h=this.c,l=this.d;return 1==t&&0==e&&0==i&&1==r||(this.a=t*s+e*h,this.b=t*o+e*l,this.c=i*s+r*h,this.d=i*o+r*l),this.tx=n*s+a*h+this.tx,this.ty=n*o+a*l+this.ty,this},o.prototype.deltaTransformPoint=function(e){var i=this.a*e.x+this.c*e.y,r=this.b*e.x+this.d*e.y;return new t.Point(i,r)},o.prototype.toString=function(){return"(a="+this.a+", b="+this.b+", c="+this.c+", d="+this.d+", tx="+this.tx+", ty="+this.ty+")"},o.prototype.createBox=function(e,i,r,n,s){if(void 0===r&&(r=0),void 0===n&&(n=0),void 0===s&&(s=0),0!==r){r/=a;var o=t.NumberUtils.cos(r),h=t.NumberUtils.sin(r);this.a=o*e,this.b=h*i,this.c=-h*e,this.d=o*i}else this.a=e,this.b=0,this.c=0,this.d=i;this.tx=n,this.ty=s},o.prototype.createGradientBox=function(t,e,i,r,n){void 0===i&&(i=0),void 0===r&&(r=0),void 0===n&&(n=0),this.createBox(t/1638.4,e/1638.4,i,r+t/2,n+e/2)},o.prototype.$transformBounds=function(t){var e=this.a,i=this.b,r=this.c,n=this.d,a=this.tx,s=this.ty,o=t.x,h=t.y,l=o+t.width,u=h+t.height,c=e*o+r*h+a,p=i*o+n*h+s,f=e*l+r*h+a,d=i*l+n*h+s,m=e*l+r*u+a,g=i*l+n*u+s,y=e*o+r*u+a,_=i*o+n*u+s,v=0;c>f&&(v=c,c=f,f=v),m>y&&(v=m,m=y,y=v),t.x=Math.floor(c<m?c:m),t.width=Math.ceil((f>y?f:y)-t.x),p>d&&(v=p,p=d,d=v),g>_&&(v=g,g=_,_=v),t.y=Math.floor(p<g?p:g),t.height=Math.ceil((d>_?d:_)-t.y)},o.prototype.getDeterminant=function(){return this.a*this.d-this.b*this.c},o.prototype.$getScaleX=function(){var t=this;if(0==t.b)return t.a;var e=Math.sqrt(t.a*t.a+t.b*t.b);return this.getDeterminant()<0?-e:e},o.prototype.$getScaleY=function(){var t=this;if(0==t.c)return t.d;var e=Math.sqrt(t.c*t.c+t.d*t.d);return this.getDeterminant()<0?-e:e},o.prototype.$getSkewX=function(){return this.d<0?Math.atan2(this.d,this.c)+e/2:Math.atan2(this.d,this.c)-e/2},o.prototype.$getSkewY=function(){return this.a<0?Math.atan2(this.b,this.a)-e:Math.atan2(this.b,this.a)},o.prototype.$updateScaleAndRotation=function(e,i,r,s){if(!(0!=r&&r!=n||0!=s&&s!=n))return this.a=e,this.b=this.c=0,void(this.d=i);r/=a,s/=a;var o=t.NumberUtils.cos(r),h=t.NumberUtils.sin(r);r==s?(this.a=o*e,this.b=h*e):(this.a=t.NumberUtils.cos(s)*e,this.b=t.NumberUtils.sin(s)*e),this.c=-h*i,this.d=o*i},o.prototype.$preMultiplyInto=function(t,e){var i=t.a*this.a,r=0,n=0,a=t.d*this.d,s=t.tx*this.a+this.tx,o=t.ty*this.d+this.ty;0===t.b&&0===t.c&&0===this.b&&0===this.c||(i+=t.b*this.c,a+=t.c*this.b,r+=t.a*this.b+t.b*this.d,n+=t.c*this.a+t.d*this.c,s+=t.ty*this.c,o+=t.tx*this.b),e.a=i,e.b=r,e.c=n,e.d=a,e.tx=s,e.ty=o},o}(t.HashObject);t.Matrix=o,i(o.prototype,"egret.Matrix"),t.$TempMatrix=new o}(f||(f={})),function(t){var e=[],n=function(i){function n(t,e,r,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===n&&(n=0);var a=i.call(this)||this;return a.x=t,a.y=e,a.width=r,a.height=n,a}return r(n,i),n.release=function(t){t&&e.push(t)},n.create=function(){var t=e.pop();return t||(t=new n),t},Object.defineProperty(n.prototype,"right",{get:function(){return this.x+this.width},set:function(t){this.width=t-this.x},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bottom",{get:function(){return this.y+this.height},set:function(t){this.height=t-this.y},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"left",{get:function(){return this.x},set:function(t){this.width+=this.x-t,this.x=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"top",{get:function(){return this.y},set:function(t){this.height+=this.y-t,this.y=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"topLeft",{get:function(){return new t.Point(this.left,this.top)},set:function(t){this.top=t.y,this.left=t.x},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bottomRight",{get:function(){return new t.Point(this.right,this.bottom)},set:function(t){this.bottom=t.y,this.right=t.x},enumerable:!0,configurable:!0}),n.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this},n.prototype.setTo=function(t,e,i,r){return this.x=t,this.y=e,this.width=i,this.height=r,this},n.prototype.contains=function(t,e){return this.x<=t&&this.x+this.width>=t&&this.y<=e&&this.y+this.height>=e},n.prototype.intersection=function(t){return this.clone().$intersectInPlace(t)},n.prototype.inflate=function(t,e){this.x-=t,this.width+=2*t,this.y-=e,this.height+=2*e},n.prototype.$intersectInPlace=function(t){var e=this.x,i=this.y,r=t.x,n=t.y,a=Math.max(e,r),s=Math.min(e+this.width,r+t.width);if(a<=s){var o=Math.max(i,n),h=Math.min(i+this.height,n+t.height);if(o<=h)return this.setTo(a,o,s-a,h-o),this}return this.setEmpty(),this},n.prototype.intersects=function(t){return Math.max(this.x,t.x)<=Math.min(this.right,t.right)&&Math.max(this.y,t.y)<=Math.min(this.bottom,t.bottom)},n.prototype.isEmpty=function(){return this.width<=0||this.height<=0},n.prototype.setEmpty=function(){this.x=0,this.y=0,this.width=0,this.height=0},n.prototype.clone=function(){return new n(this.x,this.y,this.width,this.height)},n.prototype.containsPoint=function(t){return this.x<=t.x&&this.x+this.width>t.x&&this.y<=t.y&&this.y+this.height>t.y},n.prototype.containsRect=function(t){var e=t.x+t.width,i=t.y+t.height,r=this.x+this.width,n=this.y+this.height;return t.x>=this.x&&t.x<r&&t.y>=this.y&&t.y<n&&e>this.x&&e<=r&&i>this.y&&i<=n},n.prototype.equals=function(t){return this===t||this.x===t.x&&this.y===t.y&&this.width===t.width&&this.height===t.height},n.prototype.inflatePoint=function(t){this.inflate(t.x,t.y)},n.prototype.offset=function(t,e){this.x+=t,this.y+=e},n.prototype.offsetPoint=function(t){this.offset(t.x,t.y)},n.prototype.toString=function(){return"(x="+this.x+", y="+this.y+", width="+this.width+", height="+this.height+")"},n.prototype.union=function(t){var e=this.clone();if(t.isEmpty())return e;if(e.isEmpty())return e.copyFrom(t),e;var i=Math.min(e.x,t.x),r=Math.min(e.y,t.y);return e.setTo(i,r,Math.max(e.right,t.right)-i,Math.max(e.bottom,t.bottom)-r),e},n.prototype.$getBaseWidth=function(t){var e=Math.abs(Math.cos(t)),i=Math.abs(Math.sin(t));return e*this.width+i*this.height},n.prototype.$getBaseHeight=function(t){var e=Math.abs(Math.cos(t));return Math.abs(Math.sin(t))*this.width+e*this.height},n}(t.HashObject);t.Rectangle=n,i(n.prototype,"egret.Rectangle"),t.$TempRectangle=new n}(f||(f={})),function(t){t.$locale_strings=t.$locale_strings||{},t.$locale_strings.en_US=t.$locale_strings.en_US||{};var e=t.$locale_strings.en_US;e[1001]="Could not find Egret entry class: {0}。",e[1002]="Egret entry class '{0}' must inherit from egret.DisplayObject.",e[1003]="Parameter {0} must be non-null.",e[1004]="An object cannot be added as a child to one of it's children (or children's children, etc.).",e[1005]="An object cannot be added as a child of itself.",e[1006]="The supplied DisplayObject must be a child of the caller.",e[1007]="An index specified for a parameter was out of range.",e[1008]="Instantiate singleton error，singleton class {0} can not create multiple instances.",e[1009]='the Class {0} cannot use the property "{1}"',e[1010]='the property "{1}" of the Class "{0}" is readonly',e[1011]="Stream Error. URL: {0}",e[1012]="The type of parameter {0} must be Class.",e[1013]="Variable assignment is NaN, please see the code!",e[1014]='the constant "{1}" of the Class "{0}" is read-only',e[1015]="xml not found!",e[1016]="{0}has been obsoleted",e[1017]="The format of JSON file is incorrect: {0}\ndata: {1}",e[1018]="the scale9Grid is not correct",e[1019]="Network ab:{0}",e[1020]="Cannot initialize Shader",e[1021]="Current browser does not support webgl",e[1022]="{0} ArgumentError",e[1023]="This method is not available in the ScrollView!",e[1025]="end of the file",e[1026]="! EncodingError The code point {0} could not be encoded.",e[1027]="DecodingError",e[1028]=". called injection is not configured rule: {0}, please specify configuration during its initial years of injection rule, and then call the corresponding single case.",e[1029]="Function.prototype.bind - what is trying to be bound is not callable",e[1033]="Photos can not be used across domains toDataURL to convert base64",e[1034]='Music file decoding failed: "{0}", please use the standard conversion tool reconversion under mp3.',e[1035]="Native does not support this feature!",e[1036]="Sound has stopped, please recall Sound.play () to play the sound!",e[1037]="Non-load the correct blob!",e[1038]="XML format error!",e[1039]="Cross domains pictures can not get pixel information!",e[1040]="hitTestPoint can not detect crossOrigin images! Please check if the display object has crossOrigin elements.",e[1041]="{0} is deprecated, please use {1} replace",e[1042]="The parameters passed in the region needs is an integer in drawToTexture method. Otherwise, some browsers will draw abnormal.",e[1043]="Compile errors in {0}, the attribute name: {1}, the attribute value: {2}.",e[1044]="The current version of the Runtime does not support video playback, please use the latest version",e[1045]="The resource url is not found",e[1046]="BitmapText no corresponding characters: {0}, please check the configuration file",e[1047]="egret.localStorage.setItem save failed,key={0}&value={1}",e[1048]="Video loading failed",e[1049]="In the absence of sound is not allowed to play after loading",e[1050]="ExternalInterface calls the method without js registration: {0}",e[3e3]="Theme configuration file failed to load: {0}",e[3001]="Cannot find the skin name which is configured in Theme: {0}",e[3002]='Index:"{0}" is out of the collection element index range',e[3003]="Cannot be available in this component. If this component is container, please continue to use",e[3004]="addChild(){0}addElement() replace",e[3005]="addChildAt(){0}addElementAt() replace",e[3006]="removeChild(){0}removeElement() replace",e[3007]="removeChildAt(){0}removeElementAt() replace",e[3008]="setChildIndex(){0}setElementIndex() replace",e[3009]="swapChildren(){0}swapElements() replace",e[3010]="swapChildrenAt(){0}swapElementsAt() replace",e[3011]='Index:"{0}" is out of the visual element index range',e[3012]="This method is not available in Scroller component!",e[3013]="UIStage is GUI root container, and only one such instant is in the display list！",e[3014]="set fullscreen error",e[3100]="Current browser does not support WebSocket",e[3101]="Please connect Socket firstly",e[3102]="Please set the type of binary type",e[4e3]="An Bone cannot be added as a child to itself or one of its children (or children's children, etc.)",e[4001]="Abstract class can not be instantiated!",e[4002]="Unnamed data!",e[4003]="Nonsupport version!"}(f||(f={})),(f||(f={})).JointStyle={BEVEL:"bevel",MITER:"miter",ROUND:"round"},function(t){t.$locale_strings=t.$locale_strings||{},t.$locale_strings.zh_CN=t.$locale_strings.zh_CN||{};var e=t.$locale_strings.zh_CN;e[1001]="找不到Egret入口类: {0}。",e[1002]="Egret入口类 {0} 必须继承自egret.DisplayObject。",e[1003]="参数 {0} 不能为 null。",e[1004]="无法将对象添加为它的一个子对象（或子对象的子对象等）的子对象。",e[1005]="不能将对象添加为其自身的子对象。",e[1006]="提供的 DisplayObject 必须是调用者的子级。",e[1007]="为参数指定的索引不在范围内。",e[1008]="实例化单例出错，不允许实例化多个 {0} 对象。",e[1009]="类 {0} 不可以使用属性 {1}",e[1010]="类 {0} 属性 {1} 是只读的",e[1011]="流错误。URL: {0}",e[1012]="参数 {0} 的类型必须为 Class。",e[1013]="变量赋值为NaN，请查看代码！",e[1014]="类 {0} 常量 {1} 是只读的",e[1015]="xml not found!",e[1016]="{0}已经废弃",e[1017]="JSON文件格式不正确: {0}\ndata: {1}",e[1018]="9宫格设置错误",e[1019]="网络异常:{0}",e[1020]="无法初始化着色器",e[1021]="当前浏览器不支持webgl",e[1022]="{0} ArgumentError",e[1023]="此方法在ScrollView内不可用!",e[1025]="遇到文件尾",e[1026]="EncodingError! The code point {0} could not be encoded.",e[1027]="DecodingError",e[1028]="调用了未配置的注入规则:{0}。 请先在项目初始化里配置指定的注入规则，再调用对应单例。",e[1029]="Function.prototype.bind - what is trying to be bound is not callable",e[1033]="跨域图片不可以使用toDataURL来转换成base64",e[1034]='音乐文件解码失败："{0}"，请使用标准的转换工具重新转换下mp3。',e[1035]="Native 下暂未实现此功能！",e[1036]="声音已停止，请重新调用 Sound.play() 来播放声音！",e[1037]="非正确的blob加载！",e[1038]="XML 格式错误!",e[1039]="跨域图片不能获取像素信息!",e[1040]="hitTestPoint 不能对跨域图片进行检测! 请检查该显示对象内是否含有跨域元素",e[1041]="{0} 已废弃,请使用 {1} 代替",e[1042]="drawToTexture方法传入的区域各个参数需要为整数,否则某些浏览器绘制会出现异常",e[1043]="{0} 中存在编译错误，属性名 : {1}，属性值 : {2}",e[1044]="当前的 runtime 版本不支持视频播放,请使用最新的版本",e[1045]="没有设置要加载的资源地址",e[1046]="BitmapText 找不到对应字符:{0}，请检查配置文件",e[1047]="egret.localStorage.setItem保存失败,key={0}&value={1}",e[1048]="视频加载失败",e[1049]="声音在没有加载完之前不允许播放",e[1050]="ExternalInterface调用了js没有注册的方法: {0}",e[3e3]="主题配置文件加载失败: {0}",e[3001]="找不到主题中所配置的皮肤类名: {0}",e[3002]='索引:"{0}"超出集合元素索引范围',e[3003]="在此组件中不可用，若此组件为容器类，请使用",e[3004]="addChild(){0}addElement()代替",e[3005]="addChildAt(){0}addElementAt()代替",e[3006]="removeChild(){0}removeElement()代替",e[3007]="removeChildAt(){0}removeElementAt()代替",e[3008]="setChildIndex(){0}setElementIndex()代替",e[3009]="swapChildren(){0}swapElements()代替",e[3010]="swapChildrenAt(){0}swapElementsAt()代替",e[3011]='索引:"{0}"超出可视元素索引范围',e[3012]="此方法在Scroller组件内不可用!",e[3013]="UIStage是GUI根容器，只能有一个此实例在显示列表中！",e[3014]="设置全屏模式失败",e[3100]="当前浏览器不支持WebSocket",e[3101]="请先连接WebSocket",e[3102]="请先设置type为二进制类型",e[4e3]="An Bone cannot be added as a child to itself or one of its children (or children's children, etc.)",e[4001]="Abstract class can not be instantiated!",e[4002]="Unnamed data!",e[4003]="Nonsupport version!"}(f||(f={})),function(t){t.localStorage||(t.localStorage={})}(f||(f={})),function(t){!function(t){var e=[];t.$pushSoundChannel=function(t){e.indexOf(t)<0&&e.push(t)},t.$popSoundChannel=function(t){var i=e.indexOf(t);return i>=0&&(e.splice(i,1),!0)}}(t.sys||(t.sys={}))}(f||(f={})),f||(f={}),f||(f={}),function(t){!function(t){t.GET="GET",t.POST="POST"}(t.HttpMethod||(t.HttpMethod={}))}(f||(f={})),f||(f={}),function(t){var e=function(){function t(){}return t.TEXT="text",t.ARRAY_BUFFER="arraybuffer",t}();t.HttpResponseType=e,i(e.prototype,"egret.HttpResponseType")}(f||(f={})),f||(f={}),function(t){!function(e){var n=function(i){function n(r){var n=i.call(this)||this;return n.isStage=!1,n.$renderNode=new e.BitmapNode,n.renderBuffer=null,n.offsetX=0,n.offsetY=0,n.offsetMatrix=new t.Matrix,n.$canvasScaleX=1,n.$canvasScaleY=1,n.root=r,n.isStage=r instanceof t.Stage,n}return r(n,i),n.create=function(i){var r=new t.sys.DisplayList(i);try{var n=new e.RenderBuffer;r.renderBuffer=n}catch(t){return null}return r.root=i,r},n.prototype.$getRenderNode=function(){return this.$renderNode},n.prototype.setClipRect=function(t,e){t*=n.$canvasScaleX,e*=n.$canvasScaleY,this.renderBuffer.resize(t,e)},n.prototype.drawToSurface=function(){var i;this.$canvasScaleX=this.offsetMatrix.a=n.$canvasScaleX,this.$canvasScaleY=this.offsetMatrix.d=n.$canvasScaleY,this.isStage||this.changeSurfaceSize();var r=this.renderBuffer;if(r.clear(),i=e.systemRenderer.render(this.root,r,this.offsetMatrix),!this.isStage){var a=r.surface,s=this.$renderNode;s.drawData.length=0;var o=a.width,h=a.height;this.bitmapData?(this.bitmapData.source=a,this.bitmapData.width=o,this.bitmapData.height=h):this.bitmapData=new t.BitmapData(a),s.image=this.bitmapData,s.imageWidth=o,s.imageHeight=h,s.drawImage(0,0,o,h,-this.offsetX,-this.offsetY,o/this.$canvasScaleX,h/this.$canvasScaleY)}return i},n.prototype.changeSurfaceSize=function(){this.root;var t=this.offsetX,e=this.offsetY,i=this.root.$getOriginalBounds(),r=this.$canvasScaleX,n=this.$canvasScaleY;this.offsetX=-i.x,this.offsetY=-i.y,this.offsetMatrix.setTo(this.offsetMatrix.a,0,0,this.offsetMatrix.d,this.offsetX,this.offsetY);var a=this.renderBuffer,s=Math.max(257,i.width*r),o=Math.max(257,i.height*n);this.offsetX==t&&this.offsetY==e&&a.surface.width==s&&a.surface.height==o||a.resize(s,o)},n.$setCanvasScale=function(e,i){n.$canvasScaleX=e,n.$canvasScaleY=i,t.nativeRender&&egret_native.nrSetCanvasScaleFactor(n.$canvasScaleFactor,e,i)},n.$canvasScaleFactor=1,n.$canvasScaleX=1,n.$canvasScaleY=1,n}(t.HashObject);e.DisplayList=n,i(n.prototype,"egret.sys.DisplayList")}(t.sys||(t.sys={}))}(f||(f={})),f||(f={}),f||(f={}),function(t){!function(e){var n=function(i){function n(e,r,n){var a=i.call(this)||this;return a.isPlaying=!1,e||t.$error(1003,"buffer"),a.entryClassName=n,a.stage=r,a.screenDisplayList=a.createDisplayList(r,e),a.showFPS=!1,a.showLog=!1,a.stageDisplayList=null,t.nativeRender&&(egret_native.rootWebGLBuffer=e),a}return r(n,i),n.prototype.createDisplayList=function(t,i){var r=new e.DisplayList(t);return r.renderBuffer=i,t.$displayList=r,r},n.prototype.start=function(){!this.isPlaying&&this.stage&&(e.$TempStage=e.$TempStage||this.stage,this.isPlaying=!0,this.root||this.initialize(),t.ticker.$addPlayer(this))},n.prototype.initialize=function(){var e;if(this.entryClassName&&(e=t.getDefinitionByName(this.entryClassName)),e){var i=new e;this.root=i,i instanceof t.DisplayObject?this.stage.addChild(i):t.$error(1002,this.entryClassName)}else t.$error(1001,this.entryClassName)},n.prototype.stop=function(){this.pause(),this.stage=null},n.prototype.pause=function(){this.isPlaying&&(this.isPlaying=!1,t.ticker.$removePlayer(this))},n.prototype.$render=function(e,i){if(t.nativeRender)return egret_native.updateNativeRender(),void egret_native.nrRender();var r=this.stage,n=t.getTimer(),a=r.$displayList.drawToSurface(),o=t.getTimer();e&&this.showFPS&&s.update(a,o-n,i)},n.prototype.updateStageSize=function(e,i){var r=this.stage;r.$stageWidth=e,r.$stageHeight=i,t.nativeRender?egret_native.nrResize(e,i):(this.screenDisplayList.setClipRect(e,i),this.stageDisplayList&&this.stageDisplayList.setClipRect(e,i)),r.dispatchEventWith(t.Event.RESIZE)},n.prototype.displayFPS=function(i,r,n,a){if((r=!!r)&&(t.log=function(){for(var t=arguments.length,i="",r=0;r<t;r++)i+=arguments[r]+" ";e.$logToFPS(i),console.log.apply(console,c(arguments))},t.warn=function(){for(var t=arguments.length,i="",r=0;r<t;r++)i+=arguments[r]+" ";e.$warnToFPS(i),console.warn.apply(console,c(arguments))},t.error=function(){for(var t=arguments.length,i="",r=0;r<t;r++)i+=arguments[r]+" ";e.$errorToFPS(i),console.error.apply(console,c(arguments))}),this.showFPS=!!i,this.showLog=r,!s){s=new FPS(this.stage,i,r,n,a);for(var u=o.length,p=0;p<u;p++)s.updateInfo(o[p]);o=null;var f=h.length;for(p=0;p<f;p++)s.updateWarn(h[p]);h=null;var d=l.length;for(p=0;p<d;p++)s.updateError(l[p]);l=null}},n}(t.HashObject);e.Player=n,i(n.prototype,"egret.sys.Player");var s,o=[],h=[],l=[];e.$logToFPS=function(t){s?s.updateInfo(t):o.push(t)},e.$warnToFPS=function(t){s?s.updateWarn(t):h.push(t)},e.$errorToFPS=function(t){s?s.updateError(t):l.push(t)};var u=function(){function e(e,i,r,n,a){var s;this.showFPS=i,this.showLog=r,this.logFilter=n,this.styles=a,this.infoLines=[],this.totalTime=0,this.totalTick=0,this.lastTime=0,this.drawCalls=0,this.costRender=0,this.costTicker=0,this.infoLines=[],this.totalTime=0,this.totalTick=0,this.lastTime=0,this.drawCalls=0,this.costRender=0,this.costTicker=0,this._stage=e,this.showFPS=i,this.showLog=r,this.logFilter=n,this.styles=a,this.fpsDisplay=new t.FPSDisplay(e,i,r,n,a);try{s=n?new RegExp(n):null}catch(e){t.log(e)}this.filter=function(t){return s?s.test(t):!n||0==t.indexOf(n)}}return e.prototype.update=function(e,i,r){var n=t.getTimer();if(this.totalTime+=n-this.lastTime,this.lastTime=n,this.totalTick++,this.drawCalls+=e,this.costRender+=i,this.costTicker+=r,this.totalTime>=1e3){var a=Math.min(Math.ceil(1e3*this.totalTick/this.totalTime),t.ticker.$frameRate),s=Math.round(this.drawCalls/this.totalTick),o=Math.round(this.costRender/this.totalTick),h=Math.round(this.costTicker/this.totalTick);this.fpsDisplay.update({fps:a,draw:s,costTicker:h,costRender:o}),this.totalTick=0,this.totalTime=this.totalTime%1e3,this.drawCalls=0,this.costRender=0,this.costTicker=0}},e.prototype.updateInfo=function(t){t&&this.showLog&&this.filter(t)&&this.fpsDisplay.updateInfo(t)},e.prototype.updateWarn=function(t){t&&this.showLog&&this.filter(t)&&(this.fpsDisplay.updateWarn?this.fpsDisplay.updateWarn(t):this.fpsDisplay.updateInfo("[Warning]"+t))},e.prototype.updateError=function(t){t&&this.showLog&&this.filter(t)&&(this.fpsDisplay.updateError?this.fpsDisplay.updateError(t):this.fpsDisplay.updateInfo("[Error]"+t))},e}();function c(t){for(var e=[],i=0;i<t.length;i++)e.push(t[i]);return e}i(u.prototype,"FPSImpl"),a.FPS=u,t.warn=function(){console.warn.apply(console,c(arguments))},t.error=function(){console.error.apply(console,c(arguments))},t.assert=function(){console.assert.apply(console,c(arguments))},t.log=function(){console.log.apply(console,c(arguments))}}(t.sys||(t.sys={}))}(f||(f={})),function(t){if(t.nativeRender=a.nativeRender,t.nativeRender){var e=egret_native.nrABIVersion,i=egret_native.nrMinEgretVersion;if(e<4){t.nativeRender=!1;var r="需要升级微端版本到 0.1.8 才可以开启原生渲染加速";t.sys.$warnToFPS(r),t.warn(r)}else e>4&&(t.nativeRender=!1,r="需要升级引擎版本到 "+i+" 才可以开启原生渲染加速",t.sys.$warnToFPS(r),t.warn(r))}}(f||(f={})),function(t){var e=function(e){function i(i){var r=e.call(this,i)||this;return r._verticesDirty=!0,r._bounds=new t.Rectangle,r.$renderNode=new t.sys.MeshNode,r}return r(i,e),i.prototype.createNativeDisplayObject=function(){this.$nativeDisplayObject=new egret_native.NativeDisplayObject(12)},i.prototype.setBitmapDataToWasm=function(t){this.$nativeDisplayObject.setBitmapDataToMesh(t)},i.prototype.$updateRenderNode=function(){var e=this.$bitmapData;if(e){t.$TextureScaleFactor;var i=this.$renderNode;i.smoothing=this.$smoothing,i.image=e,i.imageWidth=this.$sourceWidth,i.imageHeight=this.$sourceHeight;var r=isNaN(this.$explicitBitmapWidth)?this.$textureWidth:this.$explicitBitmapWidth,n=isNaN(this.$explicitBitmapHeight)?this.$textureHeight:this.$explicitBitmapHeight,a=r/this.$textureWidth,s=n/this.$textureHeight,o=this.$bitmapWidth,h=this.$bitmapHeight;i.drawMesh(this.$bitmapX,this.$bitmapY,o,h,this.$offsetX*a,this.$offsetY*s,a*o,s*h)}},i.prototype.$updateVertices=function(){if(this._verticesDirty=!0,this.$renderDirty=!0,t.nativeRender){var e=this.$renderNode;this.$nativeDisplayObject.setDataToMesh(e.vertices,e.indices,e.uvs)}else{var i=this.$parent;i&&!i.$cacheDirty&&(i.$cacheDirty=!0,i.$cacheDirtyUp());var r=this.$maskedObject;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp())}},i.prototype.$measureContentBounds=function(t){if(this._verticesDirty){this._verticesDirty=!1;var e=this.$renderNode,i=e.vertices;if(i.length){this._bounds.setTo(Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(var r=0,n=i.length;r<n;r+=2){var a=i[r],s=i[r+1];this._bounds.x>a&&(this._bounds.x=a),this._bounds.width<a&&(this._bounds.width=a),this._bounds.y>s&&(this._bounds.y=s),this._bounds.height<s&&(this._bounds.height=s)}this._bounds.width-=this._bounds.x,this._bounds.height-=this._bounds.y}else this._bounds.setTo(0,0,0,0);e.bounds.copyFrom(this._bounds)}t.copyFrom(this._bounds)},i}(t.Bitmap);t.Mesh=e,i(e.prototype,"egret.Mesh")}(f||(f={})),function(t){!function(e){var n=function(e){function i(){return e.call(this)||this}return r(i,e),i.prototype.calculateStageSize=function(e,i,r,n,a){var s=i,o=r,h=n,l=a,u=i/h||0,c=r/l||0;switch(e){case t.StageScaleMode.EXACT_FIT:break;case t.StageScaleMode.FIXED_HEIGHT:h=Math.round(i/c);break;case t.StageScaleMode.FIXED_WIDTH:l=Math.round(r/u);break;case t.StageScaleMode.NO_BORDER:u>c?o=Math.round(l*u):s=Math.round(h*c);break;case t.StageScaleMode.SHOW_ALL:u>c?s=Math.round(h*c):o=Math.round(l*u);break;case t.StageScaleMode.FIXED_NARROW:u>c?h=Math.round(i/c):l=Math.round(r/u);break;case t.StageScaleMode.FIXED_WIDE:u>c?l=Math.round(r/u):h=Math.round(i/c);break;default:h=i,l=r}return t.Capabilities.runtimeType!=t.RuntimeType.WXGAME&&(h%2!=0&&(h+=1),l%2!=0&&(l+=1),s%2!=0&&(s+=1),o%2!=0&&(o+=1)),{stageWidth:h,stageHeight:l,displayWidth:s,displayHeight:o}},i}(t.HashObject);e.DefaultScreenAdapter=n,i(n.prototype,"egret.sys.DefaultScreenAdapter",["egret.sys.IScreenAdapter"])}(t.sys||(t.sys={}))}(f||(f={})),function(t){var e=function(){function t(){}return t.NO_SCALE="noScale",t.SHOW_ALL="showAll",t.NO_BORDER="noBorder",t.EXACT_FIT="exactFit",t.FIXED_WIDTH="fixedWidth",t.FIXED_HEIGHT="fixedHeight",t.FIXED_NARROW="fixedNarrow",t.FIXED_WIDE="fixedWide",t}();t.StageScaleMode=e,i(e.prototype,"egret.StageScaleMode")}(f||(f={})),function(t){t.sys||(t.sys={})}(f||(f={})),function(t){!function(e){e.$START_TIME=0,e.$invalidateRenderFlag=!1,e.$requestRenderingFlag=!1;var r=function(){function i(){this.playerList=[],this.callBackList=[],this.thisObjectList=[],this.$frameRate=30,this.lastTimeStamp=0,this.costEnterFrame=0,this.isPaused=!1,t.ticker&&t.$error(1008,"egret.sys.SystemTicker"),e.$START_TIME=Date.now(),this.frameDeltaTime=1e3/this.$frameRate,this.lastCount=this.frameInterval=Math.round(6e4/this.$frameRate)}return i.prototype.$addPlayer=function(t){-1==this.playerList.indexOf(t)&&(egret_stages.push(t.stage),this.playerList=this.playerList.concat(),this.playerList.push(t))},i.prototype.$removePlayer=function(t){var e=this.playerList.indexOf(t);if(-1!==e){var i=egret_stages.indexOf(t.stage);egret_stages.splice(i,1),this.playerList=this.playerList.concat(),this.playerList.splice(e,1)}},i.prototype.$startTick=function(t,e){-1==this.getTickIndex(t,e)&&(this.concatTick(),this.callBackList.push(t),this.thisObjectList.push(e))},i.prototype.$stopTick=function(t,e){var i=this.getTickIndex(t,e);-1!=i&&(this.concatTick(),this.callBackList.splice(i,1),this.thisObjectList.splice(i,1))},i.prototype.getTickIndex=function(t,e){for(var i=this.callBackList,r=this.thisObjectList,n=i.length-1;n>=0;n--)if(i[n]==t&&r[n]==e)return n;return-1},i.prototype.concatTick=function(){this.callBackList=this.callBackList.concat(),this.thisObjectList=this.thisObjectList.concat()},i.prototype.$setFrameRate=function(t){return!(t<=0||this.$frameRate==t||(this.$frameRate=t,t>60&&(t=60),this.frameDeltaTime=1e3/t,this.lastCount=this.frameInterval=Math.round(6e4/t),0))},i.prototype.pause=function(){this.isPaused=!0},i.prototype.resume=function(){this.isPaused=!1},i.prototype.update=function(){for(var i=t.getTimer(),r=this.callBackList,n=this.thisObjectList,a=r.length,s=e.$requestRenderingFlag,o=t.getTimer(),h=0,l=t.lifecycle.contexts;h<l.length;h++){var u=l[h];u.onUpdate&&u.onUpdate()}if(this.isPaused)this.lastTimeStamp=o;else{this.callLaterAsyncs();for(var c=0;c<a;c++)r[c].call(n[c],o)&&(s=!0);var p=t.getTimer(),f=o-this.lastTimeStamp;if(this.lastTimeStamp=o,f>=this.frameDeltaTime)this.lastCount=this.frameInterval;else{if(this.lastCount-=1e3,this.lastCount>0)return void(s&&this.render(!1,this.costEnterFrame+p-i));this.lastCount+=this.frameInterval}this.render(!0,this.costEnterFrame+p-i);var d=t.getTimer();this.broadcastEnterFrame();var m=t.getTimer();this.costEnterFrame=m-d}},i.prototype.render=function(t,i){var r=this.playerList,n=r.length;if(0!=n){this.callLaters(),e.$invalidateRenderFlag&&(this.broadcastRender(),e.$invalidateRenderFlag=!1);for(var a=0;a<n;a++)r[a].$render(t,i);e.$requestRenderingFlag=!1}},i.prototype.broadcastEnterFrame=function(){var e=t.DisplayObject.$enterFrameCallBackList,i=e.length;if(0!=i){e=e.concat();for(var r=0;r<i;r++)e[r].dispatchEventWith(t.Event.ENTER_FRAME)}},i.prototype.broadcastRender=function(){var e=t.DisplayObject.$renderCallBackList,i=e.length;if(0!=i){e=e.concat();for(var r=0;r<i;r++)e[r].dispatchEventWith(t.Event.RENDER)}},i.prototype.callLaters=function(){var e,i,r;if(t.$callLaterFunctionList.length>0&&(e=t.$callLaterFunctionList,t.$callLaterFunctionList=[],i=t.$callLaterThisList,t.$callLaterThisList=[],r=t.$callLaterArgsList,t.$callLaterArgsList=[]),e)for(var n=e.length,a=0;a<n;a++){var s=e[a];null!=s&&s.apply(i[a],r[a])}},i.prototype.callLaterAsyncs=function(){if(t.$callAsyncFunctionList.length>0){var e=t.$callAsyncFunctionList,i=t.$callAsyncThisList,r=t.$callAsyncArgsList;t.$callAsyncFunctionList=[],t.$callAsyncThisList=[],t.$callAsyncArgsList=[];for(var n=0;n<e.length;n++){var a=e[n];null!=a&&a.apply(i[n],r[n])}}},i}();e.SystemTicker=r,i(r.prototype,"egret.sys.SystemTicker")}(t.sys||(t.sys={}))}(f||(f={})),function(t){!function(e){e.contexts=[];var r=!0,n=function(){function i(){}return i.prototype.pause=function(){r&&(r=!1,e.stage.dispatchEvent(new t.Event(t.Event.DEACTIVATE)),e.onPause&&e.onPause())},i.prototype.resume=function(){r||(r=!0,e.stage.dispatchEvent(new t.Event(t.Event.ACTIVATE)),e.onResume&&e.onResume())},i}();e.LifecycleContext=n,i(n.prototype,"egret.lifecycle.LifecycleContext"),e.addLifecycleListener=function(t){var i=new n;e.contexts.push(i),t(i)}}(t.lifecycle||(t.lifecycle={})),t.ticker=new t.sys.SystemTicker}(f||(f={})),n.egret_stages=[],function(t){!function(e){var n=function(e){function i(t){var i=e.call(this)||this;return i.maxTouches=0,i.useTouchesCount=0,i.touchDownTarget={},i.lastTouchX=-1,i.lastTouchY=-1,i.stage=t,i}return r(i,e),i.prototype.$initMaxTouches=function(){this.maxTouches=this.stage.$maxTouches},i.prototype.onTouchBegin=function(e,i,r){if(!(this.useTouchesCount>=this.maxTouches)){this.lastTouchX=e,this.lastTouchY=i;var n=this.findTarget(e,i);null==this.touchDownTarget[r]&&(this.touchDownTarget[r]=n,this.useTouchesCount++),t.TouchEvent.dispatchTouchEvent(n,t.TouchEvent.TOUCH_BEGIN,!0,!0,e,i,r,!0)}},i.prototype.onTouchMove=function(e,i,r){if(null!=this.touchDownTarget[r]&&(this.lastTouchX!=e||this.lastTouchY!=i)){this.lastTouchX=e,this.lastTouchY=i;var n=this.findTarget(e,i);t.TouchEvent.dispatchTouchEvent(n,t.TouchEvent.TOUCH_MOVE,!0,!0,e,i,r,!0)}},i.prototype.onTouchEnd=function(e,i,r){if(null!=this.touchDownTarget[r]){var n=this.findTarget(e,i),a=this.touchDownTarget[r];delete this.touchDownTarget[r],this.useTouchesCount--,t.TouchEvent.dispatchTouchEvent(n,t.TouchEvent.TOUCH_END,!0,!0,e,i,r,!1),a==n?t.TouchEvent.dispatchTouchEvent(n,t.TouchEvent.TOUCH_TAP,!0,!0,e,i,r,!1):t.TouchEvent.dispatchTouchEvent(a,t.TouchEvent.TOUCH_RELEASE_OUTSIDE,!0,!0,e,i,r,!1)}},i.prototype.findTarget=function(t,e){var i=this.stage.$hitTest(t,e);return i||(i=this.stage),i},i}(t.HashObject);e.TouchHandler=n,i(n.prototype,"egret.sys.TouchHandler")}(t.sys||(t.sys={}))}(f||(f={})),function(t){!function(e){var n=function(e){function i(){var t=e.call(this)||this;return t.image=null,t.smoothing=!0,t.blendMode=null,t.alpha=NaN,t.filter=null,t.rotated=!1,t.type=1,t}return r(i,e),i.prototype.drawImage=function(t,e,i,r,n,a,s,o){this.drawData.push(t,e,i,r,n,a,s,o),this.renderCount++},i.prototype.cleanBeforeRender=function(){e.prototype.cleanBeforeRender.call(this),this.image=null,this.matrix=null,this.blendMode=null,this.alpha=NaN,this.filter=null},i.$updateTextureData=function(e,r,n,a,s,o,h,l,u,c,p,f,d,m,g,y){if(r){var _=t.$TextureScaleFactor;if(e.smoothing=y,e.image=r,e.imageWidth=d,e.imageHeight=m,g==t.BitmapFillMode.SCALE){var v=p/u*_,b=f/c*_;e.drawImage(n,a,s,o,v*h,b*l,v*s,b*o)}else if(g==t.BitmapFillMode.CLIP){var T=Math.min(u,p),x=Math.min(c,f),D=s*_,$=o*_;i.drawClipImage(e,_,n,a,D,$,h,l,T,x)}else{D=s*_,$=o*_;for(var E=0;E<p;E+=u)for(var w=0;w<f;w+=c)T=Math.min(p-E,u),x=Math.min(f-w,c),i.drawClipImage(e,_,n,a,D,$,h,l,T,x,E,w)}}},i.$updateTextureDataWithScale9Grid=function(e,i,r,n,a,s,o,h,l,u,c,p,f,d,m,g){e.smoothing=g,e.image=i,e.imageWidth=d,e.imageHeight=m;var y=s,_=o;p-=u-s*t.$TextureScaleFactor,f-=c-o*t.$TextureScaleFactor;var v=r.x-h,b=r.y-l,T=v/t.$TextureScaleFactor,x=b/t.$TextureScaleFactor,D=r.width/t.$TextureScaleFactor,$=r.height/t.$TextureScaleFactor;0==$&&($=1,x>=_&&x--),0==D&&(D=1,T>=y&&T--);var E=n,w=E+T,A=w+D,S=y-T-D,O=a,C=O+x,P=C+$,R=_-x-$,M=S*t.$TextureScaleFactor,I=R*t.$TextureScaleFactor;if((T+S)*t.$TextureScaleFactor>p||(x+R)*t.$TextureScaleFactor>f)e.drawImage(n,a,s,o,h,l,p,f);else{var B=h,F=B+v,L=B+(p-M),N=p-v-M,k=l,j=k+b,U=k+f-I,H=f-b-I;x>0&&(T>0&&e.drawImage(E,O,T,x,B,k,v,b),D>0&&e.drawImage(w,O,D,x,F,k,N,b),S>0&&e.drawImage(A,O,S,x,L,k,M,b)),$>0&&(T>0&&e.drawImage(E,C,T,$,B,j,v,H),D>0&&e.drawImage(w,C,D,$,F,j,N,H),S>0&&e.drawImage(A,C,S,$,L,j,M,H)),R>0&&(T>0&&e.drawImage(E,P,T,R,B,U,v,I),D>0&&e.drawImage(w,P,D,R,F,U,N,I),S>0&&e.drawImage(A,P,S,R,L,U,M,I))}},i.drawClipImage=function(t,e,i,r,n,a,s,o,h,l,u,c){void 0===u&&(u=0),void 0===c&&(c=0);var p=s+n-h;p>0&&(n-=p),(p=o+a-l)>0&&(a-=p),t.drawImage(i,r,n/e,a/e,u+s,c+o,n,a)},i}(e.RenderNode);e.BitmapNode=n,i(n.prototype,"egret.sys.BitmapNode")}(t.sys||(t.sys={}))}(f||(f={})),function(t){!function(e){var n=["none","round","square"],a=["bevel","miter","round"],s=function(i){function s(){var t=i.call(this)||this;return t.dirtyRender=!0,t.type=3,t}return r(s,i),s.prototype.beginFill=function(t,i,r){void 0===i&&(i=1);var n=new e.FillPath;if(n.fillColor=t,n.fillAlpha=i,r){var a=this.drawData.lastIndexOf(r);this.drawData.splice(a,0,n)}else this.drawData.push(n);return this.renderCount++,n},s.prototype.beginGradientFill=function(i,r,n,a,s,o){var h=new t.Matrix;s?(h.a=819.2*s.a,h.b=819.2*s.b,h.c=819.2*s.c,h.d=819.2*s.d,h.tx=s.tx,h.ty=s.ty):(h.a=100,h.d=100);var l=new e.GradientFillPath;if(l.gradientType=i,l.colors=r,l.alphas=n,l.ratios=a,l.matrix=h,o){var u=this.drawData.lastIndexOf(o);this.drawData.splice(u,0,l)}else this.drawData.push(l);return this.renderCount++,l},s.prototype.lineStyle=function(i,r,s,o,h,l,u){void 0===s&&(s=1),void 0===l&&(l=3),void 0===u&&(u=[]),-1==n.indexOf(o)&&(o="round"),-1==a.indexOf(h)&&(h="round");var c=new e.StrokePath;return c.lineWidth=i,c.lineColor=r,c.lineAlpha=s,c.caps=o||t.CapsStyle.ROUND,c.joints=h,c.miterLimit=l,c.lineDash=u,this.drawData.push(c),this.renderCount++,c},s.prototype.clear=function(){this.drawData.length=0,this.dirtyRender=!0,this.renderCount=0},s.prototype.cleanBeforeRender=function(){},s.prototype.clean=function(){this.$texture&&(t.WebGLUtils.deleteWebGLTexture(this.$texture),this.$texture=null,this.dirtyRender=!0)},s}(e.RenderNode);e.GraphicsNode=s,i(s.prototype,"egret.sys.GraphicsNode")}(t.sys||(t.sys={}))}(f||(f={})),function(t){!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.type=4,e}return r(e,t),e.prototype.addNode=function(t){this.drawData.push(t)},e.prototype.cleanBeforeRender=function(){for(var t=this.drawData,e=t.length-1;e>=0;e--)t[e].cleanBeforeRender()},e.prototype.$getRenderCount=function(){for(var t=0,e=this.drawData,i=e.length-1;i>=0;i--)t+=e[i].$getRenderCount();return t},e}(t.RenderNode);t.GroupNode=e,i(e.prototype,"egret.sys.GroupNode")}(t.sys||(t.sys={}))}(f||(f={})),function(t){!function(e){var n=function(e){function i(){var i=e.call(this)||this;return i.image=null,i.smoothing=!0,i.bounds=new t.Rectangle,i.blendMode=null,i.alpha=NaN,i.filter=null,i.rotated=!1,i.type=5,i.vertices=[],i.uvs=[],i.indices=[],i}return r(i,e),i.prototype.drawMesh=function(t,e,i,r,n,a,s,o){this.drawData.push(t,e,i,r,n,a,s,o),this.renderCount++},i.prototype.cleanBeforeRender=function(){e.prototype.cleanBeforeRender.call(this),this.image=null,this.matrix=null},i}(e.RenderNode);e.MeshNode=n,i(n.prototype,"egret.sys.MeshNode")}(t.sys||(t.sys={}))}(f||(f={})),function(t){!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.image=null,e.smoothing=!0,e.rotated=!1,e.type=6,e}return r(e,t),e.prototype.drawImage=function(t,e,i,r,n,a,s,o){this.sourceX=t,this.sourceY=e,this.sourceW=i,this.sourceH=r,this.drawX=n,this.drawY=a,this.drawW=s,this.drawH=o,this.renderCount=1},e.prototype.cleanBeforeRender=function(){t.prototype.cleanBeforeRender.call(this),this.image=null},e}(t.RenderNode);t.NormalBitmapNode=e,i(e.prototype,"egret.sys.NormalBitmapNode")}(t.sys||(t.sys={}))}(f||(f={})),(f||(f={})).OrientationMode={AUTO:"auto",PORTRAIT:"portrait",LANDSCAPE:"landscape",LANDSCAPE_FLIPPED:"landscapeFlipped"},function(t){!function(e){var n=function(e){function i(){var t=e.call(this)||this;return t.textColor=16777215,t.strokeColor=0,t.size=30,t.stroke=0,t.bold=!1,t.italic=!1,t.fontFamily="Arial",t.dirtyRender=!0,t.type=2,t}return r(i,e),i.prototype.drawText=function(t,e,i,r){this.drawData.push(t,e,i,r),this.renderCount++,this.dirtyRender=!0},i.prototype.clean=function(){this.$texture&&(t.WebGLUtils.deleteWebGLTexture(this.$texture),this.$texture=null,this.dirtyRender=!0)},i.prototype.cleanBeforeRender=function(){e.prototype.cleanBeforeRender.call(this),this.dirtyRender=!0},i}(e.RenderNode);e.TextNode=n,i(n.prototype,"egret.sys.TextNode")}(t.sys||(t.sys={}))}(f||(f={})),function(t){!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.type=1,e}return r(e,t),e}(t.Path2D);t.FillPath=e,i(e.prototype,"egret.sys.FillPath")}(t.sys||(t.sys={}))}(f||(f={})),function(t){!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.type=2,e}return r(e,t),e}(t.Path2D);t.GradientFillPath=e,i(e.prototype,"egret.sys.GradientFillPath")}(t.sys||(t.sys={}))}(f||(f={})),function(t){var e=function(e){function i(){var i=e.call(this)||this;i.$renderBuffer=new t.sys.RenderBuffer;var r=new t.BitmapData(i.$renderBuffer.surface);return r.$deleteSource=!1,i._setBitmapData(r),i}return r(i,e),i.prototype.drawToTexture=function(e,i,r){if(void 0===r&&(r=1),i&&(0==i.width||0==i.height))return!1;var n=i||e.$getOriginalBounds();if(0==n.width||0==n.height)return!1;r/=t.$TextureScaleFactor;var a=(n.x+n.width)*r,s=(n.y+n.height)*r;i&&(a=n.width*r,s=n.height*r);var o=this.$renderBuffer;if(!o)return!1;if(o.resize(a,s),this.$bitmapData.width=a,this.$bitmapData.height=s,t.nativeRender){egret_native.activateBuffer(this.$renderBuffer);var h=!1,l=0,u=0,c=0,p=0;i&&(h=!0,l=i.x,u=i.y,c=i.width,p=i.height),egret_native.updateNativeRender(),egret_native.nrRenderDisplayObject(e.$nativeDisplayObject.id,r,h,l,u,c,p),egret_native.activateBuffer(null)}else{var f=t.Matrix.create();f.identity(),f.scale(r,r),i&&f.translate(-i.x,-i.y),t.sys.systemRenderer.render(e,o,f,!0),t.Matrix.release(f)}return this.$initData(0,0,a,s,0,0,a,s,a,s),!0},i.prototype.getPixel32=function(e,i){var r;if(this.$renderBuffer){var n=t.$TextureScaleFactor;e=Math.round(e/n),i=Math.round(i/n),r=this.$renderBuffer.getPixels(e,i,1,1)}return r},i.prototype.dispose=function(){e.prototype.dispose.call(this),this.$renderBuffer=null},i}(t.Texture);t.RenderTexture=e,i(e.prototype,"egret.RenderTexture")}(f||(f={})),function(t){!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.type=3,e}return r(e,t),e}(t.Path2D);t.StrokePath=e,i(e.prototype,"egret.sys.StrokePath")}(t.sys||(t.sys={}))}(f||(f={})),function(t){var e=["source-over","lighter","destination-out"],r={none:"butt",square:"square",round:"round"},n=[],a=[],s=function(){function i(){this.nestLevel=0,this.renderingMask=!1}return i.prototype.render=function(e,i,r,a){this.nestLevel++;var s=i.context;s.transform(r.a,r.b,r.c,r.d,0,0);var o=this.drawDisplayObject(e,s,r.tx,r.ty,!0),h=t.Matrix.create();if(r.$invertInto(h),s.transform(h.a,h.b,h.c,h.d,0,0),t.Matrix.release(h),this.nestLevel--,0===this.nestLevel){n.length>6&&(n.length=6);for(var l=n.length,u=0;u<l;u++)n[u].resize(0,0)}return o},i.prototype.drawDisplayObject=function(e,i,r,n,a){var s,o=0,h=e.$displayList;if(h&&!a?((e.$cacheDirty||e.$renderDirty||h.$canvasScaleX!=t.sys.DisplayList.$canvasScaleX||h.$canvasScaleY!=t.sys.DisplayList.$canvasScaleY)&&(o+=h.drawToSurface()),s=h.$renderNode):s=e.$renderDirty?e.$getRenderNode():e.$renderNode,e.$cacheDirty=!1,s){switch(o++,i.$offsetX=r,i.$offsetY=n,s.type){case 1:this.renderBitmap(s,i);break;case 2:this.renderText(s,i);break;case 3:this.renderGraphics(s,i);break;case 4:this.renderGroup(s,i);break;case 5:this.renderMesh(s,i);break;case 6:this.renderNormalBitmap(s,i)}i.$offsetX=0,i.$offsetY=0}if(h&&!a)return o;var l=e.$children;if(l)for(var u=l.length,c=0;c<u;c++){var p=l[c],f=void 0,d=void 0;if(p.$useTranslate){var m=p.$getMatrix();f=r+p.$x,d=n+p.$y,i.save(),i.transform(m.a,m.b,m.c,m.d,f,d),f=-p.$anchorOffsetX,d=-p.$anchorOffsetY}else f=r+p.$x-p.$anchorOffsetX,d=n+p.$y-p.$anchorOffsetY;var g=void 0;switch(1!=p.$alpha&&(g=i.globalAlpha,i.globalAlpha*=p.$alpha),p.$renderMode){case 1:break;case 2:o+=this.drawWithFilter(p,i,f,d);break;case 3:o+=this.drawWithClip(p,i,f,d);break;case 4:o+=this.drawWithScrollRect(p,i,f,d);break;default:o+=this.drawDisplayObject(p,i,f,d)}p.$useTranslate?i.restore():g&&(i.globalAlpha=g)}return o},i.prototype.drawWithFilter=function(t,i,r,n){if(t.$children&&0==t.$children.length&&(!t.$renderNode||0==t.$renderNode.$getRenderCount()))return 0;var s,o=0,h=t.$filters,l=h.length,u=0!==t.$blendMode;u&&((s=e[t.$blendMode])||(s="source-over"));var c=t.$getOriginalBounds(),m=c.x,y=c.y,_=c.width,v=c.height;if(_<=0||v<=0)return o;var b=this.createRenderBuffer(_-m,v-y,!0),T=b.context;if(t.$mask?o+=this.drawWithClip(t,T,-m,-y):t.$scrollRect||t.$maskRect?o+=this.drawWithScrollRect(t,T,-m,-y):o+=this.drawDisplayObject(t,T,-m,-y),o>0){u&&(i.globalCompositeOperation=s),o++;for(var x=T.getImageData(0,0,b.surface.width,b.surface.height),D=0;D<l;D++){var $=h[D];if("colorTransform"==$.type)p(x.data,b.surface.width,b.surface.height,$.$matrix);else if("blur"==$.type)f(x.data,b.surface.width,b.surface.height,$.$blurX,$.$blurY);else if("glow"==$.type){var E=$.$red,w=$.$green,A=$.$blue,S=$.$alpha;$.$inner||$.$knockout||$.$hideObject?g(x.data,b.surface.width,b.surface.height,[E/255,w/255,A/255,S],$.$blurX,$.$blurY,$.$angle?$.$angle/180*Math.PI:0,$.$distance||0,$.$strength,$.$inner?1:0,$.$knockout?0:1,$.$hideObject?1:0):d(x.data,b.surface.width,b.surface.height,[E/255,w/255,A/255,S],$.$blurX,$.$blurY,$.$angle?$.$angle/180*Math.PI:0,$.$distance||0,$.$strength)}else $.type}T.putImageData(x,0,0),i.drawImage(b.surface,r+m,n+y),u&&(i.globalCompositeOperation="source-over")}return a.push(b),o},i.prototype.drawWithClip=function(i,r,a,s){var o,h=0,l=0!==i.$blendMode;l&&((o=e[i.$blendMode])||(o="source-over"));var u=i.$scrollRect?i.$scrollRect:i.$maskRect,c=i.$mask;if(c){var p=c.$getMatrix();if(0==p.a&&0==p.b||0==p.c&&0==p.d)return h}if(!(c||i.$children&&0!=i.$children.length))return u&&(r.save(),r.beginPath(),r.rect(u.x+a,u.y+s,u.width,u.height),r.clip()),l&&(r.globalCompositeOperation=o),h+=this.drawDisplayObject(i,r,a,s),l&&(r.globalCompositeOperation="source-over"),u&&r.restore(),h;if(c){var f=c.$getRenderNode();if((!c.$children||0==c.$children.length)&&f&&3==f.type&&1==f.drawData.length&&1==f.drawData[0].type&&1==f.drawData[0].fillAlpha){this.renderingMask=!0,r.save(),(x=t.Matrix.create()).copyFrom(c.$getConcatenatedMatrix()),c.$getConcatenatedMatrixAt(i,x),r.transform(x.a,x.b,x.c,x.d,x.tx,x.ty);var d=this.drawDisplayObject(c,r,a,s);return this.renderingMask=!1,x.$invertInto(x),r.transform(x.a,x.b,x.c,x.d,x.tx,x.ty),t.Matrix.release(x),u&&(r.beginPath(),r.rect(u.x+a,u.y+s,u.width,u.height),r.clip()),d+=this.drawDisplayObject(i,r,a,s),r.restore(),d}}var m=i.$getOriginalBounds(),g=m.x,y=m.y,_=m.width,v=m.height;if(_<=0||v<=0)return h;var b=this.createRenderBuffer(_,v),T=b.context;if(!T)return h+this.drawDisplayObject(i,r,a,s);if(h+=this.drawDisplayObject(i,T,-g,-y),c){var x;if(f=c.$getRenderNode(),(x=t.Matrix.create()).copyFrom(c.$getConcatenatedMatrix()),c.$getConcatenatedMatrixAt(i,x),x.translate(-g,-y),f&&1==f.$getRenderCount()||c.$displayList)T.globalCompositeOperation="destination-in",T.save(),T.setTransform(x.a,x.b,x.c,x.d,x.tx,x.ty),h+=this.drawDisplayObject(c,T,0,0),T.restore();else{var D=this.createRenderBuffer(_,v),$=D.context;$.setTransform(x.a,x.b,x.c,x.d,x.tx,x.ty),h+=this.drawDisplayObject(c,$,0,0),T.globalCompositeOperation="destination-in",T.drawImage(D.surface,0,0),n.push(D)}t.Matrix.release(x)}return h>0&&(h++,l&&(r.globalCompositeOperation=o),u&&(r.save(),r.beginPath(),r.rect(u.x+a,u.y+s,u.width,u.height),r.clip()),r.drawImage(b.surface,a+g,s+y),u&&r.restore(),l&&(r.globalCompositeOperation="source-over")),n.push(b),h},i.prototype.drawWithScrollRect=function(t,e,i,r){var n=0,a=t.$scrollRect?t.$scrollRect:t.$maskRect;return a.isEmpty()?n:(t.$scrollRect&&(i-=a.x,r-=a.y),e.save(),e.beginPath(),e.rect(a.x+i,a.y+r,a.width,a.height),e.clip(),n+=this.drawDisplayObject(t,e,i,r),e.restore(),n)},i.prototype.drawNodeToBuffer=function(t,e,i,r){var n=e.context;n.setTransform(i.a,i.b,i.c,i.d,i.tx,i.ty),this.renderNode(t,n,r)},i.prototype.drawDisplayToBuffer=function(t,e,i){var r,n=e.context;i&&n.setTransform(i.a,i.b,i.c,i.d,i.tx,i.ty);var a=0;if(r=t.$renderDirty?t.$getRenderNode():t.$renderNode)switch(a++,r.type){case 1:this.renderBitmap(r,n);break;case 2:this.renderText(r,n);break;case 3:this.renderGraphics(r,n);break;case 4:this.renderGroup(r,n);break;case 5:this.renderMesh(r,n);break;case 6:this.renderNormalBitmap(r,n)}var s=t.$children;if(s)for(var o=s.length,h=0;h<o;h++){var l=s[h];switch(l.$renderMode){case 1:break;case 2:a+=this.drawWithFilter(l,n,0,0);break;case 3:a+=this.drawWithClip(l,n,0,0);break;case 4:a+=this.drawWithScrollRect(l,n,0,0);break;default:a+=this.drawDisplayObject(l,n,0,0)}}return a},i.prototype.renderNode=function(t,e,i){var r=0;switch(t.type){case 1:r=this.renderBitmap(t,e);break;case 2:r=1,this.renderText(t,e);break;case 3:r=this.renderGraphics(t,e,i);break;case 4:r=this.renderGroup(t,e);break;case 5:r=this.renderMesh(t,e);break;case 6:r+=this.renderNormalBitmap(t,e)}return r},i.prototype.renderNormalBitmap=function(t,e){var i=t.image;if(!i||!i.source)return 0;if(e.$imageSmoothingEnabled!=t.smoothing&&(e.imageSmoothingEnabled=t.smoothing,e.$imageSmoothingEnabled=t.smoothing),t.rotated){var r=t.sourceX,n=t.sourceY,a=t.sourceW,s=t.sourceH,o=t.drawX,h=t.drawY,l=t.drawW,u=t.drawH;e.save(),e.transform(0,-1,1,0,0,u),e.drawImage(i.source,r,n,s,a,o+e.$offsetX,h+e.$offsetY,u,l),e.restore()}else e.drawImage(i.source,t.sourceX,t.sourceY,t.sourceW,t.sourceH,t.drawX+e.$offsetX,t.drawY+e.$offsetY,t.drawW,t.drawH);return 1},i.prototype.renderBitmap=function(t,i){var r=t.image;if(!r||!r.source)return 0;i.$imageSmoothingEnabled!=t.smoothing&&(i.imageSmoothingEnabled=t.smoothing,i.$imageSmoothingEnabled=t.smoothing);var a,s,o,h=t.drawData,l=h.length,u=0,c=t.matrix,f=t.blendMode,d=t.alpha,m=!1;c&&(i.save(),m=!0,0==i.$offsetX&&0==i.$offsetY||(i.translate(i.$offsetX,i.$offsetY),a=i.$offsetX,s=i.$offsetY,i.$offsetX=i.$offsetY=0),i.transform(c.a,c.b,c.c,c.d,c.tx,c.ty)),f&&(i.globalCompositeOperation=e[f]),d==d&&(o=i.globalAlpha,i.globalAlpha*=d);var g=0,y=t.filter;if(y&&8==l){var _=h[0],v=h[1],b=h[2],T=h[3],x=h[4],D=h[5],$=h[6],E=h[7];t.rotated&&(b=h[3],T=h[2],$=h[7],E=h[6]);var w=this.createRenderBuffer($,E),A=w.context;g++,t.rotated&&i.transform(0,-1,1,0,0,$),A.drawImage(r.source,_,v,b,T,0,0,$,E),g++;var S=A.getImageData(0,0,$,E);p(S.data,$,E,y.$matrix),A.putImageData(S,0,0),i.drawImage(w.surface,0,0,$,E,x+i.$offsetX,D+i.$offsetY,$,E),n.push(w)}else for(;u<l;)if(g++,t.rotated){_=h[u++],v=h[u++],T=h[u++],b=h[u++];var O=h[u++],C=h[u++];E=h[u++],$=h[u++],i.save(),i.transform(0,-1,1,0,0,$),i.drawImage(r.source,_,v,b,T,O+i.$offsetX,C+i.$offsetY,$,E),i.restore()}else i.drawImage(r.source,h[u++],h[u++],h[u++],h[u++],h[u++]+i.$offsetX,h[u++]+i.$offsetY,h[u++],h[u++]);return m?i.restore():(f&&(i.globalCompositeOperation="source-over"),d==d&&(i.globalAlpha=o)),a&&(i.$offsetX=a),s&&(i.$offsetY=s),g},i.prototype.renderMesh=function(t,e){return 0},i.prototype.renderText=function(e,i){i.textAlign="left",i.textBaseline="middle",i.lineJoin="round";for(var r=e.drawData,n=r.length,a=0;a<n;){var s=r[a++],h=r[a++],l=r[a++],u=r[a++];i.font=o(e,u);var c=null==u.textColor?e.textColor:u.textColor,p=null==u.strokeColor?e.strokeColor:u.strokeColor,f=null==u.stroke?e.stroke:u.stroke;i.fillStyle=t.toColorString(c),i.strokeStyle=t.toColorString(p),f&&(i.lineWidth=2*f,i.strokeText(l,s+i.$offsetX,h+i.$offsetY)),i.fillText(l,s+i.$offsetX,h+i.$offsetY)}},i.prototype.renderGraphics=function(t,e,i){var n=t.drawData,a=n.length;i=!!i;for(var s=0;s<a;s++){var o=n[s];switch(o.type){case 1:var u=o;e.fillStyle=i?"#000000":h(u.fillColor,u.fillAlpha),this.renderPath(o,e),this.renderingMask?e.clip():e.fill();break;case 2:var c=o;e.fillStyle=i?"#000000":l(e,c.gradientType,c.colors,c.alphas,c.ratios,c.matrix),e.save();var p=c.matrix;this.renderPath(o,e),e.transform(p.a,p.b,p.c,p.d,p.tx,p.ty),e.fill(),e.restore();break;case 3:var f=o,d=f.lineWidth;e.lineWidth=d,e.strokeStyle=i?"#000000":h(f.lineColor,f.lineAlpha),e.lineCap=r[f.caps],e.lineJoin=f.joints,e.miterLimit=f.miterLimit,e.setLineDash&&e.setLineDash(f.lineDash);var m=1===d||3===d;m&&e.translate(.5,.5),this.renderPath(o,e),e.stroke(),m&&e.translate(-.5,-.5)}}return 0==a?0:1},i.prototype.renderPath=function(t,e){e.beginPath();for(var i=t.$data,r=t.$commands,n=r.length,a=0,s=0;s<n;s++)switch(r[s]){case 4:e.bezierCurveTo(i[a++]+e.$offsetX,i[a++]+e.$offsetY,i[a++]+e.$offsetX,i[a++]+e.$offsetY,i[a++]+e.$offsetX,i[a++]+e.$offsetY);break;case 3:e.quadraticCurveTo(i[a++]+e.$offsetX,i[a++]+e.$offsetY,i[a++]+e.$offsetX,i[a++]+e.$offsetY);break;case 2:e.lineTo(i[a++]+e.$offsetX,i[a++]+e.$offsetY);break;case 1:e.moveTo(i[a++]+e.$offsetX,i[a++]+e.$offsetY)}},i.prototype.renderGroup=function(t,e){var i,r,n=t.matrix,a=!1;n&&(e.save(),a=!0,0==e.$offsetX&&0==e.$offsetY||(e.translate(e.$offsetX,e.$offsetY),i=e.$offsetX,r=e.$offsetY,e.$offsetX=e.$offsetY=0),e.transform(n.a,n.b,n.c,n.d,n.tx,n.ty));for(var s=0,o=t.drawData,h=o.length,l=0;l<h;l++){var u=o[l];s+=this.renderNode(u,e)}return a&&e.restore(),i&&(e.$offsetX=i),r&&(e.$offsetY=r),s},i.prototype.createRenderBuffer=function(e,i,r){var s=r?a.pop():n.pop();return s?s.resize(e,i,!0):s=new t.sys.CanvasRenderBuffer(e,i),s},i}();function o(t,e){var i=null==e.italic?t.italic:e.italic,r=null==e.bold?t.bold:e.bold,n=null==e.size?t.size:e.size,a=e.fontFamily||t.fontFamily,s=i?"italic ":"normal ";return(s+=r?"bold ":"normal ")+(n+"px ")+a}function h(t,e){return"rgba("+(t>>16)+","+(t>>8&255)+","+(255&t)+","+e+")"}function l(e,i,r,n,a,s){var o;o=i==t.GradientType.LINEAR?e.createLinearGradient(-1,0,1,0):e.createRadialGradient(0,0,0,0,0,1);for(var l=r.length,u=0;u<l;u++)o.addColorStop(a[u]/255,h(r[u],n[u]));return o}t.CanvasRenderer=s,i(s.prototype,"egret.CanvasRenderer"),t.getFontString=o,t.getRGBAString=h;var u=!1;try{u=void 0!==typeof Uint8ClampedArray}catch(t){}function c(t,e,i){void 0===i&&(i=0);for(var r=0,n=e.length;r<n;r++)t[r+i]=e[r]}function p(t,e,i,r){for(var n=r[0],a=r[1],s=r[2],o=r[3],h=r[4],l=r[5],u=r[6],c=r[7],p=r[8],f=r[9],d=r[10],m=r[11],g=r[12],y=r[13],_=r[14],v=r[15],b=r[16],T=r[17],x=r[18],D=r[19],$=0,E=e*i*4;$<E;$+=4){var w=t[$+0],A=t[$+1],S=t[$+2],O=t[$+3];t[$+0]=n*w+a*A+s*S+o*O+h,t[$+1]=l*w+u*A+c*S+p*O+f,t[$+2]=d*w+m*A+g*S+y*O+_,t[$+3]=v*w+b*A+T*S+x*O+D}}function f(t,e,i,r,n){!function(t,e,i,r){var n;n=u?new Uint8ClampedArray(4*e):new Array(4*e);for(var a=4*e,s=2*r+1,o=0;o<i;o++){for(var h=o*a,l=0,p=0,f=0,d=0,m=0,g=0,y=4*-r,_=4*r+4;y<_;y+=4){var v=h+y;v<h||v>=h+a||(m=t[v+3],l+=t[v+0]*m,p+=t[v+1]*m,f+=t[v+2]*m,d+=m)}_=h+a;for(var b=0,T=(y=h)-4*r,x=y+4*(r+1);y<_;y+=4,b+=4,x+=4,T+=4)0===d?(n[b+0]=0,n[b+1]=0,n[b+2]=0,n[b+3]=0):(n[b+0]=l/d,n[b+1]=p/d,n[b+2]=f/d,n[b+3]=d/s),m=t[x+3],g=t[T+3],m||0==m?g||0==g?(l+=t[x+0]*m-t[T+0]*g,p+=t[x+1]*m-t[T+1]*g,f+=t[x+2]*m-t[T+2]*g,d+=m-g):(l+=t[x+0]*m,p+=t[x+1]*m,f+=t[x+2]*m,d+=m):(g||0==g)&&(l+=-t[T+0]*g,p+=-t[T+1]*g,f+=-t[T+2]*g,d+=-g);u?t.set(n,h):c(t,n,h)}}(t,e,i,r),function(t,e,i,r){var n;n=u?new Uint8ClampedArray(4*i):new Array(4*i);for(var a=4*e,s=2*r+1,o=0;o<e;o++){for(var h=4*o,l=0,c=0,p=0,f=0,d=0,m=0,g=-r*a,y=r*a+a;g<y;g+=a){var _=h+g;_<h||_>=h+i*a||(d=t[_+3],l+=t[_+0]*d,c+=t[_+1]*d,p+=t[_+2]*d,f+=d)}g=h,y=h+i*a;for(var v=0,b=h-r*a,T=h+(r+1)*a;g<y;g+=a,v+=4,T+=a,b+=a)0===f?(n[v+0]=0,n[v+1]=0,n[v+2]=0,n[v+3]=0):(n[v+0]=l/f,n[v+1]=c/f,n[v+2]=p/f,n[v+3]=f/s),d=t[T+3],m=t[b+3],d||0==d?m||0==m?(l+=t[T+0]*d-t[b+0]*m,c+=t[T+1]*d-t[b+1]*m,p+=t[T+2]*d-t[b+2]*m,f+=d-m):(l+=t[T+0]*d,c+=t[T+1]*d,p+=t[T+2]*d,f+=d):(m||0==m)&&(l+=-t[b+0]*m,c+=-t[b+1]*m,p+=-t[b+2]*m,f+=-m);for(var x=4*o,D=(y=x+i*a,0);x<y;x+=a,D+=4)t[x+0]=n[D+0],t[x+1]=n[D+1],t[x+2]=n[D+2],t[x+3]=n[D+3]}}(t,e,i,n)}function d(t,e,i,r,n,a,s,o,h){var l=function(t,e){var i;e||(e=[0,0,0,0]),u?i=new Uint8ClampedArray(t):c(i=new Array(t.length),t);for(var r=e[0],n=e[1],a=e[2],s=e[3],o=0,h=i.length;o<h;o+=4){var l=i[o+3];i[o+0]=r*l,i[o+1]=n*l,i[o+2]=a*l,i[o+3]=s*l}return i}(t,r);!function(t,e,i,r,n){var a,s,o=Math.sin(r)*n|0,h=Math.cos(r)*n|0;if(u){a=new Int32Array(t.buffer),s=new Int32Array(a.length);for(var l=0;l<i;l++){if(!((f=l+o)<0||f>i))for(var p=0;p<e;p++){(d=p+h)<0||d>e||(s[f*e+d]=a[l*e+p])}}a.set(s)}else{a=t,s=new Array(a.length);for(l=0;l<i;l++){var f;if(!((f=l+o)<0||f>i))for(p=0;p<e;p++){var d;(d=p+h)<0||d>e||(s[4*(f*e+d)+0]=a[4*(l*e+p)+0],s[4*(f*e+d)+1]=a[4*(l*e+p)+1],s[4*(f*e+d)+2]=a[4*(l*e+p)+2],s[4*(f*e+d)+3]=a[4*(l*e+p)+3])}}c(a,s)}}(l,e,i,s,o),f(l,e,i,n,a),function(t,e){for(var i=0,r=t.length;i<r;i+=4)t[i+3]*=e}(l,h),function(t,e){for(var i=0,r=t.length;i<r;i+=4){var n=t[i+0],a=t[i+1],s=t[i+2],o=t[i+3]/255,h=e[i+0],l=e[i+1],u=e[i+2],c=e[i+3]/255;t[i+0]=h+n*(1-c),t[i+1]=l+a*(1-c),t[i+2]=u+s*(1-c),t[i+3]=255*(c+o*(1-c))}}(l,t),t.set(l),u?t.set(l):c(t,l)}function m(t,e,i){return t*(1-i)+e*i}function g(t,e,i,r,n,a,s,o,h,l,p,f){var d;d=u?new Uint8ClampedArray(t.length):new Array(t.length);for(var g,y,_=r[3],v=0,b=0,T=o*Math.cos(s),x=o*Math.sin(s),D=3.141592653589793,$=n/7,E=a/7,w=0;w<e;w++)for(var A=0;A<i;A++){for(var S=A*e*4+4*w,O=0,C=0,P=t[S+0]/255,R=t[S+1]/255,M=t[S+2]/255,I=t[S+3]/255,B=0;B<=2*D;B+=2*D/12){g=Math.cos(B+0),y=Math.sin(B+0);for(var F=0;F<7;F++){v=F*$*g,b=F*E*y;var L=Math.round(w+v-T),N=Math.round(A+b-x);O+=(7-F)*(L>=e||L<0||N<0||N>=i?0:t[N*e*4+4*L+3]/255),C+=7-F}}I=Math.max(I,1e-4);var k=O/C*h*_*(1-l)*Math.max(Math.min(f,p),1-I),j=(C-O)/C*h*_*l*I,U=j/(j+(I=Math.max(I*p*(1-f),1e-4))),H=m(P,r[0],U),W=m(R,r[1],U),X=m(M,r[2],U),Y=k/(j+I+k),G=m(H,r[0],Y),V=m(W,r[1],Y),z=m(X,r[2],Y),q=Math.min(I+k+j,1);d[S+0]=255*G,d[S+1]=255*V,d[S+2]=255*z,d[S+3]=255*q}u?t.set(d):c(t,d)}}(f||(f={})),(f||(f={})).DeviceOrientation=null,f||(f={}),f||(f={}),function(t){!function(t){t.WEB="web",t.NATIVE="native",t.RUNTIME2="runtime2",t.WXGAME="wxgame"}(t.RuntimeType||(t.RuntimeType={}));var e=function(){function e(){}return e.language="zh-CN",e.os="Unknown",e.runtimeType=t.RuntimeType.WEB,e.engineVersion="5.2.8",e.renderMode="Unknown",e.boundingClientWidth=0,e.boundingClientHeight=0,e}();t.Capabilities=e,i(e.prototype,"egret.Capabilities")}(f||(f={})),function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.$graphics=new t.Graphics,i.$graphics.$setTarget(i),i}return r(i,e),i.prototype.createNativeDisplayObject=function(){this.$nativeDisplayObject=new egret_native.NativeDisplayObject(8)},Object.defineProperty(i.prototype,"graphics",{get:function(){return this.$graphics},enumerable:!0,configurable:!0}),i.prototype.$measureContentBounds=function(t){this.$graphics.$measureContentBounds(t)},i.prototype.$hitTest=function(t,i){var r=e.prototype.$hitTest.call(this,t,i);return r==this&&(r=this.$graphics.$hitTest(t,i)),r},i.prototype.$onRemoveFromStage=function(){e.prototype.$onRemoveFromStage.call(this),this.$graphics&&this.$graphics.$onRemoveFromStage()},i}(t.DisplayObject);t.Shape=e,i(e.prototype,"egret.Shape")}(f||(f={})),function(t){var e={};t.registerImplementation=function(t,i){e[t]=i},t.getImplementation=function(t){return e[t]}}(f||(f={})),function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.$graphics=new t.Graphics,i.$graphics.$setTarget(i),i}return r(i,e),i.prototype.createNativeDisplayObject=function(){this.$nativeDisplayObject=new egret_native.NativeDisplayObject(9)},Object.defineProperty(i.prototype,"graphics",{get:function(){return this.$graphics},enumerable:!0,configurable:!0}),i.prototype.$hitTest=function(e,i){if(!this.$visible)return null;var r=this.$getInvertedConcatenatedMatrix(),n=r.a*e+r.c*i+r.tx,a=r.b*e+r.d*i+r.ty,s=this.$scrollRect?this.$scrollRect:this.$maskRect;if(s&&!s.contains(n,a))return null;if(this.$mask&&!this.$mask.$hitTest(e,i))return null;for(var o=this.$children,h=!1,l=null,u=o.length-1;u>=0;u--){var c=o[u];if(!c.$maskedObject&&(l=c.$hitTest(e,i))){if(h=!0,l.$touchEnabled)break;l=null}}return l?this.$touchChildren?l:this:h?this:((l=t.DisplayObject.prototype.$hitTest.call(this,e,i))&&(l=this.$graphics.$hitTest(e,i)),l)},i.prototype.$measureContentBounds=function(t){this.$graphics.$measureContentBounds(t)},i.prototype.$onRemoveFromStage=function(){e.prototype.$onRemoveFromStage.call(this),this.$graphics&&this.$graphics.$onRemoveFromStage()},i}(t.DisplayObjectContainer);t.Sprite=e,i(e.prototype,"egret.Sprite")}(f||(f={})),function(t){var e=function(t){function e(e,i){var r=t.call(this,e)||this;return r.firstCharHeight=0,"string"==typeof i?r.charList=r.parseConfig(i):i&&i.hasOwnProperty("frames")?r.charList=i.frames:r.charList={},r}return r(e,t),e.prototype.getTexture=function(t){var e=this._textureMap[t];if(!e){var i=this.charList[t];if(!i)return null;e=this.createTexture(t,i.x,i.y,i.w,i.h,i.offX,i.offY,i.sourceW,i.sourceH),this._textureMap[t]=e}return e},e.prototype.getConfig=function(t,e){return this.charList[t]?this.charList[t][e]:0},e.prototype._getFirstCharHeight=function(){if(0==this.firstCharHeight)for(var t in this.charList){var e=this.charList[t];if(e){var i=e.sourceH;if(void 0===i){var r=e.h;void 0===r&&(r=0);var n=e.offY;void 0===n&&(n=0),i=r+n}if(i<=0)continue;this.firstCharHeight=i;break}}return this.firstCharHeight},e.prototype.parseConfig=function(t){for(var e=(t=t.split("\r\n").join("\n")).split("\n"),i=this.getConfigByKey(e[3],"count"),r={},n=4;n<4+i;n++){var a=e[n],s={};r[String.fromCharCode(this.getConfigByKey(a,"id"))]=s,s.x=this.getConfigByKey(a,"x"),s.y=this.getConfigByKey(a,"y"),s.w=this.getConfigByKey(a,"width"),s.h=this.getConfigByKey(a,"height"),s.offX=this.getConfigByKey(a,"xoffset"),s.offY=this.getConfigByKey(a,"yoffset"),s.xadvance=this.getConfigByKey(a,"xadvance")}return r},e.prototype.getConfigByKey=function(t,e){for(var i=t.split(" "),r=0,n=i.length;r<n;r++){var a=i[r];if(e==a.substring(0,e.length)){var s=a.substring(e.length+1);return parseInt(s)}}return 0},e}(t.SpriteSheet);t.BitmapFont=e,i(e.prototype,"egret.BitmapFont")}(f||(f={})),function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.$smoothing=t.Bitmap.defaultSmoothing,i.$text="",i.$textFieldWidth=NaN,i.$textLinesChanged=!1,i.$textFieldHeight=NaN,i.$font=null,i.$fontStringChanged=!1,i.$lineSpacing=0,i.$letterSpacing=0,i.$textAlign=t.HorizontalAlign.LEFT,i.$verticalAlign=t.VerticalAlign.TOP,i.$textWidth=NaN,i.$textHeight=NaN,i.$textOffsetX=0,i.$textOffsetY=0,i.$textStartX=0,i.$textStartY=0,i.textLines=[],i.$lineHeights=[],t.nativeRender||(i.$renderNode=new t.sys.BitmapNode),i}return r(i,e),i.prototype.createNativeDisplayObject=function(){this.$nativeDisplayObject=new egret_native.NativeDisplayObject(11)},Object.defineProperty(i.prototype,"smoothing",{get:function(){return this.$smoothing},set:function(t){t!=this.$smoothing&&(this.$smoothing=t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"text",{get:function(){return this.$text},set:function(t){this.$setText(t)},enumerable:!0,configurable:!0}),i.prototype.$setText=function(t){return(t=null==t?"":String(t))!=this.$text&&(this.$text=t,this.$invalidateContentBounds(),!0)},i.prototype.$getWidth=function(){var t=this.$textFieldWidth;return isNaN(t)?this.$getContentBounds().width:t},i.prototype.$setWidth=function(t){return!(t<0||t==this.$textFieldWidth||(this.$textFieldWidth=t,this.$invalidateContentBounds(),0))},i.prototype.$invalidateContentBounds=function(){this.$renderDirty=!0,this.$textLinesChanged=!0,this.$updateRenderNode()},i.prototype.$getHeight=function(){var t=this.$textFieldHeight;return isNaN(t)?this.$getContentBounds().height:t},i.prototype.$setHeight=function(t){return!(t<0||t==this.$textFieldHeight||(this.$textFieldHeight=t,this.$invalidateContentBounds(),0))},Object.defineProperty(i.prototype,"font",{get:function(){return this.$font},set:function(t){this.$setFont(t)},enumerable:!0,configurable:!0}),i.prototype.$setFont=function(t){return this.$font!=t&&(this.$font=t,this.$fontStringChanged=!0,this.$invalidateContentBounds(),!0)},Object.defineProperty(i.prototype,"lineSpacing",{get:function(){return this.$lineSpacing},set:function(t){this.$setLineSpacing(t)},enumerable:!0,configurable:!0}),i.prototype.$setLineSpacing=function(t){return this.$lineSpacing!=t&&(this.$lineSpacing=t,this.$invalidateContentBounds(),!0)},Object.defineProperty(i.prototype,"letterSpacing",{get:function(){return this.$letterSpacing},set:function(t){this.$setLetterSpacing(t)},enumerable:!0,configurable:!0}),i.prototype.$setLetterSpacing=function(t){return this.$letterSpacing!=t&&(this.$letterSpacing=t,this.$invalidateContentBounds(),!0)},Object.defineProperty(i.prototype,"textAlign",{get:function(){return this.$textAlign},set:function(t){this.$setTextAlign(t)},enumerable:!0,configurable:!0}),i.prototype.$setTextAlign=function(t){return this.$textAlign!=t&&(this.$textAlign=t,this.$invalidateContentBounds(),!0)},Object.defineProperty(i.prototype,"verticalAlign",{get:function(){return this.$verticalAlign},set:function(t){this.$setVerticalAlign(t)},enumerable:!0,configurable:!0}),i.prototype.$setVerticalAlign=function(t){return this.$verticalAlign!=t&&(this.$verticalAlign=t,this.$invalidateContentBounds(),!0)},i.prototype.$updateRenderNode=function(){var e=this.$getTextLines(),r=e.length;if(0!=r){var n,a=[],s=this.$textLinesWidth,o=this.$font;t.nativeRender||(n=this.$renderNode,o.$texture&&(n.image=o.$texture.$bitmapData),n.smoothing=this.$smoothing);for(var h=o._getFirstCharHeight(),l=Math.ceil(h*i.EMPTY_FACTOR),u=!isNaN(this.$textFieldHeight),c=this.$textWidth,p=this.$textFieldWidth,f=this.$textFieldHeight,d=this.$textAlign,m=this.$textOffsetY+this.$textStartY,g=this.$lineHeights,y=0;y<r;y++){var _=g[y];if(u&&y>0&&m+_>f)break;var v=e[y],b=v.length,T=this.$textOffsetX;if(d!=t.HorizontalAlign.LEFT){var x=p>c?p:c;d==t.HorizontalAlign.RIGHT?T+=x-s[y]:d==t.HorizontalAlign.CENTER&&(T+=Math.floor((x-s[y])/2))}for(var D=0;D<b;D++){var $=v.charAt(D),E=o.getTexture($);if(E){var w=E.$bitmapWidth,A=E.$bitmapHeight;t.nativeRender?a.push(E.$bitmapX,E.$bitmapY,w,A,T+E.$offsetX,m+E.$offsetY,E.$getScaleBitmapWidth(),E.$getScaleBitmapHeight(),E.$sourceWidth,E.$sourceHeight):(n.imageWidth=E.$sourceWidth,n.imageHeight=E.$sourceHeight,n.drawImage(E.$bitmapX,E.$bitmapY,w,A,T+E.$offsetX,m+E.$offsetY,E.$getScaleBitmapWidth(),E.$getScaleBitmapHeight())),T+=(o.getConfig($,"xadvance")||E.$getTextureWidth())+this.$letterSpacing}else" "==$?T+=l:t.$warn(1046,$)}m+=_+this.$lineSpacing}if(t.nativeRender){this.$nativeDisplayObject.setDataToBitmapNode(this.$nativeDisplayObject.id,o.$texture,a);var S=this.$getContentBounds();this.$nativeDisplayObject.setWidth(S.width),this.$nativeDisplayObject.setHeight(S.height)}}else t.nativeRender&&this.$font&&(this.$nativeDisplayObject.setDataToBitmapNode(this.$nativeDisplayObject.id,this.$font.$texture,[]),this.$nativeDisplayObject.setWidth(0),this.$nativeDisplayObject.setHeight(0))},i.prototype.$measureContentBounds=function(t){0==this.$getTextLines().length?t.setEmpty():t.setTo(this.$textOffsetX+this.$textStartX,this.$textOffsetY+this.$textStartY,this.$textWidth-this.$textOffsetX,this.$textHeight-this.$textOffsetY)},Object.defineProperty(i.prototype,"textWidth",{get:function(){return this.$getTextLines(),this.$textWidth},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"textHeight",{get:function(){return this.$getTextLines(),this.$textHeight},enumerable:!0,configurable:!0}),i.prototype.$getTextLines=function(){if(!this.$textLinesChanged)return this.textLines;var e=[];this.textLines=e;var r=[];this.$textLinesWidth=r,this.$textLinesChanged=!1;var n=[];if(this.$lineHeights=n,!this.$text||!this.$font)return this.$textWidth=0,this.$textHeight=0,e;for(var a,s,o,h,l,u=this.$lineSpacing,c=this.$letterSpacing,p=0,f=0,d=0,m=0,g=!isNaN(this.$textFieldWidth),y=this.$textFieldWidth,_=this.$textFieldHeight,v=this.$font,b=v._getFirstCharHeight(),T=Math.ceil(b*i.EMPTY_FACTOR),x=this.$text.split(/(?:\r\n|\r|\n)/),D=x.length,$=!0,E=0;E<D;E++){var w=x[E],A=w.length;o=0,h=0,a=!0,s=!1;for(var S=0;S<A;S++){a||(h+=c);var O=w.charAt(S),C=void 0,P=void 0,R=0,M=0,I=v.getTexture(O);if(I)C=I.$getTextureWidth(),P=I.$getTextureHeight(),R=I.$offsetX,M=I.$offsetY;else{if(" "!=O){t.$warn(1046,O),a&&(a=!1);continue}C=T,P=b}if(a&&(a=!1,d=Math.min(R,d)),$&&($=!1,m=Math.min(M,m)),g&&S>0&&h+C>y){if(!B(w.substring(0,S)))break;A=(w=w.substring(S)).length,h=(S=0)==A-1?C:v.getConfig(O,"xadvance")||C,o=P}else h+=S==A-1?C:v.getConfig(O,"xadvance")||C,o=Math.max(P,o)}if(_&&E>0&&f>_)break;if(s=!0,!B(w))break}function B(t){return!(_&&e.length>0&&f>_||(f+=o+u,a||s||(h-=c),e.push(t),n.push(o),r.push(h),p=Math.max(h,p),0))}return f-=u,this.$textWidth=p,this.$textHeight=f,this.$textOffsetX=d,this.$textOffsetY=m,this.$textStartX=0,this.$textStartY=0,y>p&&((l=this.$textAlign)==t.HorizontalAlign.RIGHT?this.$textStartX=y-p:l==t.HorizontalAlign.CENTER&&(this.$textStartX=Math.floor((y-p)/2))),_>f&&((l=this.$verticalAlign)==t.VerticalAlign.BOTTOM?this.$textStartY=_-f:l==t.VerticalAlign.MIDDLE&&(this.$textStartY=Math.floor((_-f)/2))),e},i.EMPTY_FACTOR=.33,i}(t.DisplayObject);t.BitmapText=e,i(e.prototype,"egret.BitmapText")}(f||(f={})),function(t){var e=function(){function t(){}return t.LEFT="left",t.RIGHT="right",t.CENTER="center",t.JUSTIFY="justify",t.CONTENT_JUSTIFY="contentJustify",t}();t.HorizontalAlign=e,i(e.prototype,"egret.HorizontalAlign")}(f||(f={})),function(t){var e=function(){function e(){this.replaceArr=[],this.resutlArr=[],this.initReplaceArr()}return e.prototype.initReplaceArr=function(){this.replaceArr=[],this.replaceArr.push([/&lt;/g,"<"]),this.replaceArr.push([/&gt;/g,">"]),this.replaceArr.push([/&amp;/g,"&"]),this.replaceArr.push([/&quot;/g,'"']),this.replaceArr.push([/&apos;/g,"'"])},e.prototype.replaceSpecial=function(t){for(var e=0;e<this.replaceArr.length;e++){var i=this.replaceArr[e][0],r=this.replaceArr[e][1];t=t.replace(i,r)}return t},e.prototype.parse=function(e){this.stackArray=[],this.resutlArr=[];for(var i=0,r=e.length;i<r;){var n=e.indexOf("<",i);if(n<0)this.addToResultArr(e.substring(i)),i=r;else{this.addToResultArr(e.substring(i,n));var a=e.indexOf(">",n);-1==a?(t.$error(1038),a=n):"/"==e.charAt(n+1)?this.stackArray.pop():this.addToArray(e.substring(n+1,a)),i=a+1}}return this.resutlArr},e.prototype.parser=function(t){return this.parse(t)},e.prototype.addToResultArr=function(t){""!=t&&(t=this.replaceSpecial(t),this.stackArray.length>0?this.resutlArr.push({text:t,style:this.stackArray[this.stackArray.length-1]}):this.resutlArr.push({text:t}))},e.prototype.changeStringToObject=function(t){var e={},i=[];if("i"==(t=t.trim()).charAt(0)||"b"==t.charAt(0)||"u"==t.charAt(0))this.addProperty(e,t,"true");else if(i=t.match(/^(font|a)\s/)){t=t.substring(i[0].length).trim();for(var r=0,n=void 0;n=t.match(this.getHeadReg());){var a=n[0],s="";'"'==(t=t.substring(a.length).trim()).charAt(0)?(r=t.indexOf('"',1),s=t.substring(1,r),r+=1):"'"==t.charAt(0)?(r=t.indexOf("'",1),s=t.substring(1,r),r+=1):r=(s=t.match(/(\S)+/)[0]).length,this.addProperty(e,a.substring(0,a.length-1).trim(),s.trim()),t=t.substring(r).trim()}}return e},e.prototype.getHeadReg=function(){return/^(color|textcolor|strokecolor|stroke|b|bold|i|italic|u|size|fontfamily|href|target)(\s)*=/},e.prototype.addProperty=function(t,e,i){switch(e.toLowerCase()){case"color":case"textcolor":i=i.replace(/#/,"0x"),t.textColor=parseInt(i);break;case"strokecolor":i=i.replace(/#/,"0x"),t.strokeColor=parseInt(i);break;case"stroke":t.stroke=parseInt(i);break;case"b":case"bold":t.bold="true"==i;break;case"u":t.underline="true"==i;break;case"i":case"italic":t.italic="true"==i;break;case"size":t.size=parseInt(i);break;case"fontfamily":t.fontFamily=i;break;case"href":t.href=this.replaceSpecial(i);break;case"target":t.target=this.replaceSpecial(i)}},e.prototype.addToArray=function(t){var e=this.changeStringToObject(t);if(0==this.stackArray.length)this.stackArray.push(e);else{var i=this.stackArray[this.stackArray.length-1];for(var r in i)null==e[r]&&(e[r]=i[r]);this.stackArray.push(e)}},e}();t.HtmlTextParser=e,i(e.prototype,"egret.HtmlTextParser")}(f||(f={})),function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.stageTextAdded=!1,t._text=null,t._isFocus=!1,t}return r(i,e),i.prototype.init=function(e){this._text=e,this.stageText=new t.StageText,this.stageText.$setTextField(this._text)},i.prototype._addStageText=function(){this.stageTextAdded||(this._text.$inputEnabled||(this._text.$touchEnabled=!0),this.tempStage=this._text.stage,this.stageText.$addToStage(),this.stageText.addEventListener("updateText",this.updateTextHandler,this),this._text.addEventListener(t.TouchEvent.TOUCH_BEGIN,this.onMouseDownHandler,this),this.stageText.addEventListener("blur",this.blurHandler,this),this.stageText.addEventListener("focus",this.focusHandler,this),this.stageTextAdded=!0)},i.prototype._removeStageText=function(){this.stageTextAdded&&(this._text.$inputEnabled||(this._text.$touchEnabled=!1),this.stageText.$removeFromStage(),this.stageText.removeEventListener("updateText",this.updateTextHandler,this),this._text.removeEventListener(t.TouchEvent.TOUCH_BEGIN,this.onMouseDownHandler,this),this.tempStage.removeEventListener(t.TouchEvent.TOUCH_BEGIN,this.onStageDownHandler,this),this.stageText.removeEventListener("blur",this.blurHandler,this),this.stageText.removeEventListener("focus",this.focusHandler,this),this.stageTextAdded=!1)},i.prototype._getText=function(){return this.stageText.$getText()},i.prototype._setText=function(t){this.stageText.$setText(t)},i.prototype._setColor=function(t){this.stageText.$setColor(t)},i.prototype.focusHandler=function(e){this._isFocus||(this._isFocus=!0,e.showing||this._text.$setIsTyping(!0),this._text.dispatchEvent(new t.FocusEvent(t.FocusEvent.FOCUS_IN,!0)))},i.prototype.blurHandler=function(e){this._isFocus&&(this._isFocus=!1,this.tempStage.removeEventListener(t.TouchEvent.TOUCH_BEGIN,this.onStageDownHandler,this),this._text.$setIsTyping(!1),this.stageText.$onBlur(),this._text.dispatchEvent(new t.FocusEvent(t.FocusEvent.FOCUS_OUT,!0)))},i.prototype.onMouseDownHandler=function(t){this.$onFocus()},i.prototype.$onFocus=function(){var e=this;this._text.visible&&(this._isFocus||(this.tempStage.removeEventListener(t.TouchEvent.TOUCH_BEGIN,this.onStageDownHandler,this),t.callLater(function(){e.tempStage.addEventListener(t.TouchEvent.TOUCH_BEGIN,e.onStageDownHandler,e)},this),t.nativeRender&&this.stageText.$setText(this._text.$TextField[13]),this.stageText.$show()))},i.prototype.onStageDownHandler=function(t){t.$target!=this._text&&this.stageText.$hide()},i.prototype.updateTextHandler=function(e){var i,r,n=this._text.$TextField,a=this.stageText.$getText(),s=!1;null!=n[35]&&(i=new RegExp("["+n[35]+"]","g"),a=(r=a.match(i))?r.join(""):"",s=!0),null!=n[36]&&(i=new RegExp("[^"+n[36]+"]","g"),a=(r=a.match(i))?r.join(""):"",s=!0),s&&this.stageText.$getText()!=a&&this.stageText.$setText(a),this.resetText(),this._text.dispatchEvent(new t.Event(t.Event.CHANGE,!0))},i.prototype.resetText=function(){this._text.$setBaseText(this.stageText.$getText())},i.prototype._hideInput=function(){this.stageText.$removeFromStage()},i.prototype.updateInput=function(){!this._text.$visible&&this.stageText&&this._hideInput()},i.prototype._updateProperties=function(){if(this._isFocus)return this.stageText.$resetStageText(),void this.updateInput();this.stageText.$setText(this._text.$TextField[13]),this.stageText.$resetStageText(),this.updateInput()},i}(t.HashObject);t.InputController=e,i(e.prototype,"egret.InputController")}(f||(f={})),f||(f={}),function(t){var e=new RegExp("(?=[\\u00BF-\\u1FFF\\u2C00-\\uD7FF]|\\b|\\s)(?![。，！、》…）)}”】\\.\\,\\!\\?\\]\\:])");function n(e,i,r){var n=null==(r=r||{}).italic?i[16]:r.italic,s=null==r.bold?i[15]:r.bold,o=null==r.size?i[0]:r.size,h=r.fontFamily||i[8]||a.default_fontFamily;return t.sys.measureText(e,h,o,s,n)}var a=function(i){function a(){var e=i.call(this)||this;e.$inputEnabled=!1,e.inputUtils=null,e.$graphicsNode=null,e.isFlow=!1,e.textArr=[],e.linesArr=[],e.$isTyping=!1;var r=new t.sys.TextNode;return r.fontFamily=a.default_fontFamily,e.textNode=r,e.$renderNode=r,e.$TextField={0:a.default_size,1:0,2:a.default_textColor,3:NaN,4:NaN,5:0,6:0,7:0,8:a.default_fontFamily,9:"left",10:"top",11:"#ffffff",12:"",13:"",14:[],15:!1,16:!1,17:!0,18:!1,19:!1,20:!1,21:0,22:0,23:0,24:t.TextFieldType.DYNAMIC,25:0,26:"#000000",27:0,28:-1,29:0,30:!1,31:!1,32:0,33:!1,34:16777215,35:null,36:null,37:t.TextFieldInputType.TEXT,38:!1},e}return r(a,i),a.prototype.createNativeDisplayObject=function(){this.$nativeDisplayObject=new egret_native.NativeDisplayObject(7)},a.prototype.isInput=function(){return this.$TextField[24]==t.TextFieldType.INPUT},a.prototype.$setTouchEnabled=function(t){i.prototype.$setTouchEnabled.call(this,t),this.isInput()&&(this.$inputEnabled=!0)},Object.defineProperty(a.prototype,"fontFamily",{get:function(){return this.$TextField[8]},set:function(t){this.$setFontFamily(t)},enumerable:!0,configurable:!0}),a.prototype.$setFontFamily=function(e){var i=this.$TextField;return i[8]!=e&&(i[8]=e,this.invalidateFontString(),t.nativeRender&&this.$nativeDisplayObject.setFontFamily(e),!0)},Object.defineProperty(a.prototype,"size",{get:function(){return this.$TextField[0]},set:function(t){this.$setSize(t)},enumerable:!0,configurable:!0}),a.prototype.$setSize=function(e){var i=this.$TextField;return i[0]!=e&&(i[0]=e,this.invalidateFontString(),t.nativeRender&&this.$nativeDisplayObject.setFontSize(e),!0)},Object.defineProperty(a.prototype,"bold",{get:function(){return this.$TextField[15]},set:function(t){this.$setBold(t)},enumerable:!0,configurable:!0}),a.prototype.$setBold=function(e){var i=this.$TextField;return e!=i[15]&&(i[15]=e,this.invalidateFontString(),t.nativeRender&&this.$nativeDisplayObject.setBold(e),!0)},Object.defineProperty(a.prototype,"italic",{get:function(){return this.$TextField[16]},set:function(t){this.$setItalic(t)},enumerable:!0,configurable:!0}),a.prototype.$setItalic=function(e){var i=this.$TextField;return e!=i[16]&&(i[16]=e,this.invalidateFontString(),t.nativeRender&&this.$nativeDisplayObject.setItalic(e),!0)},a.prototype.invalidateFontString=function(){this.$TextField[17]=!0,this.$invalidateTextField()},Object.defineProperty(a.prototype,"textAlign",{get:function(){return this.$TextField[9]},set:function(t){this.$setTextAlign(t)},enumerable:!0,configurable:!0}),a.prototype.$setTextAlign=function(e){var i=this.$TextField;return i[9]!=e&&(i[9]=e,this.$invalidateTextField(),t.nativeRender&&this.$nativeDisplayObject.setTextAlign(e),!0)},Object.defineProperty(a.prototype,"verticalAlign",{get:function(){return this.$TextField[10]},set:function(t){this.$setVerticalAlign(t)},enumerable:!0,configurable:!0}),a.prototype.$setVerticalAlign=function(e){var i=this.$TextField;return i[10]!=e&&(i[10]=e,this.$invalidateTextField(),t.nativeRender&&this.$nativeDisplayObject.setVerticalAlign(e),!0)},Object.defineProperty(a.prototype,"lineSpacing",{get:function(){return this.$TextField[1]},set:function(t){this.$setLineSpacing(t)},enumerable:!0,configurable:!0}),a.prototype.$setLineSpacing=function(e){var i=this.$TextField;return i[1]!=e&&(i[1]=e,this.$invalidateTextField(),t.nativeRender&&this.$nativeDisplayObject.setLineSpacing(e),!0)},Object.defineProperty(a.prototype,"textColor",{get:function(){return this.$TextField[2]},set:function(t){this.$setTextColor(t)},enumerable:!0,configurable:!0}),a.prototype.$setTextColor=function(e){var i=this.$TextField;return i[2]!=e&&(i[2]=e,this.inputUtils&&this.inputUtils._setColor(this.$TextField[2]),this.$invalidateTextField(),t.nativeRender&&this.$nativeDisplayObject.setTextColor(e),!0)},Object.defineProperty(a.prototype,"wordWrap",{get:function(){return this.$TextField[19]},set:function(t){this.$setWordWrap(t)},enumerable:!0,configurable:!0}),a.prototype.$setWordWrap=function(e){var i=this.$TextField;e!=i[19]&&(i[20]||(i[19]=e,this.$invalidateTextField(),t.nativeRender&&this.$nativeDisplayObject.setWordWrap(e)))},Object.defineProperty(a.prototype,"type",{get:function(){return this.$TextField[24]},set:function(t){this.$setType(t)},enumerable:!0,configurable:!0}),a.prototype.$setType=function(e){var i=this.$TextField;return i[24]!=e&&(i[24]=e,t.nativeRender&&this.$nativeDisplayObject.setType(e),e==t.TextFieldType.INPUT?(isNaN(i[3])&&this.$setWidth(100),isNaN(i[4])&&this.$setHeight(30),this.$setTouchEnabled(!0),null==this.inputUtils&&(this.inputUtils=new t.InputController),this.inputUtils.init(this),this.$invalidateTextField(),this.$stage&&this.inputUtils._addStageText()):(this.inputUtils&&(this.inputUtils._removeStageText(),this.inputUtils=null),this.$setTouchEnabled(!1)),!0)},Object.defineProperty(a.prototype,"inputType",{get:function(){return this.$TextField[37]},set:function(e){this.$TextField[37]=e,t.nativeRender&&this.$nativeDisplayObject.setInputType(e)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"text",{get:function(){return this.$getText()},set:function(t){this.$setText(t)},enumerable:!0,configurable:!0}),a.prototype.$getText=function(){return this.$TextField[24]==t.TextFieldType.INPUT?this.inputUtils._getText():this.$TextField[13]},a.prototype.$setBaseText=function(e){e=null==e?"":e.toString(),this.isFlow=!1;var i=this.$TextField;if(i[13]!=e){this.$invalidateTextField(),i[13]=e;var r;return r=i[20]?this.changeToPassText(e):e,t.nativeRender&&this.$nativeDisplayObject.setText(r),this.setMiddleStyle([{text:r}]),!0}return!1},a.prototype.$setText=function(t){null==t&&(t="");var e=this.$setBaseText(t);return this.inputUtils&&this.inputUtils._setText(this.$TextField[13]),e},Object.defineProperty(a.prototype,"displayAsPassword",{get:function(){return this.$TextField[20]},set:function(t){this.$setDisplayAsPassword(t)},enumerable:!0,configurable:!0}),a.prototype.$setDisplayAsPassword=function(e){var i=this.$TextField;if(i[20]!=e){i[20]=e,this.$invalidateTextField();var r;return r=e?this.changeToPassText(i[13]):i[13],t.nativeRender&&this.$nativeDisplayObject.setText(r),this.setMiddleStyle([{text:r}]),!0}return!1},Object.defineProperty(a.prototype,"strokeColor",{get:function(){return this.$TextField[25]},set:function(t){this.$setStrokeColor(t)},enumerable:!0,configurable:!0}),a.prototype.$setStrokeColor=function(e){var i=this.$TextField;return i[25]!=e&&(this.$invalidateTextField(),i[25]=e,t.nativeRender&&this.$nativeDisplayObject.setStrokeColor(e),i[26]=t.toColorString(e),!0)},Object.defineProperty(a.prototype,"stroke",{get:function(){return this.$TextField[27]},set:function(t){this.$setStroke(t)},enumerable:!0,configurable:!0}),a.prototype.$setStroke=function(e){return this.$TextField[27]!=e&&(this.$invalidateTextField(),this.$TextField[27]=e,t.nativeRender&&this.$nativeDisplayObject.setStroke(e),!0)},Object.defineProperty(a.prototype,"maxChars",{get:function(){return this.$TextField[21]},set:function(t){this.$setMaxChars(t)},enumerable:!0,configurable:!0}),a.prototype.$setMaxChars=function(e){return this.$TextField[21]!=e&&(this.$TextField[21]=e,t.nativeRender&&this.$nativeDisplayObject.setMaxChars(e),!0)},Object.defineProperty(a.prototype,"scrollV",{get:function(){return Math.min(Math.max(this.$TextField[28],1),this.maxScrollV)},set:function(e){this.$TextField[28]=Math.max(e,1),t.nativeRender&&this.$nativeDisplayObject.setScrollV(e),this.$invalidateTextField()},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"maxScrollV",{get:function(){return this.$getLinesArr(),Math.max(this.$TextField[29]-t.TextFieldUtils.$getScrollNum(this)+1,1)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"selectionBeginIndex",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"selectionEndIndex",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"caretIndex",{get:function(){return 0},enumerable:!0,configurable:!0}),a.prototype.$setSelection=function(t,e){return!1},a.prototype.$getLineHeight=function(){return this.$TextField[1]+this.$TextField[0]},Object.defineProperty(a.prototype,"numLines",{get:function(){return this.$getLinesArr(),this.$TextField[29]},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"multiline",{get:function(){return this.$TextField[30]},set:function(t){this.$setMultiline(t)},enumerable:!0,configurable:!0}),a.prototype.$setMultiline=function(e){return this.$TextField[30]=e,this.$invalidateTextField(),t.nativeRender&&this.$nativeDisplayObject.setMultiline(e),!0},Object.defineProperty(a.prototype,"restrict",{get:function(){var t=this.$TextField,e=null;return null!=t[35]&&(e=t[35]),null!=t[36]&&(null==e&&(e=""),e+="^"+t[36]),e},set:function(t){var e=this.$TextField;if(null==t)e[35]=null,e[36]=null;else{for(var i=-1;i<t.length&&0!=(i=t.indexOf("^",i))&&i>0&&"\\"==t.charAt(i-1);)i++;0==i?(e[35]=null,e[36]=t.substring(i+1)):i>0?(e[35]=t.substring(0,i),e[36]=t.substring(i+1)):(e[35]=t,e[36]=null)}},enumerable:!0,configurable:!0}),a.prototype.$setWidth=function(e){t.nativeRender&&this.$nativeDisplayObject.setTextFieldWidth(e);var i=this.$TextField;if(isNaN(e)){if(isNaN(i[3]))return!1;i[3]=NaN}else{if(i[3]==e)return!1;i[3]=e}return!((e=+e)<0||(this.$invalidateTextField(),0))},a.prototype.$setHeight=function(e){t.nativeRender&&this.$nativeDisplayObject.setTextFieldHeight(e);var i=this.$TextField;if(isNaN(e)){if(isNaN(i[4]))return!1;i[4]=NaN}else{if(i[4]==e)return!1;i[4]=e}return!((e=+e)<0||(this.$invalidateTextField(),0))},a.prototype.$getWidth=function(){var t=this.$TextField;return isNaN(t[3])?this.$getContentBounds().width:t[3]},a.prototype.$getHeight=function(){var t=this.$TextField;return isNaN(t[4])?this.$getContentBounds().height:t[4]},Object.defineProperty(a.prototype,"border",{get:function(){return this.$TextField[31]},set:function(t){this.$setBorder(t)},enumerable:!0,configurable:!0}),a.prototype.$setBorder=function(e){e=!!e,this.$TextField[31]=e,t.nativeRender&&this.$nativeDisplayObject.setBorder(e)},Object.defineProperty(a.prototype,"borderColor",{get:function(){return this.$TextField[32]},set:function(t){this.$setBorderColor(t)},enumerable:!0,configurable:!0}),a.prototype.$setBorderColor=function(e){e=+e||0,this.$TextField[32]=e,t.nativeRender&&this.$nativeDisplayObject.setBorderColor(e)},Object.defineProperty(a.prototype,"background",{get:function(){return this.$TextField[33]},set:function(t){this.$setBackground(t)},enumerable:!0,configurable:!0}),a.prototype.$setBackground=function(e){this.$TextField[33]=e,t.nativeRender&&this.$nativeDisplayObject.setBackground(e)},Object.defineProperty(a.prototype,"backgroundColor",{get:function(){return this.$TextField[34]},set:function(t){this.$setBackgroundColor(t)},enumerable:!0,configurable:!0}),a.prototype.$setBackgroundColor=function(e){this.$TextField[34]=e,t.nativeRender&&this.$nativeDisplayObject.setBackgroundColor(e)},a.prototype.fillBackground=function(e){var i=this.$graphicsNode;i&&i.clear();var r=this.$TextField;if(r[33]||r[31]||e&&e.length>0){if(!i)if(i=this.$graphicsNode=new t.sys.GraphicsNode,t.nativeRender)this.$renderNode=this.textNode;else{var n=new t.sys.GroupNode;n.addNode(i),n.addNode(this.textNode),this.$renderNode=n}var a=void 0;if(r[33]&&i.beginFill(r[34]).drawRect(0,0,this.$getWidth(),this.$getHeight()),r[31]&&(a=i.lineStyle(1,r[32])).drawRect(0,0,this.$getWidth()-1,this.$getHeight()-1),e&&e.length>0)for(var s=r[2],o=-1,h=e.length,l=0;l<h;l+=4){var u=e[l],c=e[l+1],p=e[l+2],f=e[l+3]||s;(o<0||o!=f)&&(o=f,a=i.lineStyle(2,f,1,t.CapsStyle.NONE)),a.moveTo(u,c),a.lineTo(u+p,c)}}if(i){var d=this.$getRenderBounds();i.x=d.x,i.y=d.y,i.width=d.width,i.height=d.height,t.Rectangle.release(d)}},a.prototype.setFocus=function(){this.type==t.TextFieldType.INPUT&&this.$stage&&this.inputUtils.$onFocus()},a.prototype.$onRemoveFromStage=function(){i.prototype.$onRemoveFromStage.call(this),this.removeEvent(),this.$TextField[24]==t.TextFieldType.INPUT&&this.inputUtils._removeStageText(),this.textNode&&(this.textNode.clean(),t.nativeRender&&egret_native.NativeDisplayObject.disposeTextData(this))},a.prototype.$onAddToStage=function(e,r){i.prototype.$onAddToStage.call(this,e,r),this.addEvent(),this.$TextField[24]==t.TextFieldType.INPUT&&this.inputUtils._addStageText()},a.prototype.$invalidateTextField=function(){if(this.$renderDirty=!0,this.$TextField[18]=!0,this.$TextField[38]=!0,t.nativeRender);else{var e=this.$parent;e&&!e.$cacheDirty&&(e.$cacheDirty=!0,e.$cacheDirtyUp());var i=this.$maskedObject;i&&!i.$cacheDirty&&(i.$cacheDirty=!0,i.$cacheDirtyUp())}},a.prototype.$getRenderBounds=function(){var e=this.$getContentBounds(),i=t.Rectangle.create();i.copyFrom(e),this.$TextField[31]&&(i.width+=2,i.height+=2);var r=2*this.$TextField[27];return r>0&&(i.width+=2*r,i.height+=2*r),i.x-=r+2,i.y-=r+2,i.width=Math.ceil(i.width)+4,i.height=Math.ceil(i.height)+4,i},a.prototype.$measureContentBounds=function(e){this.$getLinesArr();var i=0,r=0;t.nativeRender?(i=egret_native.nrGetTextFieldWidth(this.$nativeDisplayObject.id),r=egret_native.nrGetTextFieldHeight(this.$nativeDisplayObject.id)):(i=isNaN(this.$TextField[3])?this.$TextField[5]:this.$TextField[3],r=isNaN(this.$TextField[4])?t.TextFieldUtils.$getTextHeight(this):this.$TextField[4]),e.setTo(0,0,i,r)},a.prototype.$updateRenderNode=function(){if(this.$TextField[24]==t.TextFieldType.INPUT){if(this.inputUtils._updateProperties(),this.$isTyping)return void this.fillBackground()}else if(0==this.$TextField[3]){var e=this.$graphicsNode;return void(e&&e.clear())}var i=this.drawText();this.fillBackground(i);var r=this.$getRenderBounds(),n=this.textNode;n.x=r.x,n.y=r.y,n.width=Math.ceil(r.width),n.height=Math.ceil(r.height),t.Rectangle.release(r)},Object.defineProperty(a.prototype,"textFlow",{get:function(){return this.textArr},set:function(e){this.isFlow=!0;var i="";null==e&&(e=[]);for(var r=0;r<e.length;r++)i+=e[r].text;this.$TextField[20]?this.$setBaseText(i):(this.$TextField[13]=i,this.setMiddleStyle(e),t.nativeRender&&this.$nativeDisplayObject.setTextFlow(e))},enumerable:!0,configurable:!0}),a.prototype.changeToPassText=function(t){if(this.$TextField[20]){for(var e="",i=0,r=t.length;i<r;i++)switch(t.charAt(i)){case"\n":e+="\n";break;case"\r":break;default:e+="*"}return e}return t},a.prototype.setMiddleStyle=function(t){this.$TextField[18]=!0,this.$TextField[38]=!0,this.textArr=t,this.$invalidateTextField()},Object.defineProperty(a.prototype,"textWidth",{get:function(){return this.$getLinesArr(),t.nativeRender?egret_native.nrGetTextWidth(this.$nativeDisplayObject.id):this.$TextField[5]},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"textHeight",{get:function(){return this.$getLinesArr(),t.nativeRender?egret_native.nrGetTextHeight(this.$nativeDisplayObject.id):t.TextFieldUtils.$getTextHeight(this)},enumerable:!0,configurable:!0}),a.prototype.appendText=function(t){this.appendElement({text:t})},a.prototype.appendElement=function(e){var i=this.$TextField[13]+e.text;if(t.nativeRender)return this.textArr.push(e),this.$TextField[13]=i,this.$TextField[18]=!0,this.$TextField[38]=!0,void this.$nativeDisplayObject.setTextFlow(this.textArr);this.$TextField[20]?this.$setBaseText(i):(this.$TextField[13]=i,this.textArr.push(e),this.setMiddleStyle(this.textArr))},a.prototype.$getLinesArr=function(){var e=this.$TextField;return t.nativeRender&&e[38]?(egret_native.updateNativeRender(),void(e[38]=!1)):this.$getLinesArr2()},a.prototype.$getLinesArr2=function(){var i=this.$TextField;if(!i[18])return this.linesArr;i[18]=!1;var r=this.textArr;this.linesArr.length=0,i[6]=0,i[5]=0;var a=i[3];if(!isNaN(a)&&0==a)return i[29]=0,[{width:0,height:0,charNum:0,elements:[],hasNextLine:!1}];for(var s,o=this.linesArr,h=0,l=0,u=0,c=0,p=0,f=r.length;p<f;p++){var d=r[p];if(d.text){d.style=d.style||{};for(var m=d.text.toString().split(/(?:\r\n|\r|\n)/),g=0,y=m.length;g<y;g++){null==o[c]&&(s={width:0,height:0,elements:[],charNum:0,hasNextLine:!1},o[c]=s,h=0,u=0,l=0),u=i[24]==t.TextFieldType.INPUT?i[0]:Math.max(u,d.style.size||i[0]);var _=!0;if(""==m[g])g==y-1&&(_=!1);else{var v=n(m[g],i,d.style);if(isNaN(a))h+=v,l+=m[g].length,s.elements.push({width:v,text:m[g],style:d.style}),g==y-1&&(_=!1);else if(h+v<=a)s.elements.push({width:v,text:m[g],style:d.style}),h+=v,l+=m[g].length,g==y-1&&(_=!1);else{for(var b=0,T=0,x=m[g],D=void 0,$=(D=i[19]?x.split(e):x.match(/./g)).length,E=0;b<$;b++){var w=!1;if(1==(R=D[b].length)&&b<$-1){var A=D[b].charCodeAt(0),S=D[b+1].charCodeAt(0);A>=55296&&A<=56319&&56320==(64512&S)?(R=2,w=!0,v=n(D[b]+D[b+1],i,d.style)):v=n(D[b],i,d.style)}else v=n(D[b],i,d.style);if(0!=h&&h+v>a&&h+b!=0)break;if(T+v>a)for(var O=D[b].match(/./g),C=0,P=O.length;C<P;C++){var R,M=!1;if(1==(R=O[C].length)&&C<P-1?(A=O[C].charCodeAt(0),S=O[C+1].charCodeAt(0),A>=55296&&A<=56319&&56320==(64512&S)?(R=2,M=!0,v=n(O[C]+O[C+1],i,d.style)):v=n(O[C],i,d.style)):v=n(O[C],i,d.style),C>0&&h+v>a)break;T+=v,h+=v,l+=E+=R,M&&C++}else T+=v,h+=v,l+=E+=R;w&&b++}if(b>0){s.elements.push({width:T,text:x.substring(0,E),style:d.style});var I=x.substring(E),B=void 0,F=I.length;for(B=0;B<F&&" "==I.charAt(B);B++);m[g]=I.substring(B)}""!=m[g]&&(g--,_=!1)}}_&&(l++,s.hasNextLine=!0),g<m.length-1&&(s.width=h,s.height=u,s.charNum=l,i[5]=Math.max(i[5],h),i[6]+=u,c++)}p==r.length-1&&s&&(s.width=h,s.height=u,s.charNum=l,i[5]=Math.max(i[5],h),i[6]+=u)}else s&&(s.width=h,s.height=u,s.charNum=l,i[5]=Math.max(i[5],h),i[6]+=u)}return i[29]=o.length,o},a.prototype.$setIsTyping=function(e){this.$isTyping=e,this.$invalidateTextField(),t.nativeRender&&this.$nativeDisplayObject.setIsTyping(e)},a.prototype.drawText=function(){var e=this.textNode,i=this.$TextField;e.bold=i[15],e.fontFamily=i[8]||a.default_fontFamily,e.italic=i[16],e.size=i[0],e.stroke=i[27],e.strokeColor=i[25],e.textColor=i[2];var r=this.$getLinesArr();if(0==i[5])return[];var n=isNaN(i[3])?i[5]:i[3],s=t.TextFieldUtils.$getTextHeight(this),o=0,h=t.TextFieldUtils.$getStartLine(this),l=i[4];!isNaN(l)&&l>s&&(o+=t.TextFieldUtils.$getValign(this)*(l-s)),o=Math.round(o);for(var u=t.TextFieldUtils.$getHalign(this),c=0,p=[],f=h,d=i[29];f<d;f++){var m=r[f],g=m.height;if(o+=g/2,f!=h){if(i[24]==t.TextFieldType.INPUT&&!i[30])break;if(!isNaN(l)&&o>l)break}c=Math.round((n-m.width)*u);for(var y=0,_=m.elements.length;y<_;y++){var v=m.elements[y],b=v.style.size||i[0];e.drawText(c,o+(g-b)/2,v.text,v.style),v.style.underline&&p.push(c,o+g/2,v.width,v.style.textColor),c+=v.width}o+=g/2+i[1]}return p},a.prototype.addEvent=function(){this.addEventListener(t.TouchEvent.TOUCH_TAP,this.onTapHandler,this)},a.prototype.removeEvent=function(){this.removeEventListener(t.TouchEvent.TOUCH_TAP,this.onTapHandler,this)},a.prototype.onTapHandler=function(e){if(this.$TextField[24]!=t.TextFieldType.INPUT){var i=t.TextFieldUtils.$getTextElement(this,e.localX,e.localY);if(null!=i){var r=i.style;if(r&&r.href)if(r.href.match(/^event:/)){var n=r.href.match(/^event:/)[0];t.TextEvent.dispatchTextEvent(this,t.TextEvent.LINK,r.href.substring(n.length))}else open(r.href,r.target||"_blank")}}},a.default_fontFamily="Arial",a.default_size=30,a.default_textColor=16777215,a}(t.DisplayObject);t.TextField=a,i(a.prototype,"egret.TextField")}(f||(f={})),function(t){var e=function(){function t(){}return t.TEXT="text",t.TEL="tel",t.PASSWORD="password",t}();t.TextFieldInputType=e,i(e.prototype,"egret.TextFieldInputType")}(f||(f={})),function(t){var e=function(){function t(){}return t.DYNAMIC="dynamic",t.INPUT="input",t}();t.TextFieldType=e,i(e.prototype,"egret.TextFieldType")}(f||(f={})),function(t){var e=function(){function e(){}return e.$getStartLine=function(t){var i=t.$TextField,r=e.$getTextHeight(t),n=0,a=i[4];return isNaN(a)||(r<a||r>a&&(n=Math.max(i[28]-1,0),n=Math.min(i[29]-1,n)),i[30]||(n=Math.max(i[28]-1,0),i[29]>0&&(n=Math.min(i[29]-1,n)))),n},e.$getHalign=function(e){var i=e.$getLinesArr2(),r=0;return e.$TextField[9]==t.HorizontalAlign.CENTER?r=.5:e.$TextField[9]==t.HorizontalAlign.RIGHT&&(r=1),e.$TextField[24]==t.TextFieldType.INPUT&&!e.$TextField[30]&&i.length>1&&(r=0),r},e.$getTextHeight=function(e){return t.TextFieldType.INPUT!=e.$TextField[24]||e.$TextField[30]?e.$TextField[6]+(e.$TextField[29]-1)*e.$TextField[1]:e.$TextField[0]},e.$getValign=function(i){var r=e.$getTextHeight(i),n=i.$TextField[4];if(!isNaN(n)&&r<n){var a=0;return i.$TextField[10]==t.VerticalAlign.MIDDLE?a=.5:i.$TextField[10]==t.VerticalAlign.BOTTOM&&(a=1),a}return 0},e.$getTextElement=function(t,i,r){var n=e.$getHit(t,i,r),a=t.$getLinesArr2();return n&&a[n.lineIndex]&&a[n.lineIndex].elements[n.textElementIndex]?a[n.lineIndex].elements[n.textElementIndex]:null},e.$getHit=function(t,i,r){var n=t.$getLinesArr2();if(0==t.$TextField[3])return null;var a=0,s=e.$getTextHeight(t),o=0,h=t.$TextField[4];!isNaN(h)&&h>s&&0!=(o=e.$getValign(t)*(h-s))&&(r-=o);for(var l=0,u=e.$getStartLine(t);u<n.length;u++){var c=n[u];if(l+c.height>=r){l<r&&(a=u+1);break}if((l+=c.height)+t.$TextField[1]>r)return null;l+=t.$TextField[1]}if(0==a)return null;var p=n[a-1],f=t.$TextField[3];isNaN(f)&&(f=t.textWidth),i-=e.$getHalign(t)*(f-p.width);var d=0;for(u=0;u<p.elements.length;u++){var m=p.elements[u];if(d+m.width<=i)d+=m.width;else if(d<i)return{lineIndex:a-1,textElementIndex:u}}return null},e.$getScrollNum=function(t){var e=1;if(t.$TextField[30]){var i=t.height,r=t.size,n=t.lineSpacing;i-(r+n)*(e=Math.floor(i/(r+n)))>r/2&&e++}return e},e}();t.TextFieldUtils=e,i(e.prototype,"egret.TextFieldUtils")}(f||(f={})),function(t){t.sys||(t.sys={})}(f||(f={})),function(t){var e=function(){function t(){}return t.TOP="top",t.BOTTOM="bottom",t.MIDDLE="middle",t.JUSTIFY="justify",t.CONTENT_JUSTIFY="contentJustify",t}();t.VerticalAlign=e,i(e.prototype,"egret.VerticalAlign")}(f||(f={})),function(t){var e=function(){function t(){}return t.encode=function(t){for(var e=new Uint8Array(t),i=e.length,r="",n=0;n<i;n+=3)r+=s[e[n]>>2],r+=s[(3&e[n])<<4|e[n+1]>>4],r+=s[(15&e[n+1])<<2|e[n+2]>>6],r+=s[63&e[n+2]];return i%3==2?r=r.substring(0,r.length-1)+"=":i%3==1&&(r=r.substring(0,r.length-2)+"=="),r},t.decode=function(t){var e=.75*t.length,i=t.length,r=0,n=0,a=0,s=0,h=0;"="===t[t.length-1]&&(e--,"="===t[t.length-2]&&e--);for(var l=new ArrayBuffer(e),u=new Uint8Array(l),c=0;c<i;c+=4)n=o[t.charCodeAt(c)],a=o[t.charCodeAt(c+1)],s=o[t.charCodeAt(c+2)],h=o[t.charCodeAt(c+3)],u[r++]=n<<2|a>>4,u[r++]=(15&a)<<4|s>>2,u[r++]=(3&s)<<6|63&h;return l},t}();t.Base64Util=e,i(e.prototype,"egret.Base64Util")}(f||(f={}));for(var s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=new Uint8Array(256),h=0;h<s.length;h++)o[s.charCodeAt(h)]=h;!function(t){var e=function(){function t(){}return t.LITTLE_ENDIAN="littleEndian",t.BIG_ENDIAN="bigEndian",t}();t.Endian=e,i(e.prototype,"egret.Endian");var r=function(){function i(t,i){void 0===i&&(i=0),this.bufferExtSize=0,this.EOF_byte=-1,this.EOF_code_point=-1,i<0&&(i=0),this.bufferExtSize=i;var r,n=0;if(t){var a=void 0;t instanceof Uint8Array?(a=t,n=t.length):(n=t.byteLength,a=new Uint8Array(t)),(r=0==i?new Uint8Array(n):new Uint8Array((1+(n/i|0))*i)).set(a)}else r=new Uint8Array(i);this.write_position=n,this._position=0,this._bytes=r,this.data=new DataView(r.buffer),this.endian=e.BIG_ENDIAN}return Object.defineProperty(i.prototype,"endian",{get:function(){return 0==this.$endian?e.LITTLE_ENDIAN:e.BIG_ENDIAN},set:function(t){this.$endian=t==e.LITTLE_ENDIAN?0:1},enumerable:!0,configurable:!0}),i.prototype.setArrayBuffer=function(t){},Object.defineProperty(i.prototype,"readAvailable",{get:function(){return this.write_position-this._position},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"buffer",{get:function(){return this.data.buffer.slice(0,this.write_position)},set:function(t){var e,i=t.byteLength,r=new Uint8Array(t),n=this.bufferExtSize;(e=0==n?new Uint8Array(i):new Uint8Array((1+(i/n|0))*n)).set(r),this.write_position=i,this._bytes=e,this.data=new DataView(e.buffer)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"rawBuffer",{get:function(){return this.data.buffer},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"bytes",{get:function(){return this._bytes},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"dataView",{get:function(){return this.data},set:function(t){this.buffer=t.buffer},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"bufferOffset",{get:function(){return this.data.byteOffset},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"position",{get:function(){return this._position},set:function(t){this._position=t,t>this.write_position&&(this.write_position=t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"length",{get:function(){return this.write_position},set:function(t){this.write_position=t,this.data.byteLength>t&&(this._position=t),this._validateBuffer(t)},enumerable:!0,configurable:!0}),i.prototype._validateBuffer=function(t){if(this.data.byteLength<t){var e=this.bufferExtSize,i=void 0;(i=0==e?new Uint8Array(t):new Uint8Array((1+(t/e>>0))*e)).set(this._bytes),this._bytes=i,this.data=new DataView(i.buffer)}},Object.defineProperty(i.prototype,"bytesAvailable",{get:function(){return this.data.byteLength-this._position},enumerable:!0,configurable:!0}),i.prototype.clear=function(){var t=new ArrayBuffer(this.bufferExtSize);this.data=new DataView(t),this._bytes=new Uint8Array(t),this._position=0,this.write_position=0},i.prototype.readBoolean=function(){if(this.validate(1))return!!this._bytes[this.position++]},i.prototype.readByte=function(){if(this.validate(1))return this.data.getInt8(this.position++)},i.prototype.readBytes=function(e,i,r){if(void 0===i&&(i=0),void 0===r&&(r=0),e){var n=this._position,a=this.write_position-n;if(a<0)t.$error(1025);else{if(0==r)r=a;else if(r>a)return void t.$error(1025);var s=e._position;e._position=0,e.validateBuffer(i+r),e._position=s,e._bytes.set(this._bytes.subarray(n,n+r),i),this.position+=r}}},i.prototype.readDouble=function(){if(this.validate(8)){var t=this.data.getFloat64(this._position,0==this.$endian);return this.position+=8,t}},i.prototype.readFloat=function(){if(this.validate(4)){var t=this.data.getFloat32(this._position,0==this.$endian);return this.position+=4,t}},i.prototype.readInt=function(){if(this.validate(4)){var t=this.data.getInt32(this._position,0==this.$endian);return this.position+=4,t}},i.prototype.readShort=function(){if(this.validate(2)){var t=this.data.getInt16(this._position,0==this.$endian);return this.position+=2,t}},i.prototype.readUnsignedByte=function(){if(this.validate(1))return this._bytes[this.position++]},i.prototype.readUnsignedInt=function(){if(this.validate(4)){var t=this.data.getUint32(this._position,0==this.$endian);return this.position+=4,t}},i.prototype.readUnsignedShort=function(){if(this.validate(2)){var t=this.data.getUint16(this._position,0==this.$endian);return this.position+=2,t}},i.prototype.readUTF=function(){var t=this.readUnsignedShort();return t>0?this.readUTFBytes(t):""},i.prototype.readUTFBytes=function(t){if(this.validate(t)){var e=this.data,i=new Uint8Array(e.buffer,e.byteOffset+this._position,t);return this.position+=t,this.decodeUTF8(i)}},i.prototype.writeBoolean=function(t){this.validateBuffer(1),this._bytes[this.position++]=+t},i.prototype.writeByte=function(t){this.validateBuffer(1),this._bytes[this.position++]=255&t},i.prototype.writeBytes=function(t,e,i){var r;void 0===e&&(e=0),void 0===i&&(i=0),e<0||i<0||(r=0==i?t.length-e:Math.min(t.length-e,i))>0&&(this.validateBuffer(r),this._bytes.set(t._bytes.subarray(e,e+r),this._position),this.position=this._position+r)},i.prototype.writeDouble=function(t){this.validateBuffer(8),this.data.setFloat64(this._position,t,0==this.$endian),this.position+=8},i.prototype.writeFloat=function(t){this.validateBuffer(4),this.data.setFloat32(this._position,t,0==this.$endian),this.position+=4},i.prototype.writeInt=function(t){this.validateBuffer(4),this.data.setInt32(this._position,t,0==this.$endian),this.position+=4},i.prototype.writeShort=function(t){this.validateBuffer(2),this.data.setInt16(this._position,t,0==this.$endian),this.position+=2},i.prototype.writeUnsignedInt=function(t){this.validateBuffer(4),this.data.setUint32(this._position,t,0==this.$endian),this.position+=4},i.prototype.writeUnsignedShort=function(t){this.validateBuffer(2),this.data.setUint16(this._position,t,0==this.$endian),this.position+=2},i.prototype.writeUTF=function(t){var e=this.encodeUTF8(t),i=e.length;this.validateBuffer(2+i),this.data.setUint16(this._position,i,0==this.$endian),this.position+=2,this._writeUint8Array(e,!1)},i.prototype.writeUTFBytes=function(t){this._writeUint8Array(this.encodeUTF8(t))},i.prototype.toString=function(){return"[ByteArray] length:"+this.length+", bytesAvailable:"+this.bytesAvailable},i.prototype._writeUint8Array=function(t,e){void 0===e&&(e=!0);var i=this._position,r=i+t.length;e&&this.validateBuffer(r),this.bytes.set(t,i),this.position=r},i.prototype.validate=function(e){var i=this._bytes.length;if(i>0&&this._position+e<=i)return!0;t.$error(1025)},i.prototype.validateBuffer=function(t){this.write_position=t>this.write_position?t:this.write_position,t+=this._position,this._validateBuffer(t)},i.prototype.encodeUTF8=function(t){for(var e=0,i=this.stringToCodePoints(t),r=[];i.length>e;){var n=i[e++];if(this.inRange(n,55296,57343))this.encoderError(n);else if(this.inRange(n,0,127))r.push(n);else{var a=void 0,s=void 0;for(this.inRange(n,128,2047)?(a=1,s=192):this.inRange(n,2048,65535)?(a=2,s=224):this.inRange(n,65536,1114111)&&(a=3,s=240),r.push(this.div(n,Math.pow(64,a))+s);a>0;){var o=this.div(n,Math.pow(64,a-1));r.push(128+o%64),a-=1}}}return new Uint8Array(r)},i.prototype.decodeUTF8=function(t){for(var e,i=0,r="",n=0,a=0,s=0,o=0;t.length>i;){var h=t[i++];if(h==this.EOF_byte)e=0!=a?this.decoderError(!1):this.EOF_code_point;else if(0==a)this.inRange(h,0,127)?e=h:(this.inRange(h,194,223)?(a=1,o=128,n=h-192):this.inRange(h,224,239)?(a=2,o=2048,n=h-224):this.inRange(h,240,244)?(a=3,o=65536,n=h-240):this.decoderError(!1),n*=Math.pow(64,a),e=null);else if(this.inRange(h,128,191))if(s+=1,n+=(h-128)*Math.pow(64,a-s),s!==a)e=null;else{var l=n,u=o;n=0,a=0,s=0,o=0,e=this.inRange(l,u,1114111)&&!this.inRange(l,55296,57343)?l:this.decoderError(!1,h)}else n=0,a=0,s=0,o=0,i--,e=this.decoderError(!1,h);null!==e&&e!==this.EOF_code_point&&(e<=65535?e>0&&(r+=String.fromCharCode(e)):(e-=65536,r+=String.fromCharCode(55296+(e>>10&1023)),r+=String.fromCharCode(56320+(1023&e))))}return r},i.prototype.encoderError=function(e){t.$error(1026,e)},i.prototype.decoderError=function(e,i){return e&&t.$error(1027),i||65533},i.prototype.inRange=function(t,e,i){return e<=t&&t<=i},i.prototype.div=function(t,e){return Math.floor(t/e)},i.prototype.stringToCodePoints=function(t){for(var e=[],i=0,r=t.length;i<t.length;){var n=t.charCodeAt(i);if(this.inRange(n,55296,57343))if(this.inRange(n,56320,57343))e.push(65533);else if(i==r-1)e.push(65533);else{var a=t.charCodeAt(i+1);if(this.inRange(a,56320,57343)){var s=1023&n,o=1023&a;i+=1,e.push(65536+(s<<10)+o)}else e.push(65533)}else e.push(n);i+=1}return e},i}();t.ByteArray=r,i(r.prototype,"egret.ByteArray")}(f||(f={})),(f||(f={})).BitmapFillMode={REPEAT:"repeat",SCALE:"scale",CLIP:"clip"},function(t){t.registerClass=function(e,i,r){e||t.$error(1003,"classDefinition"),e.prototype||t.$error(1012,"classDefinition"),void 0===i&&t.$error(1003,"className");var n=e.prototype;n.__class__=i;var a=[i];r&&(a=a.concat(r));var s=n.__types__;if(n.__types__)for(var o=s.length,h=0;h<o;h++){var l=s[h];-1==a.indexOf(l)&&a.push(l)}n.__types__=a}}(f||(f={})),function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.$stageWidth=0,i.$stageHeight=0,i.$scaleMode=t.StageScaleMode.SHOW_ALL,i.$orientation=t.OrientationMode.AUTO,i.$maxTouches=99,i.$stage=i,i.$nestLevel=1,i}return r(i,e),i.prototype.createNativeDisplayObject=function(){this.$nativeDisplayObject=new egret_native.NativeDisplayObject(13)},Object.defineProperty(i.prototype,"frameRate",{get:function(){return t.ticker.$frameRate},set:function(e){t.ticker.$setFrameRate(e)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"stageWidth",{get:function(){return this.$stageWidth},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"stageHeight",{get:function(){return this.$stageHeight},enumerable:!0,configurable:!0}),i.prototype.invalidate=function(){t.sys.$invalidateRenderFlag=!0},i.prototype.registerImplementation=function(e,i){t.registerImplementation(e,i)},i.prototype.getImplementation=function(e){return t.getImplementation(e)},Object.defineProperty(i.prototype,"scaleMode",{get:function(){return this.$scaleMode},set:function(t){this.$scaleMode!=t&&(this.$scaleMode=t,this.$screen.updateScreenSize())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"orientation",{get:function(){return this.$orientation},set:function(t){this.$orientation!=t&&(this.$orientation=t,this.$screen.updateScreenSize())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"textureScaleFactor",{get:function(){return t.$TextureScaleFactor},set:function(e){t.$TextureScaleFactor=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"maxTouches",{get:function(){return this.$maxTouches},set:function(t){this.$maxTouches!=t&&(this.$maxTouches=t,this.$screen.updateMaxTouches())},enumerable:!0,configurable:!0}),i.prototype.setContentSize=function(t,e){this.$screen.setContentSize(t,e)},i}(t.DisplayObjectContainer);t.Stage=e,i(e.prototype,"egret.Stage"),t.$markCannotUse(e,"alpha",1),t.$markCannotUse(e,"visible",!0),t.$markCannotUse(e,"x",0),t.$markCannotUse(e,"y",0),t.$markCannotUse(e,"scaleX",1),t.$markCannotUse(e,"scaleY",1),t.$markCannotUse(e,"rotation",0),t.$markCannotUse(e,"cacheAsBitmap",!1),t.$markCannotUse(e,"scrollRect",null),t.$markCannotUse(e,"filters",null),t.$markCannotUse(e,"blendMode",null),t.$markCannotUse(e,"touchEnabled",!0),t.$markCannotUse(e,"matrix",null)}(f||(f={})),function(t){var e=function(){function t(){}return Object.defineProperty(t,"logLevel",{set:function(t){},enumerable:!0,configurable:!0}),t.ALL="all",t.DEBUG="debug",t.INFO="info",t.WARN="warn",t.ERROR="error",t.OFF="off",t}();t.Logger=e,i(e.prototype,"egret.Logger")}(f||(f={})),function(t){var e=function(){function t(){}return t.isNumber=function(t){return"number"==typeof t&&!isNaN(t)},t.sin=function(e){var i=Math.floor(e),r=i+1,n=t.sinInt(i);return i==e?n:(e-i)*t.sinInt(r)+(r-e)*n},t.sinInt=function(t){return(t%=360)<0&&(t+=360),l[t]},t.cos=function(e){var i=Math.floor(e),r=i+1,n=t.cosInt(i);return i==e?n:(e-i)*t.cosInt(r)+(r-e)*n},t.cosInt=function(t){return(t%=360)<0&&(t+=360),u[t]},t}();t.NumberUtils=e,i(e.prototype,"egret.NumberUtils")}(f||(f={}));for(var l={},u={},c=Math.PI/180,p=0;p<360;p++)l[p]=Math.sin(p*c),u[p]=Math.cos(p*c);l[90]=1,u[90]=0,l[180]=0,u[180]=-1,l[270]=-1,u[270]=0,Function.prototype.bind||(Function.prototype.bind=function(t){"function"!=typeof this&&f.$error(1029);var e=Array.prototype.slice.call(arguments,1),i=this,r=function(){},n=function(){return i.apply(this instanceof r&&t?this:t,e.concat(Array.prototype.slice.call(arguments)))};return r.prototype=this.prototype,n.prototype=new r,n}),function(t){var e=function(e){function i(t,i){void 0===i&&(i=0);var r=e.call(this)||this;return r._delay=0,r._currentCount=0,r._running=!1,r.updateInterval=1e3,r.lastCount=1e3,r.lastTimeStamp=0,r.delay=t,r.repeatCount=0|+i,r}return r(i,e),Object.defineProperty(i.prototype,"delay",{get:function(){return this._delay},set:function(t){t<1&&(t=1),this._delay!=t&&(this._delay=t,this.lastCount=this.updateInterval=Math.round(60*t))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"currentCount",{get:function(){return this._currentCount},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"running",{get:function(){return this._running},enumerable:!0,configurable:!0}),i.prototype.reset=function(){this.stop(),this._currentCount=0},i.prototype.start=function(){this._running||(this.lastCount=this.updateInterval,this.lastTimeStamp=t.getTimer(),t.ticker.$startTick(this.$update,this),this._running=!0)},i.prototype.stop=function(){this._running&&(t.stopTick(this.$update,this),this._running=!1)},i.prototype.$update=function(e){if(e-this.lastTimeStamp>=this._delay)this.lastCount=this.updateInterval;else{if(this.lastCount-=1e3,this.lastCount>0)return!1;this.lastCount+=this.updateInterval}this.lastTimeStamp=e,this._currentCount++;var i=this.repeatCount>0&&this._currentCount>=this.repeatCount;return t.TimerEvent.dispatchTimerEvent(this,t.TimerEvent.TIMER),i&&(this.stop(),t.TimerEvent.dispatchTimerEvent(this,t.TimerEvent.TIMER_COMPLETE)),!1},i}(t.EventDispatcher);t.Timer=e,i(e.prototype,"egret.Timer")}(f||(f={})),f||(f={}),function(t){t.$callLaterFunctionList=[],t.$callLaterThisList=[],t.$callLaterArgsList=[],t.callLater=function(e,i){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];t.$callLaterFunctionList.push(e),t.$callLaterThisList.push(i),t.$callLaterArgsList.push(r)},t.$callAsyncFunctionList=[],t.$callAsyncThisList=[],t.$callAsyncArgsList=[],t.$callAsync=function(e,i){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];t.$callAsyncFunctionList.push(e),t.$callAsyncThisList.push(i),t.$callAsyncArgsList.push(r)}}(f||(f={})),function(t){t.superSetter=function(t,e,i){for(var r=[],n=3;n<arguments.length;n++)r[n-3]=arguments[n];var a,s=t.prototype;t.hasOwnProperty("__sets__")||Object.defineProperty(t,"__sets__",{value:{}});var o=(a=t.__sets__)[i];if(o)return o.apply(e,r);var h=Object.getPrototypeOf(s);if(null!=h){for(;!h.hasOwnProperty(i);)if(null==(h=Object.getPrototypeOf(h)))return;o=Object.getOwnPropertyDescriptor(h,i).set,a[i]=o,o.apply(e,r)}},t.superGetter=function(t,e,i){var r,n=t.prototype;t.hasOwnProperty("__gets__")||Object.defineProperty(t,"__gets__",{value:{}});var a=(r=t.__gets__)[i];if(a)return a.call(e);var s=Object.getPrototypeOf(n);if(null!=s){for(;!s.hasOwnProperty(i);)if(null==(s=Object.getPrototypeOf(s)))return;return a=Object.getOwnPropertyDescriptor(s,i).get,r[i]=a,a.call(e)}}}(f||(f={})),function(t){var e={};t.getDefinitionByName=function(t){if(!t)return null;var i=e[t];if(i)return i;var r=t.split("."),a=r.length;i=n;for(var s=0;s<a;s++)if(!(i=i[r[s]]))return null;return e[t]=i,i},t.cleanCache=function(){e={}}}(f||(f={})),f||(f={}),(f||(f={})).getQualifiedClassName=function(t){var e=typeof t;if(!t||"object"!=e&&!t.prototype)return e;var i=t.prototype?t.prototype:Object.getPrototypeOf(t);if(i.hasOwnProperty("__class__"))return i.__class__;var r=i.constructor.toString().trim(),n=r.indexOf("("),a=r.substring(9,n);return Object.defineProperty(i,"__class__",{value:a,enumerable:!1,writable:!0}),a},function(t){t.getQualifiedSuperclassName=function(e){if(!e||"object"!=typeof e&&!e.prototype)return null;var i=e.prototype?e.prototype:Object.getPrototypeOf(e),r=Object.getPrototypeOf(i);return r&&t.getQualifiedClassName(r.constructor)||null}}(f||(f={})),function(t){t.getTimer=function(){return Date.now()-t.sys.$START_TIME}}(f||(f={})),function(t){t.hasDefinition=function(e){return!!t.getDefinitionByName(e)}}(f||(f={})),(f||(f={})).is=function(t,e){if(!t||"object"!=typeof t)return!1;var i=Object.getPrototypeOf(t),r=i?i.__types__:null;return!!r&&-1!==r.indexOf(e)},function(t){t.startTick=function(e,i){e||t.$error(1003,"callBack"),t.ticker.$startTick(e,i)}}(f||(f={})),function(t){t.stopTick=function(e,i){e||t.$error(1003,"callBack"),t.ticker.$stopTick(e,i)}}(f||(f={})),(f||(f={})).toColorString=function(t){t<0&&(t=0),t>16777215&&(t=16777215);for(var e=t.toString(16).toUpperCase();e.length>6;)e=e.slice(1,e.length);for(;e.length<6;)e="0"+e;return"#"+e},function(t){t.sys||(t.sys={})}(f||(f={})),function(t){!function(e){function i(t){if(window.location){var e=location.search;if(""==e)return"";for(var i=(e=e.slice(1)).split("&"),r=i.length,n=0;n<r;n++){var a=i[n].split("=");if(a[0]==t)return a[1]}}return""}(t.web||(t.web={})).getOption=i,t.getOption=i}()}(f||(f={})),function(t){!function(e){var r=function(){function t(){}return t.call=function(t,e){},t.addCallback=function(t,e){},t}();e.WebExternalInterface=r,i(r.prototype,"egret.web.WebExternalInterface",["egret.ExternalInterface"]),navigator.userAgent.toLowerCase().indexOf("egretnative")<0&&(t.ExternalInterface=r)}(t.web||(t.web={}))}(f||(f={})),function(t){!function(e){var r={},n=function(){function t(){}return t.call=function(t,e){var i={};i.functionName=t,i.value=e,egret_native.sendInfoToPlugin(JSON.stringify(i))},t.addCallback=function(t,e){r[t]=e},t}();e.NativeExternalInterface=n,i(n.prototype,"egret.web.NativeExternalInterface",["egret.ExternalInterface"]),navigator.userAgent.toLowerCase().indexOf("egretnative")>=0&&(t.ExternalInterface=n,egret_native.receivedPluginInfo=function(e){var i=JSON.parse(e),n=i.functionName,a=r[n];if(a){var s=i.value;a.call(null,s)}else t.$warn(1050,n)})}(t.web||(t.web={}))}(f||(f={})),function(t){!function(e){var r={},n=function(){function e(){}return e.call=function(t,e){a.ExternalInterface.call(t,e)},e.addCallback=function(t,e){r[t]=e},e.invokeCallback=function(e,i){var n=r[e];n?n.call(null,i):t.$warn(1050,e)},e}();e.WebViewExternalInterface=n,i(n.prototype,"egret.web.WebViewExternalInterface",["egret.ExternalInterface"]),navigator.userAgent.toLowerCase().indexOf("egretwebview")>=0&&(t.ExternalInterface=n)}(t.web||(t.web={}))}(f||(f={})),function(t){!function(e){var n=function(i){function n(){var t=i.call(this)||this;return t.loaded=!1,t}return r(n,i),Object.defineProperty(n.prototype,"length",{get:function(){if(this.originAudio)return this.originAudio.duration;throw new Error("sound not loaded!")},enumerable:!0,configurable:!0}),n.prototype.load=function(e){var i=this;this.url=e,e||t.$error(3002);var r=new Audio(e);r.addEventListener("canplaythrough",s),r.addEventListener("error",o);var a=navigator.userAgent.toLowerCase();function s(){n.$recycle(this.url,r),h(),a.indexOf("firefox")>=0&&(r.pause(),r.muted=!1),i.loaded=!0,i.dispatchEventWith(t.Event.COMPLETE)}function o(){h(),i.dispatchEventWith(t.IOErrorEvent.IO_ERROR)}function h(){r.removeEventListener("canplaythrough",s),r.removeEventListener("error",o)}a.indexOf("firefox")>=0&&(r.autoplay=!0,r.muted=!0),r.load(),this.originAudio=r,n.clearAudios[this.url]&&delete n.clearAudios[this.url]},n.prototype.play=function(i,r){i=+i||0,r=+r||0,0==this.loaded&&t.$error(1049);var a=n.$pop(this.url);null==a&&(a=this.originAudio.cloneNode()),a.autoplay=!0;var s=new e.HtmlSoundChannel(a);return s.$url=this.url,s.$loops=r,s.$startTime=i,s.$play(),t.sys.$pushSoundChannel(s),s},n.prototype.close=function(){0==this.loaded&&this.originAudio&&(this.originAudio.src=""),this.originAudio&&(this.originAudio=null),n.$clear(this.url)},n.$clear=function(t){n.clearAudios[t]=!0;var e=n.audios[t];e&&(e.length=0)},n.$pop=function(t){var e=n.audios[t];return e&&e.length>0?e.pop():null},n.$recycle=function(t,e){if(!n.clearAudios[t]){var i=n.audios[t];null==n.audios[t]&&(i=n.audios[t]=[]),i.push(e)}},n.MUSIC="music",n.EFFECT="effect",n.audios={},n.clearAudios={},n}(t.EventDispatcher);e.HtmlSound=n,i(n.prototype,"egret.web.HtmlSound",["egret.Sound"])}(t.web||(t.web={}))}(f||(f={})),function(t){!function(e){var n=function(i){function n(e){var r=i.call(this)||this;return r.$startTime=0,r.audio=null,r.isStopped=!1,r.canPlay=function(){r.audio.removeEventListener("canplay",r.canPlay);try{r.audio.currentTime=r.$startTime}catch(t){}finally{r.audio.play()}},r.onPlayEnd=function(){if(1==r.$loops)return r.stop(),void r.dispatchEventWith(t.Event.SOUND_COMPLETE);r.$loops>0&&r.$loops--,r.$play()},r._volume=1,e.addEventListener("ended",r.onPlayEnd),r.audio=e,r}return r(n,i),n.prototype.$play=function(){if(this.isStopped)t.$error(1036);else{try{this.audio.volume=this._volume,this.audio.currentTime=this.$startTime}catch(t){return void this.audio.addEventListener("canplay",this.canPlay)}this.audio.play()}},n.prototype.stop=function(){if(this.audio){this.isStopped||t.sys.$popSoundChannel(this),this.isStopped=!0;var i=this.audio;i.removeEventListener("ended",this.onPlayEnd),i.removeEventListener("canplay",this.canPlay),i.volume=0,this._volume=0,this.audio=null;var r=this.$url;window.setTimeout(function(){i.pause(),e.HtmlSound.$recycle(r,i)},200)}},Object.defineProperty(n.prototype,"volume",{get:function(){return this._volume},set:function(e){this.isStopped?t.$error(1036):(this._volume=e,this.audio&&(this.audio.volume=e))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"position",{get:function(){return this.audio?this.audio.currentTime:0},enumerable:!0,configurable:!0}),n}(t.EventDispatcher);e.HtmlSoundChannel=n,i(n.prototype,"egret.web.HtmlSoundChannel",["egret.SoundChannel","egret.IEventDispatcher"])}(t.web||(t.web={}))}(f||(f={})),function(t){!function(e){var n=function(){function t(){}return t.decodeAudios=function(){if(!(t.decodeArr.length<=0||t.isDecoding)){t.isDecoding=!0;var e=t.decodeArr.shift();t.ctx.decodeAudioData(e.buffer,function(i){e.self.audioBuffer=i,e.success&&e.success(),t.isDecoding=!1,t.decodeAudios()},function(){alert("sound decode error: "+e.url+"！\nsee http://edn.egret.com/cn/docs/page/156"),e.fail&&e.fail(),t.isDecoding=!1,t.decodeAudios()})}},t.decodeArr=[],t.isDecoding=!1,t}();e.WebAudioDecode=n,i(n.prototype,"egret.web.WebAudioDecode");var a=function(i){function a(){var t=i.call(this)||this;return t.loaded=!1,t}return r(a,i),Object.defineProperty(a.prototype,"length",{get:function(){if(this.audioBuffer)return this.audioBuffer.duration;throw new Error("sound not loaded!")},enumerable:!0,configurable:!0}),a.prototype.load=function(e){var i=this;this.url=e,e||t.$error(3002);var r=new XMLHttpRequest;function a(){i.loaded=!0,i.dispatchEventWith(t.Event.COMPLETE)}function s(){i.dispatchEventWith(t.IOErrorEvent.IO_ERROR)}r.open("GET",e,!0),r.responseType="arraybuffer",r.onreadystatechange=function(){4==r.readyState&&(r.status>=400||0==r.status?i.dispatchEventWith(t.IOErrorEvent.IO_ERROR):(n.decodeArr.push({buffer:r.response,success:a,fail:s,self:i,url:i.url}),n.decodeAudios()))},r.send()},a.prototype.play=function(i,r){i=+i||0,r=+r||0,0==this.loaded&&t.$error(1049);var n=new e.WebAudioSoundChannel;return n.$url=this.url,n.$loops=r,n.$audioBuffer=this.audioBuffer,n.$startTime=i,n.$play(),t.sys.$pushSoundChannel(n),n},a.prototype.close=function(){},a.MUSIC="music",a.EFFECT="effect",a}(t.EventDispatcher);e.WebAudioSound=a,i(a.prototype,"egret.web.WebAudioSound",["egret.Sound"])}(t.web||(t.web={}))}(f||(f={})),function(t){!function(e){var n=function(i){function n(){var r=i.call(this)||this;return r.$startTime=0,r.bufferSource=null,r.context=e.WebAudioDecode.ctx,r.isStopped=!1,r._currentTime=0,r._volume=1,r.onPlayEnd=function(){if(1==r.$loops)return r.stop(),void r.dispatchEventWith(t.Event.SOUND_COMPLETE);r.$loops>0&&r.$loops--,r.$play()},r._startTime=0,r.context.createGain?r.gain=r.context.createGain():r.gain=r.context.createGainNode(),r}return r(n,i),n.prototype.$play=function(){if(this.isStopped)t.$error(1036);else{this.bufferSource&&(this.bufferSource.onended=null,this.bufferSource=null);var e=this.context,i=this.gain,r=e.createBufferSource();this.bufferSource=r,r.buffer=this.$audioBuffer,r.connect(i),i.connect(e.destination),r.onended=this.onPlayEnd,this._startTime=Date.now(),this.gain.gain.value=this._volume,r.start(0,this.$startTime),this._currentTime=0}},n.prototype.stop=function(){if(this.bufferSource){var e=this.bufferSource;e.stop?e.stop(0):e.noteOff(0),e.onended=null,e.disconnect(),this.bufferSource=null,this.$audioBuffer=null}this.isStopped||t.sys.$popSoundChannel(this),this.isStopped=!0},Object.defineProperty(n.prototype,"volume",{get:function(){return this._volume},set:function(e){this.isStopped?t.$error(1036):(this._volume=e,this.gain.gain.value=e)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"position",{get:function(){return this.bufferSource?(Date.now()-this._startTime)/1e3+this.$startTime:0},enumerable:!0,configurable:!0}),n}(t.EventDispatcher);e.WebAudioSoundChannel=n,i(n.prototype,"egret.web.WebAudioSoundChannel",["egret.SoundChannel","egret.IEventDispatcher"])}(t.web||(t.web={}))}(f||(f={})),function(t){!function(e){var n=function(e){function i(i,r){void 0===r&&(r=!0);var n=e.call(this)||this;return n.loaded=!1,n.closed=!1,n.heightSet=NaN,n.widthSet=NaN,n.waiting=!1,n.userPause=!1,n.userPlay=!1,n.isPlayed=!1,n.screenChanged=function(e){var i=document.fullscreenEnabled||document.webkitIsFullScreen;i||(n.checkFullScreen(!1),t.Capabilities.isMobile||(n._fullscreen=i))},n._fullscreen=!0,n.onVideoLoaded=function(){n.video.removeEventListener("canplay",n.onVideoLoaded);var e=n.video;n.loaded=!0,n.posterData&&(n.posterData.width=n.getPlayWidth(),n.posterData.height=n.getPlayHeight()),e.width=e.videoWidth,e.height=e.videoHeight,window.setTimeout(function(){n.dispatchEventWith(t.Event.COMPLETE)},200)},n.$renderNode=new t.sys.BitmapNode,n.src=i,n.once(t.Event.ADDED_TO_STAGE,n.loadPoster,n),i&&n.load(),n}return r(i,e),i.prototype.createNativeDisplayObject=function(){this.$nativeDisplayObject=new egret_native.NativeDisplayObject(1)},i.prototype.load=function(e,i){var r=this;if(void 0===i&&(i=!0),e=e||this.src,this.src=e,e||t.$error(3002),!this.video||this.video.src!=e){var n;!this.video||t.Capabilities.isMobile?(n=document.createElement("video"),this.video=n,n.controls=null):n=this.video,n.src=e,n.setAttribute("autoplay","autoplay"),n.setAttribute("webkit-playsinline","true"),n.addEventListener("canplay",this.onVideoLoaded),n.addEventListener("error",function(){return r.onVideoError()}),n.addEventListener("ended",function(){return r.onVideoEnded()});var a=!1;n.addEventListener("canplay",function(){r.waiting=!1,a?r.userPause?r.pause():r.userPlay&&r.play():(a=!0,n.pause())}),n.addEventListener("waiting",function(){r.waiting=!0}),n.load(),this.videoPlay(),n.style.position="absolute",n.style.top="0px",n.style.zIndex="-88888",n.style.left="0px",n.height=1,n.width=1}},i.prototype.play=function(e,i){var r=this;if(void 0===i&&(i=!1),0==this.loaded)return this.load(this.src),void this.once(t.Event.COMPLETE,function(t){return r.play(e,i)},this);this.isPlayed=!0;var n=this.video;void 0!=e&&(n.currentTime=+e||0),n.loop=!!i,t.Capabilities.isMobile?n.style.zIndex="-88888":n.style.zIndex="9999",n.style.position="absolute",n.style.top="0px",n.style.left="0px",n.height=n.videoHeight,n.width=n.videoWidth,"Windows PC"!=t.Capabilities.os&&"Mac OS"!=t.Capabilities.os&&window.setTimeout(function(){n.width=0},1e3),this.checkFullScreen(this._fullscreen)},i.prototype.videoPlay=function(){this.userPause=!1,this.waiting?this.userPlay=!0:(this.userPlay=!1,this.video.play())},i.prototype.checkFullScreen=function(e){var i=this.video;if(e)null==i.parentElement&&(i.removeAttribute("webkit-playsinline"),document.body.appendChild(i)),t.stopTick(this.markDirty,this),this.goFullscreen();else if(null!=i.parentElement&&i.parentElement.removeChild(i),i.setAttribute("webkit-playsinline","true"),this.setFullScreenMonitor(!1),t.startTick(this.markDirty,this),t.Capabilities.isMobile)return this.video.currentTime=0,void this.onVideoEnded();this.videoPlay()},i.prototype.goFullscreen=function(){var e,i=this.video;return!i[e=t.web.getPrefixStyleName("requestFullscreen",i)]&&!i[e=t.web.getPrefixStyleName("requestFullScreen",i)]||(i.removeAttribute("webkit-playsinline"),i[e](),this.setFullScreenMonitor(!0),!0)},i.prototype.setFullScreenMonitor=function(t){var e=this.video;t?(e.addEventListener("mozfullscreenchange",this.screenChanged),e.addEventListener("webkitfullscreenchange",this.screenChanged),e.addEventListener("mozfullscreenerror",this.screenError),e.addEventListener("webkitfullscreenerror",this.screenError)):(e.removeEventListener("mozfullscreenchange",this.screenChanged),e.removeEventListener("webkitfullscreenchange",this.screenChanged),e.removeEventListener("mozfullscreenerror",this.screenError),e.removeEventListener("webkitfullscreenerror",this.screenError))},i.prototype.screenError=function(){t.$error(3014)},i.prototype.exitFullscreen=function(){document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.oCancelFullScreen?document.oCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()},i.prototype.onVideoEnded=function(){this.pause(),this.isPlayed=!1,this.dispatchEventWith(t.Event.ENDED)},i.prototype.onVideoError=function(){this.dispatchEventWith(t.IOErrorEvent.IO_ERROR)},i.prototype.close=function(){var t=this;this.closed=!0,this.video.removeEventListener("canplay",this.onVideoLoaded),this.video.removeEventListener("error",function(){return t.onVideoError()}),this.video.removeEventListener("ended",function(){return t.onVideoEnded()}),this.pause(),0==this.loaded&&this.video&&(this.video.src=""),this.video&&this.video.parentElement&&(this.video.parentElement.removeChild(this.video),this.video=null),this.loaded=!1},i.prototype.pause=function(){this.userPlay=!1,this.waiting?this.userPause=!0:(this.userPause=!1,this.video.pause(),t.stopTick(this.markDirty,this))},Object.defineProperty(i.prototype,"volume",{get:function(){return this.video?this.video.volume:1},set:function(t){this.video&&(this.video.volume=t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"position",{get:function(){return this.video?this.video.currentTime:0},set:function(t){this.video&&(this.video.currentTime=t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"fullscreen",{get:function(){return this._fullscreen},set:function(e){t.Capabilities.isMobile||(this._fullscreen=!!e,this.video&&0==this.video.paused&&this.checkFullScreen(this._fullscreen))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"bitmapData",{get:function(){return this.video&&this.loaded?(this._bitmapData||(this.video.width=this.video.videoWidth,this.video.height=this.video.videoHeight,this._bitmapData=new t.BitmapData(this.video),this._bitmapData.$deleteSource=!1),this._bitmapData):null},enumerable:!0,configurable:!0}),i.prototype.loadPoster=function(){var e=this,i=this.poster;if(i){var r=new t.ImageLoader;r.once(t.Event.COMPLETE,function(i){if(r.data,e.posterData=r.data,e.$renderDirty=!0,e.posterData.width=e.getPlayWidth(),e.posterData.height=e.getPlayHeight(),t.nativeRender){var n=new t.Texture;n._setBitmapData(e.posterData),e.$nativeDisplayObject.setBitmapData(n)}},this),r.load(i)}},i.prototype.$measureContentBounds=function(t){var e=this.bitmapData,i=this.posterData;e?t.setTo(0,0,this.getPlayWidth(),this.getPlayHeight()):i?t.setTo(0,0,this.getPlayWidth(),this.getPlayHeight()):t.setEmpty()},i.prototype.getPlayWidth=function(){return isNaN(this.widthSet)?this.bitmapData?this.bitmapData.width:this.posterData?this.posterData.width:NaN:this.widthSet},i.prototype.getPlayHeight=function(){return isNaN(this.heightSet)?this.bitmapData?this.bitmapData.height:this.posterData?this.posterData.height:NaN:this.heightSet},i.prototype.$updateRenderNode=function(){var e=this.$renderNode,i=this.bitmapData,r=this.posterData,n=this.getPlayWidth(),a=this.getPlayHeight();this.isPlayed&&!t.Capabilities.isMobile||!r?this.isPlayed&&i&&(e.image=i,e.imageWidth=i.width,e.imageHeight=i.height,t.WebGLUtils.deleteWebGLTexture(i.webGLTexture),i.webGLTexture=null,e.drawImage(0,0,i.width,i.height,0,0,n,a)):(e.image=r,e.imageWidth=n,e.imageHeight=a,e.drawImage(0,0,r.width,r.height,0,0,n,a))},i.prototype.markDirty=function(){return this.$renderDirty=!0,!0},i.prototype.$setHeight=function(t){this.heightSet=t,e.prototype.$setHeight.call(this,t)},i.prototype.$setWidth=function(t){this.widthSet=t,e.prototype.$setWidth.call(this,t)},Object.defineProperty(i.prototype,"paused",{get:function(){return!this.video||this.video.paused},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"length",{get:function(){if(this.video)return this.video.duration;throw new Error("Video not loaded!")},enumerable:!0,configurable:!0}),i}(t.DisplayObject);e.WebVideo=n,i(n.prototype,"egret.web.WebVideo",["egret.Video","egret.DisplayObject"]),t.Video=n}(t.web||(t.web={}))}(f||(f={})),function(t){!function(e){var n=function(e){function i(){var t=e.call(this)||this;return t._url="",t._method="",t}return r(i,e),Object.defineProperty(i.prototype,"response",{get:function(){return this._xhr?void 0!=this._xhr.response?this._xhr.response:"text"==this._responseType?this._xhr.responseText:"arraybuffer"==this._responseType&&/msie 9.0/i.test(navigator.userAgent)?window.convertResponseBodyToText(this._xhr.responseBody):"document"==this._responseType?this._xhr.responseXML:null:null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"responseType",{get:function(){return this._responseType},set:function(t){this._responseType=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"withCredentials",{get:function(){return this._withCredentials},set:function(t){this._withCredentials=t},enumerable:!0,configurable:!0}),i.prototype.getXHR=function(){return window.XMLHttpRequest?new window.XMLHttpRequest:new ActiveXObject("MSXML2.XMLHTTP")},i.prototype.open=function(t,e){void 0===e&&(e="GET"),this._url=t,this._method=e,this._xhr&&(this._xhr.abort(),this._xhr=null),this._xhr=this.getXHR(),this._xhr.onreadystatechange=this.onReadyStateChange.bind(this),this._xhr.onprogress=this.updateProgress.bind(this),this._xhr.open(this._method,this._url,!0)},i.prototype.send=function(t){if(null!=this._responseType&&(this._xhr.responseType=this._responseType),null!=this._withCredentials&&(this._xhr.withCredentials=this._withCredentials),this.headerObj)for(var e in this.headerObj)this._xhr.setRequestHeader(e,this.headerObj[e]);this._xhr.send(t)},i.prototype.abort=function(){this._xhr&&this._xhr.abort()},i.prototype.getAllResponseHeaders=function(){return this._xhr?this._xhr.getAllResponseHeaders()||"":null},i.prototype.setRequestHeader=function(t,e){this.headerObj||(this.headerObj={}),this.headerObj[t]=e},i.prototype.getResponseHeader=function(t){return this._xhr?this._xhr.getResponseHeader(t)||"":null},i.prototype.onReadyStateChange=function(){var e=this._xhr;if(4==e.readyState){var i=e.status>=400||0==e.status,r=this._url,n=this;window.setTimeout(function(){i?(n.hasEventListener(t.IOErrorEvent.IO_ERROR)||t.$error(1011,r),n.dispatchEventWith(t.IOErrorEvent.IO_ERROR)):n.dispatchEventWith(t.Event.COMPLETE)},0)}},i.prototype.updateProgress=function(e){e.lengthComputable&&t.ProgressEvent.dispatchProgressEvent(this,t.ProgressEvent.PROGRESS,e.loaded,e.total)},i}(t.EventDispatcher);e.WebHttpRequest=n,i(n.prototype,"egret.web.WebHttpRequest",["egret.HttpRequest"]),t.HttpRequest=n}(t.web||(t.web={}))}(f||(f={})),function(t){!function(e){var n=window.URL||window.webkitURL,a=function(i){function a(){var t=null!==i&&i.apply(this,arguments)||this;return t.data=null,t._crossOrigin=null,t._hasCrossOriginSet=!1,t.currentImage=null,t.request=null,t}return r(a,i),Object.defineProperty(a.prototype,"crossOrigin",{get:function(){return this._crossOrigin},set:function(t){this._hasCrossOriginSet=!0,this._crossOrigin=t},enumerable:!0,configurable:!0}),a.prototype.load=function(i){if(e.Html5Capatibility._canUseBlob&&0!=i.indexOf("wxLocalResource:")&&0!=i.indexOf("data:")&&0!=i.indexOf("http:")&&0!=i.indexOf("https:")){var r=this.request;r||((r=this.request=new t.web.WebHttpRequest).addEventListener(t.Event.COMPLETE,this.onBlobLoaded,this),r.addEventListener(t.IOErrorEvent.IO_ERROR,this.onBlobError,this),r.responseType="blob"),this.currentURL=i,r.open(i),r.send()}else this.loadImage(i)},a.prototype.onBlobLoaded=function(t){var e=this.request.response;this.request=void 0,this.loadImage(n.createObjectURL(e))},a.prototype.onBlobError=function(t){this.dispatchIOError(this.currentURL),this.request=void 0},a.prototype.loadImage=function(t){var e=new Image;this.data=null,this.currentImage=e,this._hasCrossOriginSet?this._crossOrigin&&(e.crossOrigin=this._crossOrigin):a.crossOrigin&&(e.crossOrigin=a.crossOrigin),e.onload=this.onImageComplete.bind(this),e.onerror=this.onLoadError.bind(this),e.src=t},a.prototype.onImageComplete=function(e){var i=this.getImage(e);if(i){this.data=new t.BitmapData(i);var r=this;window.setTimeout(function(){r.dispatchEventWith(t.Event.COMPLETE)},0)}},a.prototype.onLoadError=function(t){var e=this.getImage(t);e&&this.dispatchIOError(e.src)},a.prototype.dispatchIOError=function(e){var i=this;window.setTimeout(function(){i.hasEventListener(t.IOErrorEvent.IO_ERROR)||t.$error(1011,e),i.dispatchEventWith(t.IOErrorEvent.IO_ERROR)},0)},a.prototype.getImage=function(e){var i=e.target;if(0==i.src.indexOf("blob:"))try{n.revokeObjectURL(i.src)}catch(e){t.$warn(1037)}return i.onerror=null,i.onload=null,this.currentImage!==i?null:(this.currentImage=null,i)},a.crossOrigin=null,a}(t.EventDispatcher);e.WebImageLoader=a,i(a.prototype,"egret.web.WebImageLoader",["egret.ImageLoader"]),t.ImageLoader=a}(t.web||(t.web={}))}(f||(f={})),function(t){!function(e){var n=function(e){function i(){var t=e.call(this)||this;return t._isNeedShow=!1,t.inputElement=null,t.inputDiv=null,t._gscaleX=0,t._gscaleY=0,t.textValue="",t.colorValue=16777215,t._styleInfoes={},t}return r(i,e),i.prototype.$setTextField=function(t){return this.$textfield=t,!0},i.prototype.$addToStage=function(){this.htmlInput=t.web.$getTextAdapter(this.$textfield)},i.prototype._initElement=function(){var e=this.$textfield.localToGlobal(0,0),i=e.x,r=e.y,n=this.htmlInput.$scaleX,a=this.htmlInput.$scaleY;this.inputDiv.style.left=i*n+"px",this.inputDiv.style.top=r*a+"px",this.$textfield.multiline&&this.$textfield.height>this.$textfield.size?(this.inputDiv.style.top=r*a+"px",this.inputElement.style.top=-this.$textfield.lineSpacing/2*a+"px"):(this.inputDiv.style.top=r*a+"px",this.inputElement.style.top="0px");for(var s=this.$textfield,o=1,h=1,l=0;s.parent;)o*=s.scaleX,h*=s.scaleY,l+=s.rotation,s=s.parent;var u=t.web.getPrefixStyleName("transform");this.inputDiv.style[u]="rotate("+l+"deg)",this._gscaleX=n*o,this._gscaleY=a*h},i.prototype.$show=function(){this.htmlInput.isCurrentStageText(this)?this.inputElement.onblur=null:(this.inputElement=this.htmlInput.getInputElement(this),this.$textfield.multiline?this.inputElement.type="text":this.inputElement.type=this.$textfield.inputType,this.inputDiv=this.htmlInput._inputDIV),this.htmlInput._needShow=!0,this._isNeedShow=!0,this._initElement()},i.prototype.onBlurHandler=function(){this.htmlInput.clearInputElement(),window.scrollTo(0,0)},i.prototype.executeShow=function(){this.inputElement.value=this.$getText(),null==this.inputElement.onblur&&(this.inputElement.onblur=this.onBlurHandler.bind(this)),this.$resetStageText(),this.$textfield.maxChars>0?this.inputElement.setAttribute("maxlength",this.$textfield.maxChars):this.inputElement.removeAttribute("maxlength"),this.inputElement.selectionStart=this.inputElement.value.length,this.inputElement.selectionEnd=this.inputElement.value.length,this.inputElement.focus()},i.prototype.$hide=function(){this.htmlInput&&this.htmlInput.disconnectStageText(this)},i.prototype.$getText=function(){return this.textValue||(this.textValue=""),this.textValue},i.prototype.$setText=function(t){return this.textValue=t,this.resetText(),!0},i.prototype.resetText=function(){this.inputElement&&(this.inputElement.value=this.textValue)},i.prototype.$setColor=function(t){return this.colorValue=t,this.resetColor(),!0},i.prototype.resetColor=function(){this.inputElement&&this.setElementStyle("color",t.toColorString(this.colorValue))},i.prototype.$onBlur=function(){},i.prototype._onInput=function(){var e=this;window.setTimeout(function(){e.inputElement&&e.inputElement.selectionStart==e.inputElement.selectionEnd&&(e.textValue=e.inputElement.value,t.Event.dispatchEvent(e,"updateText",!1))},0)},i.prototype.setAreaHeight=function(){var e=this.$textfield;if(e.multiline){var i=t.TextFieldUtils.$getTextHeight(e);if(e.height<=e.size)this.setElementStyle("height",e.size*this._gscaleY+"px"),this.setElementStyle("padding","0px"),this.setElementStyle("lineHeight",e.size*this._gscaleY+"px");else if(e.height<i)this.setElementStyle("height",e.height*this._gscaleY+"px"),this.setElementStyle("padding","0px"),this.setElementStyle("lineHeight",(e.size+e.lineSpacing)*this._gscaleY+"px");else{this.setElementStyle("height",(i+e.lineSpacing)*this._gscaleY+"px");var r=(e.height-i)*this._gscaleY,n=r*t.TextFieldUtils.$getValign(e),a=r-n;this.setElementStyle("padding",n+"px 0px "+a+"px 0px"),this.setElementStyle("lineHeight",(e.size+e.lineSpacing)*this._gscaleY+"px")}}},i.prototype._onClickHandler=function(e){this._isNeedShow&&(e.stopImmediatePropagation(),this._isNeedShow=!1,this.executeShow(),this.dispatchEvent(new t.Event("focus")))},i.prototype._onDisconnect=function(){this.inputElement=null,this.dispatchEvent(new t.Event("blur"))},i.prototype.setElementStyle=function(t,e){this.inputElement&&this._styleInfoes[t]!=e&&(this.inputElement.style[t]=e)},i.prototype.$removeFromStage=function(){this.inputElement&&this.htmlInput.disconnectStageText(this)},i.prototype.$resetStageText=function(){if(this.inputElement){var e=this.$textfield;this.setElementStyle("fontFamily",e.fontFamily),this.setElementStyle("fontStyle",e.italic?"italic":"normal"),this.setElementStyle("fontWeight",e.bold?"bold":"normal"),this.setElementStyle("textAlign",e.textAlign),this.setElementStyle("fontSize",e.size*this._gscaleY+"px"),this.setElementStyle("color",t.toColorString(e.textColor));var i=void 0;if(e.stage?(i=e.localToGlobal(0,0).x,i=Math.min(e.width,e.stage.stageWidth-i)):i=e.width,this.setElementStyle("width",i*this._gscaleX+"px"),this.setElementStyle("verticalAlign",e.verticalAlign),e.multiline)this.setAreaHeight();else if(this.setElementStyle("lineHeight",e.size*this._gscaleY+"px"),e.height<e.size){this.setElementStyle("height",e.size*this._gscaleY+"px");var r=e.size/2*this._gscaleY;this.setElementStyle("padding","0px 0px "+r+"px 0px")}else{this.setElementStyle("height",e.size*this._gscaleY+"px");var n=(e.height-e.size)*this._gscaleY,a=n*t.TextFieldUtils.$getValign(e);(r=n-a)<e.size/2*this._gscaleY&&(r=e.size/2*this._gscaleY),this.setElementStyle("padding",a+"px 0px "+r+"px 0px")}this.inputDiv.style.clip="rect(0px "+e.width*this._gscaleX+"px "+e.height*this._gscaleY+"px 0px)",this.inputDiv.style.height=e.height*this._gscaleY+"px",this.inputDiv.style.width=i*this._gscaleX+"px"}},i}(t.EventDispatcher);e.HTML5StageText=n,i(n.prototype,"egret.web.HTML5StageText",["egret.StageText"]),t.StageText=n}(t.web||(t.web={}))}(f||(f={})),function(t){!function(e){var r=function(){function e(){this._needShow=!1,this.$scaleX=1,this.$scaleY=1}return e.prototype.isInputOn=function(){return null!=this._stageText},e.prototype.isCurrentStageText=function(t){return this._stageText==t},e.prototype.initValue=function(t){t.style.position="absolute",t.style.left="0px",t.style.top="0px",t.style.border="none",t.style.padding="0"},e.prototype.$updateSize=function(){if(this.canvas){this.$scaleX=t.sys.DisplayList.$canvasScaleX,this.$scaleY=t.sys.DisplayList.$canvasScaleY,this.StageDelegateDiv.style.left=this.canvas.style.left,this.StageDelegateDiv.style.top=this.canvas.style.top;var e=t.web.getPrefixStyleName("transform");this.StageDelegateDiv.style[e]=this.canvas.style[e],this.StageDelegateDiv.style[t.web.getPrefixStyleName("transformOrigin")]="0% 0% 0px"}},e.prototype._initStageDelegateDiv=function(e,i){this.canvas=i;var r,n=this;r||(r=document.createElement("div"),this.StageDelegateDiv=r,r.id="StageDelegateDiv",e.appendChild(r),n.initValue(r),n._inputDIV=document.createElement("div"),n.initValue(n._inputDIV),n._inputDIV.style.width="0px",n._inputDIV.style.height="0px",n._inputDIV.style.left="0px",n._inputDIV.style.top="-100px",n._inputDIV.style[t.web.getPrefixStyleName("transformOrigin")]="0% 0% 0px",r.appendChild(n._inputDIV),this.canvas.addEventListener("click",function(t){n._needShow?(n._needShow=!1,n._stageText._onClickHandler(t),n.show()):n._inputElement&&(n.clearInputElement(),n._inputElement.blur(),n._inputElement=null)}),n.initInputElement(!0),n.initInputElement(!1))},e.prototype.initInputElement=function(t){var e,i=this;t?((e=document.createElement("textarea")).style.resize="none",i._multiElement=e,e.id="egretTextarea"):(e=document.createElement("input"),i._simpleElement=e,e.id="egretInput"),e.type="text",i._inputDIV.appendChild(e),e.setAttribute("tabindex","-1"),e.style.width="1px",e.style.height="12px",i.initValue(e),e.style.outline="thin",e.style.background="none",e.style.overflow="hidden",e.style.wordBreak="break-all",e.style.opacity=0,e.oninput=function(){i._stageText&&i._stageText._onInput()}},e.prototype.show=function(){var e=this._inputElement;t.$callAsync(function(){e.style.opacity=1},this)},e.prototype.disconnectStageText=function(t){null!=this._stageText&&this._stageText!=t||(this.clearInputElement(),this._inputElement&&this._inputElement.blur()),this._needShow=!1},e.prototype.clearInputElement=function(){this._inputElement&&(this._inputElement.value="",this._inputElement.onblur=null,this._inputElement.style.width="1px",this._inputElement.style.height="12px",this._inputElement.style.left="0px",this._inputElement.style.top="0px",this._inputElement.style.opacity=0,(this._simpleElement==this._inputElement?this._multiElement:this._simpleElement).style.display="block",this._inputDIV.style.left="0px",this._inputDIV.style.top="-100px",this._inputDIV.style.height="0px",this._inputDIV.style.width="0px"),this._stageText&&(this._stageText._onDisconnect(),this._stageText=null,this.canvas.userTyping=!1)},e.prototype.getInputElement=function(t){return this.clearInputElement(),this._stageText=t,this.canvas.userTyping=!0,this._stageText.$textfield.multiline?this._inputElement=this._multiElement:this._inputElement=this._simpleElement,(this._simpleElement==this._inputElement?this._multiElement:this._simpleElement).style.display="none",this._inputElement},e}();e.HTMLInput=r,i(r.prototype,"egret.web.HTMLInput")}(t.web||(t.web={}))}(f||(f={})),function(t){!function(t){var e={},i={},r={};t.$getTextAdapter=function(t){var n=t.stage?t.stage.$hashCode:0,a=e[n],s=i[n],o=r[n];return s&&o&&(delete i[n],delete r[n]),a},t.$cacheTextAdapter=function(t,n,a,s){t._initStageDelegateDiv(a,s),e[n.$hashCode]=t,i[n.$hashCode]=s,r[n.$hashCode]=a}}(t.web||(t.web={}))}(f||(f={})),function(t){!function(e){var i=null;t.sys.measureText=function(e,r,n,a,s){i||((i=t.sys.canvasHitTestBuffer.context).textAlign="left",i.textBaseline="middle");var o="";return s&&(o+="italic "),a&&(o+="bold "),o+=(n||12)+"px ",o+=r||"Arial",i.font=o,i.measureText(e).width}}(t.web||(t.web={}))}(f||(f={})),function(t){!function(t){var e=function(){function t(t,e,i){this.surface=function(t,e){var i=document.createElement("canvas");isNaN(t)||isNaN(e)||(i.width=t,i.height=e);var r=i.getContext("2d");if(void 0===r.imageSmoothingEnabled){for(var n,a=["webkitImageSmoothingEnabled","mozImageSmoothingEnabled","msImageSmoothingEnabled"],s=a.length-1;s>=0&&void 0===r[n=a[s]];s--);try{Object.defineProperty(r,"imageSmoothingEnabled",{get:function(){return this[n]},set:function(t){this[n]=t}})}catch(t){r.imageSmoothingEnabled=r[n]}}return i}(t,e),this.context=this.surface.getContext("2d"),this.context&&(this.context.$offsetX=0,this.context.$offsetY=0)}return Object.defineProperty(t.prototype,"width",{get:function(){return this.surface.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.surface.height},enumerable:!0,configurable:!0}),t.prototype.resize=function(t,e,i){var r=this.surface;if(i){var n=!1;r.width<t&&(r.width=t,n=!0),r.height<e&&(r.height=e,n=!0),n||(this.context.globalCompositeOperation="source-over",this.context.setTransform(1,0,0,1,0,0),this.context.globalAlpha=1)}else r.width!=t&&(r.width=t),r.height!=e&&(r.height=e);this.clear()},t.prototype.getPixels=function(t,e,i,r){return void 0===i&&(i=1),void 0===r&&(r=1),this.context.getImageData(t,e,i,r).data},t.prototype.toDataURL=function(t,e){return this.surface.toDataURL(t,e)},t.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.surface.width,this.surface.height)},t.prototype.destroy=function(){this.surface.width=this.surface.height=0},t}();t.CanvasRenderBuffer=e,i(e.prototype,"egret.web.CanvasRenderBuffer",["egret.sys.RenderBuffer"])}(t.web||(t.web={}))}(f||(f={})),function(t){!function(e){var n=function(e){function i(i,r){var n=e.call(this)||this;return n.onTouchBegin=function(t){var e=n.getLocation(t);n.touch.onTouchBegin(e.x,e.y,t.identifier)},n.onMouseMove=function(t){0==t.buttons?n.onTouchEnd(t):n.onTouchMove(t)},n.onTouchMove=function(t){var e=n.getLocation(t);n.touch.onTouchMove(e.x,e.y,t.identifier)},n.onTouchEnd=function(t){var e=n.getLocation(t);n.touch.onTouchEnd(e.x,e.y,t.identifier)},n.scaleX=1,n.scaleY=1,n.rotation=0,n.canvas=r,n.touch=new t.sys.TouchHandler(i),n.addListeners(),n}return r(i,e),i.prototype.addListeners=function(){var e=this;window.navigator.msPointerEnabled?(this.canvas.addEventListener("MSPointerDown",function(t){t.identifier=t.pointerId,e.onTouchBegin(t),e.prevent(t)},!1),this.canvas.addEventListener("MSPointerMove",function(t){t.identifier=t.pointerId,e.onTouchMove(t),e.prevent(t)},!1),this.canvas.addEventListener("MSPointerUp",function(t){t.identifier=t.pointerId,e.onTouchEnd(t),e.prevent(t)},!1)):(t.Capabilities.isMobile||this.addMouseListener(),this.addTouchListener())},i.prototype.addMouseListener=function(){this.canvas.addEventListener("mousedown",this.onTouchBegin),this.canvas.addEventListener("mousemove",this.onMouseMove),this.canvas.addEventListener("mouseup",this.onTouchEnd)},i.prototype.addTouchListener=function(){var t=this;this.canvas.addEventListener("touchstart",function(e){for(var i=e.changedTouches.length,r=0;r<i;r++)t.onTouchBegin(e.changedTouches[r]);t.prevent(e)},!1),this.canvas.addEventListener("touchmove",function(e){for(var i=e.changedTouches.length,r=0;r<i;r++)t.onTouchMove(e.changedTouches[r]);t.prevent(e)},!1),this.canvas.addEventListener("touchend",function(e){for(var i=e.changedTouches.length,r=0;r<i;r++)t.onTouchEnd(e.changedTouches[r]);t.prevent(e)},!1),this.canvas.addEventListener("touchcancel",function(e){for(var i=e.changedTouches.length,r=0;r<i;r++)t.onTouchEnd(e.changedTouches[r]);t.prevent(e)},!1)},i.prototype.prevent=function(t){t.stopPropagation(),1==t.isScroll||this.canvas.userTyping||t.preventDefault()},i.prototype.getLocation=function(e){e.identifier=+e.identifier||0;var i=document.documentElement,r=this.canvas.getBoundingClientRect(),n=r.left+window.pageXOffset-i.clientLeft,a=r.top+window.pageYOffset-i.clientTop,s=e.pageX-n,o=s,h=e.pageY-a,l=h;return 90==this.rotation?(o=h,l=r.width-s):-90==this.rotation&&(o=r.height-h,l=s),o/=this.scaleX,l/=this.scaleY,t.$TempPoint.setTo(Math.round(o),Math.round(l))},i.prototype.updateScaleMode=function(t,e,i){this.scaleX=t,this.scaleY=e,this.rotation=i},i.prototype.$updateMaxTouches=function(){this.touch.$initMaxTouches()},i}(t.HashObject);e.WebTouchHandler=n,i(n.prototype,"egret.web.WebTouchHandler")}(t.web||(t.web={}))}(f||(f={})),function(t){!function(t){t.WebLifeCycleHandler=function(t){var e,i;window.addEventListener("focus",t.resume,!1),window.addEventListener("blur",t.pause,!1),void 0!==document.hidden?(e="hidden",i="visibilitychange"):void 0!==document.mozHidden?(e="mozHidden",i="mozvisibilitychange"):void 0!==document.msHidden?(e="msHidden",i="msvisibilitychange"):void 0!==document.webkitHidden?(e="webkitHidden",i="webkitvisibilitychange"):void 0!==document.oHidden&&(e="oHidden",i="ovisibilitychange"),"onpageshow"in window&&"onpagehide"in window&&(window.addEventListener("pageshow",t.resume,!1),window.addEventListener("pagehide",t.pause,!1)),e&&i&&document.addEventListener(i,function(){document[e]?t.pause():t.resume()},!1);var r=navigator.userAgent,n=/micromessenger/gi.test(r),a=/mqq/gi.test(r);if((/mobile.*qq/gi.test(r)||n)&&(a=!1),a){var s=window.browser||{};s.execWebFn=s.execWebFn||{},s.execWebFn.postX5GamePlayerMessage=function(e){var i=e.type;"app_enter_background"==i?t.pause():"app_enter_foreground"==i&&t.resume()},window.browser=s}}}(t.web||(t.web={}))}(f||(f={})),function(t){!function(e){var n=function(){function t(){}return t.WEB_AUDIO=2,t.HTML5_AUDIO=3,t}();e.AudioType=n,i(n.prototype,"egret.web.AudioType");var a=function(i){function a(){return i.call(this)||this}return r(a,i),a.$init=function(){var i=navigator.userAgent.toLowerCase();a.ua=i,a._canUseBlob=!1;var r=window.AudioContext||window.webkitAudioContext||window.mozAudioContext;if(r)try{e.WebAudioDecode.ctx=new(window.AudioContext||window.webkitAudioContext||window.mozAudioContext)}catch(t){r=!1}var s,o=a._audioType;o==n.WEB_AUDIO&&r||o==n.HTML5_AUDIO?(s=!1,a.setAudioType(o)):(s=!0,a.setAudioType(n.HTML5_AUDIO)),i.indexOf("android")>=0?s&&r&&a.setAudioType(n.WEB_AUDIO):(i.indexOf("iphone")>=0||i.indexOf("ipad")>=0||i.indexOf("ipod")>=0)&&a.getIOSVersion()>=7&&(a._canUseBlob=!0,s&&r&&a.setAudioType(n.WEB_AUDIO)),window.URL||window.webkitURL||(a._canUseBlob=!1),i.indexOf("egretnative")>=0&&(a.setAudioType(n.HTML5_AUDIO),a._canUseBlob=!0),t.Sound=a._AudioClass},a.setAudioType=function(e){switch(a._audioType=e,e){case n.WEB_AUDIO:a._AudioClass=t.web.WebAudioSound;break;case n.HTML5_AUDIO:a._AudioClass=t.web.HtmlSound}},a.getIOSVersion=function(){var t=a.ua.toLowerCase().match(/cpu [^\d]*\d.*like mac os x/);if(!t||0==t.length)return 0;var e=t[0];return parseInt(e.match(/\d+(_\d)*/)[0])||0},a._canUseBlob=!1,a._audioType=0,a.ua="",a}(t.HashObject);e.Html5Capatibility=a,i(a.prototype,"egret.web.Html5Capatibility");var s=null;function o(t,e){if(t in e)return"";t=t.charAt(0).toUpperCase()+t.substring(1,t.length);for(var i=["webkit","ms","Moz","O"],r=0;r<i.length;r++)if(i[r]+t in e)return i[r];return""}e.getPrefixStyleName=function(t,e){var i="";if(null!=e)i=o(t,e);else{if(null==s){var r=document.createElement("div").style;s=o("transform",r)}i=s}return""==i?t:i+t.charAt(0).toUpperCase()+t.substring(1,t.length)},e.getPrefix=o}(t.web||(t.web={}))}(f||(f={})),function(t){!function(e){var i=!1;function r(i){"webgl"==i&&t.WebGLUtils.checkCanUseWebGL()?(t.sys.RenderBuffer=e.WebGLRenderBuffer,t.sys.systemRenderer=new e.WebGLRenderer,t.sys.canvasRenderer=new t.CanvasRenderer,t.sys.customHitTestBuffer=new e.WebGLRenderBuffer(3,3),t.sys.canvasHitTestBuffer=new e.CanvasRenderBuffer(3,3),t.Capabilities.renderMode="webgl"):(t.sys.RenderBuffer=e.CanvasRenderBuffer,t.sys.systemRenderer=new t.CanvasRenderer,t.sys.canvasRenderer=t.sys.systemRenderer,t.sys.customHitTestBuffer=new e.CanvasRenderBuffer(3,3),t.sys.canvasHitTestBuffer=t.sys.customHitTestBuffer,t.Capabilities.renderMode="canvas")}function n(t){var e=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame;e||(e=function(t){return window.setTimeout(t,1e3/60)}),e(function i(){t.update(),e(i)})}window.isNaN=function(t){return(t=+t)!=t},t.runEgret=function(o){if(!i){i=!0,o||(o={});var h=navigator.userAgent.toLowerCase();if(h.indexOf("egretnative")>=0&&-1==h.indexOf("egretwebview")&&(t.Capabilities.runtimeType=t.RuntimeType.RUNTIME2),h.indexOf("egretnative")>=0&&t.nativeRender)egret_native.addModuleCallback(function(){if(e.Html5Capatibility.$init(),"webgl"==o.renderMode){var i=o.antialias;e.WebGLRenderContext.antialias=!!i}var h;t.sys.CanvasRenderBuffer=e.CanvasRenderBuffer,r(o.renderMode),egret_native.nrSetRenderMode(2),h=o.canvasScaleFactor?o.canvasScaleFactor:o.calculateCanvasScaleFactor?o.calculateCanvasScaleFactor(t.sys.canvasHitTestBuffer.context):window.devicePixelRatio,t.sys.DisplayList.$canvasScaleFactor=h,n(t.ticker),o.screenAdapter?t.sys.screenAdapter=o.screenAdapter:t.sys.screenAdapter||(t.sys.screenAdapter=new t.sys.DefaultScreenAdapter);for(var l=document.querySelectorAll(".egret-player"),u=l.length,c=0;c<u;c++){var p=l[c],f=new e.WebPlayer(p,o);p["egret-player"]=f}window.addEventListener("resize",function(){isNaN(a)&&(a=window.setTimeout(s,300))})},null),egret_native.initNativeRender();else{if(e.Html5Capatibility._audioType=o.audioType,e.Html5Capatibility.$init(),"webgl"==o.renderMode){var l=o.antialias;e.WebGLRenderContext.antialias=!!l}t.sys.CanvasRenderBuffer=e.CanvasRenderBuffer,r(o.renderMode);var u=void 0;if(o.canvasScaleFactor)u=o.canvasScaleFactor;else if(o.calculateCanvasScaleFactor)u=o.calculateCanvasScaleFactor(t.sys.canvasHitTestBuffer.context);else{var c=t.sys.canvasHitTestBuffer.context,p=c.backingStorePixelRatio||c.webkitBackingStorePixelRatio||c.mozBackingStorePixelRatio||c.msBackingStorePixelRatio||c.oBackingStorePixelRatio||c.backingStorePixelRatio||1;u=(window.devicePixelRatio||1)/p}t.sys.DisplayList.$canvasScaleFactor=u,n(t.ticker),o.screenAdapter?t.sys.screenAdapter=o.screenAdapter:t.sys.screenAdapter||(t.sys.screenAdapter=new t.sys.DefaultScreenAdapter);for(var f=document.querySelectorAll(".egret-player"),d=f.length,m=0;m<d;m++){var g=f[m],y=new e.WebPlayer(g,o);g["egret-player"]=y}window.addEventListener("resize",function(){isNaN(a)&&(a=window.setTimeout(s,300))})}}},t.updateAllScreens=function(){if(i)for(var t=document.querySelectorAll(".egret-player"),e=t.length,r=0;r<e;r++)t[r]["egret-player"].updateScreenSize()};var a=NaN;function s(){a=NaN,t.updateAllScreens()}}(t.web||(t.web={}))}(f||(f={}));var f,d=navigator.language||navigator.browserLanguage||"en_US";(d=d.replace("-","_"))in f.$locale_strings&&(f.$language=d),function(t){!function(e){var r=function(){function e(){}return e.detect=function(){var i=t.Capabilities,r=navigator.userAgent.toLowerCase();i.isMobile=-1!=r.indexOf("mobile")||-1!=r.indexOf("android"),i.isMobile?r.indexOf("windows")<0&&(-1!=r.indexOf("iphone")||-1!=r.indexOf("ipad")||-1!=r.indexOf("ipod"))?i.os="iOS":-1!=r.indexOf("android")&&-1!=r.indexOf("linux")?i.os="Android":-1!=r.indexOf("windows")&&(i.os="Windows Phone"):-1!=r.indexOf("windows nt")?i.os="Windows PC":-1!=r.indexOf("mac os")&&(i.os="Mac OS");var n=(navigator.language||navigator.browserLanguage).toLowerCase().split("-");n.length>1&&(n[1]=n[1].toUpperCase()),i.language=n.join("-"),e.injectUIntFixOnIE9()},e.injectUIntFixOnIE9=function(){/msie 9.0/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent)&&document.write("\x3c!-- IEBinaryToArray_ByteStr --\x3e\r\n<script type='text/vbscript' language='VBScript'>\r\nFunction IEBinaryToArray_ByteStr(Binary)\r\n   IEBinaryToArray_ByteStr = CStr(Binary)\r\nEnd Function\r\nFunction IEBinaryToArray_ByteStr_Last(Binary)\r\n   Dim lastIndex\r\n   lastIndex = LenB(Binary)\r\n   if lastIndex mod 2 Then\r\n       IEBinaryToArray_ByteStr_Last = Chr( AscB( MidB( Binary, lastIndex, 1 ) ) )\r\n   Else\r\n       IEBinaryToArray_ByteStr_Last = \"\"\r\n   End If\r\nEnd Function\r\n<\/script>\r\n\x3c!-- convertResponseBodyToText --\x3e\r\n<script>\r\nlet convertResponseBodyToText = function (binary) {\r\n   let byteMapping = {};\r\n   for ( let i = 0; i < 256; i++ ) {\r\n       for ( let j = 0; j < 256; j++ ) {\r\n           byteMapping[ String.fromCharCode( i + j * 256 ) ] =\r\n           String.fromCharCode(i) + String.fromCharCode(j);\r\n       }\r\n   }\r\n   let rawBytes = IEBinaryToArray_ByteStr(binary);\r\n   let lastChr = IEBinaryToArray_ByteStr_Last(binary);\r\n   return rawBytes.replace(/[\\s\\S]/g,                           function( match ) { return byteMapping[match]; }) + lastChr;\r\n};\r\n<\/script>\r\n")},e}();e.WebCapability=r,i(r.prototype,"egret.web.WebCapability"),r.detect()}(t.web||(t.web={}))}(f||(f={})),function(t){!function(e){var r=function(){function e(e,i,r,n,a){if(this.showPanle=!0,this.fpsHeight=0,this.WIDTH=101,this.HEIGHT=20,this.bgCanvasColor="#18304b",this.fpsFrontColor="#18fefe",this.WIDTH_COST=50,this.cost1Color="#18fefe",this.cost3Color="#ff0000",this.arrFps=[],this.arrCost=[],this.arrLog=[],i||r){"canvas"==t.Capabilities.renderMode?this.renderMode="Canvas":this.renderMode="WebGL",this.panelX=void 0===a.x?0:parseInt(a.x),this.panelY=void 0===a.y?0:parseInt(a.y),this.fontColor=void 0===a.textColor?"#ffffff":a.textColor.replace("0x","#"),this.fontSize=void 0===a.size?12:parseInt(a.size),t.Capabilities.isMobile&&(this.fontSize-=2);var s=document.createElement("div");s.style.position="absolute",s.style.background="rgba(0,0,0,"+a.bgAlpha+")",s.style.left=this.panelX+"px",s.style.top=this.panelY+"px",s.style.pointerEvents="none",document.body.appendChild(s);var o=document.createElement("div");o.style.color=this.fontColor,o.style.fontSize=this.fontSize+"px",o.style.lineHeight=this.fontSize+"px",o.style.margin="4px 4px 4px 4px",this.container=o,s.appendChild(o),i&&this.addFps(),r&&this.addLog()}}return e.prototype.addFps=function(){var t=document.createElement("div");t.style.display="inline-block",this.containerFps=t,this.container.appendChild(t);var e=document.createElement("div");e.style.paddingBottom="2px",this.fps=e,this.containerFps.appendChild(e),e.innerHTML="0 FPS "+this.renderMode+"<br/>min0 max0 avg0";var i=document.createElement("canvas");this.containerFps.appendChild(i),i.width=this.WIDTH,i.height=this.HEIGHT,this.canvasFps=i;var r=i.getContext("2d");this.contextFps=r,r.fillStyle=this.bgCanvasColor,r.fillRect(0,0,this.WIDTH,this.HEIGHT);var n=document.createElement("div");this.divDatas=n,this.containerFps.appendChild(n);var a=document.createElement("div");a.style.float="left",a.innerHTML="Draw<br/>Cost",n.appendChild(a);var s=document.createElement("div");s.style.paddingLeft=a.offsetWidth+20+"px",n.appendChild(s);var o=document.createElement("div");this.divDraw=o,o.innerHTML="0<br/>",s.appendChild(o);var h=document.createElement("div");this.divCost=h,h.innerHTML='<font  style="color:'+this.cost1Color+'">0<font/> <font  style="color:'+this.cost3Color+'">0<font/>',s.appendChild(h),i=document.createElement("canvas"),this.canvasCost=i,this.containerFps.appendChild(i),i.width=this.WIDTH,i.height=this.HEIGHT,r=i.getContext("2d"),this.contextCost=r,r.fillStyle=this.bgCanvasColor,r.fillRect(0,0,this.WIDTH,this.HEIGHT),r.fillStyle="#000000",r.fillRect(this.WIDTH_COST,0,1,this.HEIGHT),this.fpsHeight=this.container.offsetHeight},e.prototype.addLog=function(){var t=document.createElement("div");t.style.maxWidth=document.body.clientWidth-8-this.panelX+"px",t.style.wordWrap="break-word",this.log=t,this.container.appendChild(t)},e.prototype.update=function(t,e){var i,r,n;void 0===e&&(e=!1),e?(i=this.arrFps[this.arrFps.length-1],r=this.arrCost[this.arrCost.length-1][0],n=this.arrCost[this.arrCost.length-1][1]):(i=t.fps,r=t.costTicker,n=t.costRender,this.lastNumDraw=t.draw,this.arrFps.push(i),this.arrCost.push([r,n]));var a=0,s=this.arrFps.length;s>101&&(s=101,this.arrFps.shift(),this.arrCost.shift());for(var o=this.arrFps[0],h=this.arrFps[0],l=0;l<s;l++){var u=this.arrFps[l];a+=u,u<o?o=u:u>h&&(h=u)}var c=this.WIDTH,p=this.HEIGHT,f=this.contextFps;f.drawImage(this.canvasFps,1,0,c-1,p,0,0,c-1,p),f.fillStyle=this.bgCanvasColor,f.fillRect(c-1,0,1,p);var d=Math.floor(i/60*20);d<1&&(d=1),f.fillStyle=this.fpsFrontColor,f.fillRect(c-1,20-d,1,d);var m=this.WIDTH_COST;(f=this.contextCost).drawImage(this.canvasCost,1,0,m-1,p,0,0,m-1,p),f.drawImage(this.canvasCost,m+2,0,m-1,p,m+1,0,m-1,p);var g=Math.floor(r/2);g<1?g=1:g>20&&(g=20);var y=Math.floor(n/2);y<1?y=1:y>20&&(y=20),f.fillStyle=this.bgCanvasColor,f.fillRect(m-1,0,1,p),f.fillRect(2*m,0,1,p),f.fillRect(3*m+1,0,1,p),f.fillStyle=this.cost1Color,f.fillRect(m-1,20-g,1,g),f.fillStyle=this.cost3Color,f.fillRect(2*m,20-y,1,y);var _=Math.floor(a/s),v=i+" FPS "+this.renderMode;this.showPanle&&(v+="<br/>min"+o+" max"+h+" avg"+_,this.divDraw.innerHTML=this.lastNumDraw+"<br/>",this.divCost.innerHTML='<font  style="color:#18fefe">'+r+'<font/> <font  style="color:#ff0000">'+n+"<font/>"),this.fps.innerHTML=v},e.prototype.updateInfo=function(t){this.arrLog.push(t),this.updateLogLayout()},e.prototype.updateWarn=function(t){this.arrLog.push("[Warning]"+t),this.updateLogLayout()},e.prototype.updateError=function(t){this.arrLog.push("[Error]"+t),this.updateLogLayout()},e.prototype.updateLogLayout=function(){for(this.log.innerHTML=this.arrLog.join("<br/>");document.body.clientHeight<this.log.offsetHeight+this.fpsHeight+this.panelY+2*this.fontSize;)this.arrLog.shift(),this.log.innerHTML=this.arrLog.join("<br/>")},e}();e.WebFps=r,i(r.prototype,"egret.web.WebFps",["egret.FPSDisplay"]),t.FPSDisplay=r}(t.web||(t.web={}))}(f||(f={})),function(t){!function(e){e.web||(e.web={}),e.getItem=function(t){return window.localStorage.getItem(t)},e.setItem=function(e,i){try{return window.localStorage.setItem(e,i),!0}catch(r){return t.$warn(1047,e,i),!1}},e.removeItem=function(t){window.localStorage.removeItem(t)},e.clear=function(){window.localStorage.clear()}}(t.localStorage||(t.localStorage={}))}(f||(f={})),function(t){!function(e){var n=function(i){function n(t,e){var r=i.call(this)||this;return r.init(t,e),r.initOrientation(),r}return r(n,i),n.prototype.init=function(i,r){var n=this.readOption(i,r),a=new t.Stage;a.$screen=this,a.$scaleMode=n.scaleMode,a.$orientation=n.orientation,a.$maxTouches=n.maxTouches,a.frameRate=n.frameRate,a.textureScaleFactor=n.textureScaleFactor;var s=new t.sys.RenderBuffer(void 0,void 0,!0),o=s.surface;this.attachCanvas(i,o);var h=new e.WebTouchHandler(a,o),l=new t.sys.Player(s,a,n.entryClassName);t.lifecycle.stage=a,t.lifecycle.addLifecycleListener(e.WebLifeCycleHandler);var u=new e.HTMLInput;(n.showFPS||n.showLog)&&(t.nativeRender||l.displayFPS(n.showFPS,n.showLog,n.logFilter,n.fpsStyles)),this.playerOption=n,this.container=i,this.canvas=o,this.stage=a,this.player=l,this.webTouchHandler=h,this.webInput=u,t.web.$cacheTextAdapter(u,a,i,o),this.updateScreenSize(),this.updateMaxTouches(),l.start()},n.prototype.initOrientation=function(){var e=this;window.addEventListener("orientationchange",function(){window.setTimeout(function(){t.StageOrientationEvent.dispatchStageOrientationEvent(e.stage,t.StageOrientationEvent.ORIENTATION_CHANGE)},350)})},n.prototype.readOption=function(e,i){var r={};r.entryClassName=e.getAttribute("data-entry-class"),r.scaleMode=e.getAttribute("data-scale-mode")||t.StageScaleMode.NO_SCALE,r.frameRate=+e.getAttribute("data-frame-rate")||30,r.contentWidth=+e.getAttribute("data-content-width")||480,r.contentHeight=+e.getAttribute("data-content-height")||800,r.orientation=e.getAttribute("data-orientation")||t.OrientationMode.AUTO,r.maxTouches=+e.getAttribute("data-multi-fingered")||2,r.textureScaleFactor=+e.getAttribute("texture-scale-factor")||1,r.showFPS="true"==e.getAttribute("data-show-fps");for(var n=(e.getAttribute("data-show-fps-style")||"").split(","),a={},s=0;s<n.length;s++){var o=n[s].split(":");a[o[0]]=o[1]}return r.fpsStyles=a,r.showLog="true"==e.getAttribute("data-show-log"),r.logFilter=e.getAttribute("data-log-filter"),r},n.prototype.attachCanvas=function(t,e){var i=e.style;i.cursor="inherit",i.position="absolute",i.top="0",i.bottom="0",i.left="0",i.right="0",t.appendChild(e),(i=t.style).overflow="hidden",i.position="absolute"},n.prototype.updateScreenSize=function(){var e=this.canvas;if(!e.userTyping){var i=this.playerOption,r=this.container.getBoundingClientRect(),n=0,a=r.width,s=r.height;if(0!=a&&0!=s){r.top<0&&(s+=r.top,n=-r.top);var o=!1,h=this.stage.$orientation;h!=t.OrientationMode.AUTO&&(o=h!=t.OrientationMode.PORTRAIT&&s>a||h==t.OrientationMode.PORTRAIT&&a>s);var l=o?s:a,u=o?a:s;t.Capabilities.boundingClientWidth=l,t.Capabilities.boundingClientHeight=u;var c=t.sys.screenAdapter.calculateStageSize(this.stage.$scaleMode,l,u,i.contentWidth,i.contentHeight),p=c.stageWidth,f=c.stageHeight,d=c.displayWidth,m=c.displayHeight;e.style[t.web.getPrefixStyleName("transformOrigin")]="0% 0% 0px",e.width!=p&&(e.width=p),e.height!=f&&(e.height=f);var g=0;o?h==t.OrientationMode.LANDSCAPE?(g=90,e.style.top=n+(s-d)/2+"px",e.style.left=(a+m)/2+"px"):(g=-90,e.style.top=n+(s+d)/2+"px",e.style.left=(a-m)/2+"px"):(e.style.top=n+(s-m)/2+"px",e.style.left=(a-d)/2+"px");var y=d/p,_=m/f,v=y*t.sys.DisplayList.$canvasScaleFactor,b=_*t.sys.DisplayList.$canvasScaleFactor;"canvas"==t.Capabilities.renderMode&&(v=Math.ceil(v),b=Math.ceil(b));var T=t.Matrix.create();T.identity(),T.scale(y/v,_/b),T.rotate(g*Math.PI/180);var x="matrix("+T.a+","+T.b+","+T.c+","+T.d+","+T.tx+","+T.ty+")";t.Matrix.release(T),e.style[t.web.getPrefixStyleName("transform")]=x,t.sys.DisplayList.$setCanvasScale(v,b),this.webTouchHandler.updateScaleMode(y,_,g),this.webInput.$updateSize(),this.player.updateStageSize(p,f),t.nativeRender&&(e.width=p*v,e.height=f*b)}}},n.prototype.setContentSize=function(t,e){var i=this.playerOption;i.contentWidth=t,i.contentHeight=e,this.updateScreenSize()},n.prototype.updateMaxTouches=function(){this.webTouchHandler.$updateMaxTouches()},n}(t.HashObject);e.WebPlayer=n,i(n.prototype,"egret.web.WebPlayer",["egret.sys.Screen"])}(t.web||(t.web={}))}(f||(f={})),function(t){!function(e){var i,r;function n(e,n){i||(i=document.createElement("canvas"),r=i.getContext("2d"));var a=e.$getTextureWidth(),s=e.$getTextureHeight();null==n&&((n=t.$TempRectangle).x=0,n.y=0,n.width=a,n.height=s),n.x=Math.min(n.x,a-1),n.y=Math.min(n.y,s-1),n.width=Math.min(n.width,a-n.x),n.height=Math.min(n.height,s-n.y);var o=n.width,h=n.height,l=i;if(l.style.width=o+"px",l.style.height=h+"px",i.width=o,i.height=h,"webgl"==t.Capabilities.renderMode){var u=void 0;e.$renderBuffer?u=e:(u=new t.RenderTexture).drawToTexture(new t.Bitmap(e));for(var c=u.$renderBuffer.getPixels(n.x,n.y,o,h),p=new ImageData(o,h),f=0;f<c.length;f++)p.data[f]=c[f];return r.putImageData(p,0,0),e.$renderBuffer||u.dispose(),l}var d=e,m=Math.round(d.$offsetX),g=Math.round(d.$offsetY),y=d.$bitmapWidth,_=d.$bitmapHeight;return r.drawImage(d.$bitmapData.source,d.$bitmapX+n.x/t.$TextureScaleFactor,d.$bitmapY+n.y/t.$TextureScaleFactor,y*n.width/a,_*n.height/s,m,g,n.width,n.height),l}function a(e,i,r){try{return n(this,i).toDataURL(e,r)}catch(e){t.$error(1033)}return null}t.Texture.prototype.toDataURL=a,t.Texture.prototype.saveToFile=function(t,e,i,r){var n=a.call(this,t,i,r);if(null!=n){var s=n.replace(/^data:image[^;]*/,"data:image/octet-stream"),o=document.createElement("a");o.download=e,o.href=s;var h=document.createEvent("MouseEvents");h.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),o.dispatchEvent(h)}},t.Texture.prototype.getPixel32=function(e,i){return t.$warn(1041,"getPixel32","getPixels"),this.getPixels(e,i)},t.Texture.prototype.getPixels=function(e,i,a,s){if(void 0===a&&(a=1),void 0===s&&(s=1),"webgl"==t.Capabilities.renderMode){var o=void 0;return this.$renderBuffer?o=this:(o=new t.RenderTexture).drawToTexture(new t.Bitmap(this)),o.$renderBuffer.getPixels(e,i,a,s)}try{return n(this),r.getImageData(e,i,a,s).data}catch(e){t.$error(1039)}}}(t.web||(t.web={}))}(f||(f={})),function(t){!function(e){var n=function(t,e){this.nodeType=t,this.parent=e};e.XMLNode=n,i(n.prototype,"egret.web.XMLNode");var a=function(t){function e(e,i,r,n,a){var s=t.call(this,1,i)||this;return s.attributes={},s.children=[],s.localName=e,s.prefix=r,s.namespace=n,s.name=a,s}return r(e,t),e}(n);e.XML=a,i(a.prototype,"egret.web.XML");var s=function(t){function e(e,i){var r=t.call(this,3,i)||this;return r.text=e,r}return r(e,t),e}(n);e.XMLText=s,i(s.prototype,"egret.web.XMLText");var o=new DOMParser;function h(t,e){if("parsererror"==t.localName)throw new Error(t.textContent);for(var i=new a(t.localName,e,t.prefix,t.namespaceURI,t.nodeName),r=t.attributes,n=i.attributes,o=r.length,l=0;l<o;l++){var u=r[l],c=u.name;0!=c.indexOf("xmlns:")&&(n[c]=u.value,i["$"+c]=u.value)}var p=t.childNodes;o=p.length;var f=i.children;for(l=0;l<o;l++){var d=p[l],m=d.nodeType,g=null;if(1==m)g=h(d,i);else if(3==m){var y=d.textContent.trim();y&&(g=new s(y,i))}g&&f.push(g)}return i}t.XML={parse:function(t){for(var e=o.parseFromString(t,"text/xml"),i=e.childNodes.length,r=0;r<i;r++){var n=e.childNodes[r];if(1==n.nodeType)return h(n,null)}return null}}}(t.web||(t.web={}))}(f||(f={})),function(t){!function(e){var n=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.onChange=function(e){var r=new t.OrientationEvent(t.Event.CHANGE);r.beta=e.beta,r.gamma=e.gamma,r.alpha=e.alpha,i.dispatchEvent(r)},i}return r(i,e),i.prototype.start=function(){window.addEventListener("deviceorientation",this.onChange)},i.prototype.stop=function(){window.removeEventListener("deviceorientation",this.onChange)},i}(t.EventDispatcher);e.WebDeviceOrientation=n,i(n.prototype,"egret.web.WebDeviceOrientation",["egret.DeviceOrientation"])}(t.web||(t.web={}))}(f||(f={})),f.DeviceOrientation=f.web.WebDeviceOrientation,function(t){!function(e){var n=function(e){function i(i){var r=e.call(this)||this;return r.onUpdate=function(e){var i=new t.GeolocationEvent(t.Event.CHANGE),n=e.coords;i.altitude=n.altitude,i.heading=n.heading,i.accuracy=n.accuracy,i.latitude=n.latitude,i.longitude=n.longitude,i.speed=n.speed,i.altitudeAccuracy=n.altitudeAccuracy,r.dispatchEvent(i)},r.onError=function(e){var i=t.GeolocationEvent.UNAVAILABLE;e.code==e.PERMISSION_DENIED&&(i=t.GeolocationEvent.PERMISSION_DENIED);var n=new t.GeolocationEvent(t.IOErrorEvent.IO_ERROR);n.errorType=i,n.errorMessage=e.message,r.dispatchEvent(n)},r.geolocation=navigator.geolocation,r}return r(i,e),i.prototype.start=function(){var e=this.geolocation;e?this.watchId=e.watchPosition(this.onUpdate,this.onError):this.onError({code:2,message:t.sys.tr(3004),PERMISSION_DENIED:1,POSITION_UNAVAILABLE:2})},i.prototype.stop=function(){this.geolocation.clearWatch(this.watchId)},i}(t.EventDispatcher);e.WebGeolocation=n,i(n.prototype,"egret.web.WebGeolocation",["egret.Geolocation"]),t.Geolocation=t.web.WebGeolocation}(t.web||(t.web={}))}(f||(f={})),function(t){!function(e){var n=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.onChange=function(e){var r=new t.MotionEvent(t.Event.CHANGE),n={x:e.acceleration.x,y:e.acceleration.y,z:e.acceleration.z},a={x:e.accelerationIncludingGravity.x,y:e.accelerationIncludingGravity.y,z:e.accelerationIncludingGravity.z},s={alpha:e.rotationRate.alpha,beta:e.rotationRate.beta,gamma:e.rotationRate.gamma};r.acceleration=n,r.accelerationIncludingGravity=a,r.rotationRate=s,i.dispatchEvent(r)},i}return r(i,e),i.prototype.start=function(){window.addEventListener("devicemotion",this.onChange)},i.prototype.stop=function(){window.removeEventListener("devicemotion",this.onChange)},i}(t.EventDispatcher);e.WebMotion=n,i(n.prototype,"egret.web.WebMotion",["egret.Motion"]),t.Motion=t.web.WebMotion}(t.web||(t.web={}))}(f||(f={})),function(t){!function(e){var i;Object.defineProperty(t.Logger,"logLevel",{set:function(e){switch(null==i&&(i={error:console.error,debug:console.debug,warn:console.warn,info:console.info,log:console.log}),e){case t.Logger.OFF:console.error=function(){};case t.Logger.ERROR:console.warn=function(){};case t.Logger.WARN:console.info=function(){},console.log=function(){};case t.Logger.INFO:console.debug=function(){}}switch(e){case t.Logger.ALL:case t.Logger.DEBUG:console.debug=i.debug;case t.Logger.INFO:console.log=i.log,console.info=i.info;case t.Logger.WARN:console.warn=i.warn;case t.Logger.ERROR:console.error=i.error}},enumerable:!0,configurable:!0})}(t.web||(t.web={}))}(f||(f={})),function(t){!function(t){var e=function(){function t(){this.drawData=[],this.drawDataLen=0}return t.prototype.pushDrawRect=function(){if(0==this.drawDataLen||1!=this.drawData[this.drawDataLen-1].type){var t=this.drawData[this.drawDataLen]||{};t.type=1,t.count=0,this.drawData[this.drawDataLen]=t,this.drawDataLen++}this.drawData[this.drawDataLen-1].count+=2},t.prototype.pushDrawTexture=function(t,e,i,r,n){var a;(void 0===e&&(e=2),i)?((a=this.drawData[this.drawDataLen]||{}).type=0,a.texture=t,a.filter=i,a.count=e,a.textureWidth=r,a.textureHeight=n,this.drawData[this.drawDataLen]=a,this.drawDataLen++):((0==this.drawDataLen||0!=this.drawData[this.drawDataLen-1].type||t!=this.drawData[this.drawDataLen-1].texture||this.drawData[this.drawDataLen-1].filter)&&((a=this.drawData[this.drawDataLen]||{}).type=0,a.texture=t,a.count=0,this.drawData[this.drawDataLen]=a,this.drawDataLen++),this.drawData[this.drawDataLen-1].count+=e)},t.prototype.pushChangeSmoothing=function(t,e){t.smoothing=e;var i=this.drawData[this.drawDataLen]||{};i.type=10,i.texture=t,i.smoothing=e,this.drawData[this.drawDataLen]=i,this.drawDataLen++},t.prototype.pushPushMask=function(t){void 0===t&&(t=1);var e=this.drawData[this.drawDataLen]||{};e.type=2,e.count=2*t,this.drawData[this.drawDataLen]=e,this.drawDataLen++},t.prototype.pushPopMask=function(t){void 0===t&&(t=1);var e=this.drawData[this.drawDataLen]||{};e.type=3,e.count=2*t,this.drawData[this.drawDataLen]=e,this.drawDataLen++},t.prototype.pushSetBlend=function(t){for(var e=!1,i=this.drawDataLen-1;i>=0;i--){var r=this.drawData[i];if(r){if(0!=r.type&&1!=r.type||(e=!0),!e&&4==r.type){this.drawData.splice(i,1),this.drawDataLen--;continue}if(4==r.type){if(r.value==t)return;break}}}var n=this.drawData[this.drawDataLen]||{};n.type=4,n.value=t,this.drawData[this.drawDataLen]=n,this.drawDataLen++},t.prototype.pushResize=function(t,e,i){var r=this.drawData[this.drawDataLen]||{};r.type=5,r.buffer=t,r.width=e,r.height=i,this.drawData[this.drawDataLen]=r,this.drawDataLen++},t.prototype.pushClearColor=function(){var t=this.drawData[this.drawDataLen]||{};t.type=6,this.drawData[this.drawDataLen]=t,this.drawDataLen++},t.prototype.pushActivateBuffer=function(t){for(var e=!1,i=this.drawDataLen-1;i>=0;i--){var r=this.drawData[i];!r||(4!=r.type&&7!=r.type&&(e=!0),e||7!=r.type)||(this.drawData.splice(i,1),this.drawDataLen--)}var n=this.drawData[this.drawDataLen]||{};n.type=7,n.buffer=t,n.width=t.rootRenderTarget.width,n.height=t.rootRenderTarget.height,this.drawData[this.drawDataLen]=n,this.drawDataLen++},t.prototype.pushEnableScissor=function(t,e,i,r){var n=this.drawData[this.drawDataLen]||{};n.type=8,n.x=t,n.y=e,n.width=i,n.height=r,this.drawData[this.drawDataLen]=n,this.drawDataLen++},t.prototype.pushDisableScissor=function(){var t=this.drawData[this.drawDataLen]||{};t.type=9,this.drawData[this.drawDataLen]=t,this.drawDataLen++},t.prototype.clear=function(){for(var t=0;t<this.drawDataLen;t++){var e=this.drawData[t];e.type=0,e.count=0,e.texture=null,e.filter=null,e.uv=null,e.value="",e.buffer=null,e.width=0,e.height=0}this.drawDataLen=0},t}();t.WebGLDrawCmdManager=e,i(e.prototype,"egret.web.WebGLDrawCmdManager")}(t.web||(t.web={}))}(f||(f={})),function(t){!function(t){var e=function(){function t(){this.size=2e3,this.vertexMaxSize=4*this.size,this.indicesMaxSize=6*this.size,this.vertSize=5,this.vertices=null,this.indices=null,this.indicesForMesh=null,this.vertexIndex=0,this.indexIndex=0,this.hasMesh=!1;var t=this.vertexMaxSize*this.vertSize,e=this.indicesMaxSize;this.vertices=new Float32Array(t),this.indices=new Uint16Array(e),this.indicesForMesh=new Uint16Array(e);for(var i=0,r=0;i<e;i+=6,r+=4)this.indices[i+0]=r+0,this.indices[i+1]=r+1,this.indices[i+2]=r+2,this.indices[i+3]=r+0,this.indices[i+4]=r+2,this.indices[i+5]=r+3}return t.prototype.reachMaxSize=function(t,e){return void 0===t&&(t=4),void 0===e&&(e=6),this.vertexIndex>this.vertexMaxSize-t||this.indexIndex>this.indicesMaxSize-e},t.prototype.getVertices=function(){return this.vertices.subarray(0,this.vertexIndex*this.vertSize)},t.prototype.getIndices=function(){return this.indices},t.prototype.getMeshIndices=function(){return this.indicesForMesh},t.prototype.changeToMeshIndices=function(){if(!this.hasMesh){for(var t=0,e=this.indexIndex;t<e;++t)this.indicesForMesh[t]=this.indices[t];this.hasMesh=!0}},t.prototype.isMesh=function(){return this.hasMesh},t.prototype.cacheArrays=function(t,e,i,r,n,a,s,o,h,l,u,c,p,f,d){var m=t.globalAlpha,g=t.globalMatrix,y=g.a,_=g.b,v=g.c,b=g.d,T=g.tx,x=g.ty,D=t.$offsetX,$=t.$offsetY;if(0==D&&0==$||(T=D*y+$*v+T,x=D*_+$*b+x),!p){0==a&&0==s||(T=a*y+s*v+T,x=a*_+s*b+x);var E=o/r;1!=E&&(y*=E,_*=E);var w=h/n;1!=w&&(v*=w,b*=w)}if(p){var A,S=this.vertices,O=this.vertexIndex*this.vertSize,C=0,P=0,R=0,M=0,I=0,B=0;for(C=0,A=c.length;C<A;C+=2)P=O+5*C/2,I=p[C],B=p[C+1],R=c[C],M=c[C+1],S[P+0]=y*I+v*B+T,S[P+1]=_*I+b*B+x,d?(S[P+2]=(e+(1-M)*n)/l,S[P+3]=(i+R*r)/u):(S[P+2]=(e+R*r)/l,S[P+3]=(i+M*n)/u),S[P+4]=m;if(this.hasMesh)for(var F=0,L=f.length;F<L;++F)this.indicesForMesh[this.indexIndex+F]=f[F]+this.vertexIndex;this.vertexIndex+=c.length/2,this.indexIndex+=f.length}else{var N=l,k=u,j=r,U=n;if(e/=N,i/=k,S=this.vertices,O=this.vertexIndex*this.vertSize,d){var H=r;r=n/N,n=H/k,S[O++]=T,S[O++]=x,S[O++]=r+e,S[O++]=i,S[O++]=m,S[O++]=y*j+T,S[O++]=_*j+x,S[O++]=r+e,S[O++]=n+i,S[O++]=m,S[O++]=y*j+v*U+T,S[O++]=b*U+_*j+x,S[O++]=e,S[O++]=n+i,S[O++]=m,S[O++]=v*U+T,S[O++]=b*U+x,S[O++]=e,S[O++]=i,S[O++]=m}else r/=N,n/=k,S[O++]=T,S[O++]=x,S[O++]=e,S[O++]=i,S[O++]=m,S[O++]=y*j+T,S[O++]=_*j+x,S[O++]=r+e,S[O++]=i,S[O++]=m,S[O++]=y*j+v*U+T,S[O++]=b*U+_*j+x,S[O++]=r+e,S[O++]=n+i,S[O++]=m,S[O++]=v*U+T,S[O++]=b*U+x,S[O++]=e,S[O++]=n+i,S[O++]=m;if(this.hasMesh){var W=this.indicesForMesh;W[this.indexIndex+0]=0+this.vertexIndex,W[this.indexIndex+1]=1+this.vertexIndex,W[this.indexIndex+2]=2+this.vertexIndex,W[this.indexIndex+3]=0+this.vertexIndex,W[this.indexIndex+4]=2+this.vertexIndex,W[this.indexIndex+5]=3+this.vertexIndex}this.vertexIndex+=4,this.indexIndex+=6}},t.prototype.clear=function(){this.hasMesh=!1,this.vertexIndex=0,this.indexIndex=0},t}();t.WebGLVertexArrayObject=e,i(e.prototype,"egret.web.WebGLVertexArrayObject")}(t.web||(t.web={}))}(f||(f={})),function(t){!function(e){var n=function(e){function i(t,i,r){var n=e.call(this)||this;return n.clearColor=[0,0,0,0],n.useFrameBuffer=!0,n.gl=t,n.width=i||1,n.height=r||1,n}return r(i,e),i.prototype.resize=function(t,e){var i=this.gl;this.width=t,this.height=e,this.frameBuffer&&(i.bindTexture(i.TEXTURE_2D,this.texture),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,t,e,0,i.RGBA,i.UNSIGNED_BYTE,null)),this.stencilBuffer&&(i.deleteRenderbuffer(this.stencilBuffer),this.stencilBuffer=null)},i.prototype.activate=function(){var t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,this.getFrameBuffer())},i.prototype.getFrameBuffer=function(){return this.useFrameBuffer?this.frameBuffer:null},i.prototype.initFrameBuffer=function(){if(!this.frameBuffer){var t=this.gl;this.texture=this.createTexture(),this.frameBuffer=t.createFramebuffer(),t.bindFramebuffer(t.FRAMEBUFFER,this.frameBuffer),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.texture,0)}},i.prototype.createTexture=function(){var t=this.gl,e=t.createTexture();return e.glContext=t,t.bindTexture(t.TEXTURE_2D,e),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.width,this.height,0,t.RGBA,t.UNSIGNED_BYTE,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),e},i.prototype.clear=function(t){var e=this.gl;t&&this.activate(),e.colorMask(!0,!0,!0,!0),e.clearColor(this.clearColor[0],this.clearColor[1],this.clearColor[2],this.clearColor[3]),e.clear(e.COLOR_BUFFER_BIT)},i.prototype.enabledStencil=function(){if(this.frameBuffer&&!this.stencilBuffer){var t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,this.frameBuffer),this.stencilBuffer=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,this.stencilBuffer),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,this.width,this.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,this.stencilBuffer)}},i.prototype.dispose=function(){t.WebGLUtils.deleteWebGLTexture(this.texture)},i}(t.HashObject);e.WebGLRenderTarget=n,i(n.prototype,"egret.web.WebGLRenderTarget")}(t.web||(t.web={}))}(f||(f={})),function(t){!function(e){var r=function(){function i(i,r){if(this.glID=null,this.projectionX=NaN,this.projectionY=NaN,this.contextLost=!1,this.$scissorState=!1,this.vertSize=5,this.surface=function(t,e){var i=document.createElement("canvas");return isNaN(t)||isNaN(e)||(i.width=t,i.height=e),i}(i,r),!t.nativeRender){this.initWebGL(),this.$bufferStack=[];var n=this.context;this.vertexBuffer=n.createBuffer(),this.indexBuffer=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,this.vertexBuffer),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this.indexBuffer),this.drawCmdManager=new e.WebGLDrawCmdManager,this.vao=new e.WebGLVertexArrayObject,this.setGlobalCompositeOperation("source-over")}}return i.getInstance=function(t,e){return this.instance?this.instance:(this.instance=new i(t,e),this.instance)},i.prototype.pushBuffer=function(t){this.$bufferStack.push(t),t!=this.currentBuffer&&(this.currentBuffer,this.drawCmdManager.pushActivateBuffer(t)),this.currentBuffer=t},i.prototype.popBuffer=function(){if(!(this.$bufferStack.length<=1)){var t=this.$bufferStack.pop(),e=this.$bufferStack[this.$bufferStack.length-1];t!=e&&this.drawCmdManager.pushActivateBuffer(e),this.currentBuffer=e}},i.prototype.activateBuffer=function(t,e,i){t.rootRenderTarget.activate(),this.bindIndices||this.uploadIndicesArray(this.vao.getIndices()),t.restoreStencil(),t.restoreScissor(),this.onResize(e,i)},i.prototype.uploadVerticesArray=function(t){var e=this.context;e.bufferData(e.ARRAY_BUFFER,t,e.STREAM_DRAW)},i.prototype.uploadIndicesArray=function(t){var e=this.context;e.bufferData(e.ELEMENT_ARRAY_BUFFER,t,e.STATIC_DRAW),this.bindIndices=!0},i.prototype.destroy=function(){this.surface.width=this.surface.height=0},i.prototype.onResize=function(t,e){t=t||this.surface.width,e=e||this.surface.height,this.projectionX=t/2,this.projectionY=-e/2,this.context&&this.context.viewport(0,0,t,e)},i.prototype.resize=function(t,e,i){var r=this.surface;i?(r.width<t&&(r.width=t),r.height<e&&(r.height=e)):(r.width!=t&&(r.width=t),r.height!=e&&(r.height=e)),this.onResize()},i.prototype.initWebGL=function(){this.onResize(),this.surface.addEventListener("webglcontextlost",this.handleContextLost.bind(this),!1),this.surface.addEventListener("webglcontextrestored",this.handleContextRestored.bind(this),!1),this.getWebGLContext();var t=this.context;this.$maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE)},i.prototype.handleContextLost=function(){this.contextLost=!0},i.prototype.handleContextRestored=function(){this.initWebGL(),this.contextLost=!1},i.prototype.getWebGLContext=function(){for(var e,r={antialias:i.antialias,stencil:!0},n=["webgl","experimental-webgl"],a=0;a<n.length;a++){try{e=this.surface.getContext(n[a],r)}catch(t){}if(e)break}e||t.$error(1021),this.setContext(e)},i.prototype.setContext=function(t){this.context=t,t.id=i.glContextId++,this.glID=t.id,t.disable(t.DEPTH_TEST),t.disable(t.CULL_FACE),t.enable(t.BLEND),t.colorMask(!0,!0,!0,!0),t.activeTexture(t.TEXTURE0)},i.prototype.enableStencilTest=function(){var t=this.context;t.enable(t.STENCIL_TEST)},i.prototype.disableStencilTest=function(){var t=this.context;t.disable(t.STENCIL_TEST)},i.prototype.enableScissorTest=function(t){var e=this.context;e.enable(e.SCISSOR_TEST),e.scissor(t.x,t.y,t.width,t.height)},i.prototype.disableScissorTest=function(){var t=this.context;t.disable(t.SCISSOR_TEST)},i.prototype.getPixels=function(t,e,i,r,n){var a=this.context;a.readPixels(t,e,i,r,a.RGBA,a.UNSIGNED_BYTE,n)},i.prototype.createTexture=function(t){var e=this.context,i=e.createTexture();if(i)return i.glContext=e,e.bindTexture(e.TEXTURE_2D,i),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),i;this.contextLost=!0},i.prototype.createTextureFromCompressedData=function(t,e,i,r,n){return null},i.prototype.updateTexture=function(t,e){var i=this.context;i.bindTexture(i.TEXTURE_2D,t),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,e)},i.prototype.getWebGLTexture=function(t){return t.webGLTexture||("image"==t.format?t.webGLTexture=this.createTexture(t.source):"pvr"==t.format&&(t.webGLTexture=this.createTextureFromCompressedData(t.source.pvrtcData,t.width,t.height,t.source.mipmapsCount,t.source.format)),t.$deleteSource&&t.webGLTexture&&(t.source=null),t.webGLTexture&&(t.webGLTexture.smoothing=!0)),t.webGLTexture},i.prototype.clearRect=function(t,e,i,r){if(0!=t||0!=e||i!=this.surface.width||r!=this.surface.height){var n=this.currentBuffer;if(n.$hasScissor)this.setGlobalCompositeOperation("destination-out"),this.drawRect(t,e,i,r),this.setGlobalCompositeOperation("source-over");else{var a=n.globalMatrix;0==a.b&&0==a.c?(t=t*a.a+a.tx,e=e*a.d+a.ty,i*=a.a,r*=a.d,this.enableScissor(t,-e-r+n.height,i,r),this.clear(),this.disableScissor()):(this.setGlobalCompositeOperation("destination-out"),this.drawRect(t,e,i,r),this.setGlobalCompositeOperation("source-over"))}}else this.clear()},i.prototype.setGlobalCompositeOperation=function(t){this.drawCmdManager.pushSetBlend(t)},i.prototype.drawImage=function(t,e,i,r,n,a,s,o,h,l,u,c,p){var f=this.currentBuffer;if(!this.contextLost&&t&&f){var d,m,g;if(t.texture||t.source&&t.source.texture)d=t.texture||t.source.texture,f.saveTransform(),m=f.$offsetX,g=f.$offsetY,f.useOffset(),f.transform(1,0,0,-1,0,h+2*s);else{if(!t.source&&!t.webGLTexture)return;d=this.getWebGLTexture(t)}d&&(this.drawTexture(d,e,i,r,n,a,s,o,h,l,u,void 0,void 0,void 0,void 0,c,p),t.source&&t.source.texture&&(f.$offsetX=m,f.$offsetY=g,f.restoreTransform()))}},i.prototype.drawMesh=function(t,e,i,r,n,a,s,o,h,l,u,c,p,f,d,m,g){var y=this.currentBuffer;if(!this.contextLost&&t&&y){var _,v,b;if(t.texture||t.source&&t.source.texture)_=t.texture||t.source.texture,y.saveTransform(),v=y.$offsetX,b=y.$offsetY,y.useOffset(),y.transform(1,0,0,-1,0,h+2*s);else{if(!t.source&&!t.webGLTexture)return;_=this.getWebGLTexture(t)}_&&(this.drawTexture(_,e,i,r,n,a,s,o,h,l,u,c,p,f,d,m,g),(t.texture||t.source&&t.source.texture)&&(y.$offsetX=v,y.$offsetY=b,y.restoreTransform()))}},i.prototype.drawTexture=function(t,e,i,r,n,a,s,o,h,l,u,c,p,f,d,m,g){var y=this.currentBuffer;if(!this.contextLost&&t&&y){p&&f?this.vao.reachMaxSize(p.length/2,f.length)&&this.$drawWebGL():this.vao.reachMaxSize()&&this.$drawWebGL(),void 0!=g&&t.smoothing!=g&&this.drawCmdManager.pushChangeSmoothing(t,g),c&&this.vao.changeToMeshIndices();var _=f?f.length/3:2;this.drawCmdManager.pushDrawTexture(t,_,this.$filter,l,u),this.vao.cacheArrays(y,e,i,r,n,a,s,o,h,l,u,c,p,f,m)}},i.prototype.drawRect=function(t,e,i,r){var n=this.currentBuffer;!this.contextLost&&n&&(this.vao.reachMaxSize()&&this.$drawWebGL(),this.drawCmdManager.pushDrawRect(),this.vao.cacheArrays(n,0,0,i,r,t,e,i,r,i,r))},i.prototype.pushMask=function(t,e,i,r){var n=this.currentBuffer;!this.contextLost&&n&&(n.$stencilList.push({x:t,y:e,width:i,height:r}),this.vao.reachMaxSize()&&this.$drawWebGL(),this.drawCmdManager.pushPushMask(),this.vao.cacheArrays(n,0,0,i,r,t,e,i,r,i,r))},i.prototype.popMask=function(){var t=this.currentBuffer;if(!this.contextLost&&t){var e=t.$stencilList.pop();this.vao.reachMaxSize()&&this.$drawWebGL(),this.drawCmdManager.pushPopMask(),this.vao.cacheArrays(t,0,0,e.width,e.height,e.x,e.y,e.width,e.height,e.width,e.height)}},i.prototype.clear=function(){this.drawCmdManager.pushClearColor()},i.prototype.enableScissor=function(t,e,i,r){var n=this.currentBuffer;this.drawCmdManager.pushEnableScissor(t,e,i,r),n.$hasScissor=!0},i.prototype.disableScissor=function(){var t=this.currentBuffer;this.drawCmdManager.pushDisableScissor(),t.$hasScissor=!1},i.prototype.$drawWebGL=function(){if(0!=this.drawCmdManager.drawDataLen&&!this.contextLost){this.uploadVerticesArray(this.vao.getVertices()),this.vao.isMesh()&&this.uploadIndicesArray(this.vao.getMeshIndices());for(var t=this.drawCmdManager.drawDataLen,e=0,i=0;i<t;i++){var r=this.drawCmdManager.drawData[i];e=this.drawData(r,e),7==r.type&&(this.activatedBuffer=r.buffer),0!=r.type&&1!=r.type&&2!=r.type&&3!=r.type||this.activatedBuffer&&this.activatedBuffer.$computeDrawCall&&this.activatedBuffer.$drawCalls++}this.vao.isMesh()&&this.uploadIndicesArray(this.vao.getIndices()),this.drawCmdManager.clear(),this.vao.clear()}},i.prototype.drawData=function(t,i){if(t){var r,n=this.context,a=t.filter;switch(t.type){case 0:a?"custom"===a.type?r=e.EgretWebGLProgram.getProgram(n,a.$vertexSrc,a.$fragmentSrc,a.$shaderKey):"colorTransform"===a.type?r=e.EgretWebGLProgram.getProgram(n,e.EgretShaderLib.default_vert,e.EgretShaderLib.colorTransform_frag,"colorTransform"):"blurX"===a.type?r=e.EgretWebGLProgram.getProgram(n,e.EgretShaderLib.default_vert,e.EgretShaderLib.blur_frag,"blur"):"blurY"===a.type?r=e.EgretWebGLProgram.getProgram(n,e.EgretShaderLib.default_vert,e.EgretShaderLib.blur_frag,"blur"):"glow"===a.type&&(r=e.EgretWebGLProgram.getProgram(n,e.EgretShaderLib.default_vert,e.EgretShaderLib.glow_frag,"glow")):r=e.EgretWebGLProgram.getProgram(n,e.EgretShaderLib.default_vert,e.EgretShaderLib.texture_frag,"texture"),this.activeProgram(n,r),this.syncUniforms(r,a,t.textureWidth,t.textureHeight),i+=this.drawTextureElements(t,i);break;case 1:r=e.EgretWebGLProgram.getProgram(n,e.EgretShaderLib.default_vert,e.EgretShaderLib.primitive_frag,"primitive"),this.activeProgram(n,r),this.syncUniforms(r,a,t.textureWidth,t.textureHeight),i+=this.drawRectElements(t,i);break;case 2:r=e.EgretWebGLProgram.getProgram(n,e.EgretShaderLib.default_vert,e.EgretShaderLib.primitive_frag,"primitive"),this.activeProgram(n,r),this.syncUniforms(r,a,t.textureWidth,t.textureHeight),i+=this.drawPushMaskElements(t,i);break;case 3:r=e.EgretWebGLProgram.getProgram(n,e.EgretShaderLib.default_vert,e.EgretShaderLib.primitive_frag,"primitive"),this.activeProgram(n,r),this.syncUniforms(r,a,t.textureWidth,t.textureHeight),i+=this.drawPopMaskElements(t,i);break;case 4:this.setBlendMode(t.value);break;case 5:t.buffer.rootRenderTarget.resize(t.width,t.height),this.onResize(t.width,t.height);break;case 6:if(this.activatedBuffer){var s=this.activatedBuffer.rootRenderTarget;0==s.width&&0==s.height||s.clear(!0)}break;case 7:this.activateBuffer(t.buffer,t.width,t.height);break;case 8:var o=this.activatedBuffer;o&&(o.rootRenderTarget&&o.rootRenderTarget.enabledStencil(),o.enableScissor(t.x,t.y,t.width,t.height));break;case 9:(o=this.activatedBuffer)&&o.disableScissor();break;case 10:n.bindTexture(n.TEXTURE_2D,t.texture),t.smoothing?(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR)):(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.NEAREST))}return i}},i.prototype.activeProgram=function(t,e){if(e!=this.currentProgram){t.useProgram(e.id);var i=e.attributes;for(var r in i)"aVertexPosition"===r?(t.vertexAttribPointer(i.aVertexPosition.location,2,t.FLOAT,!1,20,0),t.enableVertexAttribArray(i.aVertexPosition.location)):"aTextureCoord"===r?(t.vertexAttribPointer(i.aTextureCoord.location,2,t.FLOAT,!1,20,8),t.enableVertexAttribArray(i.aTextureCoord.location)):"aColor"===r&&(t.vertexAttribPointer(i.aColor.location,1,t.FLOAT,!1,20,16),t.enableVertexAttribArray(i.aColor.location));this.currentProgram=e}},i.prototype.syncUniforms=function(t,e,i,r){var n=t.uniforms;for(var a in e&&e.type,n)if("projectionVector"===a)n[a].setValue({x:this.projectionX,y:this.projectionY});else if("uTextureSize"===a)n[a].setValue({x:i,y:r});else if("uSampler"===a);else{var s=e.$uniforms[a];void 0!==s&&n[a].setValue(s)}},i.prototype.drawTextureElements=function(t,e){var i=this.context;i.bindTexture(i.TEXTURE_2D,t.texture);var r=3*t.count;return i.drawElements(i.TRIANGLES,r,i.UNSIGNED_SHORT,2*e),r},i.prototype.drawRectElements=function(t,e){var i=this.context,r=3*t.count;return i.drawElements(i.TRIANGLES,r,i.UNSIGNED_SHORT,2*e),r},i.prototype.drawPushMaskElements=function(t,e){var i=this.context,r=3*t.count,n=this.activatedBuffer;if(n){n.rootRenderTarget&&n.rootRenderTarget.enabledStencil(),0==n.stencilHandleCount&&(n.enableStencil(),i.clear(i.STENCIL_BUFFER_BIT));var a=n.stencilHandleCount;n.stencilHandleCount++,i.colorMask(!1,!1,!1,!1),i.stencilFunc(i.EQUAL,a,255),i.stencilOp(i.KEEP,i.KEEP,i.INCR),i.drawElements(i.TRIANGLES,r,i.UNSIGNED_SHORT,2*e),i.stencilFunc(i.EQUAL,a+1,255),i.colorMask(!0,!0,!0,!0),i.stencilOp(i.KEEP,i.KEEP,i.KEEP)}return r},i.prototype.drawPopMaskElements=function(t,e){var i=this.context,r=3*t.count,n=this.activatedBuffer;if(n)if(n.stencilHandleCount--,0==n.stencilHandleCount)n.disableStencil();else{var a=n.stencilHandleCount;i.colorMask(!1,!1,!1,!1),i.stencilFunc(i.EQUAL,a+1,255),i.stencilOp(i.KEEP,i.KEEP,i.DECR),i.drawElements(i.TRIANGLES,r,i.UNSIGNED_SHORT,2*e),i.stencilFunc(i.EQUAL,a,255),i.colorMask(!0,!0,!0,!0),i.stencilOp(i.KEEP,i.KEEP,i.KEEP)}return r},i.prototype.setBlendMode=function(t){var e=this.context,r=i.blendModesForGL[t];r&&e.blendFunc(r[0],r[1])},i.prototype.drawTargetWidthFilters=function(t,i){var r,n=i,a=t.length;if(a>1)for(var s=0;s<a-1;s++){var o=t[s],h=i.rootRenderTarget.width,l=i.rootRenderTarget.height;(r=e.WebGLRenderBuffer.create(h,l)).setTransform(1,0,0,1,0,0),r.globalAlpha=1,this.drawToRenderTarget(o,i,r),i!=n&&e.WebGLRenderBuffer.release(i),i=r}var u=t[a-1];this.drawToRenderTarget(u,i,this.currentBuffer),i!=n&&e.WebGLRenderBuffer.release(i)},i.prototype.drawToRenderTarget=function(t,i,r){if(!this.contextLost){this.vao.reachMaxSize()&&this.$drawWebGL(),this.pushBuffer(r);var n,a=i,s=i.rootRenderTarget.width,o=i.rootRenderTarget.height;if("blur"==t.type){var h=t.blurXFilter,l=t.blurYFilter;0!=h.blurX&&0!=l.blurY?((n=e.WebGLRenderBuffer.create(s,o)).setTransform(1,0,0,1,0,0),n.globalAlpha=1,this.drawToRenderTarget(t.blurXFilter,i,n),i!=a&&e.WebGLRenderBuffer.release(i),i=n,t=l):t=0===h.blurX?l:h}r.saveTransform(),r.transform(1,0,0,-1,0,o),this.vao.cacheArrays(r,0,0,s,o,0,0,s,o,s,o),r.restoreTransform(),this.drawCmdManager.pushDrawTexture(i.rootRenderTarget.texture,2,t,s,o),i!=a&&e.WebGLRenderBuffer.release(i),this.popBuffer()}},i.initBlendMode=function(){i.blendModesForGL={},i.blendModesForGL["source-over"]=[1,771],i.blendModesForGL.lighter=[1,1],i.blendModesForGL["lighter-in"]=[770,771],i.blendModesForGL["destination-out"]=[0,771],i.blendModesForGL["destination-in"]=[0,770]},i.glContextId=0,i.blendModesForGL=null,i}();e.WebGLRenderContext=r,i(r.prototype,"egret.web.WebGLRenderContext"),r.initBlendMode()}(t.web||(t.web={}))}(f||(f={})),function(t){!function(e){var n=function(i){function n(r,n,a){var s=i.call(this)||this;if(s.globalAlpha=1,s.stencilState=!1,s.$stencilList=[],s.stencilHandleCount=0,s.$scissorState=!1,s.scissorRect=new t.Rectangle,s.$hasScissor=!1,s.$drawCalls=0,s.$computeDrawCall=!1,s.globalMatrix=new t.Matrix,s.savedGlobalMatrix=new t.Matrix,s.$offsetX=0,s.$offsetY=0,s.context=e.WebGLRenderContext.getInstance(r,n),t.nativeRender)return s.surface=a?s.context.surface:new egret_native.NativeRenderSurface(s,r,n,a),s.rootRenderTarget=null,s;if(s.rootRenderTarget=new e.WebGLRenderTarget(s.context.context,3,3),r&&n&&s.resize(r,n),s.root=a,s.root)s.context.pushBuffer(s),s.surface=s.context.surface,s.$computeDrawCall=!0;else{var o=s.context.activatedBuffer;o&&o.rootRenderTarget.activate(),s.rootRenderTarget.initFrameBuffer(),s.surface=s.rootRenderTarget}return s}return r(n,i),n.prototype.enableStencil=function(){this.stencilState||(this.context.enableStencilTest(),this.stencilState=!0)},n.prototype.disableStencil=function(){this.stencilState&&(this.context.disableStencilTest(),this.stencilState=!1)},n.prototype.restoreStencil=function(){this.stencilState?this.context.enableStencilTest():this.context.disableStencilTest()},n.prototype.enableScissor=function(t,e,i,r){this.$scissorState||(this.$scissorState=!0,this.scissorRect.setTo(t,e,i,r),this.context.enableScissorTest(this.scissorRect))},n.prototype.disableScissor=function(){this.$scissorState&&(this.$scissorState=!1,this.scissorRect.setEmpty(),this.context.disableScissorTest())},n.prototype.restoreScissor=function(){this.$scissorState?this.context.enableScissorTest(this.scissorRect):this.context.disableScissorTest()},Object.defineProperty(n.prototype,"width",{get:function(){return t.nativeRender?this.surface.width:this.rootRenderTarget.width},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return t.nativeRender?this.surface.height:this.rootRenderTarget.height},enumerable:!0,configurable:!0}),n.prototype.resize=function(e,i,r){e=e||1,i=i||1,t.nativeRender?this.surface.resize(e,i):(this.context.pushBuffer(this),e==this.rootRenderTarget.width&&i==this.rootRenderTarget.height||(this.context.drawCmdManager.pushResize(this,e,i),this.rootRenderTarget.width=e,this.rootRenderTarget.height=i),this.root&&this.context.resize(e,i,r),this.context.clear(),this.context.popBuffer())},n.prototype.getPixels=function(e,i,r,n){void 0===r&&(r=1),void 0===n&&(n=1);var a=new Uint8Array(4*r*n);if(t.nativeRender)egret_native.activateBuffer(this),egret_native.nrGetPixels(e,i,r,n,a),egret_native.activateBuffer(null);else{var s=this.rootRenderTarget.useFrameBuffer;this.rootRenderTarget.useFrameBuffer=!0,this.rootRenderTarget.activate(),this.context.getPixels(e,i,r,n,a),this.rootRenderTarget.useFrameBuffer=s,this.rootRenderTarget.activate()}for(var o=new Uint8Array(4*r*n),h=0;h<n;h++)for(var l=0;l<r;l++){var u=4*(r*(n-h-1)+l),c=4*(r*h+l),p=a[c+3];o[u]=Math.round(a[c]/p*255),o[u+1]=Math.round(a[c+1]/p*255),o[u+2]=Math.round(a[c+2]/p*255),o[u+3]=a[c+3]}return o},n.prototype.toDataURL=function(t,e){return this.context.surface.toDataURL(t,e)},n.prototype.destroy=function(){this.context.destroy()},n.prototype.onRenderFinish=function(){this.$drawCalls=0},n.prototype.drawFrameBufferToSurface=function(t,e,i,r,n,a,s,o,h){void 0===h&&(h=!1),this.rootRenderTarget.useFrameBuffer=!1,this.rootRenderTarget.activate(),this.context.disableStencilTest(),this.context.disableScissorTest(),this.setTransform(1,0,0,1,0,0),this.globalAlpha=1,this.context.setGlobalCompositeOperation("source-over"),h&&this.context.clear(),this.context.drawImage(this.rootRenderTarget,t,e,i,r,n,a,s,o,i,r,!1),this.context.$drawWebGL(),this.rootRenderTarget.useFrameBuffer=!0,this.rootRenderTarget.activate(),this.restoreStencil(),this.restoreScissor()},n.prototype.drawSurfaceToFrameBuffer=function(t,e,i,r,n,a,s,o,h){void 0===h&&(h=!1),this.rootRenderTarget.useFrameBuffer=!0,this.rootRenderTarget.activate(),this.context.disableStencilTest(),this.context.disableScissorTest(),this.setTransform(1,0,0,1,0,0),this.globalAlpha=1,this.context.setGlobalCompositeOperation("source-over"),h&&this.context.clear(),this.context.drawImage(this.context.surface,t,e,i,r,n,a,s,o,i,r,!1),this.context.$drawWebGL(),this.rootRenderTarget.useFrameBuffer=!1,this.rootRenderTarget.activate(),this.restoreStencil(),this.restoreScissor()},n.prototype.clear=function(){this.context.pushBuffer(this),this.context.clear(),this.context.popBuffer()},n.prototype.setTransform=function(t,e,i,r,n,a){var s=this.globalMatrix;s.a=t,s.b=e,s.c=i,s.d=r,s.tx=n,s.ty=a},n.prototype.transform=function(t,e,i,r,n,a){var s=this.globalMatrix,o=s.a,h=s.b,l=s.c,u=s.d;1==t&&0==e&&0==i&&1==r||(s.a=t*o+e*l,s.b=t*h+e*u,s.c=i*o+r*l,s.d=i*h+r*u),s.tx=n*o+a*l+s.tx,s.ty=n*h+a*u+s.ty},n.prototype.useOffset=function(){0==this.$offsetX&&0==this.$offsetY||(this.globalMatrix.append(1,0,0,1,this.$offsetX,this.$offsetY),this.$offsetX=this.$offsetY=0)},n.prototype.saveTransform=function(){var t=this.globalMatrix,e=this.savedGlobalMatrix;e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e.tx=t.tx,e.ty=t.ty},n.prototype.restoreTransform=function(){var t=this.globalMatrix,e=this.savedGlobalMatrix;t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t.tx=e.tx,t.ty=e.ty},n.create=function(t,e){var i=a.pop();if(i){i.resize(t,e);var r=i.globalMatrix;r.a=1,r.b=0,r.c=0,r.d=1,r.tx=0,r.ty=0,i.globalAlpha=1,i.$offsetX=0,i.$offsetY=0}else(i=new n(t,e)).$computeDrawCall=!1;return i},n.release=function(t){a.push(t)},n.autoClear=!0,n}(t.HashObject);e.WebGLRenderBuffer=n,i(n.prototype,"egret.web.WebGLRenderBuffer",["egret.sys.RenderBuffer"]);var a=[]}(t.web||(t.web={}))}(f||(f={})),function(t){!function(e){var r=["source-over","lighter","destination-out"],n=[],a=function(){function i(){this.nestLevel=0}return i.prototype.render=function(e,i,r,a){this.nestLevel++;var s=i,o=s.context;o.pushBuffer(s),s.transform(r.a,r.b,r.c,r.d,0,0),this.drawDisplayObject(e,s,r.tx,r.ty,!0),o.$drawWebGL();var h=s.$drawCalls;s.onRenderFinish(),o.popBuffer();var l=t.Matrix.create();if(r.$invertInto(l),s.transform(l.a,l.b,l.c,l.d,0,0),t.Matrix.release(l),this.nestLevel--,0===this.nestLevel){n.length>6&&(n.length=6);for(var u=n.length,c=0;c<u;c++)n[c].resize(0,0)}return h},i.prototype.drawDisplayObject=function(e,i,r,n,a){var s,o=0,h=e.$displayList;if(h&&!a?((e.$cacheDirty||e.$renderDirty||h.$canvasScaleX!=t.sys.DisplayList.$canvasScaleX||h.$canvasScaleY!=t.sys.DisplayList.$canvasScaleY)&&(o+=h.drawToSurface()),s=h.$renderNode):s=e.$renderDirty?e.$getRenderNode():e.$renderNode,e.$cacheDirty=!1,s){switch(o++,i.$offsetX=r,i.$offsetY=n,s.type){case 1:this.renderBitmap(s,i);break;case 2:this.renderText(s,i);break;case 3:this.renderGraphics(s,i);break;case 4:this.renderGroup(s,i);break;case 5:this.renderMesh(s,i);break;case 6:this.renderNormalBitmap(s,i)}i.$offsetX=0,i.$offsetY=0}if(h&&!a)return o;var l=e.$children;if(l)for(var u=l.length,c=0;c<u;c++){var p=l[c],f=void 0,d=void 0,m=void 0;1!=p.$alpha&&(m=i.globalAlpha,i.globalAlpha*=p.$alpha);var g=void 0;if(p.$useTranslate){var y=p.$getMatrix();f=r+p.$x,d=n+p.$y;var _=i.globalMatrix;(g=t.Matrix.create()).a=_.a,g.b=_.b,g.c=_.c,g.d=_.d,g.tx=_.tx,g.ty=_.ty,i.transform(y.a,y.b,y.c,y.d,f,d),f=-p.$anchorOffsetX,d=-p.$anchorOffsetY}else f=r+p.$x-p.$anchorOffsetX,d=n+p.$y-p.$anchorOffsetY;switch(p.$renderMode){case 1:break;case 2:o+=this.drawWithFilter(p,i,f,d);break;case 3:o+=this.drawWithClip(p,i,f,d);break;case 4:o+=this.drawWithScrollRect(p,i,f,d);break;default:o+=this.drawDisplayObject(p,i,f,d)}m&&(i.globalAlpha=m),g&&((y=i.globalMatrix).a=g.a,y.b=g.b,y.c=g.c,y.d=g.d,y.tx=g.tx,y.ty=g.ty,t.Matrix.release(g))}return o},i.prototype.drawWithFilter=function(e,i,a,s){var o=0;if(e.$children&&0==e.$children.length&&(!e.$renderNode||0==e.$renderNode.$getRenderCount()))return o;var h,l=e.$filters,u=0!==e.$blendMode;u&&((h=r[e.$blendMode])||(h="source-over"));var c=e.$getOriginalBounds(),p=c.x,f=c.y,d=c.width,m=c.height;if(d<=0||m<=0)return o;if(!e.mask&&1==l.length&&("colorTransform"==l[0].type||"custom"===l[0].type&&0===l[0].padding)){var g=this.getRenderCount(e);if(!e.$children||1==g)return u&&i.context.setGlobalCompositeOperation(h),i.context.$filter=l[0],e.$mask?o+=this.drawWithClip(e,i,a,s):e.$scrollRect||e.$maskRect?o+=this.drawWithScrollRect(e,i,a,s):o+=this.drawDisplayObject(e,i,a,s),i.context.$filter=null,u&&i.context.setGlobalCompositeOperation("source-over"),o}var y=this.createRenderBuffer(d,m);if(y.context.pushBuffer(y),e.$mask?o+=this.drawWithClip(e,y,-p,-f):e.$scrollRect||e.$maskRect?o+=this.drawWithScrollRect(e,y,-p,-f):o+=this.drawDisplayObject(e,y,-p,-f),y.context.popBuffer(),o>0){u&&i.context.setGlobalCompositeOperation(h),o++,i.$offsetX=a+p,i.$offsetY=s+f;var _=t.Matrix.create(),v=i.globalMatrix;_.a=v.a,_.b=v.b,_.c=v.c,_.d=v.d,_.tx=v.tx,_.ty=v.ty,i.useOffset(),i.context.drawTargetWidthFilters(l,y),v.a=_.a,v.b=_.b,v.c=_.c,v.d=_.d,v.tx=_.tx,v.ty=_.ty,t.Matrix.release(_),u&&i.context.setGlobalCompositeOperation("source-over")}return n.push(y),o},i.prototype.getRenderCount=function(t){var e=0,i=t.$getRenderNode();if(i&&(e+=i.$getRenderCount()),t.$children)for(var r=0,n=t.$children;r<n.length;r++){var a=n[r],s=a.$filters;if(s&&s.length>0)return 2;if(a.$children)e+=this.getRenderCount(a);else{var o=a.$getRenderNode();o&&(e+=o.$getRenderCount())}}return e},i.prototype.drawWithClip=function(e,i,a,s){var o,h=0,l=0!==e.$blendMode;l&&((o=r[e.$blendMode])||(o="source-over"));var u=e.$scrollRect?e.$scrollRect:e.$maskRect,c=e.$mask;if(c){var p=c.$getMatrix();if(0==p.a&&0==p.b||0==p.c&&0==p.d)return h}if(c||e.$children&&0!=e.$children.length){var f=e.$getOriginalBounds(),d=f.x,m=f.y,g=f.width,y=f.height;if(g<=0||y<=0)return h;var _=this.createRenderBuffer(g,y);if(_.context.pushBuffer(_),h+=this.drawDisplayObject(e,_,-d,-m),c){var v=this.createRenderBuffer(g,y);v.context.pushBuffer(v);var b=t.Matrix.create();b.copyFrom(c.$getConcatenatedMatrix()),c.$getConcatenatedMatrixAt(e,b),b.translate(-d,-m),v.setTransform(b.a,b.b,b.c,b.d,b.tx,b.ty),t.Matrix.release(b),h+=this.drawDisplayObject(c,v,0,0),v.context.popBuffer(),_.context.setGlobalCompositeOperation("destination-in"),_.setTransform(1,0,0,-1,0,v.height);var T=v.rootRenderTarget.width,x=v.rootRenderTarget.height;_.context.drawTexture(v.rootRenderTarget.texture,0,0,T,x,0,0,T,x,T,x),_.setTransform(1,0,0,1,0,0),_.context.setGlobalCompositeOperation("source-over"),v.setTransform(1,0,0,1,0,0),n.push(v)}if(_.context.setGlobalCompositeOperation("source-over"),_.context.popBuffer(),h>0){h++,l&&i.context.setGlobalCompositeOperation(o),u&&i.context.pushMask(u.x+a,u.y+s,u.width,u.height);var D=t.Matrix.create(),$=i.globalMatrix;D.a=$.a,D.b=$.b,D.c=$.c,D.d=$.d,D.tx=$.tx,D.ty=$.ty,$.append(1,0,0,-1,a+d,s+m+_.height);var E=_.rootRenderTarget.width,w=_.rootRenderTarget.height;i.context.drawTexture(_.rootRenderTarget.texture,0,0,E,w,0,0,E,w,E,w),u&&_.context.popMask(),l&&i.context.setGlobalCompositeOperation("source-over");var A=i.globalMatrix;A.a=D.a,A.b=D.b,A.c=D.c,A.d=D.d,A.tx=D.tx,A.ty=D.ty,t.Matrix.release(D)}return n.push(_),h}return u&&i.context.pushMask(u.x+a,u.y+s,u.width,u.height),l&&i.context.setGlobalCompositeOperation(o),h+=this.drawDisplayObject(e,i,a,s),l&&i.context.setGlobalCompositeOperation("source-over"),u&&i.context.popMask(),h},i.prototype.drawWithScrollRect=function(t,e,i,r){var n=0,a=t.$scrollRect?t.$scrollRect:t.$maskRect;if(a.isEmpty())return n;t.$scrollRect&&(i-=a.x,r-=a.y);var s=e.globalMatrix,o=e.context,h=!1;if(e.$hasScissor||0!=s.b||0!=s.c)e.context.pushMask(a.x+i,a.y+r,a.width,a.height);else{var l=s.a,u=s.d,c=s.tx,p=s.ty,f=a.x+i,d=a.y+r,m=f+a.width,g=d+a.height,y=void 0,_=void 0,v=void 0,b=void 0;if(1==l&&1==u)y=f+c,_=d+p,v=m+c,b=g+p;else{var T=l*f+c,x=u*d+p,D=l*m+c,$=u*d+p,E=l*m+c,w=u*g+p,A=l*f+c,S=u*g+p,O=0;T>D&&(O=T,T=D,D=O),E>A&&(O=E,E=A,A=O),y=T<E?T:E,v=D>A?D:A,x>$&&(O=x,x=$,$=O),w>S&&(O=w,w=S,S=O),_=x<w?x:w,b=$>S?$:S}o.enableScissor(y,-b+e.height,v-y,b-_),h=!0}return n+=this.drawDisplayObject(t,e,i,r),h?o.disableScissor():o.popMask(),n},i.prototype.drawNodeToBuffer=function(t,e,i,r){var n=e;n.context.pushBuffer(n),n.setTransform(i.a,i.b,i.c,i.d,i.tx,i.ty),this.renderNode(t,e,0,0,r),n.context.$drawWebGL(),n.onRenderFinish(),n.context.popBuffer()},i.prototype.drawDisplayToBuffer=function(t,e,i){var r;e.context.pushBuffer(e),i&&e.setTransform(i.a,i.b,i.c,i.d,i.tx,i.ty);var n=0;if(r=t.$renderDirty?t.$getRenderNode():t.$renderNode)switch(n++,r.type){case 1:this.renderBitmap(r,e);break;case 2:this.renderText(r,e);break;case 3:this.renderGraphics(r,e);break;case 4:this.renderGroup(r,e);break;case 5:this.renderMesh(r,e);break;case 6:this.renderNormalBitmap(r,e)}var a=t.$children;if(a)for(var s=a.length,o=0;o<s;o++){var h=a[o];switch(h.$renderMode){case 1:break;case 2:n+=this.drawWithFilter(h,e,0,0);break;case 3:n+=this.drawWithClip(h,e,0,0);break;case 4:n+=this.drawWithScrollRect(h,e,0,0);break;default:n+=this.drawDisplayObject(h,e,0,0)}}return e.context.$drawWebGL(),e.onRenderFinish(),e.context.popBuffer(),n},i.prototype.renderNode=function(t,e,i,r,n){switch(e.$offsetX=i,e.$offsetY=r,t.type){case 1:this.renderBitmap(t,e);break;case 2:this.renderText(t,e);break;case 3:this.renderGraphics(t,e,n);break;case 4:this.renderGroup(t,e);break;case 5:this.renderMesh(t,e);break;case 6:this.renderNormalBitmap(t,e)}},i.prototype.renderNormalBitmap=function(t,e){var i=t.image;i&&e.context.drawImage(i,t.sourceX,t.sourceY,t.sourceW,t.sourceH,t.drawX,t.drawY,t.drawW,t.drawH,t.imageWidth,t.imageHeight,t.rotated,t.smoothing)},i.prototype.renderBitmap=function(e,i){var n=e.image;if(n){var a,s,o,h,l=e.drawData,u=l.length,c=0,p=e.matrix,f=e.blendMode,d=e.alpha;if(p){a=t.Matrix.create();var m=i.globalMatrix;a.a=m.a,a.b=m.b,a.c=m.c,a.d=m.d,a.tx=m.tx,a.ty=m.ty,s=i.$offsetX,o=i.$offsetY,i.useOffset(),i.transform(p.a,p.b,p.c,p.d,p.tx,p.ty)}if(f&&i.context.setGlobalCompositeOperation(r[f]),d==d&&(h=i.globalAlpha,i.globalAlpha*=d),e.filter){for(i.context.$filter=e.filter;c<u;)i.context.drawImage(n,l[c++],l[c++],l[c++],l[c++],l[c++],l[c++],l[c++],l[c++],e.imageWidth,e.imageHeight,e.rotated,e.smoothing);i.context.$filter=null}else for(;c<u;)i.context.drawImage(n,l[c++],l[c++],l[c++],l[c++],l[c++],l[c++],l[c++],l[c++],e.imageWidth,e.imageHeight,e.rotated,e.smoothing);if(f&&i.context.setGlobalCompositeOperation("source-over"),d==d&&(i.globalAlpha=h),p){var g=i.globalMatrix;g.a=a.a,g.b=a.b,g.c=a.c,g.d=a.d,g.tx=a.tx,g.ty=a.ty,i.$offsetX=s,i.$offsetY=o,t.Matrix.release(a)}}},i.prototype.renderMesh=function(e,i){var n,a,s,o,h=e.image,l=e.drawData,u=l.length,c=0,p=e.matrix,f=e.blendMode,d=e.alpha;if(p){n=t.Matrix.create();var m=i.globalMatrix;n.a=m.a,n.b=m.b,n.c=m.c,n.d=m.d,n.tx=m.tx,n.ty=m.ty,a=i.$offsetX,s=i.$offsetY,i.useOffset(),i.transform(p.a,p.b,p.c,p.d,p.tx,p.ty)}if(f&&i.context.setGlobalCompositeOperation(r[f]),d==d&&(o=i.globalAlpha,i.globalAlpha*=d),e.filter){for(i.context.$filter=e.filter;c<u;)i.context.drawMesh(h,l[c++],l[c++],l[c++],l[c++],l[c++],l[c++],l[c++],l[c++],e.imageWidth,e.imageHeight,e.uvs,e.vertices,e.indices,e.bounds,e.rotated,e.smoothing);i.context.$filter=null}else for(;c<u;)i.context.drawMesh(h,l[c++],l[c++],l[c++],l[c++],l[c++],l[c++],l[c++],l[c++],e.imageWidth,e.imageHeight,e.uvs,e.vertices,e.indices,e.bounds,e.rotated,e.smoothing);if(f&&i.context.setGlobalCompositeOperation("source-over"),d==d&&(i.globalAlpha=o),p){var g=i.globalMatrix;g.a=n.a,g.b=n.b,g.c=n.c,g.d=n.d,g.tx=n.tx,g.ty=n.ty,i.$offsetX=a,i.$offsetY=s,t.Matrix.release(n)}},i.prototype.renderText=function(i,r){var n=i.width-i.x,a=i.height-i.y;if(!(n<=0||a<=0)&&n&&a&&0!=i.drawData.length){var s=t.sys.DisplayList.$canvasScaleX,o=t.sys.DisplayList.$canvasScaleY,h=r.context.$maxTextureSize;n*s>h&&(s*=h/(n*s)),a*o>h&&(o*=h/(a*o)),n*=s,a*=o;var l=i.x*s,u=i.y*o;if(i.$canvasScaleX==s&&i.$canvasScaleY==o||(i.$canvasScaleX=s,i.$canvasScaleY=o,i.dirtyRender=!0),this.canvasRenderBuffer&&this.canvasRenderBuffer.context?i.dirtyRender&&this.canvasRenderBuffer.resize(n,a):(this.canvasRenderer=new t.CanvasRenderer,this.canvasRenderBuffer=new e.CanvasRenderBuffer(n,a)),this.canvasRenderBuffer.context){if(1==s&&1==o||this.canvasRenderBuffer.context.setTransform(s,0,0,o,0,0),l||u?(i.dirtyRender&&this.canvasRenderBuffer.context.setTransform(s,0,0,o,-l,-u),r.transform(1,0,0,1,l/s,u/o)):1==s&&1==o||this.canvasRenderBuffer.context.setTransform(s,0,0,o,0,0),i.dirtyRender){var c=this.canvasRenderBuffer.surface;this.canvasRenderer.renderText(i,this.canvasRenderBuffer.context);var p=i.$texture;p?r.context.updateTexture(p,c):(p=r.context.createTexture(c),i.$texture=p),i.$textureWidth=c.width,i.$textureHeight=c.height}var f=i.$textureWidth,d=i.$textureHeight;r.context.drawTexture(i.$texture,0,0,f,d,0,0,f/s,d/o,f,d),(l||u)&&(i.dirtyRender&&this.canvasRenderBuffer.context.setTransform(s,0,0,o,0,0),r.transform(1,0,0,1,-l/s,-u/o)),i.dirtyRender=!1}}},i.prototype.renderGraphics=function(i,r,n){var a=i.width,s=i.height;if(!(a<=0||s<=0)&&a&&s&&0!=i.drawData.length){var o=t.sys.DisplayList.$canvasScaleX,h=t.sys.DisplayList.$canvasScaleY;(a*o<1||s*h<1)&&(o=h=1),i.$canvasScaleX==o&&i.$canvasScaleY==h||(i.$canvasScaleX=o,i.$canvasScaleY=h,i.dirtyRender=!0),a*=o,s*=h;var l=Math.ceil(a),u=Math.ceil(s);if(o*=l/a,h*=u/s,a=l,s=u,this.canvasRenderBuffer&&this.canvasRenderBuffer.context?(i.dirtyRender||n)&&this.canvasRenderBuffer.resize(a,s):(this.canvasRenderer=new t.CanvasRenderer,this.canvasRenderBuffer=new e.CanvasRenderBuffer(a,s)),this.canvasRenderBuffer.context){1==o&&1==h||this.canvasRenderBuffer.context.setTransform(o,0,0,h,0,0),(i.x||i.y)&&((i.dirtyRender||n)&&this.canvasRenderBuffer.context.translate(-i.x,-i.y),r.transform(1,0,0,1,i.x,i.y));var c=this.canvasRenderBuffer.surface;if(n){this.canvasRenderer.renderGraphics(i,this.canvasRenderBuffer.context,!0),t.WebGLUtils.deleteWebGLTexture(c);var p=r.context.getWebGLTexture(c);r.context.drawTexture(p,0,0,a,s,0,0,a,s,c.width,c.height)}else{i.dirtyRender&&(this.canvasRenderer.renderGraphics(i,this.canvasRenderBuffer.context),(p=i.$texture)?r.context.updateTexture(p,c):(p=r.context.createTexture(c),i.$texture=p),i.$textureWidth=c.width,i.$textureHeight=c.height);var f=i.$textureWidth,d=i.$textureHeight;r.context.drawTexture(i.$texture,0,0,f,d,0,0,f/o,d/h,f,d)}(i.x||i.y)&&((i.dirtyRender||n)&&this.canvasRenderBuffer.context.translate(i.x,i.y),r.transform(1,0,0,1,-i.x,-i.y)),n||(i.dirtyRender=!1)}}},i.prototype.renderGroup=function(e,i){var r,n,a,s=e.matrix;if(s){r=t.Matrix.create();var o=i.globalMatrix;r.a=o.a,r.b=o.b,r.c=o.c,r.d=o.d,r.tx=o.tx,r.ty=o.ty,n=i.$offsetX,a=i.$offsetY,i.useOffset(),i.transform(s.a,s.b,s.c,s.d,s.tx,s.ty)}for(var h=e.drawData,l=h.length,u=0;u<l;u++){var c=h[u];this.renderNode(c,i,i.$offsetX,i.$offsetY)}if(s){var p=i.globalMatrix;p.a=r.a,p.b=r.b,p.c=r.c,p.d=r.d,p.tx=r.tx,p.ty=r.ty,i.$offsetX=n,i.$offsetY=a,t.Matrix.release(r)}},i.prototype.createRenderBuffer=function(t,i){var r=n.pop();return r?r.resize(t,i):(r=new e.WebGLRenderBuffer(t,i)).$computeDrawCall=!1,r},i}();e.WebGLRenderer=a,i(a.prototype,"egret.web.WebGLRenderer",["egret.sys.SystemRenderer"])}(t.web||(t.web={}))}(f||(f={})),function(t){!function(t){var e=function(){function t(t,e,i){this.gl=t,this.name=i.name,this.type=i.type,this.size=i.size,this.location=t.getAttribLocation(e,this.name),this.count=0,this.initCount(t),this.format=t.FLOAT,this.initFormat(t)}return t.prototype.initCount=function(t){switch(this.type){case 5126:case 5120:case 5121:case 5123:this.count=1;break;case 35664:this.count=2;break;case 35665:this.count=3;break;case 35666:this.count=4}},t.prototype.initFormat=function(t){switch(this.type){case 5126:case 35664:case 35665:case 35666:this.format=t.FLOAT;break;case 5121:this.format=t.UNSIGNED_BYTE;break;case 5123:this.format=t.UNSIGNED_SHORT;break;case 5120:this.format=t.BYTE}},t}();t.EgretWebGLAttribute=e,i(e.prototype,"egret.web.EgretWebGLAttribute")}(t.web||(t.web={}))}(f||(f={})),function(t){!function(t){function e(t,e,i){var r=t.createShader(e);return t.shaderSource(r,i),t.compileShader(r),t.getShaderParameter(r,t.COMPILE_STATUS)||(console.log("shader not compiled!"),console.log(t.getShaderInfoLog(r))),r}var r=function(){function i(i,r,n){this.vshaderSource=r,this.fshaderSource=n,this.vertexShader=e(i,i.VERTEX_SHADER,this.vshaderSource),this.fragmentShader=e(i,i.FRAGMENT_SHADER,this.fshaderSource),this.id=function(t,e,i){var r=t.createProgram();return t.attachShader(r,e),t.attachShader(r,i),t.linkProgram(r),r}(i,this.vertexShader,this.fragmentShader),this.uniforms=function(e,i){for(var r={},n=e.getProgramParameter(i,e.ACTIVE_UNIFORMS),a=0;a<n;a++){var s=e.getActiveUniform(i,a),o=s.name,h=new t.EgretWebGLUniform(e,i,s);r[o]=h}return r}(i,this.id),this.attributes=function(e,i){for(var r={},n=e.getProgramParameter(i,e.ACTIVE_ATTRIBUTES),a=0;a<n;a++){var s=e.getActiveAttrib(i,a),o=s.name,h=new t.EgretWebGLAttribute(e,i,s);r[o]=h}return r}(i,this.id)}return i.getProgram=function(t,e,r,n){return this.programCache[n]||(this.programCache[n]=new i(t,e,r)),this.programCache[n]},i.deleteProgram=function(t,e,i,r){},i.programCache={},i}();t.EgretWebGLProgram=r,i(r.prototype,"egret.web.EgretWebGLProgram")}(t.web||(t.web={}))}(f||(f={})),function(t){!function(t){var e=function(){function t(t,e,i){this.gl=t,this.name=i.name,this.type=i.type,this.size=i.size,this.location=t.getUniformLocation(e,this.name),this.setDefaultValue(),this.generateSetValue(),this.generateUpload()}return t.prototype.setDefaultValue=function(){switch(this.type){case 5126:case 35678:case 35680:case 35670:case 5124:this.value=0;break;case 35664:case 35671:case 35667:this.value=[0,0];break;case 35665:case 35672:case 35668:this.value=[0,0,0];break;case 35666:case 35673:case 35669:this.value=[0,0,0,0];break;case 35674:this.value=new Float32Array([1,0,0,1]);break;case 35675:this.value=new Float32Array([1,0,0,0,1,0,0,0,1]);break;case 35676:this.value=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}},t.prototype.generateSetValue=function(){switch(this.type){case 5126:case 35678:case 35680:case 35670:case 5124:this.setValue=function(t){var e=this.value!==t;this.value=t,e&&this.upload()};break;case 35664:case 35671:case 35667:this.setValue=function(t){var e=this.value[0]!==t.x||this.value[1]!==t.y;this.value[0]=t.x,this.value[1]=t.y,e&&this.upload()};break;case 35665:case 35672:case 35668:this.setValue=function(t){this.value[0]=t.x,this.value[1]=t.y,this.value[2]=t.z,this.upload()};break;case 35666:case 35673:case 35669:this.setValue=function(t){this.value[0]=t.x,this.value[1]=t.y,this.value[2]=t.z,this.value[3]=t.w,this.upload()};break;case 35674:case 35675:case 35676:this.setValue=function(t){this.value.set(t),this.upload()}}},t.prototype.generateUpload=function(){var t=this.gl,e=this.type,i=this.location;switch(e){case 5126:this.upload=function(){var e=this.value;t.uniform1f(i,e)};break;case 35664:this.upload=function(){var e=this.value;t.uniform2f(i,e[0],e[1])};break;case 35665:this.upload=function(){var e=this.value;t.uniform3f(i,e[0],e[1],e[2])};break;case 35666:this.upload=function(){var e=this.value;t.uniform4f(i,e[0],e[1],e[2],e[3])};break;case 35678:case 35680:case 35670:case 5124:this.upload=function(){var e=this.value;t.uniform1i(i,e)};break;case 35671:case 35667:this.upload=function(){var e=this.value;t.uniform2i(i,e[0],e[1])};break;case 35672:case 35668:this.upload=function(){var e=this.value;t.uniform3i(i,e[0],e[1],e[2])};break;case 35673:case 35669:this.upload=function(){var e=this.value;t.uniform4i(i,e[0],e[1],e[2],e[3])};break;case 35674:this.upload=function(){var e=this.value;t.uniformMatrix2fv(i,!1,e)};break;case 35675:this.upload=function(){var e=this.value;t.uniformMatrix3fv(i,!1,e)};break;case 35676:this.upload=function(){var e=this.value;t.uniformMatrix4fv(i,!1,e)}}},t}();t.EgretWebGLUniform=e,i(e.prototype,"egret.web.EgretWebGLUniform")}(t.web||(t.web={}))}(f||(f={})),function(t){!function(t){var e=function(){function t(){}return t.blur_frag="precision mediump float;\nuniform vec2 blur;\nuniform sampler2D uSampler;\nvarying vec2 vTextureCoord;\nuniform vec2 uTextureSize;\nvoid main()\n{\n    const int sampleRadius = 5;\n    const int samples = sampleRadius * 2 + 1;\n    vec2 blurUv = blur / uTextureSize;\n    vec4 color = vec4(0, 0, 0, 0);\n    vec2 uv = vec2(0.0, 0.0);\n    blurUv /= float(sampleRadius);\n    for (int i = -sampleRadius; i <= sampleRadius; i++) {\n        uv.x = vTextureCoord.x + float(i) * blurUv.x;\n        uv.y = vTextureCoord.y + float(i) * blurUv.y;\n        color += texture2D(uSampler, uv);\n    }\n    color /= float(samples);\n    gl_FragColor = color;\n}",t.colorTransform_frag="precision mediump float;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nuniform mat4 matrix;\nuniform vec4 colorAdd;\nuniform sampler2D uSampler;\nvoid main(void) {\n    vec4 texColor = texture2D(uSampler, vTextureCoord);\n    if(texColor.a > 0.) {\n        texColor = vec4(texColor.rgb / texColor.a, texColor.a);\n    }\n    vec4 locColor = clamp(texColor * matrix + colorAdd, 0., 1.);\n    gl_FragColor = vColor * vec4(locColor.rgb * locColor.a, locColor.a);\n}",t.default_vert="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec2 aColor;\nuniform vec2 projectionVector;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nconst vec2 center = vec2(-1.0, 1.0);\nvoid main(void) {\n   gl_Position = vec4( (aVertexPosition / projectionVector) + center , 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n   vColor = vec4(aColor.x, aColor.x, aColor.x, aColor.x);\n}",t.glow_frag="precision highp float;\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float dist;\nuniform float angle;\nuniform vec4 color;\nuniform float alpha;\nuniform float blurX;\nuniform float blurY;\nuniform float strength;\nuniform float inner;\nuniform float knockout;\nuniform float hideObject;\nuniform vec2 uTextureSize;\nfloat random(vec2 scale)\n{\n    return fract(sin(dot(gl_FragCoord.xy, scale)) * 43758.5453);\n}\nvoid main(void) {\n    vec2 px = vec2(1.0 / uTextureSize.x, 1.0 / uTextureSize.y);\n    const float linearSamplingTimes = 7.0;\n    const float circleSamplingTimes = 12.0;\n    vec4 ownColor = texture2D(uSampler, vTextureCoord);\n    vec4 curColor;\n    float totalAlpha = 0.0;\n    float maxTotalAlpha = 0.0;\n    float curDistanceX = 0.0;\n    float curDistanceY = 0.0;\n    float offsetX = dist * cos(angle) * px.x;\n    float offsetY = dist * sin(angle) * px.y;\n    const float PI = 3.14159265358979323846264;\n    float cosAngle;\n    float sinAngle;\n    float offset = PI * 2.0 / circleSamplingTimes * random(vec2(12.9898, 78.233));\n    float stepX = blurX * px.x / linearSamplingTimes;\n    float stepY = blurY * px.y / linearSamplingTimes;\n    for (float a = 0.0; a <= PI * 2.0; a += PI * 2.0 / circleSamplingTimes) {\n        cosAngle = cos(a + offset);\n        sinAngle = sin(a + offset);\n        for (float i = 1.0; i <= linearSamplingTimes; i++) {\n            curDistanceX = i * stepX * cosAngle;\n            curDistanceY = i * stepY * sinAngle;\n            \n            curColor = texture2D(uSampler, vec2(vTextureCoord.x + curDistanceX - offsetX, vTextureCoord.y + curDistanceY + offsetY));\n            totalAlpha += (linearSamplingTimes - i) * curColor.a;\n            maxTotalAlpha += (linearSamplingTimes - i);\n        }\n    }\n    ownColor.a = max(ownColor.a, 0.0001);\n    ownColor.rgb = ownColor.rgb / ownColor.a;\n    float outerGlowAlpha = (totalAlpha / maxTotalAlpha) * strength * alpha * (1. - inner) * max(min(hideObject, knockout), 1. - ownColor.a);\n    float innerGlowAlpha = ((maxTotalAlpha - totalAlpha) / maxTotalAlpha) * strength * alpha * inner * ownColor.a;\n    ownColor.a = max(ownColor.a * knockout * (1. - hideObject), 0.0001);\n    vec3 mix1 = mix(ownColor.rgb, color.rgb, innerGlowAlpha / (innerGlowAlpha + ownColor.a));\n    vec3 mix2 = mix(mix1, color.rgb, outerGlowAlpha / (innerGlowAlpha + ownColor.a + outerGlowAlpha));\n    float resultAlpha = min(ownColor.a + outerGlowAlpha + innerGlowAlpha, 1.);\n    gl_FragColor = vec4(mix2 * resultAlpha, resultAlpha);\n}",t.primitive_frag="precision lowp float;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvoid main(void) {\n    gl_FragColor = vColor;\n}",t.texture_frag="precision lowp float;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nuniform sampler2D uSampler;\nvoid main(void) {\n    gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor;\n}",t}();t.EgretShaderLib=e,i(e.prototype,"egret.web.EgretShaderLib")}(t.web||(t.web={}))}(f||(f={})),window.egret=f},function(t,e,i){(function(t,e){function r(t){return"function"==typeof t}var n=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},a=0,s=void 0,o=void 0,h=function(t,e){m[a]=t,m[a+1]=e,2===(a+=2)&&(o?o(g):T())},l="undefined"!=typeof window?window:void 0,u=l||{},c=u.MutationObserver||u.WebKitMutationObserver,p="undefined"==typeof self&&void 0!==t&&"[object process]"==={}.toString.call(t),f="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function d(){var t=setTimeout;return function(){return t(g,1)}}var m=new Array(1e3);function g(){for(var t=0;t<a;t+=2)(0,m[t])(m[t+1]),m[t]=void 0,m[t+1]=void 0;a=0}var y,_,v,b,T=void 0;function x(t,e){var i=arguments,r=this,n=new this.constructor(E);void 0===n[$]&&H(n);var a,s=r._state;return s?(a=i[s-1],h(function(){return j(s,n,a,r._result)})):F(r,n,t,e),n}function D(t){if(t&&"object"==typeof t&&t.constructor===this)return t;var e=new this(E);return R(e,t),e}p?T=function(){return t.nextTick(g)}:c?(_=0,v=new c(g),b=document.createTextNode(""),v.observe(b,{characterData:!0}),T=function(){b.data=_=++_%2}):f?((y=new MessageChannel).port1.onmessage=g,T=function(){return y.port2.postMessage(0)}):T=void 0===l?function(){try{var t=i(!function(){var t=new Error("Cannot find module 'vertx'");throw t.code="MODULE_NOT_FOUND",t}());return void 0!==(s=t.runOnLoop||t.runOnContext)?function(){s(g)}:d()}catch(t){return d()}}():d();var $=Math.random().toString(36).substring(16);function E(){}var w=void 0,A=1,S=2,O=new N;function C(t){try{return t.then}catch(t){return O.error=t,O}}function P(t,e,i){e.constructor===t.constructor&&i===x&&e.constructor.resolve===D?function(t,e){e._state===A?I(t,e._result):e._state===S?B(t,e._result):F(e,void 0,function(e){return R(t,e)},function(e){return B(t,e)})}(t,e):i===O?B(t,O.error):void 0===i?I(t,e):r(i)?function(t,e,i){h(function(t){var r=!1,n=function(t,e,i,r){try{t.call(e,i,r)}catch(t){return t}}(i,e,function(i){r||(r=!0,e!==i?R(t,i):I(t,i))},function(e){r||(r=!0,B(t,e))},t._label);!r&&n&&(r=!0,B(t,n))},t)}(t,e,i):I(t,e)}function R(t,e){var i;t===e?B(t,new TypeError("You cannot resolve a promise with itself")):"function"==typeof(i=e)||"object"==typeof i&&null!==i?P(t,e,C(e)):I(t,e)}function M(t){t._onerror&&t._onerror(t._result),L(t)}function I(t,e){t._state===w&&(t._result=e,t._state=A,0!==t._subscribers.length&&h(L,t))}function B(t,e){t._state===w&&(t._state=S,t._result=e,h(M,t))}function F(t,e,i,r){var n=t._subscribers,a=n.length;t._onerror=null,n[a]=e,n[a+A]=i,n[a+S]=r,0===a&&t._state&&h(L,t)}function L(t){var e=t._subscribers,i=t._state;if(0!==e.length){for(var r=void 0,n=void 0,a=t._result,s=0;s<e.length;s+=3)r=e[s],n=e[s+i],r?j(i,r,n,a):n(a);t._subscribers.length=0}}function N(){this.error=null}var k=new N;function j(t,e,i,n){var a=r(i),s=void 0,o=void 0,h=void 0,l=void 0;if(a){if((s=function(t,e){try{return t(e)}catch(t){return k.error=t,k}}(i,n))===k?(l=!0,o=s.error,s=null):h=!0,e===s)return void B(e,new TypeError("A promises callback cannot return that same promise."))}else s=n,h=!0;e._state!==w||(a&&h?R(e,s):l?B(e,o):t===A?I(e,s):t===S&&B(e,s))}var U=0;function H(t){t[$]=U++,t._state=void 0,t._result=void 0,t._subscribers=[]}function W(t,e){this._instanceConstructor=t,this.promise=new t(E),this.promise[$]||H(this.promise),n(e)?(this._input=e,this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?I(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&I(this.promise,this._result))):B(this.promise,new Error("Array Methods must be provided an Array"))}function X(t){this[$]=U++,this._result=this._state=void 0,this._subscribers=[],E!==t&&("function"!=typeof t&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof X?function(t,e){try{e(function(e){R(t,e)},function(e){B(t,e)})}catch(e){B(t,e)}}(this,t):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}W.prototype._enumerate=function(){for(var t=this.length,e=this._input,i=0;this._state===w&&i<t;i++)this._eachEntry(e[i],i)},W.prototype._eachEntry=function(t,e){var i=this._instanceConstructor,r=i.resolve;if(r===D){var n=C(t);if(n===x&&t._state!==w)this._settledAt(t._state,e,t._result);else if("function"!=typeof n)this._remaining--,this._result[e]=t;else if(i===X){var a=new i(E);P(a,t,n),this._willSettleAt(a,e)}else this._willSettleAt(new i(function(e){return e(t)}),e)}else this._willSettleAt(r(t),e)},W.prototype._settledAt=function(t,e,i){var r=this.promise;r._state===w&&(this._remaining--,t===S?B(r,i):this._result[e]=i),0===this._remaining&&I(r,this._result)},W.prototype._willSettleAt=function(t,e){var i=this;F(t,void 0,function(t){return i._settledAt(A,e,t)},function(t){return i._settledAt(S,e,t)})},X.all=function(t){return new W(this,t).promise},X.race=function(t){var e=this;return n(t)?new e(function(i,r){for(var n=t.length,a=0;a<n;a++)e.resolve(t[a]).then(i,r)}):new e(function(t,e){return e(new TypeError("You must pass an array to race."))})},X.resolve=D,X.reject=function(t){var e=new this(E);return B(e,t),e},X._setScheduler=function(t){o=t},X._setAsap=function(t){h=t},X._asap=h,X.prototype={constructor:X,then:x,catch:function(t){return this.then(null,t)}},X.polyfill=function(){var t=void 0;if(void 0!==e)t=e;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var i=t.Promise;if("undefined"!=typeof egret_native&&egret_native.capability&&!egret_native.capability("Promise")&&(i=void 0),i){var r=null;try{r=Object.prototype.toString.call(i.resolve())}catch(t){}if("[object Promise]"===r&&!i.cast)return}t.Promise=X},X.Promise=X,X.polyfill();var Y,G=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},V=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);i.prototype=e.prototype,t.prototype=new i},z=this&&this.__decorate||function(t,e,i,r){var n,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(s=(a<3?n(s):a>3?n(e,i,s):n(e,i))||s);return a>3&&s&&Object.defineProperty(e,i,s),s};Y||(Y={}),function(t){function e(e){var i=t.config.config.fileSystem.getFile(e);return i||(e=t.resourceNameSelector(e),i=t.config.config.fileSystem.getFile(e)),i}var i;t.resourceNameSelector=function(t){return t},t.getResourceInfo=e,t.setConfigURL=function(t,e){var r;r=t.indexOf(".json")>=0?"legacyResourceConfig":"resourceConfig",i={type:r,root:e,url:t,name:t}};var r=function(){function r(){}return r.prototype.init=function(){return this.config||(this.config={alias:{},groups:{},resourceRoot:i.root,typeSelector:function(){return"unknown"},mergeSelector:null,fileSystem:null,loadGroup:[]}),t.queue.pushResItem(i).catch(function(e){return e.__resource_manager_error__||(console.error(e.stack),e=new t.ResourceManagerError(1002)),t.host.remove(i),X.reject(e)})},r.prototype.getGroupByName=function(e,i){var r=this.config.groups[e],n=[];if(!r){if(i)throw new t.ResourceManagerError(2005,e);return null}for(var a=0,s=r;a<s.length;a++){var o=s[a],h=t.config.getResourceWithSubkey(o,!0),l=h.key,u=(h.subkey,t.config.getResource(l,!0));-1==n.indexOf(u)&&n.push(u)}return n},r.prototype.__temp__get__type__via__url=function(e){var i=this.config.alias[e];if(i||(i=e),t.resourceTypeSelector){var r=t.resourceTypeSelector(i);if(!r)throw new t.ResourceManagerError(2004,i);return r}return console.warn("RES.mapConfig 并未设置 typeSelector"),"unknown"},r.prototype.getResourceWithSubkey=function(e,i){var r=(e=this.getKeyByAlias(e)).indexOf("#"),n="";r>=0&&(n=e.substr(r+1),e=e.substr(0,r));var a=this.getResource(e);if(a)return{r:a,key:e,subkey:n};if(i){var s=n?e+"#"+n:e;throw new t.ResourceManagerError(2006,s)}return null},r.prototype.getKeyByAlias=function(t){return this.config.alias[t]?this.config.alias[t]:t},r.prototype.getResource=function(i,r){var n=this.config.alias[i];n||(n=i);var a=e(n);if(!a){if(r)throw new t.ResourceManagerError(2006,i);return null}return a},r.prototype.getGroup=function(t){return this.getGroupByName(t)},r.prototype.createGroup=function(t,e,i){if(void 0===i&&(i=!1),!i&&this.config.groups[t]||!e||0==e.length)return!1;for(var r=[],n=0,a=e;n<a.length;n++){var s=a[n];if(this.config.groups[s]){var o=this.config.groups[s];r=r.concat(o)}else r.push(s)}return this.config.groups[t]=r,!0},r.prototype.addSubkey=function(t,e){this.addAlias(t,e+"#"+t)},r.prototype.addAlias=function(t,e){this.config.alias[e]&&(e=this.config.alias[e]),this.config.alias[t]=e},r.prototype.getType=function(t){return this.getResource(t,!0).type},r.prototype.addResourceData=function(e){t.hasRes(e.name)||(e.type||(e.type=this.__temp__get__type__via__url(e.url)),t.config.config.fileSystem.addFile(e.url,e.type,e.root,e.extra),e.name&&(this.config.alias[e.name]=e.url))},r.prototype.removeResourceData=function(e){t.hasRes(e.name)&&(t.config.config.fileSystem.removeFile(e.url),this.config.alias[e.name]&&delete this.config.alias[e.name])},r}();t.ResourceConfig=r,G(r.prototype,"RES.ResourceConfig")}(Y||(Y={})),function(t){var e=function(){function e(){this.groupTotalDic={},this.numLoadedDic={},this.groupErrorDic={},this.retryTimesDic={},this.maxRetryTimes=3,this.reporterDic={},this.dispatcherDic={},this.failedList=new Array,this.loadItemErrorDic={},this.errorDic={},this.itemListPriorityDic={},this.itemLoadDic={},this.promiseHash={},this.lazyLoadList=new Array,this.loadingCount=0,this.thread=4}return e.prototype.pushResItem=function(t){if(this.promiseHash[t.name])return this.promiseHash[t.name];this.lazyLoadList.push(t),this.itemListPriorityDic[Number.NEGATIVE_INFINITY]=this.lazyLoadList,this.updatelistPriority(this.lazyLoadList,Number.NEGATIVE_INFINITY);var e=new egret.EventDispatcher;this.dispatcherDic[t.name]=e;var i=new X(function(t,i){e.addEventListener("complete",function(e){t(e.data)},null),e.addEventListener("error",function(t){i(t.data)},null)});return this.promiseHash[t.name]=i,this.loadNextResource(),i},e.prototype.pushResGroup=function(t,e,i,r){if(this.promiseHash[e])return this.promiseHash[e];for(var n=t.length,a=0;a<n;a++){var s=t[a];s.groupNames||(s.groupNames=[]),s.groupNames.push(e)}this.groupTotalDic[e]=t.length,this.numLoadedDic[e]=0,this.updatelistPriority(t,i),this.reporterDic[e]=r;var o=new egret.EventDispatcher;this.dispatcherDic[e]=o;var h=new X(function(t,e){o.addEventListener("complete",t,null),o.addEventListener("error",function(t){e(t.data)},null)});return this.promiseHash[e]=h,this.loadNextResource(),h},e.prototype.updatelistPriority=function(t,e){void 0==this.itemListPriorityDic[e]&&(this.itemListPriorityDic[e]=[]);for(var i=0,r=t;i<r.length;i++){var n=r[i];if(1!=this.itemLoadDic[n.name]){var a=this.findPriorityInDic(n);if(void 0==a)this.itemListPriorityDic[e].push(n);else if(a<e){this.itemListPriorityDic[e].push(n);var s=this.itemListPriorityDic[a].indexOf(n);this.itemListPriorityDic[a].splice(s,1)}}}},e.prototype.findPriorityInDic=function(t){for(var e in this.itemListPriorityDic)if(this.itemListPriorityDic[e].indexOf(t)>-1)return parseInt(e)},e.prototype.loadNextResource=function(){for(;this.loadingCount<this.thread&&this.loadSingleResource(););},e.prototype.loadSingleResource=function(){var e=this,i=this.getOneResourceInfoInGroup();return!!i&&(this.itemLoadDic[i.name]=1,this.loadingCount++,this.loadResource(i).then(function(r){e.loadingCount--,delete e.itemLoadDic[i.name],t.host.save(i,r),e.promiseHash[i.name]&&e.deleteDispatcher(i.name).dispatchEventWith("complete",!1,r);var n=i.groupNames;if(n){delete i.groupNames;for(var a=0,s=n;a<s.length;a++){var o=s[a];e.setGroupProgress(o,i)&&e.loadGroupEnd(o)}}e.loadNextResource()}).catch(function(r){if(!r)throw i.name+" load fail";if(!r.__resource_manager_error__)throw r;delete e.itemLoadDic[i.name],e.loadingCount--,delete t.host.state[i.root+i.name];var n=e.retryTimesDic[i.name]||1;if(!(n>e.maxRetryTimes))return e.retryTimesDic[i.name]=n+1,e.failedList.push(i),void e.loadNextResource();delete e.retryTimesDic[i.name],e.promiseHash[i.name]&&e.deleteDispatcher(i.name).dispatchEventWith("error",!1,{r:i,error:r});var a=i.groupNames;if(a){delete i.groupNames;for(var s=0,o=a;s<o.length;s++){var h=o[s];e.loadItemErrorDic[h]||(e.loadItemErrorDic[h]=[]),-1==e.loadItemErrorDic[h].indexOf(i)&&e.loadItemErrorDic[h].push(i),e.groupErrorDic[h]=!0,e.setGroupProgress(h,i)?e.loadGroupEnd(h,r):e.errorDic[h]=r}}e.loadNextResource()}),!0)},e.prototype.getOneResourceInfoInGroup=function(){if(this.failedList.length>0)return this.failedList.shift();var t=Number.NEGATIVE_INFINITY;for(var e in this.itemListPriorityDic)t=Math.max(t,e);var i=this.itemListPriorityDic[t];return i?0==i.length?(delete this.itemListPriorityDic[t],this.getOneResourceInfoInGroup()):i.shift():void 0},e.prototype.setGroupProgress=function(t,e){var i=this.reporterDic[t];this.numLoadedDic[t]++;var r=this.numLoadedDic[t],n=this.groupTotalDic[t];return i&&i.onProgress&&i.onProgress(r,n,e),r==n},e.prototype.loadGroupEnd=function(t,e){delete this.groupTotalDic[t],delete this.numLoadedDic[t],delete this.reporterDic[t];var i=this.deleteDispatcher(t);if(e)delete this.groupErrorDic[t],n=this.loadItemErrorDic[t],delete this.loadItemErrorDic[t],i.dispatchEventWith("error",!1,{itemList:n,lastError:e});else{var r=this.groupErrorDic[t];if(delete this.groupErrorDic[t],r){var n=this.loadItemErrorDic[t];delete this.loadItemErrorDic[t];var a=this.errorDic[t];delete this.errorDic[t],i.dispatchEventWith("error",!1,{itemList:n,error:a})}else i.dispatchEventWith("complete")}},e.prototype.deleteDispatcher=function(t){delete this.promiseHash[t];var e=this.dispatcherDic[t];return delete this.dispatcherDic[t],e},e.prototype.loadResource=function(e,i){if(!i){if(1==t.FEATURE_FLAG.FIX_DUPLICATE_LOAD){var r=t.host.state[e.root+e.name];if(2==r)return X.resolve(t.host.get(e));if(1==r)return e.promise}i=t.processor.isSupport(e)}if(!i)throw new t.ResourceManagerError(2001,e.name,e.type);t.host.state[e.root+e.name]=1;var n=i.onLoadStart(t.host,e);return e.promise=n,n},e.prototype.unloadResource=function(e){if(!t.host.get(e))return console.warn("尝试释放不存在的资源:",e.name),!1;var i=t.processor.isSupport(e);return!i||(i.onRemoveStart(t.host,e),t.host.remove(e),1==e.extra&&t.config.removeResourceData(e),!0)},e}();t.ResourceLoader=e,G(e.prototype,"RES.ResourceLoader")}(Y||(Y={})),function(t){t.checkNull=function(t,e,i){var r=i.value;i.value=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return t[0]?r.apply(this,t):(console.warn("方法"+e+"的参数不能为null"),null)}},t.FEATURE_FLAG={FIX_DUPLICATE_LOAD:1},function(t){t.setUpgradeGuideLevel=function(t){}}(t.upgrade||(t.upgrade={}))}(Y||(Y={})),function(t){t.nameSelector=function(e){return t.path.basename(e).split(".").join("_")},t.registerAnalyzer=function(e,i){throw new t.ResourceManagerError(2002)},t.loadConfig=function(r,n,a){if(n.indexOf("://")>=0){var s=n.split("://");n=s[0]+"://"+t.path.normalize(s[1]+"/"),r=r.replace(n,"")}else n=t.path.normalize(n+"/"),r=r.replace(n,"");return t.resDefaultJson=a||"",t.setConfigURL(r,n),e||(e=new i),e.loadConfig()},t.loadGroup=function(t,i,r){return void 0===i&&(i=0),e.loadGroup(t,i,r)},t.isGroupLoaded=function(t){return e.isGroupLoaded(t)},t.getGroupByName=function(i){return e.getGroupByName(i).map(function(e){return t.ResourceItem.convertToResItem(e)})},t.createGroup=function(t,i,r){return void 0===r&&(r=!1),e.createGroup(t,i,r)},t.hasRes=function(t){return e.hasRes(t)},t.getRes=function(t){return e.getRes(t)},t.getResAsync=function(t,i,r){return e.getResAsync.apply(e,arguments)},t.getResByUrl=function(t,i,r,n){void 0===n&&(n=""),e.getResByUrl(t,i,r,n)},t.destroyRes=function(t,i){return e.destroyRes(t,i)},t.setMaxLoadingThread=function(t){e||(e=new i),e.setMaxLoadingThread(t)},t.setMaxRetryTimes=function(t){e.setMaxRetryTimes(t)},t.addEventListener=function(t,r,n,a,s){void 0===a&&(a=!1),void 0===s&&(s=0),e||(e=new i),e.addEventListener(t,r,n,a,s)},t.removeEventListener=function(t,i,r,n){void 0===n&&(n=!1),e.removeEventListener(t,i,r,n)},t.$addResourceData=function(t){e.addResourceData(t)},t.getVersionController=function(){return e||(e=new i),e.vcs},t.registerVersionController=function(t){e||(e=new i),e.registerVersionController(t)},t.getVirtualUrl=function(t){return e.vcs?e.vcs.getVirtualUrl(t):t};var e,i=function(e){function i(){var i=e.call(this)||this;return i.isVcsInit=!1,t.VersionController&&(i.vcs=new t.VersionController),i}return V(i,e),i.prototype.registerVersionController=function(t){this.vcs=t,this.isVcsInit=!1},i.prototype.loadConfig=function(){var e=this,i=function(){return t.config.init().then(function(i){t.ResourceEvent.dispatchResourceEvent(e,t.ResourceEvent.CONFIG_COMPLETE)},function(i){return t.ResourceEvent.dispatchResourceEvent(e,t.ResourceEvent.CONFIG_LOAD_ERROR),X.reject(i)})};return!this.isVcsInit&&this.vcs?(this.isVcsInit=!0,this.vcs.init().then(function(){return i()})):i()},i.prototype.isGroupLoaded=function(e){return t.config.getGroupByName(e,!0).every(function(e){return null!=t.host.get(e)})},i.prototype.getGroupByName=function(e){return t.config.getGroupByName(e,!0)},i.prototype.loadGroup=function(e,i,r){var n=this;void 0===i&&(i=0);var a={onProgress:function(i,a,s){r&&r.onProgress&&r.onProgress(i,a,s),t.ResourceEvent.dispatchResourceEvent(n,t.ResourceEvent.GROUP_PROGRESS,e,s,i,a)}};return this._loadGroup(e,i,a).then(function(i){-1==t.config.config.loadGroup.indexOf(e)&&t.config.config.loadGroup.push(e),t.ResourceEvent.dispatchResourceEvent(n,t.ResourceEvent.GROUP_COMPLETE,e)},function(i){if(-1==t.config.config.loadGroup.indexOf(e)&&t.config.config.loadGroup.push(e),i.itemList)for(var r=i.itemList,a=r.length,s=0;s<a;s++){var o=r[s];delete o.promise,t.ResourceEvent.dispatchResourceEvent(n,t.ResourceEvent.ITEM_LOAD_ERROR,e,o)}return t.ResourceEvent.dispatchResourceEvent(n,t.ResourceEvent.GROUP_LOAD_ERROR,e),X.reject(i.error)})},i.prototype._loadGroup=function(e,i,r){void 0===i&&(i=0);var n=t.config.getGroupByName(e,!0);return 0==n.length?new X(function(i,r){r({error:new t.ResourceManagerError(2006,e)})}):t.queue.pushResGroup(n,e,i,r)},i.prototype.createGroup=function(e,i,r){return void 0===r&&(r=!1),t.config.createGroup(e,i,r)},i.prototype.hasRes=function(e){return null!=t.config.getResourceWithSubkey(e)},i.prototype.getRes=function(e){var i=t.config.getResourceWithSubkey(e);if(i){var r=i.r,n=i.key,a=i.subkey,s=t.processor.isSupport(r);return s&&s.getData&&a?s.getData(t.host,r,n,a):t.host.get(r)}return null},i.prototype.getResAsync=function(e,i,r){var n=this,a=e,s=t.config.getResourceWithSubkey(e,!0),o=s.r,h=s.subkey;return t.queue.pushResItem(o).then(function(n){t.host.save(o,n);var s=t.processor.isSupport(o);return s&&s.getData&&h&&(n=s.getData(t.host,o,e,h)),i&&i.call(r,n,a),n},function(e){return t.host.remove(o),t.ResourceEvent.dispatchResourceEvent(n,t.ResourceEvent.ITEM_LOAD_ERROR,"",o),X.reject(e)})},i.prototype.getResByUrl=function(e,i,r,n){var a=this;void 0===n&&(n="");var s=t.config.getResource(e);if(!(s||(n||(n=t.config.__temp__get__type__via__url(e)),s={name:e,url:e,type:n,root:"",extra:1},t.config.addResourceData(s),s=t.config.getResource(e))))throw"never";return t.queue.pushResItem(s).then(function(e){return t.host.save(s,e),i&&s&&i.call(r,e,s.url,!0),e},function(e){return t.host.remove(s),i&&s&&i.call(r,null,s.url,!1),t.ResourceEvent.dispatchResourceEvent(a,t.ResourceEvent.ITEM_LOAD_ERROR,"",s),X.reject(e)})},i.prototype.destroyRes=function(e,i){void 0===i&&(i=!0);var r=t.config.getGroup(e);if(r&&r.length>0){if(i||1==t.config.config.loadGroup.length&&t.config.config.loadGroup[0]==e){for(var n=0,a=r;n<a.length;n++){var s=a[n];t.queue.unloadResource(s)}var o=t.config.config.loadGroup.indexOf(e);t.config.config.loadGroup.splice(o,1)}else{for(var h={},l=0,u=t.config.config.loadGroup;l<u.length;l++){var c=u[l];for(var p in t.config.config.groups[c])h[f=t.config.config.groups[c][p]]?h[f]++:h[f]=1}for(var f in h)h[f]&&1==h[f]&&(s=t.config.getResource(f))&&t.queue.unloadResource(s);o=t.config.config.loadGroup.indexOf(e),t.config.config.loadGroup.splice(o,1)}return!0}return(s=t.config.getResource(e))?t.queue.unloadResource(s):(console.warn("无法删除指定组:"+e),!1)},i.prototype.setMaxLoadingThread=function(e){e<1&&(e=1),t.queue.thread=e},i.prototype.setMaxRetryTimes=function(e){e=Math.max(e,0),t.queue.maxRetryTimes=e},i.prototype.addResourceData=function(e){t.config.addResourceData(e)},z([t.checkNull],i.prototype,"hasRes",null),z([t.checkNull],i.prototype,"getRes",null),z([t.checkNull],i.prototype,"getResAsync",null),z([t.checkNull],i.prototype,"getResByUrl",null),i}(egret.EventDispatcher);t.Resource=i,G(i.prototype,"RES.Resource")}(Y||(Y={})),function(t){var e;(e=t.path||(t.path={})).normalize=function(t){var e=t.split("/");return e.filter(function(t,i){return!!t||i==e.length-1}).join("/")},e.basename=function(t){return t.substr(t.lastIndexOf("/")+1)},e.dirname=function(t){return t.substr(0,t.lastIndexOf("/"))}}(Y||(Y={})),function(t){var e=function(){function t(){}return t.prototype.init=function(){return this.versionInfo=this.getLocalData("all.manifest"),X.resolve()},t.prototype.getVirtualUrl=function(t){return t},t.prototype.getLocalData=function(t){if(egret_native.readUpdateFileSync&&egret_native.readResourceFileSync){var e=egret_native.readUpdateFileSync(t);if(null!=e)return JSON.parse(e);if(null!=(e=egret_native.readResourceFileSync(t)))return JSON.parse(e)}return null},t}();t.NativeVersionController=e,G(e.prototype,"RES.NativeVersionController",["RES.IVersionController"]),egret.Capabilities.runtimeType==egret.RuntimeType.NATIVE&&(t.VersionController=e)}(Y||(Y={})),function(t){!function(e){function i(e,i){var r=this;return new X(function(n,a){e.addEventListener(egret.Event.COMPLETE,function(){var t=e.data?e.data:e.response;n(t)},r),e.addEventListener(egret.IOErrorEvent.IO_ERROR,function(){var e=new t.ResourceManagerError(1001,i.url);a(e)},r)})}function r(t,e){if(-1!=e.indexOf("://"))return e;var i=(t=t.split("\\").join("/")).match(/#.*|\?.*/),r="";i&&(r=i[0]);var n=t.lastIndexOf("/");return(t=-1!=n?t.substring(0,n+1)+e:e)+r}e.isSupport=function(t){return e._map[t.type]},e.map=function(t,i){e._map[t]=i},e.getRelativePath=r,e.ImageProcessor={onLoadStart:function(e,r){var n=new egret.ImageLoader;return n.load(t.getVirtualUrl(r.root+r.url)),i(n,r).then(function(t){var i=new egret.Texture;i._setBitmapData(t);var n=e.resourceConfig.getResource(r.name);if(n&&n.scale9grid){var a=n.scale9grid.split(",");i.scale9Grid=new egret.Rectangle(parseInt(a[0]),parseInt(a[1]),parseInt(a[2]),parseInt(a[3]))}return i})},onRemoveStart:function(t,e){t.get(e).dispose()}},e.BinaryProcessor={onLoadStart:function(e,r){var n=new egret.HttpRequest;return n.responseType=egret.HttpResponseType.ARRAY_BUFFER,n.open(t.getVirtualUrl(r.root+r.url),"get"),n.send(),i(n,r)},onRemoveStart:function(t,e){}},e.TextProcessor={onLoadStart:function(e,r){if(t.resDefaultJson&&"legacyResourceConfig"===r.type){var n=t.resDefaultJson;return t.resDefaultJson="",new X(function(t,e){t(n)})}var a=new egret.HttpRequest;return a.responseType=egret.HttpResponseType.TEXT,a.open(t.getVirtualUrl(r.root+r.url),"get"),a.send(),i(a,r)},onRemoveStart:function(t,e){return!0}},e.JsonProcessor={onLoadStart:function(t,e){return t.load(e,"text").then(function(t){return JSON.parse(t)})},onRemoveStart:function(t,e){}},e.XMLProcessor={onLoadStart:function(t,e){return t.load(e,"text").then(function(t){return egret.XML.parse(t)})},onRemoveStart:function(t,e){return!0}},e.CommonJSProcessor={onLoadStart:function(e,i){return e.load(i,"text").then(function(e){var r=new Function("require","exports",e),n={};try{r(function(){},n)}catch(e){throw new t.ResourceManagerError(2003,i.name,e.message)}return n})},onRemoveStart:function(t,e){}},e.SheetProcessor={onLoadStart:function(e,i){return e.load(i,"json").then(function(n){var a=e.resourceConfig.getResource(t.nameSelector(n.file));if(!a){var s=r(i.url,n.file);a={name:s,url:s,type:"image",root:i.root}}return e.load(a).then(function(t){var i=n.frames,r=new egret.SpriteSheet(t);for(var s in r.$resourceInfo=a,i){var o=i[s],h=r.createTexture(s,o.x,o.y,o.w,o.h,o.offX,o.offY,o.sourceW,o.sourceH);if(o.scale9grid){var l=o.scale9grid.split(",");h.scale9Grid=new egret.Rectangle(parseInt(l[0]),parseInt(l[1]),parseInt(l[2]),parseInt(l[3]))}}return e.save(a,t),r})})},getData:function(t,e,i,r){var n=t.get(e);return n?n.getTexture(r):null},onRemoveStart:function(t,e){var i=t.get(e),r=i.$resourceInfo;i.dispose(),t.unload(r)}},e.FontProcessor={onLoadStart:function(e,i){return e.load(i,"text").then(function(n){var a,s,o,h,l,u;try{a=JSON.parse(n)}catch(t){a=n}"string"==typeof a?(o=i.url,l="",-1!=(h=(u=a.split("\n")[2]).indexOf('file="'))&&(h=(u=u.substring(h+6)).indexOf('"'),l=u.substring(0,h)),s=o=-1!=(h=(o=o.split("\\").join("/")).lastIndexOf("/"))?o.substring(0,h+1)+l:l):s=r(i.url,a.file);var c=e.resourceConfig.getResource(t.nameSelector(s));return c||(c={name:s,url:s,type:"image",root:i.root}),e.load(c).then(function(t){var i=new egret.BitmapFont(t,a);return i.$resourceInfo=c,e.save(c,t),i})})},onRemoveStart:function(t,e){var i=t.get(e).$resourceInfo;t.unload(i)}},e.SoundProcessor={onLoadStart:function(e,r){var n=new egret.Sound;return n.load(t.getVirtualUrl(r.root+r.url)),i(n,r).then(function(){return n})},onRemoveStart:function(t,e){}},e.MovieClipProcessor={onLoadStart:function(e,i){var r,n;return e.load(i,"json").then(function(a){r=a;var s=i.name,o=s.substring(0,s.lastIndexOf("."))+".png";if(!(n=e.resourceConfig.getResource(o,!0)))throw new t.ResourceManagerError(1001,o);return e.load(n)}).then(function(t){e.save(n,t);var i=t;return new egret.MovieClipDataFactory(r,i)})},onRemoveStart:function(t,e){var i=t.get(e);i.clearCache(),i.$spriteSheet.dispose();var r=e.name,n=r.substring(0,r.lastIndexOf("."))+".png",a=t.resourceConfig.getResource(n,!0);t.unload(a)}},e.MergeJSONProcessor={onLoadStart:function(e,i){return e.load(i,"json").then(function(e){for(var r in e)t.config.addSubkey(r,i.name);return e})},getData:function(t,e,i,r){var n=t.get(e);return n?n[r]:(console.error("missing resource :"+e.name),null)},onRemoveStart:function(t,e){}},e.LegacyResourceConfigProcessor={onLoadStart:function(e,i){return e.load(i,"json").then(function(r){var n=t.config.config,a=i.root,s=n.fileSystem;s||(s={fsData:{},getFile:function(t){return p[t]},addFile:function(t,e,i,r){e||(e=""),void 0==i&&(i=""),p[t]={name:t,type:e,url:t,root:i,extra:r}},profile:function(){console.log(p)},removeFile:function(t){delete p[t]}},n.fileSystem=s);for(var o=n.groups,h=0,l=r.groups;h<l.length;h++){var u=l[h];""==u.keys?o[u.name]=[]:o[u.name]=u.keys.split(",")}for(var c=n.alias,p=s.fsData,f=function(t){p[t.name]=t,p[t.name].root=a,t.subkeys&&t.subkeys.split(",").forEach(function(e){c[e]=t.name+"#"+e,c[t.name+"."+e]=t.name+"#"+e})},d=0,m=r.resources;d<m.length;d++)f(m[d]);return e.save(i,n),n})},onRemoveStart:function(){}},e._map={image:e.ImageProcessor,json:e.JsonProcessor,text:e.TextProcessor,xml:e.XMLProcessor,sheet:e.SheetProcessor,font:e.FontProcessor,bin:e.BinaryProcessor,commonjs:e.CommonJSProcessor,sound:e.SoundProcessor,movieclip:e.MovieClipProcessor,mergeJson:e.MergeJSONProcessor,legacyResourceConfig:e.LegacyResourceConfigProcessor}}(t.processor||(t.processor={}))}(Y||(Y={})),function(t){var e=function(e){function i(t,i,r){void 0===i&&(i=!1),void 0===r&&(r=!1);var n=e.call(this,t,i,r)||this;return n.itemsLoaded=0,n.itemsTotal=0,n.groupName="",n}return V(i,e),i.dispatchResourceEvent=function(e,r,n,a,s,o){void 0===n&&(n=""),void 0===a&&(a=void 0),void 0===s&&(s=0),void 0===o&&(o=0);var h=egret.Event.create(i,r);h.groupName=n,a&&(h.resItem=t.ResourceItem.convertToResItem(a)),h.itemsLoaded=s,h.itemsTotal=o;var l=e.dispatchEvent(h);return egret.Event.release(h),l},i.ITEM_LOAD_ERROR="itemLoadError",i.CONFIG_COMPLETE="configComplete",i.CONFIG_LOAD_ERROR="configLoadError",i.GROUP_PROGRESS="groupProgress",i.GROUP_COMPLETE="groupComplete",i.GROUP_LOAD_ERROR="groupLoadError",i}(egret.Event);t.ResourceEvent=e,G(e.prototype,"RES.ResourceEvent")}(Y||(Y={})),function(t){!function(e){e.TYPE_XML="xml",e.TYPE_IMAGE="image",e.TYPE_BIN="bin",e.TYPE_TEXT="text",e.TYPE_JSON="json",e.TYPE_SHEET="sheet",e.TYPE_FONT="font",e.TYPE_SOUND="sound",e.convertToResItem=function(e){var i=e.name;if(t.config.config)for(var r in t.config.config.alias)t.config.config.alias[r]==e.url&&(i=r);else i=e.url;return{name:i,url:e.url,type:e.type,data:e,root:e.root}}}(t.ResourceItem||(t.ResourceItem={}))}(Y||(Y={})),function(t){var e=function(){function e(t){this.data=t}return e.prototype.profile=function(){console.log(this.data)},e.prototype.addFile=function(e,i){i||(i=""),e=t.path.normalize(e);var r=t.path.basename(e),n=t.path.dirname(e);this.exists(n)||this.mkdir(n),this.resolve(n)[r]={url:e,type:i}},e.prototype.getFile=function(t){var e=this.resolve(t);return e&&(e.name=t),e},e.prototype.resolve=function(e){if(""==e)return this.data;for(var i=(e=t.path.normalize(e)).split("/"),r=this.data,n=0,a=i;n<a.length;n++){var s=a[n];if(!r)return r;r=r[s]}return r},e.prototype.mkdir=function(e){for(var i=(e=t.path.normalize(e)).split("/"),r=this.data,n=0,a=i;n<a.length;n++){var s=a[n];r[s]||(r[s]={}),r=r[s]}},e.prototype.exists=function(e){if(""==e)return!0;for(var i=(e=t.path.normalize(e)).split("/"),r=this.data,n=0,a=i;n<a.length;n++){var s=a[n];if(!r[s])return!1;r=r[s]}return!0},e}();t.NewFileSystem=e,G(e.prototype,"RES.NewFileSystem")}(Y||(Y={})),function(t){var e={};t.profile=function(){t.config.config.fileSystem.profile(),console.log(e);var i=0;for(var r in e){var n=e[r];n instanceof egret.Texture&&(i+=n.$bitmapWidth*n.$bitmapHeight*4)}console.log("gpu size : "+(i/1024).toFixed(3)+"kb")},t.host={state:{},get resourceConfig(){return t.config},load:function(e,i){var r="string"==typeof i?t.processor._map[i]:i;return t.queue.loadResource(e,r)},unload:function(e){return t.queue.unloadResource(e)},save:function(i,r){t.host.state[i.root+i.name]=2,i.promise=void 0,e[i.url]=r},get:function(t){return e[t.url]},remove:function(i){delete t.host.state[i.root+i.name],delete e[i.url]}},t.config=new t.ResourceConfig,t.queue=new t.ResourceLoader;var i=function(t){function e(i,r,n){var a=t.call(this)||this;return a.__resource_manager_error__=!0,a.name=i.toString(),a.message=e.errorMessage[i].replace("{0}",r).replace("{1}",n),a}return V(e,t),e.errorMessage={1001:"文件加载失败:{0}",1002:"ResourceManager 初始化失败：配置文件加载失败",2001:"{0}解析失败,不支持指定解析类型:'{1}'，请编写自定义 Processor ，更多内容请参见 https://github.com/egret-labs/resourcemanager/blob/master/docs/README.md#processor",2002:"Analyzer 相关API 在 ResourceManager 中不再支持，请编写自定义 Processor ，更多内容请参见 https://github.com/egret-labs/resourcemanager/blob/master/docs/README.md#processor",2003:"{0}解析失败,错误原因:{1}",2004:"无法找到文件类型:{0}",2005:"资源配置文件中无法找到特定的资源组:{0}",2006:"资源配置文件中无法找到特定的资源:{0}"},e}(Error);t.ResourceManagerError=i,G(i.prototype,"RES.ResourceManagerError")}(Y||(Y={})),window.RES=Y}).call(this,i(3),i(4))},function(t,e){var i,r,n=t.exports={};function a(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function o(t){if(i===setTimeout)return setTimeout(t,0);if((i===a||!i)&&setTimeout)return i=setTimeout,setTimeout(t,0);try{return i(t,0)}catch(e){try{return i.call(null,t,0)}catch(e){return i.call(this,t,0)}}}!function(){try{i="function"==typeof setTimeout?setTimeout:a}catch(t){i=a}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(t){r=s}}();var h,l=[],u=!1,c=-1;function p(){u&&h&&(u=!1,h.length?l=h.concat(l):c=-1,l.length&&f())}function f(){if(!u){var t=o(p);u=!0;for(var e=l.length;e;){for(h=l,l=[];++c<e;)h&&h[c].run();c=-1,e=l.length}h=null,u=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function d(t,e){this.fun=t,this.array=e}function m(){}n.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];l.push(new d(t,e)),1!==l.length||u||o(f)},d.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=m,n.addListener=m,n.once=m,n.off=m,n.removeListener=m,n.removeAllListeners=m,n.emit=m,n.prependListener=m,n.prependOnceListener=m,n.listeners=function(t){return[]},n.binding=function(t){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(t){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},function(t,e){var i;i=function(){return this}();try{i=i||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(i=window)}t.exports=i},function(t,e,i){"use strict";var r,n,a,s=this&&this.__extends||(Object.setPrototypeOf||Array);if(a||(a={}),function(t){var e=function(){function e(e){this._clock=new t.WorldClock,this._events=[],this._objects=[],this._eventManager=null,this._eventManager=e}return e.prototype.advanceTime=function(e){if(this._objects.length>0){for(var i=0,r=this._objects;i<r.length;i++)r[i].returnToPool();this._objects.length=0}if(this._clock.advanceTime(e),this._events.length>0){for(var n=0;n<this._events.length;++n){var a=this._events[n],s=a.armature;null!==s._armatureData&&(s.eventDispatcher.dispatchDBEvent(a.type,a),a.type===t.EventObject.SOUND_EVENT&&this._eventManager.dispatchDBEvent(a.type,a)),this.bufferObject(a)}this._events.length=0}},e.prototype.bufferEvent=function(t){this._events.indexOf(t)<0&&this._events.push(t)},e.prototype.bufferObject=function(t){this._objects.indexOf(t)<0&&this._objects.push(t)},Object.defineProperty(e.prototype,"clock",{get:function(){return this._clock},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"eventManager",{get:function(){return this._eventManager},enumerable:!0,configurable:!0}),e.VERSION="5.6.300",e.yDown=!0,e.debug=!1,e.debugDraw=!1,e.webAssembly=!1,e}();t.DragonBones=e}(a||(a={})),void 0===o)var o=window;console.warn||(console.warn=function(){}),console.assert||(console.assert=function(){}),Date.now||(Date.now=function(){return(new Date).getTime()}),s=function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);i.prototype=e.prototype,t.prototype=new i},function(t){var e=function(){function t(){this.hashCode=t._hashCode++,this._isInPool=!1}return t._returnObject=function(e){var i=String(e.constructor),r=i in t._maxCountMap?t._maxCountMap[i]:t._defaultMaxCount,n=t._poolsMap[i]=t._poolsMap[i]||[];n.length<r&&(e._isInPool?console.warn("The object is already in the pool."):(e._isInPool=!0,n.push(e)))},t.toString=function(){throw new Error},t.setMaxCount=function(e,i){if((i<0||i!=i)&&(i=0),null!==e)null!==(n=(r=String(e))in t._poolsMap?t._poolsMap[r]:null)&&n.length>i&&(n.length=i),t._maxCountMap[r]=i;else for(var r in t._defaultMaxCount=i,t._poolsMap){var n;(n=t._poolsMap[r]).length>i&&(n.length=i),r in t._maxCountMap&&(t._maxCountMap[r]=i)}},t.clearPool=function(e){if(void 0===e&&(e=null),null!==e){var i=String(e);null!==(n=i in t._poolsMap?t._poolsMap[i]:null)&&n.length>0&&(n.length=0)}else for(var r in t._poolsMap){var n;(n=t._poolsMap[r]).length=0}},t.borrowObject=function(e){var i=String(e),r=i in t._poolsMap?t._poolsMap[i]:null;if(null!==r&&r.length>0){var n=r.pop();return n._isInPool=!1,n}var a=new e;return a._onClear(),a},t.prototype.returnToPool=function(){this._onClear(),t._returnObject(this)},t._hashCode=0,t._defaultMaxCount=3e3,t._maxCountMap={},t._poolsMap={},t}();t.BaseObject=e}(a||(a={})),function(t){var e=function(){function t(t,e,i,r,n,a){void 0===t&&(t=1),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=1),void 0===n&&(n=0),void 0===a&&(a=0),this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=a}return t.prototype.toString=function(){return"[object dragonBones.Matrix] a:"+this.a+" b:"+this.b+" c:"+this.c+" d:"+this.d+" tx:"+this.tx+" ty:"+this.ty},t.prototype.copyFrom=function(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},t.prototype.copyFromArray=function(t,e){return void 0===e&&(e=0),this.a=t[e],this.b=t[e+1],this.c=t[e+2],this.d=t[e+3],this.tx=t[e+4],this.ty=t[e+5],this},t.prototype.identity=function(){return this.a=this.d=1,this.b=this.c=0,this.tx=this.ty=0,this},t.prototype.concat=function(t){var e=this.a*t.a,i=0,r=0,n=this.d*t.d,a=this.tx*t.a+t.tx,s=this.ty*t.d+t.ty;return 0===this.b&&0===this.c||(e+=this.b*t.c,i+=this.b*t.d,r+=this.c*t.a,n+=this.c*t.b),0===t.b&&0===t.c||(i+=this.a*t.b,r+=this.d*t.c,a+=this.ty*t.c,s+=this.tx*t.b),this.a=e,this.b=i,this.c=r,this.d=n,this.tx=a,this.ty=s,this},t.prototype.invert=function(){var t=this.a,e=this.b,i=this.c,r=this.d,n=this.tx,a=this.ty;if(0===e&&0===i)return this.b=this.c=0,0===t||0===r?this.a=this.b=this.tx=this.ty=0:(t=this.a=1/t,r=this.d=1/r,this.tx=-t*n,this.ty=-r*a),this;var s=t*r-e*i;if(0===s)return this.a=this.d=1,this.b=this.c=0,this.tx=this.ty=0,this;s=1/s;var o=this.a=r*s;return e=this.b=-e*s,i=this.c=-i*s,r=this.d=t*s,this.tx=-(o*n+i*a),this.ty=-(e*n+r*a),this},t.prototype.transformPoint=function(t,e,i,r){void 0===r&&(r=!1),i.x=this.a*t+this.c*e,i.y=this.b*t+this.d*e,r||(i.x+=this.tx,i.y+=this.ty)},t.prototype.transformRectangle=function(t,e){void 0===e&&(e=!1);var i=this.a,r=this.b,n=this.c,a=this.d,s=e?0:this.tx,o=e?0:this.ty,h=t.x,l=t.y,u=h+t.width,c=l+t.height,p=i*h+n*l+s,f=r*h+a*l+o,d=i*u+n*l+s,m=r*u+a*l+o,g=i*u+n*c+s,y=r*u+a*c+o,_=i*h+n*c+s,v=r*h+a*c+o,b=0;p>d&&(b=p,p=d,d=b),g>_&&(b=g,g=_,_=b),t.x=Math.floor(p<g?p:g),t.width=Math.ceil((d>_?d:_)-t.x),f>m&&(b=f,f=m,m=b),y>v&&(b=y,y=v,v=b),t.y=Math.floor(f<y?f:y),t.height=Math.ceil((m>v?m:v)-t.y)},t}();t.Matrix=e}(a||(a={})),function(t){var e=function(){function t(t,e,i,r,n,a){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),void 0===n&&(n=1),void 0===a&&(a=1),this.x=t,this.y=e,this.skew=i,this.rotation=r,this.scaleX=n,this.scaleY=a}return t.normalizeRadian=function(t){return(t=(t+Math.PI)%(2*Math.PI))+(t>0?-Math.PI:Math.PI)},t.prototype.toString=function(){return"[object dragonBones.Transform] x:"+this.x+" y:"+this.y+" skewX:"+180*this.skew/Math.PI+" skewY:"+180*this.rotation/Math.PI+" scaleX:"+this.scaleX+" scaleY:"+this.scaleY},t.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.skew=t.skew,this.rotation=t.rotation,this.scaleX=t.scaleX,this.scaleY=t.scaleY,this},t.prototype.identity=function(){return this.x=this.y=0,this.skew=this.rotation=0,this.scaleX=this.scaleY=1,this},t.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this.skew+=t.skew,this.rotation+=t.rotation,this.scaleX*=t.scaleX,this.scaleY*=t.scaleY,this},t.prototype.minus=function(t){return this.x-=t.x,this.y-=t.y,this.skew-=t.skew,this.rotation-=t.rotation,this.scaleX/=t.scaleX,this.scaleY/=t.scaleY,this},t.prototype.fromMatrix=function(e){var i=this.scaleX,r=this.scaleY,n=t.PI_Q;this.x=e.tx,this.y=e.ty,this.rotation=Math.atan(e.b/e.a);var a=Math.atan(-e.c/e.d);return this.scaleX=this.rotation>-n&&this.rotation<n?e.a/Math.cos(this.rotation):e.b/Math.sin(this.rotation),this.scaleY=a>-n&&a<n?e.d/Math.cos(a):-e.c/Math.sin(a),i>=0&&this.scaleX<0&&(this.scaleX=-this.scaleX,this.rotation=this.rotation-Math.PI),r>=0&&this.scaleY<0&&(this.scaleY=-this.scaleY,a-=Math.PI),this.skew=a-this.rotation,this},t.prototype.toMatrix=function(t){return 0===this.rotation?(t.a=1,t.b=0):(t.a=Math.cos(this.rotation),t.b=Math.sin(this.rotation)),0===this.skew?(t.c=-t.b,t.d=t.a):(t.c=-Math.sin(this.skew+this.rotation),t.d=Math.cos(this.skew+this.rotation)),1!==this.scaleX&&(t.a*=this.scaleX,t.b*=this.scaleX),1!==this.scaleY&&(t.c*=this.scaleY,t.d*=this.scaleY),t.tx=this.x,t.ty=this.y,this},t.PI=Math.PI,t.PI_D=2*Math.PI,t.PI_H=Math.PI/2,t.PI_Q=Math.PI/4,t.RAD_DEG=180/Math.PI,t.DEG_RAD=Math.PI/180,t}();t.Transform=e}(a||(a={})),function(t){var e=function(){function t(t,e,i,r,n,a,s,o){void 0===t&&(t=1),void 0===e&&(e=1),void 0===i&&(i=1),void 0===r&&(r=1),void 0===n&&(n=0),void 0===a&&(a=0),void 0===s&&(s=0),void 0===o&&(o=0),this.alphaMultiplier=t,this.redMultiplier=e,this.greenMultiplier=i,this.blueMultiplier=r,this.alphaOffset=n,this.redOffset=a,this.greenOffset=s,this.blueOffset=o}return t.prototype.copyFrom=function(t){this.alphaMultiplier=t.alphaMultiplier,this.redMultiplier=t.redMultiplier,this.greenMultiplier=t.greenMultiplier,this.blueMultiplier=t.blueMultiplier,this.alphaOffset=t.alphaOffset,this.redOffset=t.redOffset,this.greenOffset=t.greenOffset,this.blueOffset=t.blueOffset},t.prototype.identity=function(){this.alphaMultiplier=this.redMultiplier=this.greenMultiplier=this.blueMultiplier=1,this.alphaOffset=this.redOffset=this.greenOffset=this.blueOffset=0},t}();t.ColorTransform=e}(a||(a={})),function(t){var e=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}return t.prototype.copyFrom=function(t){this.x=t.x,this.y=t.y},t.prototype.clear=function(){this.x=this.y=0},t}();t.Point=e}(a||(a={})),function(t){var e=function(){function t(t,e,i,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),this.x=t,this.y=e,this.width=i,this.height=r}return t.prototype.copyFrom=function(t){this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height},t.prototype.clear=function(){this.x=this.y=0,this.width=this.height=0},t}();t.Rectangle=e}(a||(a={})),function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ints=[],e.floats=[],e.strings=[],e}return s(e,t),e.toString=function(){return"[class dragonBones.UserData]"},e.prototype._onClear=function(){this.ints.length=0,this.floats.length=0,this.strings.length=0},e.prototype.addInt=function(t){this.ints.push(t)},e.prototype.addFloat=function(t){this.floats.push(t)},e.prototype.addString=function(t){this.strings.push(t)},e.prototype.getInt=function(t){return void 0===t&&(t=0),t>=0&&t<this.ints.length?this.ints[t]:0},e.prototype.getFloat=function(t){return void 0===t&&(t=0),t>=0&&t<this.floats.length?this.floats[t]:0},e.prototype.getString=function(t){return void 0===t&&(t=0),t>=0&&t<this.strings.length?this.strings[t]:""},e}(t.BaseObject);t.UserData=e;var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.data=null,e}return s(e,t),e.toString=function(){return"[class dragonBones.ActionData]"},e.prototype._onClear=function(){null!==this.data&&this.data.returnToPool(),this.type=0,this.name="",this.bone=null,this.slot=null,this.data=null},e}(t.BaseObject);t.ActionData=i}(a||(a={})),function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.frameIndices=[],e.cachedFrames=[],e.armatureNames=[],e.armatures={},e.userData=null,e}return s(e,t),e.toString=function(){return"[class dragonBones.DragonBonesData]"},e.prototype._onClear=function(){for(var t in this.armatures)this.armatures[t].returnToPool(),delete this.armatures[t];null!==this.userData&&this.userData.returnToPool(),this.autoSearch=!1,this.frameRate=0,this.version="",this.name="",this.stage=null,this.frameIndices.length=0,this.cachedFrames.length=0,this.armatureNames.length=0,this.binary=null,this.intArray=null,this.floatArray=null,this.frameIntArray=null,this.frameFloatArray=null,this.frameArray=null,this.timelineArray=null,this.userData=null},e.prototype.addArmature=function(t){t.name in this.armatures?console.warn("Same armature: "+t.name):(t.parent=this,this.armatures[t.name]=t,this.armatureNames.push(t.name))},e.prototype.getArmature=function(t){return t in this.armatures?this.armatures[t]:null},e.prototype.dispose=function(){console.warn("已废弃"),this.returnToPool()},e}(t.BaseObject);t.DragonBonesData=e}(a||(a={})),function(t){var e=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.aabb=new t.Rectangle,i.animationNames=[],i.sortedBones=[],i.sortedSlots=[],i.defaultActions=[],i.actions=[],i.bones={},i.slots={},i.constraints={},i.skins={},i.animations={},i.canvas=null,i.userData=null,i}return s(i,e),i.toString=function(){return"[class dragonBones.ArmatureData]"},i.prototype._onClear=function(){for(var t=0,e=this.defaultActions;t<e.length;t++)e[t].returnToPool();for(var i=0,r=this.actions;i<r.length;i++)r[i].returnToPool();for(var n in this.bones)this.bones[n].returnToPool(),delete this.bones[n];for(var n in this.slots)this.slots[n].returnToPool(),delete this.slots[n];for(var n in this.constraints)this.constraints[n].returnToPool(),delete this.constraints[n];for(var n in this.skins)this.skins[n].returnToPool(),delete this.skins[n];for(var n in this.animations)this.animations[n].returnToPool(),delete this.animations[n];null!==this.canvas&&this.canvas.returnToPool(),null!==this.userData&&this.userData.returnToPool(),this.type=0,this.frameRate=0,this.cacheFrameRate=0,this.scale=1,this.name="",this.aabb.clear(),this.animationNames.length=0,this.sortedBones.length=0,this.sortedSlots.length=0,this.defaultActions.length=0,this.actions.length=0,this.defaultSkin=null,this.defaultAnimation=null,this.canvas=null,this.userData=null,this.parent=null},i.prototype.sortBones=function(){var t=this.sortedBones.length;if(!(t<=0)){var e=this.sortedBones.concat(),i=0,r=0;for(this.sortedBones.length=0;r<t;){var n=e[i++];if(i>=t&&(i=0),!(this.sortedBones.indexOf(n)>=0)){var a=!1;for(var s in this.constraints){var o=this.constraints[s];if(o.root===n&&this.sortedBones.indexOf(o.target)<0){a=!0;break}}a||null!==n.parent&&this.sortedBones.indexOf(n.parent)<0||(this.sortedBones.push(n),r++)}}}},i.prototype.cacheFrames=function(t){if(!(this.cacheFrameRate>0))for(var e in this.cacheFrameRate=t,this.animations)this.animations[e].cacheFrames(this.cacheFrameRate)},i.prototype.setCacheFrame=function(t,e){var i=this.parent.cachedFrames,r=i.length;return i.length+=10,i[r]=t.a,i[r+1]=t.b,i[r+2]=t.c,i[r+3]=t.d,i[r+4]=t.tx,i[r+5]=t.ty,i[r+6]=e.rotation,i[r+7]=e.skew,i[r+8]=e.scaleX,i[r+9]=e.scaleY,r},i.prototype.getCacheFrame=function(t,e,i){var r=this.parent.cachedFrames;t.a=r[i],t.b=r[i+1],t.c=r[i+2],t.d=r[i+3],t.tx=r[i+4],t.ty=r[i+5],e.rotation=r[i+6],e.skew=r[i+7],e.scaleX=r[i+8],e.scaleY=r[i+9],e.x=t.tx,e.y=t.ty},i.prototype.addBone=function(t){t.name in this.bones?console.warn("Same bone: "+t.name):(this.bones[t.name]=t,this.sortedBones.push(t))},i.prototype.addSlot=function(t){t.name in this.slots?console.warn("Same slot: "+t.name):(this.slots[t.name]=t,this.sortedSlots.push(t))},i.prototype.addConstraint=function(t){t.name in this.constraints?console.warn("Same constraint: "+t.name):this.constraints[t.name]=t},i.prototype.addSkin=function(t){t.name in this.skins?console.warn("Same skin: "+t.name):(t.parent=this,this.skins[t.name]=t,null===this.defaultSkin&&(this.defaultSkin=t),"default"===t.name&&(this.defaultSkin=t))},i.prototype.addAnimation=function(t){t.name in this.animations?console.warn("Same animation: "+t.name):(t.parent=this,this.animations[t.name]=t,this.animationNames.push(t.name),null===this.defaultAnimation&&(this.defaultAnimation=t))},i.prototype.addAction=function(t,e){e?this.defaultActions.push(t):this.actions.push(t)},i.prototype.getBone=function(t){return t in this.bones?this.bones[t]:null},i.prototype.getSlot=function(t){return t in this.slots?this.slots[t]:null},i.prototype.getConstraint=function(t){return t in this.constraints?this.constraints[t]:null},i.prototype.getSkin=function(t){return t in this.skins?this.skins[t]:null},i.prototype.getMesh=function(t,e,i){var r=this.getSkin(t);return null===r?null:r.getDisplay(e,i)},i.prototype.getAnimation=function(t){return t in this.animations?this.animations[t]:null},i}(t.BaseObject);t.ArmatureData=e;var i=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transform=new t.Transform,i.userData=null,i}return s(i,e),i.toString=function(){return"[class dragonBones.BoneData]"},i.prototype._onClear=function(){null!==this.userData&&this.userData.returnToPool(),this.inheritTranslation=!1,this.inheritRotation=!1,this.inheritScale=!1,this.inheritReflection=!1,this.type=0,this.length=0,this.name="",this.transform.identity(),this.userData=null,this.parent=null},i}(t.BaseObject);t.BoneData=i;var r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.vertices=[],e}return s(e,t),e.toString=function(){return"[class dragonBones.SurfaceData]"},e.prototype._onClear=function(){t.prototype._onClear.call(this),this.type=1,this.segmentX=0,this.segmentY=0,this.vertices.length=0},e}(i);t.SurfaceData=r;var n=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.color=null,t.userData=null,t}return s(i,e),i.createColor=function(){return new t.ColorTransform},i.toString=function(){return"[class dragonBones.SlotData]"},i.prototype._onClear=function(){null!==this.userData&&this.userData.returnToPool(),this.blendMode=0,this.displayIndex=0,this.zOrder=0,this.name="",this.color=null,this.userData=null,this.parent=null},i.DEFAULT_COLOR=new t.ColorTransform,i}(t.BaseObject);t.SlotData=n}(a||(a={})),function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.toString=function(){return"[class dragonBones.CanvasData]"},e.prototype._onClear=function(){this.hasBackground=!1,this.color=0,this.x=0,this.y=0,this.width=0,this.height=0},e}(t.BaseObject);t.CanvasData=e}(a||(a={})),function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.displays={},e}return s(e,t),e.toString=function(){return"[class dragonBones.SkinData]"},e.prototype._onClear=function(){for(var t in this.displays){for(var e=0,i=this.displays[t];e<i.length;e++){var r=i[e];null!==r&&r.returnToPool()}delete this.displays[t]}this.name="",this.parent=null},e.prototype.addDisplay=function(t,e){t in this.displays||(this.displays[t]=[]),null!==e&&(e.parent=this),this.displays[t].push(e)},e.prototype.getDisplay=function(t,e){var i=this.getDisplays(t);if(null!==i)for(var r=0,n=i;r<n.length;r++){var a=n[r];if(null!==a&&a.name===e)return a}return null},e.prototype.getDisplays=function(t){return t in this.displays?this.displays[t]:null},e}(t.BaseObject);t.SkinData=e}(a||(a={})),function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype._onClear=function(){this.order=0,this.name="",this.type=0,this.target=null,this.root=null,this.bone=null},e}(t.BaseObject);t.ConstraintData=e;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.toString=function(){return"[class dragonBones.IKConstraintData]"},e.prototype._onClear=function(){t.prototype._onClear.call(this),this.scaleEnabled=!1,this.bendPositive=!1,this.weight=1},e}(e);t.IKConstraintData=i;var r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bones=[],e}return s(e,t),e.toString=function(){return"[class dragonBones.PathConstraintData]"},e.prototype._onClear=function(){t.prototype._onClear.call(this),this.pathSlot=null,this.pathDisplayData=null,this.bones.length=0,this.positionMode=0,this.spacingMode=1,this.rotateMode=1,this.position=0,this.spacing=0,this.rotateOffset=0,this.rotateMix=0,this.translateMix=0},e.prototype.AddBone=function(t){this.bones.push(t)},e}(e);t.PathConstraintData=r}(a||(a={})),function(t){var e=function(){function t(){this.weight=null}return t.prototype.clear=function(){this.isShared||null===this.weight||this.weight.returnToPool(),this.isShared=!1,this.inheritDeform=!1,this.offset=0,this.data=null,this.weight=null},t.prototype.shareFrom=function(t){this.isShared=!0,this.offset=t.offset,this.weight=t.weight},t}();t.VerticesData=e;var i=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transform=new t.Transform,i}return s(i,e),i.prototype._onClear=function(){this.name="",this.path="",this.transform.identity(),this.parent=null},i}(t.BaseObject);t.DisplayData=i;var r=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.pivot=new t.Point,i}return s(i,e),i.toString=function(){return"[class dragonBones.ImageDisplayData]"},i.prototype._onClear=function(){e.prototype._onClear.call(this),this.type=0,this.pivot.clear(),this.texture=null},i}(i);t.ImageDisplayData=r;var n=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.actions=[],e}return s(e,t),e.toString=function(){return"[class dragonBones.ArmatureDisplayData]"},e.prototype._onClear=function(){t.prototype._onClear.call(this);for(var e=0,i=this.actions;e<i.length;e++)i[e].returnToPool();this.type=1,this.inheritAnimation=!1,this.actions.length=0,this.armature=null},e.prototype.addAction=function(t){this.actions.push(t)},e}(i);t.ArmatureDisplayData=n;var a=function(t){function i(){var i=null!==t&&t.apply(this,arguments)||this;return i.vertices=new e,i}return s(i,t),i.toString=function(){return"[class dragonBones.MeshDisplayData]"},i.prototype._onClear=function(){t.prototype._onClear.call(this),this.type=2,this.vertices.clear(),this.texture=null},i}(i);t.MeshDisplayData=a;var o=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.boundingBox=null,e}return s(e,t),e.toString=function(){return"[class dragonBones.BoundingBoxDisplayData]"},e.prototype._onClear=function(){t.prototype._onClear.call(this),null!==this.boundingBox&&this.boundingBox.returnToPool(),this.type=3,this.boundingBox=null},e}(i);t.BoundingBoxDisplayData=o;var h=function(t){function i(){var i=null!==t&&t.apply(this,arguments)||this;return i.vertices=new e,i.curveLengths=[],i}return s(i,t),i.toString=function(){return"[class dragonBones.PathDisplayData]"},i.prototype._onClear=function(){t.prototype._onClear.call(this),this.type=4,this.closed=!1,this.constantSpeed=!1,this.vertices.clear(),this.curveLengths.length=0},i}(i);t.PathDisplayData=h;var l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bones=[],e}return s(e,t),e.toString=function(){return"[class dragonBones.WeightData]"},e.prototype._onClear=function(){this.count=0,this.offset=0,this.bones.length=0},e.prototype.addBone=function(t){this.bones.push(t)},e}(t.BaseObject);t.WeightData=l}(a||(a={})),function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype._onClear=function(){this.color=0,this.width=0,this.height=0},e}(t.BaseObject);t.BoundingBoxData=e;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.toString=function(){return"[class dragonBones.RectangleBoundingBoxData]"},e._computeOutCode=function(t,e,i,r,n,a){var s=0;return t<i?s|=1:t>n&&(s|=2),e<r?s|=4:e>a&&(s|=8),s},e.rectangleIntersectsSegment=function(t,i,r,n,a,s,o,h,l,u,c){void 0===l&&(l=null),void 0===u&&(u=null),void 0===c&&(c=null);var p=t>a&&t<o&&i>s&&i<h,f=r>a&&r<o&&n>s&&n<h;if(p&&f)return-1;for(var d=0,m=e._computeOutCode(t,i,a,s,o,h),g=e._computeOutCode(r,n,a,s,o,h);;){if(0==(m|g)){d=2;break}if(0!=(m&g))break;var y=0,_=0,v=0,b=0!==m?m:g;0!=(4&b)?(y=t+(r-t)*(s-i)/(n-i),_=s,null!==c&&(v=.5*-Math.PI)):0!=(8&b)?(y=t+(r-t)*(h-i)/(n-i),_=h,null!==c&&(v=.5*Math.PI)):0!=(2&b)?(_=i+(n-i)*(o-t)/(r-t),y=o,null!==c&&(v=0)):0!=(1&b)&&(_=i+(n-i)*(a-t)/(r-t),y=a,null!==c&&(v=Math.PI)),b===m?(t=y,i=_,m=e._computeOutCode(t,i,a,s,o,h),null!==c&&(c.x=v)):(r=y,n=_,g=e._computeOutCode(r,n,a,s,o,h),null!==c&&(c.y=v))}return d&&(p?(d=2,null!==l&&(l.x=r,l.y=n),null!==u&&(u.x=r,u.y=r),null!==c&&(c.x=c.y+Math.PI)):f?(d=1,null!==l&&(l.x=t,l.y=i),null!==u&&(u.x=t,u.y=i),null!==c&&(c.y=c.x+Math.PI)):(d=3,null!==l&&(l.x=t,l.y=i),null!==u&&(u.x=r,u.y=n))),d},e.prototype._onClear=function(){t.prototype._onClear.call(this),this.type=0},e.prototype.containsPoint=function(t,e){var i=.5*this.width;if(t>=-i&&t<=i){var r=.5*this.height;if(e>=-r&&e<=r)return!0}return!1},e.prototype.intersectsSegment=function(t,i,r,n,a,s,o){void 0===a&&(a=null),void 0===s&&(s=null),void 0===o&&(o=null);var h=.5*this.width,l=.5*this.height;return e.rectangleIntersectsSegment(t,i,r,n,-h,-l,h,l,a,s,o)},e}(e);t.RectangleBoundingBoxData=i;var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.toString=function(){return"[class dragonBones.EllipseData]"},e.ellipseIntersectsSegment=function(t,e,i,r,n,a,s,o,h,l,u){void 0===h&&(h=null),void 0===l&&(l=null),void 0===u&&(u=null);var c=s/o,p=c*c,f=i-t,d=(r*=c)-(e*=c),m=Math.sqrt(f*f+d*d),g=f/m,y=d/m,_=(n-t)*g+(a-e)*y,v=s*s,b=v-(t*t+e*e)+_*_,T=0;if(b>=0){var x=Math.sqrt(b),D=_-x,$=_+x,E=D<0?-1:D<=m?0:1,w=$<0?-1:$<=m?0:1,A=E*w;if(A<0)return-1;0===A&&(-1===E?(T=2,i=t+$*g,r=(e+$*y)/c,null!==h&&(h.x=i,h.y=r),null!==l&&(l.x=i,l.y=r),null!==u&&(u.x=Math.atan2(r/v*p,i/v),u.y=u.x+Math.PI)):1===w?(T=1,t+=D*g,e=(e+D*y)/c,null!==h&&(h.x=t,h.y=e),null!==l&&(l.x=t,l.y=e),null!==u&&(u.x=Math.atan2(e/v*p,t/v),u.y=u.x+Math.PI)):(T=3,null!==h&&(h.x=t+D*g,h.y=(e+D*y)/c,null!==u&&(u.x=Math.atan2(h.y/v*p,h.x/v))),null!==l&&(l.x=t+$*g,l.y=(e+$*y)/c,null!==u&&(u.y=Math.atan2(l.y/v*p,l.x/v)))))}return T},e.prototype._onClear=function(){t.prototype._onClear.call(this),this.type=1},e.prototype.containsPoint=function(t,e){var i=.5*this.width;if(t>=-i&&t<=i){var r=.5*this.height;if(e>=-r&&e<=r)return e*=i/r,Math.sqrt(t*t+e*e)<=i}return!1},e.prototype.intersectsSegment=function(t,i,r,n,a,s,o){return void 0===a&&(a=null),void 0===s&&(s=null),void 0===o&&(o=null),e.ellipseIntersectsSegment(t,i,r,n,0,0,.5*this.width,.5*this.height,a,s,o)},e}(e);t.EllipseBoundingBoxData=r;var n=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.vertices=[],e}return s(e,t),e.toString=function(){return"[class dragonBones.PolygonBoundingBoxData]"},e.polygonIntersectsSegment=function(t,e,i,r,n,a,s,o){void 0===a&&(a=null),void 0===s&&(s=null),void 0===o&&(o=null),t===i&&(t=i+1e-6),e===r&&(e=r+1e-6);for(var h=n.length,l=t-i,u=e-r,c=t*r-e*i,p=0,f=n[h-2],d=n[h-1],m=0,g=0,y=0,_=0,v=0,b=0,T=0;T<h;T+=2){var x=n[T],D=n[T+1];f===x&&(f=x+1e-4),d===D&&(d=D+1e-4);var $=f-x,E=d-D,w=f*D-d*x,A=l*E-u*$,S=(c*$-l*w)/A;if((S>=f&&S<=x||S>=x&&S<=f)&&(0===l||S>=t&&S<=i||S>=i&&S<=t)){var O=(c*E-u*w)/A;if((O>=d&&O<=D||O>=D&&O<=d)&&(0===u||O>=e&&O<=r||O>=r&&O<=e)){if(null===s){y=S,_=O,v=S,b=O,p++,null!==o&&(o.x=Math.atan2(D-d,x-f)-.5*Math.PI,o.y=o.x);break}var C=S-t;C<0&&(C=-C),0===p?(m=C,g=C,y=S,_=O,v=S,b=O,null!==o&&(o.x=Math.atan2(D-d,x-f)-.5*Math.PI,o.y=o.x)):(C<m&&(m=C,y=S,_=O,null!==o&&(o.x=Math.atan2(D-d,x-f)-.5*Math.PI)),C>g&&(g=C,v=S,b=O,null!==o&&(o.y=Math.atan2(D-d,x-f)-.5*Math.PI))),p++}}f=x,d=D}return 1===p?(null!==a&&(a.x=y,a.y=_),null!==s&&(s.x=y,s.y=_),null!==o&&(o.y=o.x+Math.PI)):p>1&&(p++,null!==a&&(a.x=y,a.y=_),null!==s&&(s.x=v,s.y=b)),p},e.prototype._onClear=function(){t.prototype._onClear.call(this),this.type=2,this.x=0,this.y=0,this.vertices.length=0},e.prototype.containsPoint=function(t,e){var i=!1;if(t>=this.x&&t<=this.width&&e>=this.y&&e<=this.height)for(var r=0,n=this.vertices.length,a=n-2;r<n;r+=2){var s=this.vertices[a+1],o=this.vertices[r+1];if(o<e&&s>=e||s<e&&o>=e){var h=this.vertices[a],l=this.vertices[r];(e-o)*(h-l)/(s-o)+l<t&&(i=!i)}a=r}return i},e.prototype.intersectsSegment=function(t,r,n,a,s,o,h){void 0===s&&(s=null),void 0===o&&(o=null),void 0===h&&(h=null);var l=0;return 0!==i.rectangleIntersectsSegment(t,r,n,a,this.x,this.y,this.x+this.width,this.y+this.height,null,null,null)&&(l=e.polygonIntersectsSegment(t,r,n,a,this.vertices,s,o,h)),l},e}(e);t.PolygonBoundingBoxData=n}(a||(a={})),function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.cachedFrames=[],e.boneTimelines={},e.surfaceTimelines={},e.slotTimelines={},e.constraintTimelines={},e.animationTimelines={},e.boneCachedFrameIndices={},e.slotCachedFrameIndices={},e.actionTimeline=null,e.zOrderTimeline=null,e}return s(e,t),e.toString=function(){return"[class dragonBones.AnimationData]"},e.prototype._onClear=function(){for(var t in this.boneTimelines){for(var e=0,i=this.boneTimelines[t];e<i.length;e++)i[e].returnToPool();delete this.boneTimelines[t]}for(var t in this.surfaceTimelines){for(var r=0,n=this.surfaceTimelines[t];r<n.length;r++)n[r].returnToPool();delete this.surfaceTimelines[t]}for(var t in this.slotTimelines){for(var a=0,s=this.slotTimelines[t];a<s.length;a++)s[a].returnToPool();delete this.slotTimelines[t]}for(var t in this.constraintTimelines){for(var o=0,h=this.constraintTimelines[t];o<h.length;o++)h[o].returnToPool();delete this.constraintTimelines[t]}for(var t in this.animationTimelines){for(var l=0,u=this.animationTimelines[t];l<u.length;l++)u[l].returnToPool();delete this.animationTimelines[t]}for(var t in this.boneCachedFrameIndices)delete this.boneCachedFrameIndices[t];for(var t in this.slotCachedFrameIndices)delete this.slotCachedFrameIndices[t];null!==this.actionTimeline&&this.actionTimeline.returnToPool(),null!==this.zOrderTimeline&&this.zOrderTimeline.returnToPool(),this.frameIntOffset=0,this.frameFloatOffset=0,this.frameOffset=0,this.frameCount=0,this.playTimes=0,this.duration=0,this.scale=1,this.fadeInTime=0,this.cacheFrameRate=0,this.name="",this.cachedFrames.length=0,this.actionTimeline=null,this.zOrderTimeline=null,this.parent=null},e.prototype.cacheFrames=function(t){if(!(this.cacheFrameRate>0)){this.cacheFrameRate=Math.max(Math.ceil(t*this.scale),1);var e=Math.ceil(this.cacheFrameRate*this.duration)+1;this.cachedFrames.length=e;for(var i=0,r=this.cacheFrames.length;i<r;++i)this.cachedFrames[i]=!1;for(var n=0,a=this.parent.sortedBones;n<a.length;n++){var s=a[n];for(i=0,r=(l=new Array(e)).length;i<r;++i)l[i]=-1;this.boneCachedFrameIndices[s.name]=l}for(var o=0,h=this.parent.sortedSlots;o<h.length;o++){var l,u=h[o];for(i=0,r=(l=new Array(e)).length;i<r;++i)l[i]=-1;this.slotCachedFrameIndices[u.name]=l}}},e.prototype.addBoneTimeline=function(t,e){var i=t.name in this.boneTimelines?this.boneTimelines[t.name]:this.boneTimelines[t.name]=[];i.indexOf(e)<0&&i.push(e)},e.prototype.addSurfaceTimeline=function(t,e){var i=t.name in this.surfaceTimelines?this.surfaceTimelines[t.name]:this.surfaceTimelines[t.name]=[];i.indexOf(e)<0&&i.push(e)},e.prototype.addSlotTimeline=function(t,e){var i=t.name in this.slotTimelines?this.slotTimelines[t.name]:this.slotTimelines[t.name]=[];i.indexOf(e)<0&&i.push(e)},e.prototype.addConstraintTimeline=function(t,e){var i=t.name in this.constraintTimelines?this.constraintTimelines[t.name]:this.constraintTimelines[t.name]=[];i.indexOf(e)<0&&i.push(e)},e.prototype.addAnimationTimeline=function(t,e){var i=t in this.animationTimelines?this.animationTimelines[t]:this.animationTimelines[t]=[];i.indexOf(e)<0&&i.push(e)},e.prototype.getBoneTimelines=function(t){return t in this.boneTimelines?this.boneTimelines[t]:null},e.prototype.getSurfaceTimelines=function(t){return t in this.surfaceTimelines?this.surfaceTimelines[t]:null},e.prototype.getSlotTimelines=function(t){return t in this.slotTimelines?this.slotTimelines[t]:null},e.prototype.getConstraintTimelines=function(t){return t in this.constraintTimelines?this.constraintTimelines[t]:null},e.prototype.getAnimationTimelines=function(t){return t in this.animationTimelines?this.animationTimelines[t]:null},e.prototype.getBoneCachedFrameIndices=function(t){return t in this.boneCachedFrameIndices?this.boneCachedFrameIndices[t]:null},e.prototype.getSlotCachedFrameIndices=function(t){return t in this.slotCachedFrameIndices?this.slotCachedFrameIndices[t]:null},e}(t.BaseObject);t.AnimationData=e;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.toString=function(){return"[class dragonBones.TimelineData]"},e.prototype._onClear=function(){this.type=10,this.offset=0,this.frameIndicesOffset=-1},e}(t.BaseObject);t.TimelineData=i}(a||(a={})),function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.boneMask=[],e}return s(e,t),e.toString=function(){return"[class dragonBones.AnimationConfig]"},e.prototype._onClear=function(){this.pauseFadeOut=!0,this.fadeOutMode=4,this.fadeOutTweenType=1,this.fadeOutTime=-1,this.actionEnabled=!0,this.additiveBlending=!1,this.displayControl=!0,this.pauseFadeIn=!0,this.resetToPose=!0,this.fadeInTweenType=1,this.playTimes=-1,this.layer=0,this.position=0,this.duration=-1,this.timeScale=-100,this.weight=1,this.fadeInTime=-1,this.autoFadeOutTime=-1,this.name="",this.animation="",this.group="",this.boneMask.length=0},e.prototype.clear=function(){this._onClear()},e.prototype.copyFrom=function(t){this.pauseFadeOut=t.pauseFadeOut,this.fadeOutMode=t.fadeOutMode,this.autoFadeOutTime=t.autoFadeOutTime,this.fadeOutTweenType=t.fadeOutTweenType,this.actionEnabled=t.actionEnabled,this.additiveBlending=t.additiveBlending,this.displayControl=t.displayControl,this.pauseFadeIn=t.pauseFadeIn,this.resetToPose=t.resetToPose,this.playTimes=t.playTimes,this.layer=t.layer,this.position=t.position,this.duration=t.duration,this.timeScale=t.timeScale,this.fadeInTime=t.fadeInTime,this.fadeOutTime=t.fadeOutTime,this.fadeInTweenType=t.fadeInTweenType,this.weight=t.weight,this.name=t.name,this.animation=t.animation,this.group=t.group,this.boneMask.length=t.boneMask.length;for(var e=0,i=this.boneMask.length;e<i;++e)this.boneMask[e]=t.boneMask[e]},e.prototype.containsBoneMask=function(t){return 0===this.boneMask.length||this.boneMask.indexOf(t)>=0},e.prototype.addBoneMask=function(t,e,i){void 0===i&&(i=!0);var r=t.getBone(e);if(null!==r&&(this.boneMask.indexOf(e)<0&&this.boneMask.push(e),i))for(var n=0,a=t.getBones();n<a.length;n++){var s=a[n];this.boneMask.indexOf(s.name)<0&&r.contains(s)&&this.boneMask.push(s.name)}},e.prototype.removeBoneMask=function(t,e,i){void 0===i&&(i=!0);var r=this.boneMask.indexOf(e);if(r>=0&&this.boneMask.splice(r,1),i){var n=t.getBone(e);if(null!==n)if(this.boneMask.length>0)for(var a=0,s=t.getBones();a<s.length;a++){var o=s[a],h=this.boneMask.indexOf(o.name);h>=0&&n.contains(o)&&this.boneMask.splice(h,1)}else for(var l=0,u=t.getBones();l<u.length;l++)(o=u[l])!==n&&(n.contains(o)||this.boneMask.push(o.name))}},e}(t.BaseObject);t.AnimationConfig=e}(a||(a={})),function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.textures={},e}return s(e,t),e.prototype._onClear=function(){for(var t in this.textures)this.textures[t].returnToPool(),delete this.textures[t];this.autoSearch=!1,this.width=0,this.height=0,this.scale=1,this.name="",this.imagePath=""},e.prototype.copyFrom=function(t){for(var e in this.autoSearch=t.autoSearch,this.scale=t.scale,this.width=t.width,this.height=t.height,this.name=t.name,this.imagePath=t.imagePath,this.textures)this.textures[e].returnToPool(),delete this.textures[e];for(var e in t.textures){var i=this.createTexture();i.copyFrom(t.textures[e]),this.textures[e]=i}},e.prototype.addTexture=function(t){t.name in this.textures?console.warn("Same texture: "+t.name):(t.parent=this,this.textures[t.name]=t)},e.prototype.getTexture=function(t){return t in this.textures?this.textures[t]:null},e}(t.BaseObject);t.TextureAtlasData=e;var i=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.region=new t.Rectangle,i.frame=null,i}return s(i,e),i.createRectangle=function(){return new t.Rectangle},i.prototype._onClear=function(){this.rotated=!1,this.name="",this.region.clear(),this.parent=null,this.frame=null},i.prototype.copyFrom=function(t){this.rotated=t.rotated,this.name=t.name,this.region.copyFrom(t.region),this.parent=t.parent,null===this.frame&&null!==t.frame?this.frame=i.createRectangle():null!==this.frame&&null===t.frame&&(this.frame=null),null!==this.frame&&null!==t.frame&&this.frame.copyFrom(t.frame)},i}(t.BaseObject);t.TextureData=i}(a||(a={})),function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.vertices=[],e.bones=[],e}return s(e,t),e.toString=function(){return"[class dragonBones.DeformVertices]"},e.prototype._onClear=function(){this.verticesDirty=!1,this.vertices.length=0,this.bones.length=0,this.verticesData=null},e.prototype.init=function(t,e){if(this.verticesData=t,null!==this.verticesData){var i;i=null!==this.verticesData.weight?2*this.verticesData.weight.count:2*this.verticesData.data.intArray[this.verticesData.offset+0],this.verticesDirty=!0,this.vertices.length=i,this.bones.length=0;for(var r=0,n=this.vertices.length;r<n;++r)this.vertices[r]=0;if(null!==this.verticesData.weight)for(r=0,n=this.verticesData.weight.bones.length;r<n;++r){var a=e.getBone(this.verticesData.weight.bones[r].name);this.bones.push(a)}}else this.verticesDirty=!1,this.vertices.length=0,this.bones.length=0,this.verticesData=null},e.prototype.isBonesUpdate=function(){for(var t=0,e=this.bones;t<e.length;t++){var i=e[t];if(null!==i&&i._childrenTransformDirty)return!0}return!1},e}(t.BaseObject);t.DeformVertices=e}(a||(a={})),n=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._bones=[],e._slots=[],e._constraints=[],e._actions=[],e._animation=null,e._proxy=null,e._replaceTextureAtlasData=null,e._clock=null,e}return s(e,t),e.toString=function(){return"[class dragonBones.Armature]"},e._onSortSlots=function(t,e){return t._zOrder>e._zOrder?1:-1},e.prototype._onClear=function(){null!==this._clock&&this._clock.remove(this);for(var t=0,e=this._bones;t<e.length;t++)e[t].returnToPool();for(var i=0,r=this._slots;i<r.length;i++)r[i].returnToPool();for(var n=0,a=this._constraints;n<a.length;n++)a[n].returnToPool();for(var s=0,o=this._actions;s<o.length;s++)o[s].returnToPool();null!==this._animation&&this._animation.returnToPool(),null!==this._proxy&&this._proxy.dbClear(),null!==this._replaceTextureAtlasData&&this._replaceTextureAtlasData.returnToPool(),this.inheritAnimation=!0,this.userData=null,this._lockUpdate=!1,this._slotsDirty=!0,this._zOrderDirty=!1,this._flipX=!1,this._flipY=!1,this._cacheFrameIndex=-1,this._bones.length=0,this._slots.length=0,this._constraints.length=0,this._actions.length=0,this._armatureData=null,this._animation=null,this._proxy=null,this._display=null,this._replaceTextureAtlasData=null,this._replacedTexture=null,this._dragonBones=null,this._clock=null,this._parent=null},e.prototype._sortZOrder=function(t,e){var i=this._armatureData.sortedSlots,r=null===t;if(this._zOrderDirty||!r){for(var n=0,a=i.length;n<a;++n){var s=r?n:t[e+n];if(!(s<0||s>=a)){var o=i[s],h=this.getSlot(o.name);null!==h&&h._setZorder(n)}}this._slotsDirty=!0,this._zOrderDirty=!r}},e.prototype._addBone=function(t){this._bones.indexOf(t)<0&&this._bones.push(t)},e.prototype._addSlot=function(t){this._slots.indexOf(t)<0&&this._slots.push(t)},e.prototype._addConstraint=function(t){this._constraints.indexOf(t)<0&&this._constraints.push(t)},e.prototype._bufferAction=function(t,e){this._actions.indexOf(t)<0&&(e?this._actions.push(t):this._actions.unshift(t))},e.prototype.dispose=function(){null!==this._armatureData&&(this._lockUpdate=!0,this._dragonBones.bufferObject(this))},e.prototype.init=function(t,e,i,n){null===this._armatureData&&(this._armatureData=t,this._animation=r.BaseObject.borrowObject(r.Animation),this._proxy=e,this._display=i,this._dragonBones=n,this._proxy.dbInit(this),this._animation.init(this),this._animation.animations=this._armatureData.animations)},e.prototype.advanceTime=function(t){if(!this._lockUpdate)if(null!==this._armatureData)if(null!==this._armatureData.parent){var i=this._cacheFrameIndex;if(this._animation.advanceTime(t),this._slotsDirty&&(this._slotsDirty=!1,this._slots.sort(e._onSortSlots)),this._cacheFrameIndex<0||this._cacheFrameIndex!==i){var r=0,n=0;for(r=0,n=this._bones.length;r<n;++r)this._bones[r].update(this._cacheFrameIndex);for(r=0,n=this._slots.length;r<n;++r)this._slots[r].update(this._cacheFrameIndex)}if(this._actions.length>0){this._lockUpdate=!0;for(var a=0,s=this._actions;a<s.length;a++){var o=s[a],h=o.actionData;if(null!==h&&0===h.type)if(null!==o.slot)null!==(c=o.slot.childArmature)&&c.animation.fadeIn(h.name);else if(null!==o.bone)for(var l=0,u=this.getSlots();l<u.length;l++){var c,p=u[l];p.parent===o.bone&&null!==(c=p.childArmature)&&c.animation.fadeIn(h.name)}else this._animation.fadeIn(h.name);o.returnToPool()}this._actions.length=0,this._lockUpdate=!1}this._proxy.dbUpdate()}else console.warn("The armature data has been disposed.\nPlease make sure dispose armature before call factory.clear().");else console.warn("The armature has been disposed.")},e.prototype.invalidUpdate=function(t,e){if(void 0===t&&(t=null),void 0===e&&(e=!1),null!==t&&t.length>0){if(null!==(s=this.getBone(t))&&(s.invalidUpdate(),e))for(var i=0,r=this._slots;i<r.length;i++)(l=r[i]).parent===s&&l.invalidUpdate()}else{for(var n=0,a=this._bones;n<a.length;n++){var s;(s=a[n]).invalidUpdate()}if(e)for(var o=0,h=this._slots;o<h.length;o++){var l;(l=h[o]).invalidUpdate()}}},e.prototype.containsPoint=function(t,e){for(var i=0,r=this._slots;i<r.length;i++){var n=r[i];if(n.containsPoint(t,e))return n}return null},e.prototype.intersectsSegment=function(t,e,i,r,n,a,s){void 0===n&&(n=null),void 0===a&&(a=null),void 0===s&&(s=null);for(var o=t===i,h=0,l=0,u=0,c=0,p=0,f=0,d=0,m=0,g=null,y=null,_=0,v=this._slots;_<v.length;_++){var b=v[_];if(b.intersectsSegment(t,e,i,r,n,a,s)>0){if(null===n&&null===a){g=b;break}var T;null!==n&&((T=o?n.y-e:n.x-t)<0&&(T=-T),(null===g||T<h)&&(h=T,u=n.x,c=n.y,g=b,s&&(d=s.x))),null!==a&&((T=a.x-t)<0&&(T=-T),(null===y||T>l)&&(l=T,p=a.x,f=a.y,y=b,null!==s&&(m=s.y)))}}return null!==g&&null!==n&&(n.x=u,n.y=c,null!==s&&(s.x=d)),null!==y&&null!==a&&(a.x=p,a.y=f,null!==s&&(s.y=m)),g},e.prototype.getBone=function(t){for(var e=0,i=this._bones;e<i.length;e++){var r=i[e];if(r.name===t)return r}return null},e.prototype.getBoneByDisplay=function(t){var e=this.getSlotByDisplay(t);return null!==e?e.parent:null},e.prototype.getSlot=function(t){for(var e=0,i=this._slots;e<i.length;e++){var r=i[e];if(r.name===t)return r}return null},e.prototype.getSlotByDisplay=function(t){if(null!==t)for(var e=0,i=this._slots;e<i.length;e++){var r=i[e];if(r.display===t)return r}return null},e.prototype.getBones=function(){return this._bones},e.prototype.getSlots=function(){return this._slots},Object.defineProperty(e.prototype,"flipX",{get:function(){return this._flipX},set:function(t){this._flipX!==t&&(this._flipX=t,this.invalidUpdate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"flipY",{get:function(){return this._flipY},set:function(t){this._flipY!==t&&(this._flipY=t,this.invalidUpdate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cacheFrameRate",{get:function(){return this._armatureData.cacheFrameRate},set:function(t){if(this._armatureData.cacheFrameRate!==t){this._armatureData.cacheFrames(t);for(var e=0,i=this._slots;e<i.length;e++){var r=i[e].childArmature;null!==r&&(r.cacheFrameRate=t)}}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this._armatureData.name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"armatureData",{get:function(){return this._armatureData},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"animation",{get:function(){return this._animation},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"proxy",{get:function(){return this._proxy},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"eventDispatcher",{get:function(){return this._proxy},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"display",{get:function(){return this._display},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"replacedTexture",{get:function(){return this._replacedTexture},set:function(t){if(this._replacedTexture!==t){null!==this._replaceTextureAtlasData&&(this._replaceTextureAtlasData.returnToPool(),this._replaceTextureAtlasData=null),this._replacedTexture=t;for(var e=0,i=this._slots;e<i.length;e++){var r=i[e];r.invalidUpdate(),r.update(-1)}}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"clock",{get:function(){return this._clock},set:function(t){if(this._clock!==t){null!==this._clock&&this._clock.remove(this),this._clock=t,this._clock&&this._clock.add(this);for(var e=0,i=this._slots;e<i.length;e++){var r=i[e].childArmature;null!==r&&(r.clock=this._clock)}}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return this._parent},enumerable:!0,configurable:!0}),e.prototype.replaceTexture=function(t){this.replacedTexture=t},e.prototype.hasEventListener=function(t){return console.warn("Deprecated."),this._proxy.hasDBEventListener(t)},e.prototype.addEventListener=function(t,e,i){console.warn("Deprecated."),this._proxy.addDBEventListener(t,e,i)},e.prototype.removeEventListener=function(t,e,i){console.warn("Deprecated."),this._proxy.removeDBEventListener(t,e,i)},e.prototype.enableAnimationCache=function(t){console.warn("Deprecated."),this.cacheFrameRate=t},e.prototype.getDisplay=function(){return this._display},e}((r=a||(a={})).BaseObject),r.Armature=n,function(t){var e=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.globalTransformMatrix=new t.Matrix,i.global=new t.Transform,i.offset=new t.Transform,i}return s(i,e),i.prototype._onClear=function(){this.globalTransformMatrix.identity(),this.global.identity(),this.offset.identity(),this.origin=null,this.userData=null,this._globalDirty=!1,this._armature=null},i.prototype.updateGlobalTransform=function(){this._globalDirty&&(this._globalDirty=!1,this.global.fromMatrix(this.globalTransformMatrix))},Object.defineProperty(i.prototype,"armature",{get:function(){return this._armature},enumerable:!0,configurable:!0}),i._helpMatrix=new t.Matrix,i._helpTransform=new t.Transform,i._helpPoint=new t.Point,i}(t.BaseObject);t.TransformObject=e}(a||(a={})),function(t){var e=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.animationPose=new t.Transform,i._blendState=new t.BlendState,i}return s(i,e),i.toString=function(){return"[class dragonBones.Bone]"},i.prototype._onClear=function(){e.prototype._onClear.call(this),this.offsetMode=1,this.animationPose.identity(),this._transformDirty=!1,this._childrenTransformDirty=!1,this._localDirty=!0,this._hasConstraint=!1,this._visible=!0,this._cachedFrameIndex=-1,this._blendState.clear(),this._boneData=null,this._parent=null,this._cachedFrameIndices=null},i.prototype._updateGlobalTransformMatrix=function(e){var i=this._boneData,r=this.global,n=this.globalTransformMatrix,a=this.origin,s=this.offset,o=this.animationPose,h=this._parent,l=this._armature.flipX,u=this._armature.flipY===t.DragonBones.yDown,c=null!==h,p=0;if(1===this.offsetMode?null!==a?(r.x=a.x+s.x+o.x,r.y=a.y+s.y+o.y,r.skew=a.skew+s.skew+o.skew,r.rotation=a.rotation+s.rotation+o.rotation,r.scaleX=a.scaleX*s.scaleX*o.scaleX,r.scaleY=a.scaleY*s.scaleY*o.scaleY):r.copyFrom(s).add(o):0===this.offsetMode?null!==a?r.copyFrom(a).add(o):r.copyFrom(o):(c=!1,r.copyFrom(s)),c){var f=0===h._boneData.type?h.globalTransformMatrix:h._getGlobalTransformMatrix(r.x,r.y);if(i.inheritScale)i.inheritRotation||(h.updateGlobalTransform(),p=l&&u?r.rotation-(h.global.rotation+Math.PI):l?r.rotation+h.global.rotation+Math.PI:u?r.rotation+h.global.rotation:r.rotation-h.global.rotation,r.rotation=p),r.toMatrix(n),n.concat(f),i.inheritTranslation?(r.x=n.tx,r.y=n.ty):(n.tx=r.x,n.ty=r.y),e?r.fromMatrix(n):this._globalDirty=!0;else{if(i.inheritTranslation){var d=r.x,m=r.y;r.x=f.a*d+f.c*m+f.tx,r.y=f.b*d+f.d*m+f.ty}else l&&(r.x=-r.x),u&&(r.y=-r.y);i.inheritRotation?(h.updateGlobalTransform(),p=h.global.scaleX<0?r.rotation+h.global.rotation+Math.PI:r.rotation+h.global.rotation,f.a*f.d-f.b*f.c<0&&(p-=2*r.rotation,(l!==u||i.inheritReflection)&&(r.skew+=Math.PI)),r.rotation=p):(l||u)&&(l&&u?p=r.rotation+Math.PI:(p=l?Math.PI-r.rotation:-r.rotation,r.skew+=Math.PI),r.rotation=p),r.toMatrix(n)}}else(l||u)&&(l&&(r.x=-r.x),u&&(r.y=-r.y),l&&u?p=r.rotation+Math.PI:(p=l?Math.PI-r.rotation:-r.rotation,r.skew+=Math.PI),r.rotation=p),r.toMatrix(n)},i.prototype.init=function(t,e){null===this._boneData&&(this._boneData=t,this._armature=e,null!==this._boneData.parent&&(this._parent=this._armature.getBone(this._boneData.parent.name)),this._armature._addBone(this),this.origin=this._boneData.transform)},i.prototype.update=function(t){if(this._blendState.dirty=!1,t>=0&&null!==this._cachedFrameIndices){var e=this._cachedFrameIndices[t];if(e>=0&&this._cachedFrameIndex===e)this._transformDirty=!1;else if(e>=0)this._transformDirty=!0,this._cachedFrameIndex=e;else{if(this._hasConstraint)for(var i=0,r=this._armature._constraints;i<r.length;i++)(s=r[i])._root===this&&s.update();this._transformDirty||null!==this._parent&&this._parent._childrenTransformDirty?(this._transformDirty=!0,this._cachedFrameIndex=-1):this._cachedFrameIndex>=0?(this._transformDirty=!1,this._cachedFrameIndices[t]=this._cachedFrameIndex):(this._transformDirty=!0,this._cachedFrameIndex=-1)}}else{if(this._hasConstraint)for(var n=0,a=this._armature._constraints;n<a.length;n++){var s;(s=a[n])._root===this&&s.update()}(this._transformDirty||null!==this._parent&&this._parent._childrenTransformDirty)&&(t=-1,this._transformDirty=!0,this._cachedFrameIndex=-1)}if(this._transformDirty)if(this._transformDirty=!1,this._childrenTransformDirty=!0,this._cachedFrameIndex<0){var o=t>=0;this._localDirty&&this._updateGlobalTransformMatrix(o),o&&null!==this._cachedFrameIndices&&(this._cachedFrameIndex=this._cachedFrameIndices[t]=this._armature._armatureData.setCacheFrame(this.globalTransformMatrix,this.global))}else this._armature._armatureData.getCacheFrame(this.globalTransformMatrix,this.global,this._cachedFrameIndex);else this._childrenTransformDirty&&(this._childrenTransformDirty=!1);this._localDirty=!0},i.prototype.updateByConstraint=function(){this._localDirty&&(this._localDirty=!1,(this._transformDirty||null!==this._parent&&this._parent._childrenTransformDirty)&&this._updateGlobalTransformMatrix(!0),this._transformDirty=!0)},i.prototype.invalidUpdate=function(){this._transformDirty=!0},i.prototype.contains=function(t){if(t===this)return!1;for(var e=t;e!==this&&null!==e;)e=e.parent;return e===this},Object.defineProperty(i.prototype,"boneData",{get:function(){return this._boneData},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"visible",{get:function(){return this._visible},set:function(t){if(this._visible!==t){this._visible=t;for(var e=0,i=this._armature.getSlots();e<i.length;e++){var r=i[e];r.parent===this&&r._updateVisible()}}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"name",{get:function(){return this._boneData.name},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"parent",{get:function(){return this._parent},enumerable:!0,configurable:!0}),i.prototype.getBones=function(){console.warn("Deprecated.");for(var t=new Array,e=0,i=this._armature.getBones();e<i.length;e++){var r=i[e];r.parent===this&&t.push(r)}return t},i.prototype.getSlots=function(){console.warn("Deprecated.");for(var t=new Array,e=0,i=this._armature.getSlots();e<i.length;e++){var r=i[e];r.parent===this&&t.push(r)}return t},Object.defineProperty(i.prototype,"slot",{get:function(){console.warn("Deprecated.");for(var t=0,e=this._armature.getSlots();t<e.length;t++){var i=e[t];if(i.parent===this)return i}return null},enumerable:!0,configurable:!0}),i}(t.TransformObject);t.Bone=e}(a||(a={})),function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._vertices=[],e._deformVertices=[],e._hullCache=[],e._matrixCahce=[],e}return s(e,t),e.toString=function(){return"[class dragonBones.Surface]"},e.prototype._onClear=function(){t.prototype._onClear.call(this),this._dX=0,this._dY=0,this._k=0,this._kX=0,this._kY=0,this._vertices.length=0,this._deformVertices.length=0,this._matrixCahce.length=0,this._hullCache.length=0},e.prototype._getAffineTransform=function(t,e,i,r,n,a,s,o,h,l,u,c,p){var f=s-n,d=o-a,m=h-n,g=l-a;u.rotation=Math.atan2(d,f),u.skew=Math.atan2(g,m)-.5*Math.PI-u.rotation,p&&(u.rotation+=Math.PI),u.scaleX=Math.sqrt(f*f+d*d)/i,u.scaleY=Math.sqrt(m*m+g*g)/r,u.toMatrix(c),u.x=c.tx=n-(c.a*t+c.c*e),u.y=c.ty=a-(c.b*t+c.d*e)},e.prototype._updateVertices=function(){var t=this._boneData.vertices,e=this._vertices,i=this._deformVertices;if(null!==this._parent)if(1===this._parent._boneData.type)for(var r=0,n=t.length;r<n;r+=2){var a=t[r]+i[r],s=t[r+1]+i[r],o=this._parent._getGlobalTransformMatrix(a,s);e[r]=o.a*a+o.c*s+o.tx,e[r+1]=o.b*a+o.d*s+o.ty}else{var h=this._parent.globalTransformMatrix;for(r=0,n=t.length;r<n;r+=2)a=t[r]+i[r],s=t[r+1]+i[r+1],e[r]=h.a*a+h.c*s+h.tx,e[r+1]=h.b*a+h.d*s+h.ty}else for(r=0,n=t.length;r<n;r+=2)e[r]=t[r]+i[r],e[r+1]=t[r+1]+i[r+1]},e.prototype._updateGlobalTransformMatrix=function(t){var e=2*this._boneData.segmentX,i=this._vertices.length-2,r=this._vertices[0],n=this._vertices[1],a=this._vertices[e],s=this._vertices[e+1],o=this._vertices[i],h=this._vertices[i+1],l=this._vertices[i-e],u=this._vertices[i-e+1],c=r+.5*(o-r),p=n+.5*(h-n),f=c+.5*(a+.5*(l-a)-c),d=p+.5*(s+.5*(u-s)-p),m=a+.5*(o-a),g=s+.5*(h-s),y=l+.5*(o-l),_=u+.5*(h-u);this._globalDirty=!1,this._getAffineTransform(0,0,200,200,f,d,m,g,y,_,this.global,this.globalTransformMatrix,!1)},e.prototype._getGlobalTransformMatrix=function(t,i){var r=1e3;if(t<-r||r<t||i<-r||r<i)return this.globalTransformMatrix;var n=!1,a=200,s=this._boneData,o=s.segmentX,h=s.segmentY,l=2*s.segmentX,u=this._dX,c=this._dY,p=Math.floor((t+a)/u),f=Math.floor((i+a)/c),d=0,m=p*u-a,g=f*c-a,y=this._matrixCahce,_=e._helpMatrix;if(t<-a){if(i<-a||i>=a)return this.globalTransformMatrix;if(d=7*(2*(o*(h+1)+2*o+h+f)+((n=i>this._kX*(t+a)+g)?1:0)),this._matrixCahce[d]>0)_.copyFromArray(y,d+1);else{var v=f*(l+2),b=this._hullCache[4],T=this._hullCache[5],x=this._hullCache[2]-(h-f)*b,D=this._hullCache[3]-(h-f)*T,$=this._vertices;n?this._getAffineTransform(-a,g+c,800,c,$[v+l+2],$[v+l+3],x+b,D+T,$[v],$[v+1],e._helpTransform,_,!0):this._getAffineTransform(-r,g,800,c,x,D,$[v],$[v+1],x+b,D+T,e._helpTransform,_,!1),y[d]=1,y[d+1]=_.a,y[d+2]=_.b,y[d+3]=_.c,y[d+4]=_.d,y[d+5]=_.tx,y[d+6]=_.ty}}else if(t>=a){if(i<-a||i>=a)return this.globalTransformMatrix;d=7*(2*(o*(h+1)+o+f)+((n=i>this._kX*(t-r)+g)?1:0)),this._matrixCahce[d]>0?_.copyFromArray(y,d+1):(v=(f+1)*(l+2)-2,b=this._hullCache[4],T=this._hullCache[5],x=this._hullCache[0]+f*b,D=this._hullCache[1]+f*T,$=this._vertices,n?this._getAffineTransform(r,g+c,800,c,x+b,D+T,$[v+l+2],$[v+l+3],x,D,e._helpTransform,_,!0):this._getAffineTransform(a,g,800,c,$[v],$[v+1],x,D,$[v+l+2],$[v+l+3],e._helpTransform,_,!1),y[d]=1,y[d+1]=_.a,y[d+2]=_.b,y[d+3]=_.c,y[d+4]=_.d,y[d+5]=_.tx,y[d+6]=_.ty)}else if(i<-a){if(t<-a||t>=a)return this.globalTransformMatrix;d=7*(o*(h+1)+2*p+((n=i>this._kY*(t-m-u)-r)?1:0)),this._matrixCahce[d]>0?_.copyFromArray(y,d+1):(v=2*p,b=this._hullCache[10],T=this._hullCache[11],x=this._hullCache[8]+p*b,D=this._hullCache[9]+p*T,$=this._vertices,n?this._getAffineTransform(m+u,-a,u,800,$[v+2],$[v+3],$[v],$[v+1],x+b,D+T,e._helpTransform,_,!0):this._getAffineTransform(m,-r,u,800,x,D,x+b,D+T,$[v],$[v+1],e._helpTransform,_,!1),y[d]=1,y[d+1]=_.a,y[d+2]=_.b,y[d+3]=_.c,y[d+4]=_.d,y[d+5]=_.tx,y[d+6]=_.ty)}else if(i>=a){if(t<-a||t>=a)return this.globalTransformMatrix;d=7*(2*(o*(h+1)+o+h+f)+((n=i>this._kY*(t-m-u)+a)?1:0)),this._matrixCahce[d]>0?_.copyFromArray(y,d+1):(v=h*(l+2)+2*p,b=this._hullCache[10],T=this._hullCache[11],x=this._hullCache[6]-(o-p)*b,D=this._hullCache[7]-(o-p)*T,$=this._vertices,n?this._getAffineTransform(m+u,r,u,800,x+b,D+T,x,D,$[v+2],$[v+3],e._helpTransform,_,!0):this._getAffineTransform(m,a,u,800,$[v],$[v+1],$[v+2],$[v+3],x,D,e._helpTransform,_,!1),y[d]=1,y[d+1]=_.a,y[d+2]=_.b,y[d+3]=_.c,y[d+4]=_.d,y[d+5]=_.tx,y[d+6]=_.ty)}else d=7*(2*(o*f+p)+((n=i>this._k*(t-m-u)+g)?1:0)),this._matrixCahce[d]>0?_.copyFromArray(y,d+1):(v=2*p+f*(l+2),$=this._vertices,n?this._getAffineTransform(m+u,g+c,u,c,$[v+l+4],$[v+l+5],$[v+l+2],$[v+l+3],$[v+2],$[v+3],e._helpTransform,_,!0):this._getAffineTransform(m,g,u,c,$[v],$[v+1],$[v+2],$[v+3],$[v+l+2],$[v+l+3],e._helpTransform,_,!1),y[d]=1,y[d+1]=_.a,y[d+2]=_.b,y[d+3]=_.c,y[d+4]=_.d,y[d+5]=_.tx,y[d+6]=_.ty);return _},e.prototype.init=function(e,i){if(null===this._boneData){t.prototype.init.call(this,e,i);var r=e.segmentX,n=e.segmentY,a=e.vertices.length;this._dX=400/r,this._dY=400/n,this._k=-this._dY/this._dX,this._kX=-this._dY/800,this._kY=-800/this._dX,this._vertices.length=a,this._deformVertices.length=a,this._matrixCahce.length=2*(r*n+2*r+2*n)*7,this._hullCache.length=10;for(var s=0;s<a;++s)this._deformVertices[s]=0}},e.prototype.update=function(t){if(this._blendState.dirty=!1,t>=0&&null!==this._cachedFrameIndices){var i=this._cachedFrameIndices[t];if(i>=0&&this._cachedFrameIndex===i)this._transformDirty=!1;else if(i>=0)this._transformDirty=!0,this._cachedFrameIndex=i;else{if(this._hasConstraint)for(var r=0,n=this._armature._constraints;r<n.length;r++)(o=n[r])._root===this&&o.update();this._transformDirty||null!==this._parent&&this._parent._childrenTransformDirty?(this._transformDirty=!0,this._cachedFrameIndex=-1):this._cachedFrameIndex>=0?(this._transformDirty=!1,this._cachedFrameIndices[t]=this._cachedFrameIndex):(this._transformDirty=!0,this._cachedFrameIndex=-1)}}else{if(this._hasConstraint)for(var a=0,s=this._armature._constraints;a<s.length;a++){var o;(o=s[a])._root===this&&o.update()}(this._transformDirty||null!==this._parent&&this._parent._childrenTransformDirty)&&(t=-1,this._transformDirty=!0,this._cachedFrameIndex=-1)}if(this._transformDirty){this._transformDirty=!1,this._childrenTransformDirty=!0;for(var h=0,l=this._matrixCahce.length;h<l;h+=7)this._matrixCahce[h]=-1;if(this._updateVertices(),this._cachedFrameIndex<0){var u=t>=0;this._localDirty&&this._updateGlobalTransformMatrix(u),u&&null!==this._cachedFrameIndices&&(this._cachedFrameIndex=this._cachedFrameIndices[t]=this._armature._armatureData.setCacheFrame(this.globalTransformMatrix,this.global))}else this._armature._armatureData.getCacheFrame(this.globalTransformMatrix,this.global,this._cachedFrameIndex);var c=2*this.global.x,p=2*this.global.y,f=e._helpPoint;this.globalTransformMatrix.transformPoint(1e3,-200,f),this._hullCache[0]=f.x,this._hullCache[1]=f.y,this._hullCache[2]=c-f.x,this._hullCache[3]=p-f.y,this.globalTransformMatrix.transformPoint(0,this._dY,f,!0),this._hullCache[4]=f.x,this._hullCache[5]=f.y,this.globalTransformMatrix.transformPoint(200,1e3,f),this._hullCache[6]=f.x,this._hullCache[7]=f.y,this._hullCache[8]=c-f.x,this._hullCache[9]=p-f.y,this.globalTransformMatrix.transformPoint(this._dX,0,f,!0),this._hullCache[10]=f.x,this._hullCache[11]=f.y}else this._childrenTransformDirty&&(this._childrenTransformDirty=!1);this._localDirty=!0},e}(t.Bone);t.Surface=e}(a||(a={})),function(t){var e=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i._localMatrix=new t.Matrix,i._colorTransform=new t.ColorTransform,i._displayDatas=[],i._displayList=[],i._deformVertices=null,i._rawDisplay=null,i._meshDisplay=null,i}return s(i,e),i.prototype._onClear=function(){e.prototype._onClear.call(this);for(var i=[],r=0,n=this._displayList;r<n.length;r++)null!==(o=n[r])&&o!==this._rawDisplay&&o!==this._meshDisplay&&i.indexOf(o)<0&&i.push(o);for(var a=0,s=i;a<s.length;a++){var o;(o=s[a])instanceof t.Armature?o.dispose():this._disposeDisplay(o,!0)}null!==this._deformVertices&&this._deformVertices.returnToPool(),null!==this._meshDisplay&&this._meshDisplay!==this._rawDisplay&&this._disposeDisplay(this._meshDisplay,!1),null!==this._rawDisplay&&this._disposeDisplay(this._rawDisplay,!1),this.displayController=null,this._displayDirty=!1,this._zOrderDirty=!1,this._blendModeDirty=!1,this._colorDirty=!1,this._transformDirty=!1,this._visible=!0,this._blendMode=0,this._displayIndex=-1,this._animationDisplayIndex=-1,this._zOrder=0,this._cachedFrameIndex=-1,this._pivotX=0,this._pivotY=0,this._localMatrix.identity(),this._colorTransform.identity(),this._displayList.length=0,this._displayDatas.length=0,this._slotData=null,this._rawDisplayDatas=null,this._displayData=null,this._boundingBoxData=null,this._textureData=null,this._deformVertices=null,this._rawDisplay=null,this._meshDisplay=null,this._display=null,this._childArmature=null,this._parent=null,this._cachedFrameIndices=null},i.prototype._getDefaultRawDisplayData=function(t){var e=this._armature._armatureData.defaultSkin;if(null!==e){var i=e.getDisplays(this._slotData.name);if(null!==i)return t<i.length?i[t]:null}return null},i.prototype._updateDisplayData=function(){var e=this._displayData,r=null!==this._deformVertices?this._deformVertices.verticesData:null,n=this._textureData,a=null,s=null;if(this._displayData=null,this._boundingBoxData=null,this._textureData=null,this._displayIndex>=0&&(null!==this._rawDisplayDatas&&(a=this._displayIndex<this._rawDisplayDatas.length?this._rawDisplayDatas[this._displayIndex]:null),null===a&&(a=this._getDefaultRawDisplayData(this._displayIndex)),this._displayIndex<this._displayDatas.length&&(this._displayData=this._displayDatas[this._displayIndex])),null!==this._displayData&&(2===this._displayData.type?s=this._displayData.vertices:4===this._displayData.type?s=this._displayData.vertices:null!==a&&(2===a.type?s=a.vertices:4===a.type&&(s=a.vertices)),3===this._displayData.type?this._boundingBoxData=this._displayData.boundingBox:null!==a&&3===a.type&&(this._boundingBoxData=a.boundingBox),0===this._displayData.type?this._textureData=this._displayData.texture:2===this._displayData.type&&(this._textureData=this._displayData.texture)),this._displayData!==e||s!==r||this._textureData!==n){if(null===s&&null!==this._textureData){var o=this._displayData,h=this._textureData.parent.scale*this._armature._armatureData.scale,l=this._textureData.frame;this._pivotX=o.pivot.x,this._pivotY=o.pivot.y;var u=null!==l?l:this._textureData.region,c=u.width,p=u.height;this._textureData.rotated&&null===l&&(c=u.height,p=u.width),this._pivotX*=c*h,this._pivotY*=p*h,null!==l&&(this._pivotX+=l.x*h,this._pivotY+=l.y*h),null!==this._displayData&&null!==a&&this._displayData!==a&&(a.transform.toMatrix(i._helpMatrix),i._helpMatrix.invert(),i._helpMatrix.transformPoint(0,0,i._helpPoint),this._pivotX-=i._helpPoint.x,this._pivotY-=i._helpPoint.y,this._displayData.transform.toMatrix(i._helpMatrix),i._helpMatrix.invert(),i._helpMatrix.transformPoint(0,0,i._helpPoint),this._pivotX+=i._helpPoint.x,this._pivotY+=i._helpPoint.y),t.DragonBones.yDown||(this._pivotY=(this._textureData.rotated?this._textureData.region.width:this._textureData.region.height)*h-this._pivotY)}else this._pivotX=0,this._pivotY=0;null!==a?this.origin=a.transform:null!==this._displayData?this.origin=this._displayData.transform:this.origin=null,s!==r?(null===this._deformVertices&&(this._deformVertices=t.BaseObject.borrowObject(t.DeformVertices)),this._deformVertices.init(s,this._armature)):null!==this._deformVertices&&this._textureData!==n&&(this._deformVertices.verticesDirty=!0),this._displayDirty=!0,this._transformDirty=!0}},i.prototype._updateDisplay=function(){var e=null!==this._display?this._display:this._rawDisplay,i=this._childArmature;this._displayIndex>=0&&this._displayIndex<this._displayList.length?(this._display=this._displayList[this._displayIndex],null!==this._display&&this._display instanceof t.Armature?(this._childArmature=this._display,this._display=this._childArmature.display):this._childArmature=null):(this._display=null,this._childArmature=null);var r=null!==this._display?this._display:this._rawDisplay;if(r!==e&&(this._onUpdateDisplay(),this._replaceDisplay(e),this._transformDirty=!0,this._visibleDirty=!0,this._blendModeDirty=!0,this._colorDirty=!0),r!==this._rawDisplay&&r!==this._meshDisplay||this._updateFrame(),this._childArmature!==i&&(null!==i&&(i._parent=null,i.clock=null,i.inheritAnimation&&i.animation.reset()),null!==this._childArmature&&(this._childArmature._parent=this,this._childArmature.clock=this._armature.clock,this._childArmature.inheritAnimation))){if(0===this._childArmature.cacheFrameRate){var n=this._armature.cacheFrameRate;0!==n&&(this._childArmature.cacheFrameRate=n)}var a=null;if(null!==this._displayData&&1===this._displayData.type)a=this._displayData.actions;else if(this._displayIndex>=0&&null!==this._rawDisplayDatas){var s=this._displayIndex<this._rawDisplayDatas.length?this._rawDisplayDatas[this._displayIndex]:null;null===s&&(s=this._getDefaultRawDisplayData(this._displayIndex)),null!==s&&1===s.type&&(a=s.actions)}if(null!==a&&a.length>0)for(var o=0,h=a;o<h.length;o++){var l=h[o],u=t.BaseObject.borrowObject(t.EventObject);t.EventObject.actionDataToInstance(l,u,this._armature),u.slot=this,this._armature._bufferAction(u,!1)}else this._childArmature.animation.play()}},i.prototype._updateGlobalTransformMatrix=function(t){var e=0===this._parent._boneData.type?this._parent.globalTransformMatrix:this._parent._getGlobalTransformMatrix(this.global.x,this.global.y);this.globalTransformMatrix.copyFrom(this._localMatrix),this.globalTransformMatrix.concat(e),t?this.global.fromMatrix(this.globalTransformMatrix):this._globalDirty=!0},i.prototype._setDisplayIndex=function(t,e){if(void 0===e&&(e=!1),e){if(this._animationDisplayIndex===t)return!1;this._animationDisplayIndex=t}return this._displayIndex!==t&&(this._displayIndex=t,this._displayDirty=!0,this._updateDisplayData(),this._displayDirty)},i.prototype._setZorder=function(t){return this._zOrder,this._zOrder=t,this._zOrderDirty=!0,this._zOrderDirty},i.prototype._setColor=function(t){return this._colorTransform.copyFrom(t),this._colorDirty=!0,this._colorDirty},i.prototype._setDisplayList=function(e){if(null!==e&&e.length>0){this._displayList.length!==e.length&&(this._displayList.length=e.length);for(var i=0,r=e.length;i<r;++i){var n=e[i];null!==n&&n!==this._rawDisplay&&n!==this._meshDisplay&&!(n instanceof t.Armature)&&this._displayList.indexOf(n)<0&&this._initDisplay(n,!0),this._displayList[i]=n}}else this._displayList.length>0&&(this._displayList.length=0);return this._displayIndex>=0&&this._displayIndex<this._displayList.length?this._displayDirty=this._display!==this._displayList[this._displayIndex]:this._displayDirty=null!==this._display,this._updateDisplayData(),this._displayDirty},i.prototype.init=function(t,e,i,r){if(null===this._slotData){this._slotData=t,this._visibleDirty=!0,this._blendModeDirty=!0,this._colorDirty=!0,this._blendMode=this._slotData.blendMode,this._zOrder=this._slotData.zOrder,this._colorTransform.copyFrom(this._slotData.color),this._rawDisplay=i,this._meshDisplay=r,this._armature=e;var n=this._armature.getBone(this._slotData.parent.name);null!==n&&(this._parent=n),this._armature._addSlot(this),this._initDisplay(this._rawDisplay,!1),this._rawDisplay!==this._meshDisplay&&this._initDisplay(this._meshDisplay,!1),this._onUpdateDisplay(),this._addDisplay()}},i.prototype.update=function(t){if(this._displayDirty&&(this._displayDirty=!1,this._updateDisplay(),this._transformDirty&&(null!==this.origin?this.global.copyFrom(this.origin).add(this.offset).toMatrix(this._localMatrix):this.global.copyFrom(this.offset).toMatrix(this._localMatrix))),this._zOrderDirty&&(this._zOrderDirty=!1,this._updateZOrder()),t>=0&&null!==this._cachedFrameIndices){var e=this._cachedFrameIndices[t];e>=0&&this._cachedFrameIndex===e?this._transformDirty=!1:e>=0?(this._transformDirty=!0,this._cachedFrameIndex=e):this._transformDirty||this._parent._childrenTransformDirty?(this._transformDirty=!0,this._cachedFrameIndex=-1):this._cachedFrameIndex>=0?(this._transformDirty=!1,this._cachedFrameIndices[t]=this._cachedFrameIndex):(this._transformDirty=!0,this._cachedFrameIndex=-1)}else(this._transformDirty||this._parent._childrenTransformDirty)&&(t=-1,this._transformDirty=!0,this._cachedFrameIndex=-1);if(null!==this._display){if(this._visibleDirty&&(this._visibleDirty=!1,this._updateVisible()),this._blendModeDirty&&(this._blendModeDirty=!1,this._updateBlendMode()),this._colorDirty&&(this._colorDirty=!1,this._updateColor()),null!==this._deformVertices&&null!==this._deformVertices.verticesData&&this._display===this._meshDisplay){var i=null!==this._deformVertices.verticesData.weight,r=0!==this._parent._boneData.type;if((this._deformVertices.verticesDirty||i&&this._deformVertices.isBonesUpdate()||r&&this._parent._childrenTransformDirty)&&(this._deformVertices.verticesDirty=!1,this._updateMesh()),i||r)return}if(this._transformDirty){if(this._transformDirty=!1,this._cachedFrameIndex<0){var n=t>=0;this._updateGlobalTransformMatrix(n),n&&null!==this._cachedFrameIndices&&(this._cachedFrameIndex=this._cachedFrameIndices[t]=this._armature._armatureData.setCacheFrame(this.globalTransformMatrix,this.global))}else this._armature._armatureData.getCacheFrame(this.globalTransformMatrix,this.global,this._cachedFrameIndex);this._updateTransform()}}},i.prototype.updateTransformAndMatrix=function(){this._transformDirty&&(this._transformDirty=!1,this._updateGlobalTransformMatrix(!1))},i.prototype.replaceDisplayData=function(t,e){if(void 0===e&&(e=-1),e<0&&(e=this._displayIndex<0?0:this._displayIndex),this._displayDatas.length<=e){this._displayDatas.length=e+1;for(var i=0,r=this._displayDatas.length;i<r;++i)this._displayDatas[i]||(this._displayDatas[i]=null)}this._displayDatas[e]=t},i.prototype.containsPoint=function(t,e){return null!==this._boundingBoxData&&(this.updateTransformAndMatrix(),i._helpMatrix.copyFrom(this.globalTransformMatrix),i._helpMatrix.invert(),i._helpMatrix.transformPoint(t,e,i._helpPoint),this._boundingBoxData.containsPoint(i._helpPoint.x,i._helpPoint.y))},i.prototype.intersectsSegment=function(t,e,r,n,a,s,o){if(void 0===a&&(a=null),void 0===s&&(s=null),void 0===o&&(o=null),null===this._boundingBoxData)return 0;this.updateTransformAndMatrix(),i._helpMatrix.copyFrom(this.globalTransformMatrix),i._helpMatrix.invert(),i._helpMatrix.transformPoint(t,e,i._helpPoint),t=i._helpPoint.x,e=i._helpPoint.y,i._helpMatrix.transformPoint(r,n,i._helpPoint),r=i._helpPoint.x,n=i._helpPoint.y;var h=this._boundingBoxData.intersectsSegment(t,e,r,n,a,s,o);return h>0&&(1===h||2===h?null!==a?(this.globalTransformMatrix.transformPoint(a.x,a.y,a),null!==s&&(s.x=a.x,s.y=a.y)):null!==s&&this.globalTransformMatrix.transformPoint(s.x,s.y,s):(null!==a&&this.globalTransformMatrix.transformPoint(a.x,a.y,a),null!==s&&this.globalTransformMatrix.transformPoint(s.x,s.y,s)),null!==o&&(this.globalTransformMatrix.transformPoint(Math.cos(o.x),Math.sin(o.x),i._helpPoint,!0),o.x=Math.atan2(i._helpPoint.y,i._helpPoint.x),this.globalTransformMatrix.transformPoint(Math.cos(o.y),Math.sin(o.y),i._helpPoint,!0),o.y=Math.atan2(i._helpPoint.y,i._helpPoint.x))),h},i.prototype.invalidUpdate=function(){this._displayDirty=!0,this._transformDirty=!0},Object.defineProperty(i.prototype,"visible",{get:function(){return this._visible},set:function(t){this._visible!==t&&(this._visible=t,this._updateVisible())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"displayIndex",{get:function(){return this._displayIndex},set:function(t){this._setDisplayIndex(t)&&this.update(-1)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"name",{get:function(){return this._slotData.name},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"displayList",{get:function(){return this._displayList.concat()},set:function(e){var i=this._displayList.concat(),r=new Array;this._setDisplayList(e)&&this.update(-1);for(var n=0,a=i;n<a.length;n++)null!==(h=a[n])&&h!==this._rawDisplay&&h!==this._meshDisplay&&this._displayList.indexOf(h)<0&&r.indexOf(h)<0&&r.push(h);for(var s=0,o=r;s<o.length;s++){var h;(h=o[s])instanceof t.Armature||this._disposeDisplay(h,!0)}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"slotData",{get:function(){return this._slotData},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"rawDisplayDatas",{get:function(){return this._rawDisplayDatas},set:function(t){if(this._rawDisplayDatas!==t)if(this._displayDirty=!0,this._rawDisplayDatas=t,null!==this._rawDisplayDatas){this._displayDatas.length=this._rawDisplayDatas.length;for(var e=0,i=this._displayDatas.length;e<i;++e){var r=this._rawDisplayDatas[e];null===r&&(r=this._getDefaultRawDisplayData(e)),this._displayDatas[e]=r}}else this._displayDatas.length=0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"displayData",{get:function(){return this._displayData},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"boundingBoxData",{get:function(){return this._boundingBoxData},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"rawDisplay",{get:function(){return this._rawDisplay},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"meshDisplay",{get:function(){return this._meshDisplay},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"display",{get:function(){return this._display},set:function(t){if(this._display!==t){var e=this._displayList.length;if(this._displayIndex<0&&0===e&&(this._displayIndex=0),!(this._displayIndex<0)){var i=this.displayList;e<=this._displayIndex&&(i.length=this._displayIndex+1),i[this._displayIndex]=t,this.displayList=i}}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"childArmature",{get:function(){return this._childArmature},set:function(t){this._childArmature!==t&&(this.display=t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"parent",{get:function(){return this._parent},enumerable:!0,configurable:!0}),i.prototype.getDisplay=function(){return this._display},i.prototype.setDisplay=function(t){this.display=t},i}(t.TransformObject);t.Slot=e}(a||(a={})),function(t){var e=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return s(i,e),i.prototype._onClear=function(){this._armature=null,this._target=null,this._root=null,this._bone=null},Object.defineProperty(i.prototype,"name",{get:function(){return this._constraintData.name},enumerable:!0,configurable:!0}),i._helpMatrix=new t.Matrix,i._helpTransform=new t.Transform,i._helpPoint=new t.Point,i}(t.BaseObject);t.Constraint=e;var i=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return s(i,e),i.toString=function(){return"[class dragonBones.IKConstraint]"},i.prototype._onClear=function(){e.prototype._onClear.call(this),this._scaleEnabled=!1,this._bendPositive=!1,this._weight=1,this._constraintData=null},i.prototype._computeA=function(){var e=this._target.global,i=this._root.global,r=this._root.globalTransformMatrix,n=Math.atan2(e.y-i.y,e.x-i.x);i.scaleX<0&&(n+=Math.PI),i.rotation+=t.Transform.normalizeRadian(n-i.rotation)*this._weight,i.toMatrix(r)},i.prototype._computeB=function(){var e=this._bone._boneData.length,i=this._root,r=this._target.global,n=i.global,a=this._bone.global,s=this._bone.globalTransformMatrix,o=s.a*e,h=s.b*e,l=o*o+h*h,u=Math.sqrt(l),c=a.x-n.x,p=a.y-n.y,f=c*c+p*p,d=Math.sqrt(f),m=a.rotation,g=n.rotation,y=Math.atan2(p,c),_=(c=r.x-n.x)*c+(p=r.y-n.y)*p,v=Math.sqrt(_),b=0;if(u+d<=v||v+u<=d||v+d<=u)b=Math.atan2(r.y-n.y,r.x-n.x),u+d<=v||d<u&&(b+=Math.PI);else{var T=(f-l+_)/(2*_),x=Math.sqrt(f-T*T*_)/v,D=n.x+c*T,$=n.y+p*T,E=-p*x,w=c*x,A=!1,S=i.parent;if(null!==S){var O=S.globalTransformMatrix;A=O.a*O.d-O.b*O.c<0}A!==this._bendPositive?(a.x=D-E,a.y=$-w):(a.x=D+E,a.y=$+w),b=Math.atan2(a.y-n.y,a.x-n.x)}var C=t.Transform.normalizeRadian(b-y);n.rotation=g+C*this._weight,n.toMatrix(i.globalTransformMatrix);var P=y+C*this._weight;a.x=n.x+Math.cos(P)*d,a.y=n.y+Math.sin(P)*d;var R=Math.atan2(r.y-a.y,r.x-a.x);a.scaleX<0&&(R+=Math.PI),a.rotation=n.rotation+m-g+t.Transform.normalizeRadian(R-C-m)*this._weight,a.toMatrix(s)},i.prototype.init=function(t,e){if(null===this._constraintData){this._constraintData=t,this._armature=e,this._target=this._armature.getBone(this._constraintData.target.name),this._root=this._armature.getBone(this._constraintData.root.name),this._bone=null!==this._constraintData.bone?this._armature.getBone(this._constraintData.bone.name):null;var i=this._constraintData;this._scaleEnabled=i.scaleEnabled,this._bendPositive=i.bendPositive,this._weight=i.weight,this._root._hasConstraint=!0}},i.prototype.update=function(){this._root.updateByConstraint(),null!==this._bone?(this._bone.updateByConstraint(),this._computeB()):this._computeA()},i.prototype.invalidUpdate=function(){this._root.invalidUpdate(),null!==this._bone&&this._bone.invalidUpdate()},i}(e);t.IKConstraint=i;var r=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t._bones=[],t._spaces=[],t._positions=[],t._curves=[],t._boneLengths=[],t._pathGlobalVertices=[],t._segments=[10],t}return s(i,e),i.toString=function(){return"[class dragonBones.PathConstraint]"},i.prototype._onClear=function(){e.prototype._onClear.call(this),this.dirty=!1,this.pathOffset=0,this.position=0,this.spacing=0,this.rotateOffset=0,this.rotateMix=1,this.translateMix=1,this._pathSlot=null,this._bones.length=0,this._spaces.length=0,this._positions.length=0,this._curves.length=0,this._boneLengths.length=0,this._pathGlobalVertices.length=0},i.prototype._updatePathVertices=function(t){var e=this._armature,i=e.armatureData.parent,r=e.armatureData.scale,n=i.intArray,a=i.floatArray,s=t.offset,o=n[s+0],h=n[s+2];this._pathGlobalVertices.length=2*o;var l=t.weight;if(null!==l)for(var u=this._pathSlot._deformVertices.bones,c=l.bones.length,p=l.offset,f=n[p+1],d=p+2+c,m=($=0,0);$<o;$++){for(var g=0,y=0,_=0,v=n[d++];_<v;_++){var b=u[n[d++]];if(null!==b){b.updateByConstraint(),D=b.globalTransformMatrix;var T=a[f++];w=a[f++]*r,A=a[f++]*r,g+=(D.a*w+D.c*A+D.tx)*T,y+=(D.b*w+D.d*A+D.ty)*T}}this._pathGlobalVertices[m++]=g,this._pathGlobalVertices[m++]=y}else{var x=this._pathSlot.parent;x.updateByConstraint();for(var D=x.globalTransformMatrix,$=0,E=h;$<o;$+=2){var w=a[E++]*r,A=a[E++]*r,S=D.a*w+D.c*A+D.tx,O=D.b*w+D.d*A+D.ty;this._pathGlobalVertices[$]=S,this._pathGlobalVertices[$+1]=O}}},i.prototype._computeVertices=function(t,e,i,r){for(var n=i,a=t;n<e;n+=2)r[n]=this._pathGlobalVertices[a++],r[n+1]=this._pathGlobalVertices[a++]},i.prototype._computeBezierCurve=function(t,e,i,r,n){var a=this._armature.armatureData.parent.intArray[t.vertices.offset+0],s=this._positions,o=this._spaces,h=t.closed,l=Array(),u=2*a,c=u/6,p=-1,f=this.position;s.length=3*e+2;var d=0;if(t.constantSpeed){h?(u+=2,l.length=a,this._computeVertices(2,u-4,0,l),this._computeVertices(0,2,u-4,l),l[u-2]=l[0],l[u-1]=l[1]):(c--,u-=4,l.length=u,this._computeVertices(2,u,0,l));var m=new Array(c);d=0;for(var g,y,_,v,b,T,x,D,$=l[0],E=l[1],w=0,A=0,S=0,O=0,C=0,P=0,R=(H=0,2);H<c;H++,R+=6)w=l[R],A=l[R+1],S=l[R+2],O=l[R+3],C=l[R+4],P=l[R+5],b=2*(g=.1875*($-2*w+S))+(_=.09375*(3*(w-S)-$+C)),T=2*(y=.1875*(E-2*A+O))+(v=.09375*(3*(A-O)-E+P)),x=.75*(w-$)+g+.16666667*_,D=.75*(A-E)+y+.16666667*v,d+=Math.sqrt(x*x+D*D),x+=b,D+=T,b+=_,T+=v,d+=Math.sqrt(x*x+D*D),x+=b,D+=T,d+=Math.sqrt(x*x+D*D),x+=b+_,D+=T+v,d+=Math.sqrt(x*x+D*D),m[H]=d,$=C,E=P;if(r&&(f*=d),n)for(H=0;H<e;H++)o[H]*=d;for(var M=this._segments,I=0,B=(H=0,W=0,X=0,0);H<e;H++,W+=3){var F=f+=o[H];if(h)(F%=d)<0&&(F+=d),X=0;else{if(F<0)continue;if(F>d)continue}for(;;X++){var L=m[X];if(!(F>L)){0===X?F/=L:F=(F-(j=m[X-1]))/(L-j);break}}if(X!==p){p=X;var N=6*X;for($=l[N],E=l[N+1],w=l[N+2],A=l[N+3],S=l[N+4],O=l[N+5],C=l[N+6],P=l[N+7],b=2*(g=.03*($-2*w+S))+(_=.006*(3*(w-S)-$+C)),T=2*(y=.03*(E-2*A+O))+(v=.006*(3*(A-O)-E+P)),x=.3*(w-$)+g+.16666667*_,D=.3*(A-E)+y+.16666667*v,I=Math.sqrt(x*x+D*D),M[0]=I,N=1;N<8;N++)x+=b,D+=T,b+=_,T+=v,I+=Math.sqrt(x*x+D*D),M[N]=I;x+=b,D+=T,I+=Math.sqrt(x*x+D*D),M[8]=I,x+=b+_,D+=T+v,I+=Math.sqrt(x*x+D*D),M[9]=I,B=0}for(F*=I;;B++){var k=M[B];if(!(F>k)){var j;0===B?F/=k:F=B+(F-(j=M[B-1]))/(k-j);break}}this.addCurvePosition(.1*F,$,E,w,A,S,O,C,P,s,W,i)}}else{var U=t.curveLengths;if(d=U[c-=h?1:2],r&&(f*=d),n)for(var H=0;H<e;H++)o[H]*=d;l.length=8;H=0;for(var W=0,X=0;H<e;H++,W+=3){if(f+=o[H],h)(f%=d)<0&&(f+=d),X=0;else{if(f<0)continue;if(f>d)continue}for(var Y=0;;X++){var G=U[X];if(!(f>G)){if(0===X)Y=f/G;else{var V=U[X-1];Y=(f-V)/(G-V)}break}}X!==p&&(p=X,h&&X===c?(this._computeVertices(u-4,4,0,l),this._computeVertices(0,4,4,l)):this._computeVertices(6*X+2,8,0,l)),this.addCurvePosition(Y,l[0],l[1],l[2],l[3],l[4],l[5],l[6],l[7],s,W,i)}}},i.prototype.addCurvePosition=function(t,e,i,r,n,a,s,o,h,l,u,c){if(0===t)return l[u]=e,l[u+1]=i,void(l[u+2]=0);if(1===t)return l[u]=o,l[u+1]=h,void(l[u+2]=0);var p=1-t,f=p*p,d=t*t,m=f*p,g=f*t*3,y=p*d*3,_=t*d,v=m*e+g*r+y*a+_*o,b=m*i+g*n+y*s+_*h;l[u]=v,l[u+1]=b,l[u+2]=c?Math.atan2(b-(m*i+g*n+y*s),v-(m*e+g*r+y*a)):0},i.prototype.init=function(t,e){this._constraintData=t,this._armature=e;var i=t;this.pathOffset=i.pathDisplayData.vertices.offset,this.position=i.position,this.spacing=i.spacing,this.rotateOffset=i.rotateOffset,this.rotateMix=i.rotateMix,this.translateMix=i.translateMix,this._root=this._armature.getBone(i.root.name),this._target=this._armature.getBone(i.target.name),this._pathSlot=this._armature.getSlot(i.pathSlot.name);for(var r=0,n=i.bones.length;r<n;r++){var a=this._armature.getBone(i.bones[r].name);null!==a&&this._bones.push(a)}2===i.rotateMode&&(this._boneLengths.length=this._bones.length),this._root._hasConstraint=!0},i.prototype.update=function(){var e=this._pathSlot;if(null!==e._deformVertices&&null!==e._deformVertices.verticesData&&e._deformVertices.verticesData.offset===this.pathOffset){var i=this._constraintData,r=e._displayData,n=!1,a=e._deformVertices;if(this._root._childrenTransformDirty?(this._updatePathVertices(r.vertices),n=!0):null!==a&&(a.verticesDirty||a.isBonesUpdate())&&(this._updatePathVertices(r.vertices),a.verticesDirty=!1,n=!0),n||this.dirty){var s=i.positionMode,o=i.spacingMode,h=i.rotateMode,l=this._bones,u=0===o,c=2===h,p=0===h,f=l.length,d=p?f:f+1,m=this.spacing,g=this._spaces;if(g.length=d,c||u){g[0]=0;for(var y=0,_=d-1;y<_;y++){(P=l[y]).updateByConstraint();var v=P._boneData.length,b=v*(R=P.globalTransformMatrix).a,T=v*R.b,x=Math.sqrt(b*b+T*T);c&&(this._boneLengths[y]=x),g[y+1]=(v+m)*x/v}}else for(y=0;y<d;y++)g[y]=m;this._computeBezierCurve(r,d,p,1===s,2===o);var D,$=this._positions,E=this.rotateOffset,w=$[0],A=$[1];0===E?D=1===h:(D=!1,null!==(P=e.parent)&&(E*=(R=P.globalTransformMatrix).a*R.d-R.b*R.c>0?t.Transform.DEG_RAD:-t.Transform.DEG_RAD));for(var S=this.rotateMix,O=this.translateMix,C=(y=0,3);y<f;y++,C+=3){var P,R;(P=l[y]).updateByConstraint(),(R=P.globalTransformMatrix).tx+=(w-R.tx)*O,R.ty+=(A-R.ty)*O;var M=(b=$[C])-w,I=(T=$[C+1])-A;if(c){var B=this._boneLengths[y],F=(Math.sqrt(M*M+I*I)/B-1)*S+1;R.a*=F,R.b*=F}if(w=b,A=T,S>0){var L=R.a,N=R.b,k=R.c,j=R.d,U=void 0,H=void 0,W=void 0;if(U=p?$[C-1]:Math.atan2(I,M),U-=Math.atan2(N,L),D){H=Math.cos(U),W=Math.sin(U);var X=P._boneData.length;w+=(X*(H*L-W*N)-M)*S,A+=(X*(W*L+H*N)-I)*S}else U+=E;U>t.Transform.PI?U-=t.Transform.PI_D:U<-t.Transform.PI&&(U+=t.Transform.PI_D),U*=S,H=Math.cos(U),W=Math.sin(U),R.a=H*L-W*N,R.b=W*L+H*N,R.c=H*k-W*j,R.d=W*k+H*j}P.global.fromMatrix(R)}this.dirty=!1}}},i.prototype.invalidUpdate=function(){},i}(e);t.PathConstraint=r}(a||(a={})),function(t){var e=function(){function t(t){void 0===t&&(t=0),this.time=0,this.timeScale=1,this._systemTime=0,this._animatebles=[],this._clock=null,this.time=t,this._systemTime=.001*(new Date).getTime()}return t.prototype.advanceTime=function(t){t!=t&&(t=0);var e=.001*Date.now();if(t<0&&(t=e-this._systemTime),this._systemTime=e,1!==this.timeScale&&(t*=this.timeScale),0!==t){t<0?this.time-=t:this.time+=t;for(var i=0,r=0,n=this._animatebles.length;i<n;++i){var a=this._animatebles[i];null!==a?(r>0&&(this._animatebles[i-r]=a,this._animatebles[i]=null),a.advanceTime(t)):r++}if(r>0){for(n=this._animatebles.length;i<n;++i){var s=this._animatebles[i];null!==s?this._animatebles[i-r]=s:r++}this._animatebles.length-=r}}},t.prototype.contains=function(t){if(t===this)return!1;for(var e=t;e!==this&&null!==e;)e=e.clock;return e===this},t.prototype.add=function(t){this._animatebles.indexOf(t)<0&&(this._animatebles.push(t),t.clock=this)},t.prototype.remove=function(t){var e=this._animatebles.indexOf(t);e>=0&&(this._animatebles[e]=null,t.clock=null)},t.prototype.clear=function(){for(var t=0,e=this._animatebles;t<e.length;t++){var i=e[t];null!==i&&(i.clock=null)}},Object.defineProperty(t.prototype,"clock",{get:function(){return this._clock},set:function(t){this._clock!==t&&(null!==this._clock&&this._clock.remove(this),this._clock=t,null!==this._clock&&this._clock.add(this))},enumerable:!0,configurable:!0}),t.clock=new t,t}();t.WorldClock=e}(a||(a={})),function(t){var e=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t._animationNames=[],t._animationStates=[],t._animations={},t._animationConfig=null,t}return s(i,e),i.toString=function(){return"[class dragonBones.Animation]"},i.prototype._onClear=function(){for(var t=0,e=this._animationStates;t<e.length;t++)e[t].returnToPool();for(var i in this._animations)delete this._animations[i];null!==this._animationConfig&&this._animationConfig.returnToPool(),this.timeScale=1,this._lockUpdate=!1,this._animationDirty=!1,this._inheritTimeScale=1,this._animationNames.length=0,this._animationStates.length=0,this._armature=null,this._animationConfig=null,this._lastAnimationState=null},i.prototype._fadeOut=function(t){switch(t.fadeOutMode){case 1:for(var e=0,i=this._animationStates;e<i.length;e++)null===(l=i[e])._parent&&l.layer===t.layer&&l.fadeOut(t.fadeOutTime,t.pauseFadeOut);break;case 2:for(var r=0,n=this._animationStates;r<n.length;r++)null===(l=n[r])._parent&&l.group===t.group&&l.fadeOut(t.fadeOutTime,t.pauseFadeOut);break;case 3:for(var a=0,s=this._animationStates;a<s.length;a++)null===(l=s[a])._parent&&l.layer===t.layer&&l.group===t.group&&l.fadeOut(t.fadeOutTime,t.pauseFadeOut);break;case 4:for(var o=0,h=this._animationStates;o<h.length;o++){var l;null===(l=h[o])._parent&&l.fadeOut(t.fadeOutTime,t.pauseFadeOut)}}},i.prototype.init=function(e){null===this._armature&&(this._armature=e,this._animationConfig=t.BaseObject.borrowObject(t.AnimationConfig))},i.prototype.advanceTime=function(t){t<0&&(t=-t),this._armature.inheritAnimation&&null!==this._armature._parent?this._inheritTimeScale=this._armature._parent._armature.animation._inheritTimeScale*this.timeScale:this._inheritTimeScale=this.timeScale,1!==this._inheritTimeScale&&(t*=this._inheritTimeScale);var e=this._animationStates.length;if(1===e)if((d=this._animationStates[0])._fadeState>0&&d._subFadeState>0)this._armature._dragonBones.bufferObject(d),this._animationStates.length=0,this._lastAnimationState=null;else{var i=d._animationData,r=i.cacheFrameRate;if(this._animationDirty&&r>0){this._animationDirty=!1;for(var n=0,a=this._armature.getBones();n<a.length;n++){var s=a[n];s._cachedFrameIndices=i.getBoneCachedFrameIndices(s.name)}for(var o=0,h=this._armature.getSlots();o<h.length;o++){var l=h[o],u=l.rawDisplayDatas;if(null!==u&&u.length>0){var c=u[0];if(null!==c&&c.parent===this._armature.armatureData.defaultSkin){l._cachedFrameIndices=i.getSlotCachedFrameIndices(l.name);continue}}l._cachedFrameIndices=null}}d.advanceTime(t,r)}else if(e>1){for(var p=0,f=0;p<e;++p){var d;(d=this._animationStates[p])._fadeState>0&&d._subFadeState>0?(f++,this._armature._dragonBones.bufferObject(d),this._animationDirty=!0,this._lastAnimationState===d&&(this._lastAnimationState=null)):(f>0&&(this._animationStates[p-f]=d),d.advanceTime(t,0)),p===e-1&&f>0&&(this._animationStates.length-=f,null===this._lastAnimationState&&this._animationStates.length>0&&(this._lastAnimationState=this._animationStates[this._animationStates.length-1]))}this._armature._cacheFrameIndex=-1}else this._armature._cacheFrameIndex=-1},i.prototype.reset=function(){for(var t=0,e=this._animationStates;t<e.length;t++)e[t].returnToPool();this._animationDirty=!1,this._animationConfig.clear(),this._animationStates.length=0,this._lastAnimationState=null},i.prototype.stop=function(t){if(void 0===t&&(t=null),null!==t)null!==(r=this.getState(t))&&r.stop();else for(var e=0,i=this._animationStates;e<i.length;e++){var r;(r=i[e]).stop()}},i.prototype.playConfig=function(e){var i=e.animation;if(!(i in this._animations))return console.warn("Non-existent animation.\n","DragonBones name: "+this._armature.armatureData.parent.name,"Armature name: "+this._armature.name,"Animation name: "+i),null;var r=this._animations[i];if(5===e.fadeOutMode)for(var n=0,a=this._animationStates;n<a.length;n++){var s=a[n];if(s._animationData===r)return s}0===this._animationStates.length?e.fadeInTime=0:e.fadeInTime<0&&(e.fadeInTime=r.fadeInTime),e.fadeOutTime<0&&(e.fadeOutTime=e.fadeInTime),e.timeScale<=-100&&(e.timeScale=1/r.scale),r.frameCount>1?(e.position<0?(e.position%=r.duration,e.position=r.duration-e.position):e.position===r.duration?e.position-=1e-6:e.position>r.duration&&(e.position%=r.duration),e.duration>0&&e.position+e.duration>r.duration&&(e.duration=r.duration-e.position),e.playTimes<0&&(e.playTimes=r.playTimes)):(e.playTimes=1,e.position=0,e.duration>0&&(e.duration=0)),0===e.duration&&(e.duration=-1),this._fadeOut(e);var o=t.BaseObject.borrowObject(t.AnimationState);if(o.init(this._armature,r,e),this._animationDirty=!0,this._armature._cacheFrameIndex=-1,this._animationStates.length>0){for(var h=!1,l=0,u=this._animationStates.length;l<u;++l){if(o.layer>this._animationStates[l].layer){h=!0,this._animationStates.splice(l,0,o);break}if(l!==u-1&&o.layer>this._animationStates[l+1].layer){h=!0,this._animationStates.splice(l+1,0,o);break}}h||this._animationStates.push(o)}else this._animationStates.push(o);for(var c=0,p=this._armature.getSlots();c<p.length;c++){var f=p[c].childArmature;null!==f&&f.inheritAnimation&&f.animation.hasAnimation(i)&&null===f.animation.getState(i)&&f.animation.fadeIn(i)}var d=!1;for(var m in r.animationTimelines){this._lockUpdate||(d=!0,this._lockUpdate=!0);var g=this.fadeIn(m,e.fadeInTime,1,o.layer,null,0);null!==g&&(g.resetToPose=!1,g._parent=o,g.stop())}return d&&(this._lockUpdate=!1),this._lockUpdate||(e.fadeInTime<=0&&this._armature.advanceTime(0),this._lastAnimationState=o),o},i.prototype.play=function(t,e){if(void 0===t&&(t=null),void 0===e&&(e=-1),this._animationConfig.clear(),this._animationConfig.resetToPose=!0,this._animationConfig.playTimes=e,this._animationConfig.fadeInTime=0,this._animationConfig.animation=null!==t?t:"",null!==t&&t.length>0)this.playConfig(this._animationConfig);else if(null===this._lastAnimationState){var i=this._armature.armatureData.defaultAnimation;null!==i&&(this._animationConfig.animation=i.name,this.playConfig(this._animationConfig))}else this._lastAnimationState.isPlaying||this._lastAnimationState.isCompleted?(this._animationConfig.animation=this._lastAnimationState.name,this.playConfig(this._animationConfig)):this._lastAnimationState.play();return this._lastAnimationState},i.prototype.fadeIn=function(t,e,i,r,n,a){return void 0===e&&(e=-1),void 0===i&&(i=-1),void 0===r&&(r=0),void 0===n&&(n=null),void 0===a&&(a=3),this._animationConfig.clear(),this._animationConfig.fadeOutMode=a,this._animationConfig.playTimes=i,this._animationConfig.layer=r,this._animationConfig.fadeInTime=e,this._animationConfig.animation=t,this._animationConfig.group=null!==n?n:"",this.playConfig(this._animationConfig)},i.prototype.gotoAndPlayByTime=function(t,e,i){return void 0===e&&(e=0),void 0===i&&(i=-1),this._animationConfig.clear(),this._animationConfig.resetToPose=!0,this._animationConfig.playTimes=i,this._animationConfig.position=e,this._animationConfig.fadeInTime=0,this._animationConfig.animation=t,this.playConfig(this._animationConfig)},i.prototype.gotoAndPlayByFrame=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=-1),this._animationConfig.clear(),this._animationConfig.resetToPose=!0,this._animationConfig.playTimes=i,this._animationConfig.fadeInTime=0,this._animationConfig.animation=t;var r=t in this._animations?this._animations[t]:null;return null!==r&&(this._animationConfig.position=r.duration*e/r.frameCount),this.playConfig(this._animationConfig)},i.prototype.gotoAndPlayByProgress=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=-1),this._animationConfig.clear(),this._animationConfig.resetToPose=!0,this._animationConfig.playTimes=i,this._animationConfig.fadeInTime=0,this._animationConfig.animation=t;var r=t in this._animations?this._animations[t]:null;return null!==r&&(this._animationConfig.position=r.duration*(e>0?e:0)),this.playConfig(this._animationConfig)},i.prototype.gotoAndStopByTime=function(t,e){void 0===e&&(e=0);var i=this.gotoAndPlayByTime(t,e,1);return null!==i&&i.stop(),i},i.prototype.gotoAndStopByFrame=function(t,e){void 0===e&&(e=0);var i=this.gotoAndPlayByFrame(t,e,1);return null!==i&&i.stop(),i},i.prototype.gotoAndStopByProgress=function(t,e){void 0===e&&(e=0);var i=this.gotoAndPlayByProgress(t,e,1);return null!==i&&i.stop(),i},i.prototype.getState=function(t){for(var e=this._animationStates.length;e--;){var i=this._animationStates[e];if(i.name===t)return i}return null},i.prototype.hasAnimation=function(t){return t in this._animations},i.prototype.getStates=function(){return this._animationStates},Object.defineProperty(i.prototype,"isPlaying",{get:function(){for(var t=0,e=this._animationStates;t<e.length;t++)if(e[t].isPlaying)return!0;return!1},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isCompleted",{get:function(){for(var t=0,e=this._animationStates;t<e.length;t++)if(!e[t].isCompleted)return!1;return this._animationStates.length>0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"lastAnimationName",{get:function(){return null!==this._lastAnimationState?this._lastAnimationState.name:""},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"animationNames",{get:function(){return this._animationNames},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"animations",{get:function(){return this._animations},set:function(t){if(this._animations!==t){for(var e in this._animationNames.length=0,this._animations)delete this._animations[e];for(var e in t)this._animationNames.push(e),this._animations[e]=t[e]}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"animationConfig",{get:function(){return this._animationConfig.clear(),this._animationConfig},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"lastAnimationState",{get:function(){return this._lastAnimationState},enumerable:!0,configurable:!0}),i.prototype.gotoAndPlay=function(t,e,i,r,n,a,s,o,h){void 0===e&&(e=-1),void 0===i&&(i=-1),void 0===r&&(r=-1),void 0===n&&(n=0),void 0===a&&(a=null),void 0===s&&(s=3),void 0===o&&(o=!0),void 0===h&&(h=!0),console.warn("Deprecated."),this._animationConfig.clear(),this._animationConfig.resetToPose=!0,this._animationConfig.fadeOutMode=s,this._animationConfig.playTimes=r,this._animationConfig.layer=n,this._animationConfig.fadeInTime=e,this._animationConfig.animation=t,this._animationConfig.group=null!==a?a:"";var l=this._animations[t];return l&&i>0&&(this._animationConfig.timeScale=l.duration/i),this.playConfig(this._animationConfig)},i.prototype.gotoAndStop=function(t,e){return void 0===e&&(e=0),console.warn("Deprecated."),this.gotoAndStopByTime(t,e)},Object.defineProperty(i.prototype,"animationList",{get:function(){return console.warn("Deprecated."),this._animationNames},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"animationDataList",{get:function(){console.warn("Deprecated.");for(var t=[],e=0,i=this._animationNames.length;e<i;++e)t.push(this._animations[this._animationNames[e]]);return t},enumerable:!0,configurable:!0}),i}(t.BaseObject);t.Animation=e}(a||(a={})),function(t){var e=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t._blendState=new r,t._boneMask=[],t._boneTimelines=[],t._surfaceTimelines=[],t._slotTimelines=[],t._constraintTimelines=[],t._animationTimelines=[],t._poseTimelines=[],t._bonePoses={},t._actionTimeline=null,t._zOrderTimeline=null,t._parent=null,t}return s(n,e),n.toString=function(){return"[class dragonBones.AnimationState]"},n.prototype._onClear=function(){for(var t=0,e=this._boneTimelines;t<e.length;t++)e[t].returnToPool();for(var i=0,r=this._surfaceTimelines;i<r.length;i++)r[i].returnToPool();for(var n=0,a=this._slotTimelines;n<a.length;n++)a[n].returnToPool();for(var s=0,o=this._constraintTimelines;s<o.length;s++)o[s].returnToPool();for(var h=0,l=this._animationTimelines;h<l.length;h++)l[h].returnToPool();for(var u in this._bonePoses)this._bonePoses[u].returnToPool(),delete this._bonePoses[u];null!==this._actionTimeline&&this._actionTimeline.returnToPool(),null!==this._zOrderTimeline&&this._zOrderTimeline.returnToPool(),this.actionEnabled=!1,this.additiveBlending=!1,this.displayControl=!1,this.resetToPose=!1,this.playTimes=1,this.layer=0,this.timeScale=1,this.weight=1,this.autoFadeOutTime=0,this.fadeTotalTime=0,this.name="",this.group="",this._timelineDirty=2,this._playheadState=0,this._fadeState=-1,this._subFadeState=-1,this._position=0,this._duration=0,this._fadeTime=0,this._time=0,this._fadeProgress=0,this._weightResult=0,this._blendState.clear(),this._boneMask.length=0,this._boneTimelines.length=0,this._surfaceTimelines.length=0,this._slotTimelines.length=0,this._constraintTimelines.length=0,this._animationTimelines.length=0,this._poseTimelines.length=0,this._animationData=null,this._armature=null,this._actionTimeline=null,this._zOrderTimeline=null,this._parent=null},n.prototype._updateTimelines=function(){for(var e=0,i=this._armature._constraints;e<i.length;e++){var r=i[e];if(null!==(h=this._animationData.getConstraintTimelines(r.name)))for(var n=0,a=h;n<a.length;n++)switch((p=a[n]).type){case 30:(f=t.BaseObject.borrowObject(t.IKConstraintTimelineState)).constraint=r,f.init(this._armature,this,p),this._constraintTimelines.push(f)}else this.resetToPose&&((f=t.BaseObject.borrowObject(t.IKConstraintTimelineState)).constraint=r,f.init(this._armature,this,null),this._constraintTimelines.push(f),this._poseTimelines.push(f))}for(var s=0,o=this._armature.animation.getStates();s<o.length;s++){var h,l=o[s];if(l._parent===this&&null!==(h=this._animationData.getAnimationTimelines(l.name)))for(var u=0,c=h;u<c.length;u++){var p;switch((p=c[u]).type){case 40:var f;(f=t.BaseObject.borrowObject(t.AnimationTimelineState)).animationState=l,f.init(this._armature,this,p),this._animationTimelines.push(f)}}}},n.prototype._updateBoneAndSlotTimelines=function(){for(var e={},r=0,n=this._boneTimelines;r<n.length;r++)(h=(_=n[r]).bone.name)in e||(e[h]=[]),e[h].push(_);for(var a=0,s=this._armature.getBones();a<s.length;a++){var o=s[a],h=o.name;if(this.containsBoneMask(h))if(h in e)delete e[h];else if(0===o._boneData.type){var l=this._animationData.getBoneTimelines(h),u=h in this._bonePoses?this._bonePoses[h]:this._bonePoses[h]=t.BaseObject.borrowObject(i);if(null!==l)for(var c=0,p=l;c<p.length;c++)switch((P=p[c]).type){case 10:(_=t.BaseObject.borrowObject(t.BoneAllTimelineState)).bone=o,_.bonePose=u,_.init(this._armature,this,P),this._boneTimelines.push(_);break;case 11:(_=t.BaseObject.borrowObject(t.BoneTranslateTimelineState)).bone=o,_.bonePose=u,_.init(this._armature,this,P),this._boneTimelines.push(_);break;case 12:(_=t.BaseObject.borrowObject(t.BoneRotateTimelineState)).bone=o,_.bonePose=u,_.init(this._armature,this,P),this._boneTimelines.push(_);break;case 13:(_=t.BaseObject.borrowObject(t.BoneScaleTimelineState)).bone=o,_.bonePose=u,_.init(this._armature,this,P),this._boneTimelines.push(_)}else this.resetToPose&&((_=t.BaseObject.borrowObject(t.BoneAllTimelineState)).bone=o,_.bonePose=u,_.init(this._armature,this,null),this._boneTimelines.push(_),this._poseTimelines.push(_))}else if(1===o._boneData.type)if(null!==(l=this._animationData.getSurfaceTimelines(h)))for(var f=0,d=l;f<d.length;f++)switch((P=d[f]).type){case 50:(_=t.BaseObject.borrowObject(t.SurfaceTimelineState)).surface=o,_.init(this._armature,this,P),this._surfaceTimelines.push(_)}else this.resetToPose&&((_=t.BaseObject.borrowObject(t.SurfaceTimelineState)).surface=o,_.init(this._armature,this,null),this._surfaceTimelines.push(_),this._poseTimelines.push(_))}for(var m in e)for(var g=0,y=e[m];g<y.length;g++){var _=y[g];this._boneTimelines.splice(this._boneTimelines.indexOf(_),1),_.returnToPool()}for(var v={},b=[],T=0,x=this._slotTimelines;T<x.length;T++)(h=(_=x[T]).slot.name)in v||(v[h]=[]),v[h].push(_);for(var D=0,$=this._armature.getSlots();D<$.length;D++){var E=$[D],w=E.parent.name;if(this.containsBoneMask(w))if(h=E.name,l=this._animationData.getSlotTimelines(h),h in v)delete v[h];else{var A=!1,S=!1;if(b.length=0,null!==l)for(var O=0,C=l;O<C.length;O++){var P;switch((P=C[O]).type){case 20:(_=t.BaseObject.borrowObject(t.SlotDislayTimelineState)).slot=E,_.init(this._armature,this,P),this._slotTimelines.push(_),A=!0;break;case 21:(_=t.BaseObject.borrowObject(t.SlotColorTimelineState)).slot=E,_.init(this._armature,this,P),this._slotTimelines.push(_),S=!0;break;case 22:(_=t.BaseObject.borrowObject(t.DeformTimelineState)).slot=E,_.init(this._armature,this,P),this._slotTimelines.push(_),b.push(_.vertexOffset)}}if(this.resetToPose&&(A||((_=t.BaseObject.borrowObject(t.SlotDislayTimelineState)).slot=E,_.init(this._armature,this,null),this._slotTimelines.push(_),this._poseTimelines.push(_)),S||((_=t.BaseObject.borrowObject(t.SlotColorTimelineState)).slot=E,_.init(this._armature,this,null),this._slotTimelines.push(_),this._poseTimelines.push(_)),null!==E.rawDisplayDatas))for(var R=0,M=E.rawDisplayDatas;R<M.length;R++){var I=M[R];if(null!==I&&2===I.type){var B=I.vertices.offset;b.indexOf(B)<0&&((_=t.BaseObject.borrowObject(t.DeformTimelineState)).vertexOffset=B,_.slot=E,_.init(this._armature,this,null),this._slotTimelines.push(_),this._poseTimelines.push(_))}}}}for(var m in v)for(var F=0,L=v[m];F<L.length;F++)_=L[F],this._slotTimelines.splice(this._slotTimelines.indexOf(_),1),_.returnToPool()},n.prototype._advanceFadeTime=function(e){var i,r=this._fadeState>0;if(this._subFadeState<0){this._subFadeState=0;var n=r?t.EventObject.FADE_OUT:t.EventObject.FADE_IN;this._armature.eventDispatcher.hasDBEventListener(n)&&((i=t.BaseObject.borrowObject(t.EventObject)).type=n,i.armature=this._armature,i.animationState=this,this._armature._dragonBones.bufferEvent(i))}(e<0&&(e=-e),this._fadeTime+=e,this._fadeTime>=this.fadeTotalTime?(this._subFadeState=1,this._fadeProgress=r?0:1):this._fadeTime>0?this._fadeProgress=r?1-this._fadeTime/this.fadeTotalTime:this._fadeTime/this.fadeTotalTime:this._fadeProgress=r?1:0,this._subFadeState>0)&&(r||(this._playheadState|=1,this._fadeState=0),n=r?t.EventObject.FADE_OUT_COMPLETE:t.EventObject.FADE_IN_COMPLETE,this._armature.eventDispatcher.hasDBEventListener(n)&&((i=t.BaseObject.borrowObject(t.EventObject)).type=n,i.armature=this._armature,i.animationState=this,this._armature._dragonBones.bufferEvent(i)))},n.prototype.init=function(e,i,r){if(null===this._armature){if(this._armature=e,this._animationData=i,this.resetToPose=r.resetToPose,this.additiveBlending=r.additiveBlending,this.displayControl=r.displayControl,this.actionEnabled=r.actionEnabled,this.layer=r.layer,this.playTimes=r.playTimes,this.timeScale=r.timeScale,this.fadeTotalTime=r.fadeInTime,this.autoFadeOutTime=r.autoFadeOutTime,this.weight=r.weight,this.name=r.name.length>0?r.name:r.animation,this.group=r.group,r.pauseFadeIn?this._playheadState=2:this._playheadState=3,r.duration<0?(this._position=0,this._duration=this._animationData.duration,0!==r.position?this.timeScale>=0?this._time=r.position:this._time=r.position-this._duration:this._time=0):(this._position=r.position,this._duration=r.duration,this._time=0),this.timeScale<0&&0===this._time&&(this._time=-1e-6),this.fadeTotalTime<=0&&(this._fadeProgress=.999999),r.boneMask.length>0){this._boneMask.length=r.boneMask.length;for(var n=0,a=this._boneMask.length;n<a;++n)this._boneMask[n]=r.boneMask[n]}this._actionTimeline=t.BaseObject.borrowObject(t.ActionTimelineState),this._actionTimeline.init(this._armature,this,this._animationData.actionTimeline),this._actionTimeline.currentTime=this._time,this._actionTimeline.currentTime<0&&(this._actionTimeline.currentTime=this._duration-this._actionTimeline.currentTime),null!==this._animationData.zOrderTimeline&&(this._zOrderTimeline=t.BaseObject.borrowObject(t.ZOrderTimelineState),this._zOrderTimeline.init(this._armature,this,this._animationData.zOrderTimeline))}},n.prototype.advanceTime=function(e,i){if(this._blendState.dirty=!1,0===this._fadeState&&0===this._subFadeState||this._advanceFadeTime(e),3===this._playheadState&&(1!==this.timeScale&&(e*=this.timeScale),this._time+=e),0!==this._timelineDirty&&(2===this._timelineDirty&&this._updateTimelines(),this._timelineDirty=0,this._updateBoneAndSlotTimelines()),0!==this.weight){var r=0===this._fadeState&&i>0,n=!0,a=!0,s=this._time;if(this._weightResult=this.weight*this._fadeProgress,null!==this._parent&&(this._weightResult*=this._parent._weightResult/this._parent._fadeProgress),this._actionTimeline.playState<=0&&this._actionTimeline.update(s),r){var o=2*i;this._actionTimeline.currentTime=Math.floor(this._actionTimeline.currentTime*o)/o}if(null!==this._zOrderTimeline&&this._zOrderTimeline.playState<=0&&this._zOrderTimeline.update(s),r){var h=Math.floor(this._actionTimeline.currentTime*i);this._armature._cacheFrameIndex===h?(n=!1,a=!1):(this._armature._cacheFrameIndex=h,this._animationData.cachedFrames[h]?a=!1:this._animationData.cachedFrames[h]=!0)}if(n){if(a)for(var l=0,u=this._boneTimelines.length;l<u;++l)(m=this._boneTimelines[l]).playState<=0&&m.update(s),(l===u-1||m.bone!==this._boneTimelines[l+1].bone)&&0!==(c=m.bone._blendState.update(this._weightResult,this.layer))&&m.blend(c);for(l=0,u=this._surfaceTimelines.length;l<u;++l){var c=(m=this._surfaceTimelines[l]).surface._blendState.update(this._weightResult,this.layer);m.playState<=0&&m.update(s),0!==c&&m.blend(c)}if(this.displayControl)for(l=0,u=this._slotTimelines.length;l<u;++l){var p=(m=this._slotTimelines[l]).slot.displayController;null!==p&&p!==this.name&&p!==this.group||m.playState<=0&&m.update(s)}for(l=0,u=this._constraintTimelines.length;l<u;++l)(m=this._constraintTimelines[l]).playState<=0&&m.update(s);for(l=0,u=this._animationTimelines.length;l<u;++l)c=(m=this._animationTimelines[l]).animationState._blendState.update(this._weightResult,this.layer),m.playState<=0&&m.update(s),0!==c&&m.blend(c)}if(0===this._fadeState){if(this._subFadeState>0&&(this._subFadeState=0,this._poseTimelines.length>0)){for(var f=0,d=this._poseTimelines;f<d.length;f++){var m;(m=d[f])instanceof t.BoneTimelineState?this._boneTimelines.splice(this._boneTimelines.indexOf(m),1):m instanceof t.SurfaceTimelineState?this._surfaceTimelines.splice(this._surfaceTimelines.indexOf(m),1):m instanceof t.SlotTimelineState?this._slotTimelines.splice(this._slotTimelines.indexOf(m),1):m instanceof t.ConstraintTimelineState&&this._constraintTimelines.splice(this._constraintTimelines.indexOf(m),1),m.returnToPool()}this._poseTimelines.length=0}this._actionTimeline.playState>0&&this.autoFadeOutTime>=0&&this.fadeOut(this.autoFadeOutTime)}}},n.prototype.play=function(){this._playheadState=3},n.prototype.stop=function(){this._playheadState&=1},n.prototype.fadeOut=function(t,e){if(void 0===e&&(e=!0),t<0&&(t=0),e&&(this._playheadState&=2),this._fadeState>0){if(t>this.fadeTotalTime-this._fadeTime)return}else{this._fadeState=1,this._subFadeState=-1,(t<=0||this._fadeProgress<=0)&&(this._fadeProgress=1e-6);for(var i=0,r=this._boneTimelines;i<r.length;i++)(p=r[i]).fadeOut();for(var n=0,a=this._surfaceTimelines;n<a.length;n++)(p=a[n]).fadeOut();for(var s=0,o=this._slotTimelines;s<o.length;s++)(p=o[s]).fadeOut();for(var h=0,l=this._constraintTimelines;h<l.length;h++)(p=l[h]).fadeOut();for(var u=0,c=this._animationTimelines;u<c.length;u++){var p;(p=c[u]).animationState.fadeOut(t,e),p.fadeOut()}}this.displayControl=!1,this.fadeTotalTime=this._fadeProgress>1e-6?t/this._fadeProgress:0,this._fadeTime=this.fadeTotalTime*(1-this._fadeProgress)},n.prototype.containsBoneMask=function(t){return 0===this._boneMask.length||this._boneMask.indexOf(t)>=0},n.prototype.addBoneMask=function(t,e){void 0===e&&(e=!0);var i=this._armature.getBone(t);if(null!==i){if(this._boneMask.indexOf(t)<0&&this._boneMask.push(t),e)for(var r=0,n=this._armature.getBones();r<n.length;r++){var a=n[r];this._boneMask.indexOf(a.name)<0&&i.contains(a)&&this._boneMask.push(a.name)}this._timelineDirty=1}},n.prototype.removeBoneMask=function(t,e){void 0===e&&(e=!0);var i=this._boneMask.indexOf(t);if(i>=0&&this._boneMask.splice(i,1),e){var r=this._armature.getBone(t);if(null!==r){var n=this._armature.getBones();if(this._boneMask.length>0)for(var a=0,s=n;a<s.length;a++){var o=s[a],h=this._boneMask.indexOf(o.name);h>=0&&r.contains(o)&&this._boneMask.splice(h,1)}else for(var l=0,u=n;l<u.length;l++)(o=u[l])!==r&&(r.contains(o)||this._boneMask.push(o.name))}}this._timelineDirty=1},n.prototype.removeAllBoneMask=function(){this._boneMask.length=0,this._timelineDirty=1},Object.defineProperty(n.prototype,"isFadeIn",{get:function(){return this._fadeState<0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isFadeOut",{get:function(){return this._fadeState>0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isFadeComplete",{get:function(){return 0===this._fadeState},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isPlaying",{get:function(){return 0!=(2&this._playheadState)&&this._actionTimeline.playState<=0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isCompleted",{get:function(){return this._actionTimeline.playState>0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"currentPlayTimes",{get:function(){return this._actionTimeline.currentPlayTimes},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"totalTime",{get:function(){return this._duration},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"currentTime",{get:function(){return this._actionTimeline.currentTime},set:function(t){var e=this._actionTimeline.currentPlayTimes-(this._actionTimeline.playState>0?1:0);if((t<0||this._duration<t)&&(t=t%this._duration+e*this._duration)<0&&(t+=this._duration),this.playTimes>0&&e===this.playTimes-1&&t===this._duration&&(t=this._duration-1e-6),this._time!==t){this._time=t,this._actionTimeline.setCurrentTime(this._time),null!==this._zOrderTimeline&&(this._zOrderTimeline.playState=-1);for(var i=0,r=this._boneTimelines;i<r.length;i++)r[i].playState=-1;for(var n=0,a=this._slotTimelines;n<a.length;n++)a[n].playState=-1}},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"animationData",{get:function(){return this._animationData},enumerable:!0,configurable:!0}),n}(t.BaseObject);t.AnimationState=e;var i=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.current=new t.Transform,i.delta=new t.Transform,i.result=new t.Transform,i}return s(i,e),i.toString=function(){return"[class dragonBones.BonePose]"},i.prototype._onClear=function(){this.current.identity(),this.delta.identity(),this.result.identity()},i}(t.BaseObject);t.BonePose=i;var r=function(){function t(){}return t.prototype.update=function(t,e){if(this.dirty){if(!(this.leftWeight>0))return 0;if(this.layer!==e){if(this.layerWeight>=this.leftWeight)return this.leftWeight=0,0;this.layer=e,this.leftWeight-=this.layerWeight,this.layerWeight=0}return t*=this.leftWeight,this.layerWeight+=t,this.blendWeight=t,2}return this.dirty=!0,this.layer=e,this.layerWeight=t,this.leftWeight=1,this.blendWeight=t,1},t.prototype.clear=function(){this.dirty=!1,this.layer=0,this.leftWeight=0,this.layerWeight=0,this.blendWeight=0},t}();t.BlendState=r}(a||(a={})),function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype._onClear=function(){this.playState=-1,this.currentPlayTimes=-1,this.currentTime=-1,this._tweenState=0,this._frameRate=0,this._frameValueOffset=0,this._frameCount=0,this._frameOffset=0,this._frameIndex=-1,this._frameRateR=0,this._position=0,this._duration=0,this._timeScale=1,this._timeOffset=0,this._dragonBonesData=null,this._animationData=null,this._timelineData=null,this._armature=null,this._animationState=null,this._actionTimeline=null,this._frameArray=null,this._frameIntArray=null,this._frameFloatArray=null,this._timelineArray=null,this._frameIndices=null},e.prototype._setCurrentTime=function(t){var e=this.playState,i=this.currentPlayTimes,r=this.currentTime;if(null!==this._actionTimeline&&this._frameCount<=1)this.playState=this._actionTimeline.playState>=0?1:-1,this.currentPlayTimes=1,this.currentTime=this._actionTimeline.currentTime;else if(null===this._actionTimeline||1!==this._timeScale||0!==this._timeOffset){var n=this._animationState.playTimes,a=n*this._duration;t*=this._timeScale,0!==this._timeOffset&&(t+=this._timeOffset*this._animationData.duration),n>0&&(t>=a||t<=-a)?(this.playState<=0&&3===this._animationState._playheadState&&(this.playState=1),this.currentPlayTimes=n,this.currentTime=t<0?0:this._duration+1e-6):(0!==this.playState&&3===this._animationState._playheadState&&(this.playState=0),t<0?(t=-t,this.currentPlayTimes=Math.floor(t/this._duration),this.currentTime=this._duration-t%this._duration):(this.currentPlayTimes=Math.floor(t/this._duration),this.currentTime=t%this._duration)),this.currentTime+=this._position}else this.playState=this._actionTimeline.playState,this.currentPlayTimes=this._actionTimeline.currentPlayTimes,this.currentTime=this._actionTimeline.currentTime;return(this.currentPlayTimes!==i||this.currentTime!==r)&&((e<0&&this.playState!==e||this.playState<=0&&this.currentPlayTimes!==i)&&(this._frameIndex=-1),!0)},e.prototype.init=function(t,e,i){this._armature=t,this._animationState=e,this._timelineData=i,this._actionTimeline=this._animationState._actionTimeline,this===this._actionTimeline&&(this._actionTimeline=null),this._animationData=this._animationState._animationData,this._frameRate=this._animationData.parent.frameRate,this._frameRateR=1/this._frameRate,this._position=this._animationState._position,this._duration=this._animationState._duration,this._dragonBonesData=this._animationData.parent.parent,null!==this._timelineData&&(this._frameIntArray=this._dragonBonesData.frameIntArray,this._frameFloatArray=this._dragonBonesData.frameFloatArray,this._frameArray=this._dragonBonesData.frameArray,this._timelineArray=this._dragonBonesData.timelineArray,this._frameIndices=this._dragonBonesData.frameIndices,this._frameCount=this._timelineArray[this._timelineData.offset+2],this._frameValueOffset=this._timelineArray[this._timelineData.offset+4],this._timeScale=100/this._timelineArray[this._timelineData.offset+0],this._timeOffset=.01*this._timelineArray[this._timelineData.offset+1])},e.prototype.fadeOut=function(){},e.prototype.update=function(t){if(this._setCurrentTime(t)){if(this._frameCount>1){var e=Math.floor(this.currentTime*this._frameRate),i=this._frameIndices[this._timelineData.frameIndicesOffset+e];this._frameIndex!==i&&(this._frameIndex=i,this._frameOffset=this._animationData.frameOffset+this._timelineArray[this._timelineData.offset+5+this._frameIndex],this._onArriveAtFrame())}else this._frameIndex<0&&(this._frameIndex=0,null!==this._timelineData&&(this._frameOffset=this._animationData.frameOffset+this._timelineArray[this._timelineData.offset+5]),this._onArriveAtFrame());0!==this._tweenState&&this._onUpdateFrame()}},e}(t.BaseObject);t.TimelineState=e;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e._getEasingValue=function(t,e,i){var r=e;switch(t){case 3:r=Math.pow(e,2);break;case 4:r=1-Math.pow(1-e,2);break;case 5:r=.5*(1-Math.cos(e*Math.PI))}return(r-e)*i+e},e._getEasingCurveValue=function(t,e,i,r){if(t<=0)return 0;if(t>=1)return 1;var n=i+1,a=Math.floor(t*n),s=0===a?0:e[r+a-1];return 1e-4*(s+((a===n-1?1e4:e[r+a])-s)*(t*n-a))},e.prototype._onClear=function(){t.prototype._onClear.call(this),this._tweenType=0,this._curveCount=0,this._framePosition=0,this._frameDurationR=0,this._tweenProgress=0,this._tweenEasing=0},e.prototype._onArriveAtFrame=function(){if(this._frameCount>1&&(this._frameIndex!==this._frameCount-1||0===this._animationState.playTimes||this._animationState.currentPlayTimes<this._animationState.playTimes-1))if(this._tweenType=this._frameArray[this._frameOffset+1],this._tweenState=0===this._tweenType?1:2,2===this._tweenType?this._curveCount=this._frameArray[this._frameOffset+2]:0!==this._tweenType&&1!==this._tweenType&&(this._tweenEasing=.01*this._frameArray[this._frameOffset+2]),this._framePosition=this._frameArray[this._frameOffset]*this._frameRateR,this._frameIndex===this._frameCount-1)this._frameDurationR=1/(this._animationData.duration-this._framePosition);else{var t=this._animationData.frameOffset+this._timelineArray[this._timelineData.offset+5+this._frameIndex+1],e=this._frameArray[t]*this._frameRateR-this._framePosition;this._frameDurationR=e>0?1/e:0}else this._tweenState=1},e.prototype._onUpdateFrame=function(){2===this._tweenState?(this._tweenProgress=(this.currentTime-this._framePosition)*this._frameDurationR,2===this._tweenType?this._tweenProgress=e._getEasingCurveValue(this._tweenProgress,this._frameArray,this._curveCount,this._frameOffset+3):1!==this._tweenType&&(this._tweenProgress=e._getEasingValue(this._tweenType,this._tweenProgress,this._tweenEasing))):this._tweenProgress=0},e}(e);t.TweenTimelineState=i;var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype._onClear=function(){t.prototype._onClear.call(this),this.bone=null,this.bonePose=null},e.prototype.blend=function(t){var e=this.bone._blendState.blendWeight,i=this.bone.animationPose,r=this.bonePose.result;2===t?(i.x+=r.x*e,i.y+=r.y*e,i.rotation+=r.rotation*e,i.skew+=r.skew*e,i.scaleX+=(r.scaleX-1)*e,i.scaleY+=(r.scaleY-1)*e):1!==e?(i.x=r.x*e,i.y=r.y*e,i.rotation=r.rotation*e,i.skew=r.skew*e,i.scaleX=(r.scaleX-1)*e+1,i.scaleY=(r.scaleY-1)*e+1):(i.x=r.x,i.y=r.y,i.rotation=r.rotation,i.skew=r.skew,i.scaleX=r.scaleX,i.scaleY=r.scaleY),0===this._animationState._fadeState&&0===this._animationState._subFadeState||(this.bone._transformDirty=!0)},e}(i);t.BoneTimelineState=r;var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype._onClear=function(){t.prototype._onClear.call(this),this.slot=null},e}(i);t.SlotTimelineState=n;var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype._onClear=function(){t.prototype._onClear.call(this),this.constraint=null},e}(i);t.ConstraintTimelineState=a}(a||(a={})),function(t){var e=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return s(i,e),i.toString=function(){return"[class dragonBones.ActionTimelineState]"},i.prototype._onCrossFrame=function(e){var i=this._armature.eventDispatcher;if(this._animationState.actionEnabled)for(var r=this._animationData.frameOffset+this._timelineArray[this._timelineData.offset+5+e],n=this._frameArray[r+1],a=this._animationData.parent.actions,s=0;s<n;++s){var o=a[this._frameArray[r+2+s]];if(0===o.type)(h=t.BaseObject.borrowObject(t.EventObject)).time=this._frameArray[r]/this._frameRate,h.animationState=this._animationState,t.EventObject.actionDataToInstance(o,h,this._armature),this._armature._bufferAction(h,!0);else{var h,l=10===o.type?t.EventObject.FRAME_EVENT:t.EventObject.SOUND_EVENT;(11===o.type||i.hasDBEventListener(l))&&((h=t.BaseObject.borrowObject(t.EventObject)).time=this._frameArray[r]/this._frameRate,h.animationState=this._animationState,t.EventObject.actionDataToInstance(o,h,this._armature),this._armature._dragonBones.bufferEvent(h))}}},i.prototype._onArriveAtFrame=function(){},i.prototype._onUpdateFrame=function(){},i.prototype.update=function(e){var i=this.playState,r=this.currentPlayTimes,n=this.currentTime;if(this._setCurrentTime(e)){var a=this._armature.eventDispatcher;if(i<0){if(this.playState===i)return;if(this._animationState.displayControl&&this._animationState.resetToPose&&this._armature._sortZOrder(null,0),r=this.currentPlayTimes,a.hasDBEventListener(t.EventObject.START)){var s=t.BaseObject.borrowObject(t.EventObject);s.type=t.EventObject.START,s.armature=this._armature,s.animationState=this._animationState,this._armature._dragonBones.bufferEvent(s)}}var o=this._animationState.timeScale<0,h=null,l=null;if(this.currentPlayTimes!==r&&(a.hasDBEventListener(t.EventObject.LOOP_COMPLETE)&&((h=t.BaseObject.borrowObject(t.EventObject)).type=t.EventObject.LOOP_COMPLETE,h.armature=this._armature,h.animationState=this._animationState),this.playState>0&&a.hasDBEventListener(t.EventObject.COMPLETE)&&((l=t.BaseObject.borrowObject(t.EventObject)).type=t.EventObject.COMPLETE,l.armature=this._armature,l.animationState=this._animationState)),this._frameCount>1){var u=this._timelineData,c=Math.floor(this.currentTime*this._frameRate),p=this._frameIndices[u.frameIndicesOffset+c];if(this._frameIndex!==p){var f=this._frameIndex;if(this._frameIndex=p,null!==this._timelineArray)if(this._frameOffset=this._animationData.frameOffset+this._timelineArray[u.offset+5+this._frameIndex],o){if(f<0){var d=Math.floor(n*this._frameRate);f=this._frameIndices[u.frameIndicesOffset+d],this.currentPlayTimes===r&&f===p&&(f=-1)}for(;f>=0;){var m=this._animationData.frameOffset+this._timelineArray[u.offset+5+f],g=this._frameArray[m]/this._frameRate;if(this._position<=g&&g<=this._position+this._duration&&this._onCrossFrame(f),null!==h&&0===f&&(this._armature._dragonBones.bufferEvent(h),h=null),f>0?f--:f=this._frameCount-1,f===p)break}}else for(f<0&&(d=Math.floor(n*this._frameRate),f=this._frameIndices[u.frameIndicesOffset+d],m=this._animationData.frameOffset+this._timelineArray[u.offset+5+f],g=this._frameArray[m]/this._frameRate,this.currentPlayTimes===r&&(n<=g?f>0?f--:f=this._frameCount-1:f===p&&(f=-1)));f>=0&&(f<this._frameCount-1?f++:f=0,m=this._animationData.frameOffset+this._timelineArray[u.offset+5+f],g=this._frameArray[m]/this._frameRate,this._position<=g&&g<=this._position+this._duration&&this._onCrossFrame(f),null!==h&&0===f&&(this._armature._dragonBones.bufferEvent(h),h=null),f!==p););}}else this._frameIndex<0&&(this._frameIndex=0,null!==this._timelineData)&&(this._frameOffset=this._animationData.frameOffset+this._timelineArray[this._timelineData.offset+5],g=this._frameArray[this._frameOffset]/this._frameRate,this.currentPlayTimes===r?n<=g&&this._onCrossFrame(this._frameIndex):this._position<=g&&(o||null===h||(this._armature._dragonBones.bufferEvent(h),h=null),this._onCrossFrame(this._frameIndex)));null!==h&&this._armature._dragonBones.bufferEvent(h),null!==l&&this._armature._dragonBones.bufferEvent(l)}},i.prototype.setCurrentTime=function(t){this._setCurrentTime(t),this._frameIndex=-1},i}(t.TimelineState);t.ActionTimelineState=e;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.toString=function(){return"[class dragonBones.ZOrderTimelineState]"},e.prototype._onArriveAtFrame=function(){this.playState>=0&&(this._frameArray[this._frameOffset+1]>0?this._armature._sortZOrder(this._frameArray,this._frameOffset+2):this._armature._sortZOrder(null,0))},e.prototype._onUpdateFrame=function(){},e}(t.TimelineState);t.ZOrderTimelineState=i;var r=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return s(i,e),i.toString=function(){return"[class dragonBones.BoneAllTimelineState]"},i.prototype._onArriveAtFrame=function(){if(e.prototype._onArriveAtFrame.call(this),null!==this._timelineData){var t=this._animationData.frameFloatOffset+this._frameValueOffset+6*this._frameIndex,i=this._armature._armatureData.scale,r=this._frameFloatArray,n=this.bonePose.current,a=this.bonePose.delta;n.x=r[t++]*i,n.y=r[t++]*i,n.rotation=r[t++],n.skew=r[t++],n.scaleX=r[t++],n.scaleY=r[t++],2===this._tweenState?(this._frameIndex===this._frameCount-1&&(t=this._animationData.frameFloatOffset+this._frameValueOffset),a.x=r[t++]*i-n.x,a.y=r[t++]*i-n.y,a.rotation=r[t++]-n.rotation,a.skew=r[t++]-n.skew,a.scaleX=r[t++]-n.scaleX,a.scaleY=r[t++]-n.scaleY):(a.x=0,a.y=0,a.rotation=0,a.skew=0,a.scaleX=0,a.scaleY=0)}else n=this.bonePose.current,a=this.bonePose.delta,n.x=0,n.y=0,n.rotation=0,n.skew=0,n.scaleX=1,n.scaleY=1,a.x=0,a.y=0,a.rotation=0,a.skew=0,a.scaleX=0,a.scaleY=0},i.prototype._onUpdateFrame=function(){e.prototype._onUpdateFrame.call(this);var t=this.bonePose.current,i=this.bonePose.delta,r=this.bonePose.result;this.bone._transformDirty=!0,2!==this._tweenState&&(this._tweenState=0),r.x=t.x+i.x*this._tweenProgress,r.y=t.y+i.y*this._tweenProgress,r.rotation=t.rotation+i.rotation*this._tweenProgress,r.skew=t.skew+i.skew*this._tweenProgress,r.scaleX=t.scaleX+i.scaleX*this._tweenProgress,r.scaleY=t.scaleY+i.scaleY*this._tweenProgress},i.prototype.fadeOut=function(){var e=this.bonePose.result;e.rotation=t.Transform.normalizeRadian(e.rotation),e.skew=t.Transform.normalizeRadian(e.skew)},i}(t.BoneTimelineState);t.BoneAllTimelineState=r;var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.toString=function(){return"[class dragonBones.BoneTranslateTimelineState]"},e.prototype._onArriveAtFrame=function(){if(t.prototype._onArriveAtFrame.call(this),null!==this._timelineData){var e=this._animationData.frameFloatOffset+this._frameValueOffset+2*this._frameIndex,i=this._armature._armatureData.scale,r=this._frameFloatArray,n=this.bonePose.current,a=this.bonePose.delta;n.x=r[e++]*i,n.y=r[e++]*i,2===this._tweenState?(this._frameIndex===this._frameCount-1&&(e=this._animationData.frameFloatOffset+this._frameValueOffset),a.x=r[e++]*i-n.x,a.y=r[e++]*i-n.y):(a.x=0,a.y=0)}else n=this.bonePose.current,a=this.bonePose.delta,n.x=0,n.y=0,a.x=0,a.y=0},e.prototype._onUpdateFrame=function(){t.prototype._onUpdateFrame.call(this);var e=this.bonePose.current,i=this.bonePose.delta,r=this.bonePose.result;this.bone._transformDirty=!0,2!==this._tweenState&&(this._tweenState=0),r.x=e.x+i.x*this._tweenProgress,r.y=e.y+i.y*this._tweenProgress},e}(t.BoneTimelineState);t.BoneTranslateTimelineState=n;var a=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return s(i,e),i.toString=function(){return"[class dragonBones.BoneRotateTimelineState]"},i.prototype._onArriveAtFrame=function(){if(e.prototype._onArriveAtFrame.call(this),null!==this._timelineData){var i=this._animationData.frameFloatOffset+this._frameValueOffset+2*this._frameIndex,r=this._frameFloatArray,n=this.bonePose.current,a=this.bonePose.delta;n.rotation=r[i++],n.skew=r[i++],2===this._tweenState?(this._frameIndex===this._frameCount-1?(i=this._animationData.frameFloatOffset+this._frameValueOffset,a.rotation=t.Transform.normalizeRadian(r[i++]-n.rotation)):a.rotation=r[i++]-n.rotation,a.skew=r[i++]-n.skew):(a.rotation=0,a.skew=0)}else n=this.bonePose.current,a=this.bonePose.delta,n.rotation=0,n.skew=0,a.rotation=0,a.skew=0},i.prototype._onUpdateFrame=function(){e.prototype._onUpdateFrame.call(this);var t=this.bonePose.current,i=this.bonePose.delta,r=this.bonePose.result;this.bone._transformDirty=!0,2!==this._tweenState&&(this._tweenState=0),r.rotation=t.rotation+i.rotation*this._tweenProgress,r.skew=t.skew+i.skew*this._tweenProgress},i.prototype.fadeOut=function(){var e=this.bonePose.result;e.rotation=t.Transform.normalizeRadian(e.rotation),e.skew=t.Transform.normalizeRadian(e.skew)},i}(t.BoneTimelineState);t.BoneRotateTimelineState=a;var o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.toString=function(){return"[class dragonBones.BoneScaleTimelineState]"},e.prototype._onArriveAtFrame=function(){if(t.prototype._onArriveAtFrame.call(this),null!==this._timelineData){var e=this._animationData.frameFloatOffset+this._frameValueOffset+2*this._frameIndex,i=this._frameFloatArray,r=this.bonePose.current,n=this.bonePose.delta;r.scaleX=i[e++],r.scaleY=i[e++],2===this._tweenState?(this._frameIndex===this._frameCount-1&&(e=this._animationData.frameFloatOffset+this._frameValueOffset),n.scaleX=i[e++]-r.scaleX,n.scaleY=i[e++]-r.scaleY):(n.scaleX=0,n.scaleY=0)}else r=this.bonePose.current,n=this.bonePose.delta,r.scaleX=1,r.scaleY=1,n.scaleX=0,n.scaleY=0},e.prototype._onUpdateFrame=function(){t.prototype._onUpdateFrame.call(this);var e=this.bonePose.current,i=this.bonePose.delta,r=this.bonePose.result;this.bone._transformDirty=!0,2!==this._tweenState&&(this._tweenState=0),r.scaleX=e.scaleX+i.scaleX*this._tweenProgress,r.scaleY=e.scaleY+i.scaleY*this._tweenProgress},e}(t.BoneTimelineState);t.BoneScaleTimelineState=o;var h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._current=[],e._delta=[],e._result=[],e}return s(e,t),e.toString=function(){return"[class dragonBones.SurfaceTimelineState]"},e.prototype._onClear=function(){t.prototype._onClear.call(this),this.surface=null,this._frameFloatOffset=0,this._valueCount=0,this._deformCount=0,this._valueOffset=0,this._current.length=0,this._delta.length=0,this._result.length=0},e.prototype._onArriveAtFrame=function(){if(t.prototype._onArriveAtFrame.call(this),null!==this._timelineData){var e=this._animationData.frameFloatOffset+this._frameValueOffset+this._frameIndex*this._valueCount,i=this._armature._armatureData.scale,r=this._frameFloatArray;if(2===this._tweenState){var n=e+this._valueCount;this._frameIndex===this._frameCount-1&&(n=this._animationData.frameFloatOffset+this._frameValueOffset);for(var a=0;a<this._valueCount;++a)this._delta[a]=r[n+a]*i-(this._current[a]=r[e+a]*i)}else for(a=0;a<this._valueCount;++a)this._current[a]=r[e+a]*i}else for(a=0;a<this._valueCount;++a)this._current[a]=0},e.prototype._onUpdateFrame=function(){t.prototype._onUpdateFrame.call(this),this.surface._transformDirty=!0,2!==this._tweenState&&(this._tweenState=0);for(var e=0;e<this._valueCount;++e)this._result[e]=this._current[e]+this._delta[e]*this._tweenProgress},e.prototype.init=function(e,i,r){if(t.prototype.init.call(this,e,i,r),null!==this._timelineData){var n=this._animationData.frameIntOffset+this._timelineArray[this._timelineData.offset+3];this._deformCount=this._frameIntArray[n+1],this._valueCount=this._frameIntArray[n+2],this._valueOffset=this._frameIntArray[n+3],this._frameFloatOffset=this._frameIntArray[n+4]+this._animationData.frameFloatOffset}else this._deformCount=this.surface._deformVertices.length,this._valueCount=this._deformCount,this._valueOffset=0,this._frameFloatOffset=0;this._current.length=this._valueCount,this._delta.length=this._valueCount,this._result.length=this._valueCount;for(var a=0;a<this._valueCount;++a)this._delta[a]=0},e.prototype.blend=function(t){for(var e=this.surface._blendState.blendWeight,i=this.surface._deformVertices,r=0;r<this._deformCount;++r){var n;n=r<this._valueOffset?this._frameFloatArray[this._frameFloatOffset+r]:r<this._valueOffset+this._valueCount?this._result[r-this._valueOffset]:this._frameFloatArray[this._frameFloatOffset+r-this._valueCount],2===t?i[r]+=n*e:i[r]=1!==e?n*e:n}0===this._animationState._fadeState&&0===this._animationState._subFadeState||(this.surface._transformDirty=!0)},e}(t.TweenTimelineState);t.SurfaceTimelineState=h;var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.toString=function(){return"[class dragonBones.SlotDislayTimelineState]"},e.prototype._onArriveAtFrame=function(){if(this.playState>=0){var t=null!==this._timelineData?this._frameArray[this._frameOffset+1]:this.slot._slotData.displayIndex;this.slot.displayIndex!==t&&this.slot._setDisplayIndex(t,!0)}},e}(t.SlotTimelineState);t.SlotDislayTimelineState=l;var u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._current=[0,0,0,0,0,0,0,0],e._delta=[0,0,0,0,0,0,0,0],e._result=[0,0,0,0,0,0,0,0],e}return s(e,t),e.toString=function(){return"[class dragonBones.SlotColorTimelineState]"},e.prototype._onClear=function(){t.prototype._onClear.call(this),this._dirty=!1},e.prototype._onArriveAtFrame=function(){if(t.prototype._onArriveAtFrame.call(this),null!==this._timelineData){var e=this._dragonBonesData.intArray,i=this._frameIntArray,r=this._animationData.frameIntOffset+this._frameValueOffset+1*this._frameIndex,n=i[r];n<0&&(n+=65536),this._current[0]=e[n++],this._current[1]=e[n++],this._current[2]=e[n++],this._current[3]=e[n++],this._current[4]=e[n++],this._current[5]=e[n++],this._current[6]=e[n++],this._current[7]=e[n++],2===this._tweenState&&((n=this._frameIndex===this._frameCount-1?i[this._animationData.frameIntOffset+this._frameValueOffset]:i[r+1])<0&&(n+=65536),this._delta[0]=e[n++]-this._current[0],this._delta[1]=e[n++]-this._current[1],this._delta[2]=e[n++]-this._current[2],this._delta[3]=e[n++]-this._current[3],this._delta[4]=e[n++]-this._current[4],this._delta[5]=e[n++]-this._current[5],this._delta[6]=e[n++]-this._current[6],this._delta[7]=e[n++]-this._current[7])}else{var a=this.slot._slotData.color;this._current[0]=100*a.alphaMultiplier,this._current[1]=100*a.redMultiplier,this._current[2]=100*a.greenMultiplier,this._current[3]=100*a.blueMultiplier,this._current[4]=a.alphaOffset,this._current[5]=a.redOffset,this._current[6]=a.greenOffset,this._current[7]=a.blueOffset}},e.prototype._onUpdateFrame=function(){t.prototype._onUpdateFrame.call(this),this._dirty=!0,2!==this._tweenState&&(this._tweenState=0),this._result[0]=.01*(this._current[0]+this._delta[0]*this._tweenProgress),this._result[1]=.01*(this._current[1]+this._delta[1]*this._tweenProgress),this._result[2]=.01*(this._current[2]+this._delta[2]*this._tweenProgress),this._result[3]=.01*(this._current[3]+this._delta[3]*this._tweenProgress),this._result[4]=this._current[4]+this._delta[4]*this._tweenProgress,this._result[5]=this._current[5]+this._delta[5]*this._tweenProgress,this._result[6]=this._current[6]+this._delta[6]*this._tweenProgress,this._result[7]=this._current[7]+this._delta[7]*this._tweenProgress},e.prototype.fadeOut=function(){this._tweenState=0,this._dirty=!1},e.prototype.update=function(e){if(t.prototype.update.call(this,e),0!==this._tweenState||this._dirty){var i=this.slot._colorTransform;if(0!==this._animationState._fadeState||0!==this._animationState._subFadeState){if(i.alphaMultiplier!==this._result[0]||i.redMultiplier!==this._result[1]||i.greenMultiplier!==this._result[2]||i.blueMultiplier!==this._result[3]||i.alphaOffset!==this._result[4]||i.redOffset!==this._result[5]||i.greenOffset!==this._result[6]||i.blueOffset!==this._result[7]){var r=Math.pow(this._animationState._fadeProgress,4);i.alphaMultiplier+=(this._result[0]-i.alphaMultiplier)*r,i.redMultiplier+=(this._result[1]-i.redMultiplier)*r,i.greenMultiplier+=(this._result[2]-i.greenMultiplier)*r,i.blueMultiplier+=(this._result[3]-i.blueMultiplier)*r,i.alphaOffset+=(this._result[4]-i.alphaOffset)*r,i.redOffset+=(this._result[5]-i.redOffset)*r,i.greenOffset+=(this._result[6]-i.greenOffset)*r,i.blueOffset+=(this._result[7]-i.blueOffset)*r,this.slot._colorDirty=!0}}else this._dirty&&(this._dirty=!1,i.alphaMultiplier===this._result[0]&&i.redMultiplier===this._result[1]&&i.greenMultiplier===this._result[2]&&i.blueMultiplier===this._result[3]&&i.alphaOffset===this._result[4]&&i.redOffset===this._result[5]&&i.greenOffset===this._result[6]&&i.blueOffset===this._result[7]||(i.alphaMultiplier=this._result[0],i.redMultiplier=this._result[1],i.greenMultiplier=this._result[2],i.blueMultiplier=this._result[3],i.alphaOffset=this._result[4],i.redOffset=this._result[5],i.greenOffset=this._result[6],i.blueOffset=this._result[7],this.slot._colorDirty=!0))}},e}(t.SlotTimelineState);t.SlotColorTimelineState=u;var c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._current=[],e._delta=[],e._result=[],e}return s(e,t),e.toString=function(){return"[class dragonBones.DeformTimelineState]"},e.prototype._onClear=function(){t.prototype._onClear.call(this),this.vertexOffset=0,this._dirty=!1,this._frameFloatOffset=0,this._valueCount=0,this._deformCount=0,this._valueOffset=0,this._current.length=0,this._delta.length=0,this._result.length=0},e.prototype._onArriveAtFrame=function(){if(t.prototype._onArriveAtFrame.call(this),null!==this._timelineData){var e=this._animationData.frameFloatOffset+this._frameValueOffset+this._frameIndex*this._valueCount,i=this._armature._armatureData.scale,r=this._frameFloatArray;if(2===this._tweenState){var n=e+this._valueCount;this._frameIndex===this._frameCount-1&&(n=this._animationData.frameFloatOffset+this._frameValueOffset);for(var a=0;a<this._valueCount;++a)this._delta[a]=r[n+a]*i-(this._current[a]=r[e+a]*i)}else for(a=0;a<this._valueCount;++a)this._current[a]=r[e+a]*i}else for(a=0;a<this._valueCount;++a)this._current[a]=0},e.prototype._onUpdateFrame=function(){t.prototype._onUpdateFrame.call(this),this._dirty=!0,2!==this._tweenState&&(this._tweenState=0);for(var e=0;e<this._valueCount;++e)this._result[e]=this._current[e]+this._delta[e]*this._tweenProgress},e.prototype.init=function(e,i,r){if(t.prototype.init.call(this,e,i,r),null!==this._timelineData){var n=this._animationData.frameIntOffset+this._timelineArray[this._timelineData.offset+3];this.vertexOffset=this._frameIntArray[n+0],this.vertexOffset<0&&(this.vertexOffset+=65536),this._deformCount=this._frameIntArray[n+1],this._valueCount=this._frameIntArray[n+2],this._valueOffset=this._frameIntArray[n+3],this._frameFloatOffset=this._frameIntArray[n+4]+this._animationData.frameFloatOffset}else{var a=this.slot._deformVertices;this._deformCount=null!==a?a.vertices.length:0,this._valueCount=this._deformCount,this._valueOffset=0,this._frameFloatOffset=0}this._current.length=this._valueCount,this._delta.length=this._valueCount,this._result.length=this._valueCount;for(var s=0;s<this._valueCount;++s)this._delta[s]=0},e.prototype.fadeOut=function(){this._tweenState=0,this._dirty=!1},e.prototype.update=function(e){var i=this.slot._deformVertices;if(null!==i&&null!==i.verticesData&&i.verticesData.offset===this.vertexOffset&&(t.prototype.update.call(this,e),0!==this._tweenState||this._dirty)){var r=i.vertices;if(0!==this._animationState._fadeState||0!==this._animationState._subFadeState){for(var n=Math.pow(this._animationState._fadeProgress,2),a=0;a<this._deformCount;++a)a<this._valueOffset?r[a]+=(this._frameFloatArray[this._frameFloatOffset+a]-r[a])*n:a<this._valueOffset+this._valueCount?r[a]+=(this._result[a-this._valueOffset]-r[a])*n:r[a]+=(this._frameFloatArray[this._frameFloatOffset+a-this._valueCount]-r[a])*n;i.verticesDirty=!0}else if(this._dirty){for(this._dirty=!1,a=0;a<this._deformCount;++a)a<this._valueOffset?r[a]=this._frameFloatArray[this._frameFloatOffset+a]:a<this._valueOffset+this._valueCount?r[a]=this._result[a-this._valueOffset]:r[a]=this._frameFloatArray[this._frameFloatOffset+a-this._valueCount];i.verticesDirty=!0}}},e}(t.SlotTimelineState);t.DeformTimelineState=c;var p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.toString=function(){return"[class dragonBones.IKConstraintTimelineState]"},e.prototype._onClear=function(){t.prototype._onClear.call(this),this._current=0,this._delta=0},e.prototype._onArriveAtFrame=function(){t.prototype._onArriveAtFrame.call(this);var e=this.constraint;if(null!==this._timelineData){var i=this._animationData.frameIntOffset+this._frameValueOffset+2*this._frameIndex,r=this._frameIntArray,n=0!==r[i++];this._current=.01*r[i++],2===this._tweenState?(this._frameIndex===this._frameCount-1&&(i=this._animationData.frameIntOffset+this._frameValueOffset),this._delta=.01*r[i+1]-this._current):this._delta=0,e._bendPositive=n}else{var a=e._constraintData;this._current=a.weight,this._delta=0,e._bendPositive=a.bendPositive}e.invalidUpdate()},e.prototype._onUpdateFrame=function(){t.prototype._onUpdateFrame.call(this),2!==this._tweenState&&(this._tweenState=0);var e=this.constraint;e._weight=this._current+this._delta*this._tweenProgress,e.invalidUpdate()},e}(t.ConstraintTimelineState);t.IKConstraintTimelineState=p;var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._floats=[0,0,0,0,0,0],e}return s(e,t),e.toString=function(){return"[class dragonBones.AnimationTimelineState]"},e.prototype._onClear=function(){t.prototype._onClear.call(this),this.animationState=null},e.prototype._onArriveAtFrame=function(){if(t.prototype._onArriveAtFrame.call(this),null!==this._timelineData){var e=this._animationData.frameIntOffset+this._frameValueOffset+2*this._frameIndex,i=1/this.animationState._animationData.parent.frameRate,r=this._frameIntArray;this._floats[0]=r[e++]*i,this._floats[3]=.01*r[e++],2===this._tweenState?(this._frameIndex===this._frameCount-1&&(e=this._animationData.frameIntOffset+this._frameValueOffset),this._floats[1]=r[e++]*i-this._floats[0],this._floats[4]=.01*r[e++]-this._floats[3]):(this._floats[1]=0,this._floats[4]=0)}},e.prototype._onUpdateFrame=function(){t.prototype._onUpdateFrame.call(this),2!==this._tweenState&&(this._tweenState=0),this._floats[0]>=0&&(this._floats[2]=this._floats[0]+this._floats[1]*this._tweenProgress),this._floats[5]=this._floats[3]+this._floats[4]*this._tweenProgress},e.prototype.blend=function(t){var e=this.animationState,i=e._blendState.blendWeight;2===t?(e.weight+=this._floats[5]*i,e.currentTime+=this._floats[2]*i):(e.weight=this._floats[5]*i,e.currentTime=this._floats[2]*i)},e}(t.TweenTimelineState);t.AnimationTimelineState=f}(a||(a={})),function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.actionDataToInstance=function(t,i,r){0===t.type?i.type=e.FRAME_EVENT:i.type=10===t.type?e.FRAME_EVENT:e.SOUND_EVENT,i.name=t.name,i.armature=r,i.actionData=t,i.data=t.data,null!==t.bone&&(i.bone=r.getBone(t.bone.name)),null!==t.slot&&(i.slot=r.getSlot(t.slot.name))},e.toString=function(){return"[class dragonBones.EventObject]"},e.prototype._onClear=function(){this.time=0,this.type="",this.name="",this.armature=null,this.bone=null,this.slot=null,this.animationState=null,this.actionData=null,this.data=null},e.START="start",e.LOOP_COMPLETE="loopComplete",e.COMPLETE="complete",e.FADE_IN="fadeIn",e.FADE_IN_COMPLETE="fadeInComplete",e.FADE_OUT="fadeOut",e.FADE_OUT_COMPLETE="fadeOutComplete",e.FRAME_EVENT="frameEvent",e.SOUND_EVENT="soundEvent",e}(t.BaseObject);t.EventObject=e}(a||(a={})),function(t){var e=function(){function e(){}return e._getArmatureType=function(t){switch(t.toLowerCase()){case"stage":return 2;case"armature":return 0;case"movieclip":return 1;default:return 0}},e._getBoneType=function(t){switch(t.toLowerCase()){case"bone":return 0;case"surface":return 1;default:return 0}},e._getDisplayType=function(t){switch(t.toLowerCase()){case"image":return 0;case"mesh":return 2;case"armature":return 1;case"boundingbox":return 3;case"path":return 4;default:return 0}},e._getBoundingBoxType=function(t){switch(t.toLowerCase()){case"rectangle":return 0;case"ellipse":return 1;case"polygon":return 2;default:return 0}},e._getActionType=function(t){switch(t.toLowerCase()){case"play":return 0;case"frame":return 10;case"sound":return 11;default:return 0}},e._getBlendMode=function(t){switch(t.toLowerCase()){case"normal":return 0;case"add":return 1;case"alpha":return 2;case"darken":return 3;case"difference":return 4;case"erase":return 5;case"hardlight":return 6;case"invert":return 7;case"layer":return 8;case"lighten":return 9;case"multiply":return 10;case"overlay":return 11;case"screen":return 12;case"subtract":return 13;default:return 0}},e._getPositionMode=function(t){switch(t.toLocaleLowerCase()){case"percent":return 1;case"fixed":return 0;default:return 1}},e._getSpacingMode=function(t){switch(t.toLocaleLowerCase()){case"length":return 0;case"percent":return 2;case"fixed":return 1;default:return 0}},e._getRotateMode=function(t){switch(t.toLocaleLowerCase()){case"tangent":return 0;case"chain":return 1;case"chainscale":return 2;default:return 0}},e.parseDragonBonesData=function(e){return console.warn("Deprecated."),e instanceof ArrayBuffer?t.BinaryDataParser.getInstance().parseDragonBonesData(e):t.ObjectDataParser.getInstance().parseDragonBonesData(e)},e.parseTextureAtlasData=function(i,r){void 0===r&&(r=1),console.warn("已废弃");for(var n={},a=i[e.SUB_TEXTURE],s=0,o=a.length;s<o;s++){var h=a[s],l=h[e.NAME],u=new t.Rectangle,c=null;u.x=h[e.X]/r,u.y=h[e.Y]/r,u.width=h[e.WIDTH]/r,u.height=h[e.HEIGHT]/r,e.FRAME_WIDTH in h&&((c=new t.Rectangle).x=h[e.FRAME_X]/r,c.y=h[e.FRAME_Y]/r,c.width=h[e.FRAME_WIDTH]/r,c.height=h[e.FRAME_HEIGHT]/r),n[l]={region:u,frame:c,rotated:!1}}return n},e.DATA_VERSION_2_3="2.3",e.DATA_VERSION_3_0="3.0",e.DATA_VERSION_4_0="4.0",e.DATA_VERSION_4_5="4.5",e.DATA_VERSION_5_0="5.0",e.DATA_VERSION_5_5="5.5",e.DATA_VERSION=e.DATA_VERSION_5_5,e.DATA_VERSIONS=[e.DATA_VERSION_4_0,e.DATA_VERSION_4_5,e.DATA_VERSION_5_0,e.DATA_VERSION_5_5],e.TEXTURE_ATLAS="textureAtlas",e.SUB_TEXTURE="SubTexture",e.FORMAT="format",e.IMAGE_PATH="imagePath",e.WIDTH="width",e.HEIGHT="height",e.ROTATED="rotated",e.FRAME_X="frameX",e.FRAME_Y="frameY",e.FRAME_WIDTH="frameWidth",e.FRAME_HEIGHT="frameHeight",e.DRADON_BONES="dragonBones",e.USER_DATA="userData",e.ARMATURE="armature",e.BONE="bone",e.SURFACE="surface",e.SLOT="slot",e.CONSTRAINT="constraint",e.IK="ik",e.PATH_CONSTRAINT="path",e.SKIN="skin",e.DISPLAY="display",e.ANIMATION="animation",e.Z_ORDER="zOrder",e.FFD="ffd",e.FRAME="frame",e.TRANSLATE_FRAME="translateFrame",e.ROTATE_FRAME="rotateFrame",e.SCALE_FRAME="scaleFrame",e.DISPLAY_FRAME="displayFrame",e.COLOR_FRAME="colorFrame",e.DEFAULT_ACTIONS="defaultActions",e.ACTIONS="actions",e.EVENTS="events",e.INTS="ints",e.FLOATS="floats",e.STRINGS="strings",e.CANVAS="canvas",e.TRANSFORM="transform",e.PIVOT="pivot",e.AABB="aabb",e.COLOR="color",e.VERSION="version",e.COMPATIBLE_VERSION="compatibleVersion",e.FRAME_RATE="frameRate",e.TYPE="type",e.SUB_TYPE="subType",e.NAME="name",e.PARENT="parent",e.TARGET="target",e.STAGE="stage",e.SHARE="share",e.PATH="path",e.LENGTH="length",e.DISPLAY_INDEX="displayIndex",e.BLEND_MODE="blendMode",e.INHERIT_TRANSLATION="inheritTranslation",e.INHERIT_ROTATION="inheritRotation",e.INHERIT_SCALE="inheritScale",e.INHERIT_REFLECTION="inheritReflection",e.INHERIT_ANIMATION="inheritAnimation",e.INHERIT_DEFORM="inheritDeform",e.SEGMENT_X="segmentX",e.SEGMENT_Y="segmentY",e.BEND_POSITIVE="bendPositive",e.CHAIN="chain",e.WEIGHT="weight",e.FADE_IN_TIME="fadeInTime",e.PLAY_TIMES="playTimes",e.SCALE="scale",e.OFFSET="offset",e.POSITION="position",e.DURATION="duration",e.TWEEN_EASING="tweenEasing",e.TWEEN_ROTATE="tweenRotate",e.TWEEN_SCALE="tweenScale",e.CLOCK_WISE="clockwise",e.CURVE="curve",e.SOUND="sound",e.EVENT="event",e.ACTION="action",e.X="x",e.Y="y",e.SKEW_X="skX",e.SKEW_Y="skY",e.SCALE_X="scX",e.SCALE_Y="scY",e.VALUE="value",e.ROTATE="rotate",e.SKEW="skew",e.ALPHA_OFFSET="aO",e.RED_OFFSET="rO",e.GREEN_OFFSET="gO",e.BLUE_OFFSET="bO",e.ALPHA_MULTIPLIER="aM",e.RED_MULTIPLIER="rM",e.GREEN_MULTIPLIER="gM",e.BLUE_MULTIPLIER="bM",e.UVS="uvs",e.VERTICES="vertices",e.TRIANGLES="triangles",e.WEIGHTS="weights",e.SLOT_POSE="slotPose",e.BONE_POSE="bonePose",e.GLUE_WEIGHTS="glueWeights",e.GLUE_MESHES="glueMeshes",e.BONES="bones",e.POSITION_MODE="positionMode",e.SPACING_MODE="spacingMode",e.ROTATE_MODE="rotateMode",e.SPACING="spacing",e.ROTATE_OFFSET="rotateOffset",e.ROTATE_MIX="rotateMix",e.TRANSLATE_MIX="translateMix",e.TARGET_DISPLAY="targetDisplay",e.CLOSED="closed",e.CONSTANT_SPEED="constantSpeed",e.VERTEX_COUNT="vertexCount",e.LENGTHS="lengths",e.GOTO_AND_PLAY="gotoAndPlay",e.DEFAULT_NAME="default",e}();t.DataParser=e}(a||(a={})),function(t){var e=function(e){function r(){var i=null!==e&&e.apply(this,arguments)||this;return i._rawTextureAtlasIndex=0,i._rawBones=[],i._data=null,i._armature=null,i._bone=null,i._surface=null,i._slot=null,i._skin=null,i._mesh=null,i._animation=null,i._timeline=null,i._rawTextureAtlases=null,i._defaultColorOffset=-1,i._prevClockwise=0,i._prevRotation=0,i._helpMatrixA=new t.Matrix,i._helpMatrixB=new t.Matrix,i._helpTransform=new t.Transform,i._helpColorTransform=new t.ColorTransform,i._helpPoint=new t.Point,i._helpArray=[],i._intArray=[],i._floatArray=[],i._frameIntArray=[],i._frameFloatArray=[],i._frameArray=[],i._timelineArray=[],i._cacheRawMeshes=[],i._cacheMeshes=[],i._actionFrames=[],i._weightSlotPose={},i._weightBonePoses={},i._cacheBones={},i._slotChildActions={},i}return s(r,e),r._getBoolean=function(t,e,i){if(e in t){var r=t[e],n=typeof r;if("boolean"===n)return r;if("string"!==n)return!!r;switch(r){case"0":case"NaN":case"":case"false":case"null":case"undefined":return!1;default:return!0}}return i},r._getNumber=function(t,e,i){if(e in t){var r=t[e];return null===r||"NaN"===r?i:+r||0}return i},r._getString=function(e,i,r){if(i in e){var n=e[i];if("string"==typeof n){if(t.DragonBones.webAssembly)for(var a=0,s=n.length;a<s;++a)if(n.charCodeAt(a)>255)return encodeURI(n);return n}return String(n)}return r},r.prototype._getCurvePoint=function(t,e,i,r,n,a,s,o,h,l){var u=1-h,c=u*u,p=h*h,f=u*c,d=3*h*c,m=3*u*p,g=h*p;l.x=f*t+d*i+m*n+g*s,l.y=f*e+d*r+m*a+g*o},r.prototype._samplingEasingCurve=function(t,e){for(var i=t.length,r=-2,n=0,a=e.length;n<a;++n){for(var s=(n+1)/(a+1);(r+6<i?t[r+6]:1)<s;)r+=6;for(var o=r>=0&&r+6<i,h=o?t[r]:0,l=o?t[r+1]:0,u=t[r+2],c=t[r+3],p=t[r+4],f=t[r+5],d=o?t[r+6]:1,m=o?t[r+7]:1,g=0,y=1;y-g>1e-4;){var _=.5*(y+g);this._getCurvePoint(h,l,u,c,p,f,d,m,_,this._helpPoint),s-this._helpPoint.x>0?g=_:y=_}e[n]=this._helpPoint.y}},r.prototype._parseActionDataInFrame=function(e,i,r,n){t.DataParser.EVENT in e&&this._mergeActionFrame(e[t.DataParser.EVENT],i,10,r,n),t.DataParser.SOUND in e&&this._mergeActionFrame(e[t.DataParser.SOUND],i,11,r,n),t.DataParser.ACTION in e&&this._mergeActionFrame(e[t.DataParser.ACTION],i,0,r,n),t.DataParser.EVENTS in e&&this._mergeActionFrame(e[t.DataParser.EVENTS],i,10,r,n),t.DataParser.ACTIONS in e&&this._mergeActionFrame(e[t.DataParser.ACTIONS],i,0,r,n)},r.prototype._mergeActionFrame=function(e,r,n,a,s){for(var o=t.DragonBones.webAssembly?this._armature.actions.size():this._armature.actions.length,h=this._parseActionData(e,n,a,s),l=0,u=null,c=0,p=h;c<p.length;c++){var f=p[c];this._armature.addAction(f,!1)}0===this._actionFrames.length&&((u=new i).frameStart=0,this._actionFrames.push(u),u=null);for(var d=0,m=this._actionFrames;d<m.length;d++){var g=m[d];if(g.frameStart===r){u=g;break}if(g.frameStart>r)break;l++}null===u&&((u=new i).frameStart=r,this._actionFrames.splice(l+1,0,u));for(var y=0;y<h.length;++y)u.actions.push(o+y)},r.prototype._parseArmature=function(e,i){var n=t.BaseObject.borrowObject(t.ArmatureData);if(n.name=r._getString(e,t.DataParser.NAME,""),n.frameRate=r._getNumber(e,t.DataParser.FRAME_RATE,this._data.frameRate),n.scale=i,t.DataParser.TYPE in e&&"string"==typeof e[t.DataParser.TYPE]?n.type=t.DataParser._getArmatureType(e[t.DataParser.TYPE]):n.type=r._getNumber(e,t.DataParser.TYPE,0),0===n.frameRate&&(n.frameRate=24),this._armature=n,t.DataParser.CANVAS in e){var a=e[t.DataParser.CANVAS],s=t.BaseObject.borrowObject(t.CanvasData);t.DataParser.COLOR in a?s.hasBackground=!0:s.hasBackground=!1,s.color=r._getNumber(a,t.DataParser.COLOR,0),s.x=r._getNumber(a,t.DataParser.X,0)*n.scale,s.y=r._getNumber(a,t.DataParser.Y,0)*n.scale,s.width=r._getNumber(a,t.DataParser.WIDTH,0)*n.scale,s.height=r._getNumber(a,t.DataParser.HEIGHT,0)*n.scale,n.canvas=s}if(t.DataParser.AABB in e){var o=e[t.DataParser.AABB];n.aabb.x=r._getNumber(o,t.DataParser.X,0)*n.scale,n.aabb.y=r._getNumber(o,t.DataParser.Y,0)*n.scale,n.aabb.width=r._getNumber(o,t.DataParser.WIDTH,0)*n.scale,n.aabb.height=r._getNumber(o,t.DataParser.HEIGHT,0)*n.scale}if(t.DataParser.BONE in e)for(var h=0,l=e[t.DataParser.BONE];h<l.length;h++){var u=l[h],c=r._getString(u,t.DataParser.PARENT,""),p=this._parseBone(u);if(c.length>0){var f=n.getBone(c);null!==f?p.parent=f:(c in this._cacheBones||(this._cacheBones[c]=[]),this._cacheBones[c].push(p))}if(p.name in this._cacheBones){for(var d=0,m=this._cacheBones[p.name];d<m.length;d++)m[d].parent=p;delete this._cacheBones[p.name]}n.addBone(p),this._rawBones.push(p)}if(t.DataParser.IK in e)for(var g=0,y=e[t.DataParser.IK];g<y.length;g++){var _=y[g];(S=this._parseIKConstraint(_))&&n.addConstraint(S)}if(n.sortBones(),t.DataParser.SLOT in e)for(var v=0,b=0,T=e[t.DataParser.SLOT];b<T.length;b++){var x=T[b];n.addSlot(this._parseSlot(x,v++))}if(t.DataParser.SKIN in e)for(var D=0,$=e[t.DataParser.SKIN];D<$.length;D++){var E=$[D];n.addSkin(this._parseSkin(E))}if(t.DataParser.PATH_CONSTRAINT in e)for(var w=0,A=e[t.DataParser.PATH_CONSTRAINT];w<A.length;w++){var S,O=A[w];(S=this._parsePathConstraint(O))&&n.addConstraint(S)}for(var C=0,P=this._cacheRawMeshes.length;C<P;++C){var R=this._cacheRawMeshes[C];t.DataParser.GLUE_WEIGHTS in R&&t.DataParser.GLUE_MESHES in R&&this._parseMeshGlue(R,this._cacheMeshes[C])}for(C=0,P=this._cacheRawMeshes.length;C<P;++C){var M=this._cacheRawMeshes[C],I=r._getString(M,t.DataParser.SHARE,"");if(0!==I.length){var B=r._getString(M,t.DataParser.SKIN,t.DataParser.DEFAULT_NAME);0===B.length&&(B=t.DataParser.DEFAULT_NAME);var F=n.getMesh(B,"",I);null!==F&&this._cacheMeshes[C].vertices.shareFrom(F.vertices)}}if(t.DataParser.ANIMATION in e)for(var L=0,N=e[t.DataParser.ANIMATION];L<N.length;L++){var k=N[L],j=this._parseAnimation(k);n.addAnimation(j)}if(t.DataParser.DEFAULT_ACTIONS in e)for(var U=0,H=this._parseActionData(e[t.DataParser.DEFAULT_ACTIONS],0,null,null);U<H.length;U++){var W=H[U];n.addAction(W,!0),0===W.type&&null!==(j=n.getAnimation(W.name))&&(n.defaultAnimation=j)}if(t.DataParser.ACTIONS in e)for(var X=0,Y=this._parseActionData(e[t.DataParser.ACTIONS],0,null,null);X<Y.length;X++)W=Y[X],n.addAction(W,!1);for(var G in this._rawBones.length=0,this._cacheRawMeshes.length=0,this._cacheMeshes.length=0,this._armature=null,this._weightSlotPose)delete this._weightSlotPose[G];for(var G in this._weightBonePoses)delete this._weightBonePoses[G];for(var G in this._cacheBones)delete this._cacheBones[G];for(var G in this._slotChildActions)delete this._slotChildActions[G];return n},r.prototype._parseBone=function(e){var i=this._armature.scale;if(0===(t.DataParser.TYPE in e&&"string"==typeof e[t.DataParser.TYPE]?t.DataParser._getBoneType(e[t.DataParser.TYPE]):r._getNumber(e,t.DataParser.TYPE,0))){var n=t.BaseObject.borrowObject(t.BoneData);return n.inheritTranslation=r._getBoolean(e,t.DataParser.INHERIT_TRANSLATION,!0),n.inheritRotation=r._getBoolean(e,t.DataParser.INHERIT_ROTATION,!0),n.inheritScale=r._getBoolean(e,t.DataParser.INHERIT_SCALE,!0),n.inheritReflection=r._getBoolean(e,t.DataParser.INHERIT_REFLECTION,!0),n.length=r._getNumber(e,t.DataParser.LENGTH,0)*i,n.name=r._getString(e,t.DataParser.NAME,""),t.DataParser.TRANSFORM in e&&this._parseTransform(e[t.DataParser.TRANSFORM],n.transform,i),n}var a=t.BaseObject.borrowObject(t.SurfaceData);if(a.name=r._getString(e,t.DataParser.NAME,""),a.segmentX=r._getNumber(e,t.DataParser.SEGMENT_X,0),a.segmentY=r._getNumber(e,t.DataParser.SEGMENT_Y,0),a.vertices.length=(a.segmentX+1)*(a.segmentY+1)*2,t.DataParser.VERTICES in e)for(var s=e[t.DataParser.VERTICES],o=0,h=a.vertices.length;o<h;++o)o<s.length?a.vertices[o]=s[o]*i:a.vertices[o]=0;return a},r.prototype._parseIKConstraint=function(e){var i=this._armature.getBone(r._getString(e,t.DataParser.BONE,""));if(null===i)return null;var n=this._armature.getBone(r._getString(e,t.DataParser.TARGET,""));if(null===n)return null;var a=t.BaseObject.borrowObject(t.IKConstraintData);return a.scaleEnabled=r._getBoolean(e,t.DataParser.SCALE,!1),a.bendPositive=r._getBoolean(e,t.DataParser.BEND_POSITIVE,!0),a.weight=r._getNumber(e,t.DataParser.WEIGHT,1),a.name=r._getString(e,t.DataParser.NAME,""),a.type=0,a.target=n,r._getNumber(e,t.DataParser.CHAIN,0)>0&&null!==i.parent?(a.root=i.parent,a.bone=i):(a.root=i,a.bone=null),a},r.prototype._parsePathConstraint=function(e){var i=this._armature.getSlot(r._getString(e,t.DataParser.TARGET,""));if(null===i)return null;var n=this._armature.defaultSkin;if(null===n)return null;var a=n.getDisplay(i.name,r._getString(e,t.DataParser.TARGET_DISPLAY,i.name));if(null===a||!(a instanceof t.PathDisplayData))return null;var s=e[t.DataParser.BONES];if(null===s||0===s.length)return null;var o=t.BaseObject.borrowObject(t.PathConstraintData);o.name=r._getString(e,t.DataParser.NAME,""),o.type=1,o.pathSlot=i,o.pathDisplayData=a,o.target=i.parent,o.positionMode=t.DataParser._getPositionMode(r._getString(e,t.DataParser.POSITION_MODE,"")),o.spacingMode=t.DataParser._getSpacingMode(r._getString(e,t.DataParser.SPACING_MODE,"")),o.rotateMode=t.DataParser._getRotateMode(r._getString(e,t.DataParser.ROTATE_MODE,"")),o.position=r._getNumber(e,t.DataParser.POSITION,0),o.spacing=r._getNumber(e,t.DataParser.SPACING,0),o.rotateOffset=r._getNumber(e,t.DataParser.ROTATE_OFFSET,0),o.rotateMix=r._getNumber(e,t.DataParser.ROTATE_MIX,1),o.translateMix=r._getNumber(e,t.DataParser.TRANSLATE_MIX,1);for(var h=0,l=s;h<l.length;h++){var u=l[h],c=this._armature.getBone(u);null!==c&&(o.AddBone(c),null===o.root&&(o.root=c))}return o},r.prototype._parseSlot=function(e,i){var n=t.BaseObject.borrowObject(t.SlotData);return n.displayIndex=r._getNumber(e,t.DataParser.DISPLAY_INDEX,0),n.zOrder=i,n.name=r._getString(e,t.DataParser.NAME,""),n.parent=this._armature.getBone(r._getString(e,t.DataParser.PARENT,"")),t.DataParser.BLEND_MODE in e&&"string"==typeof e[t.DataParser.BLEND_MODE]?n.blendMode=t.DataParser._getBlendMode(e[t.DataParser.BLEND_MODE]):n.blendMode=r._getNumber(e,t.DataParser.BLEND_MODE,0),t.DataParser.COLOR in e?(n.color=t.SlotData.createColor(),this._parseColorTransform(e[t.DataParser.COLOR],n.color)):n.color=t.SlotData.DEFAULT_COLOR,t.DataParser.ACTIONS in e&&(this._slotChildActions[n.name]=this._parseActionData(e[t.DataParser.ACTIONS],0,null,null)),n},r.prototype._parseSkin=function(e){var i=t.BaseObject.borrowObject(t.SkinData);if(i.name=r._getString(e,t.DataParser.NAME,t.DataParser.DEFAULT_NAME),0===i.name.length&&(i.name=t.DataParser.DEFAULT_NAME),t.DataParser.SLOT in e){var n=e[t.DataParser.SLOT];this._skin=i;for(var a=0,s=n;a<s.length;a++){var o=s[a],h=r._getString(o,t.DataParser.NAME,""),l=this._armature.getSlot(h);if(null!==l){if(this._slot=l,t.DataParser.DISPLAY in o)for(var u=0,c=o[t.DataParser.DISPLAY];u<c.length;u++){var p=c[u];p?i.addDisplay(h,this._parseDisplay(p)):i.addDisplay(h,null)}this._slot=null}}this._skin=null}return i},r.prototype._parseDisplay=function(e){var i=r._getString(e,t.DataParser.NAME,""),n=r._getString(e,t.DataParser.PATH,""),a=0,s=null;switch(a=t.DataParser.TYPE in e&&"string"==typeof e[t.DataParser.TYPE]?t.DataParser._getDisplayType(e[t.DataParser.TYPE]):r._getNumber(e,t.DataParser.TYPE,a)){case 0:var o=s=t.BaseObject.borrowObject(t.ImageDisplayData);o.name=i,o.path=n.length>0?n:i,this._parsePivot(e,o);break;case 1:var h=s=t.BaseObject.borrowObject(t.ArmatureDisplayData);if(h.name=i,h.path=n.length>0?n:i,h.inheritAnimation=!0,t.DataParser.ACTIONS in e)for(var l=0,u=this._parseActionData(e[t.DataParser.ACTIONS],0,null,null);l<u.length;l++){var c=u[l];h.addAction(c)}else if(this._slot.name in this._slotChildActions){var p=this._skin.getDisplays(this._slot.name);if(null===p?0===this._slot.displayIndex:this._slot.displayIndex===p.length){for(var f=0,d=this._slotChildActions[this._slot.name];f<d.length;f++)c=d[f],h.addAction(c);delete this._slotChildActions[this._slot.name]}}break;case 2:var m=s=t.BaseObject.borrowObject(t.MeshDisplayData);m.vertices.inheritDeform=r._getBoolean(e,t.DataParser.INHERIT_DEFORM,!0),m.name=i,m.path=n.length>0?n:i,m.vertices.data=this._data,t.DataParser.SHARE in e?(this._cacheRawMeshes.push(e),this._cacheMeshes.push(m)):this._parseMesh(e,m),t.DataParser.GLUE_WEIGHTS in e&&t.DataParser.GLUE_MESHES in e&&(this._cacheRawMeshes.push(e),this._cacheMeshes.push(m));break;case 3:var g=this._parseBoundingBox(e);if(null!==g){var y=s=t.BaseObject.borrowObject(t.BoundingBoxDisplayData);y.name=i,y.path=n.length>0?n:i,y.boundingBox=g}break;case 4:var _=e[t.DataParser.LENGTHS],v=s=t.BaseObject.borrowObject(t.PathDisplayData);v.closed=r._getBoolean(e,t.DataParser.CLOSED,!1),v.constantSpeed=r._getBoolean(e,t.DataParser.CONSTANT_SPEED,!1),v.name=i,v.path=n.length>0?n:i,v.vertices.data=this._data,v.curveLengths.length=_.length;for(var b=0,T=_.length;b<T;++b)v.curveLengths[b]=_[b];this._parsePath(e,v)}return null!==s&&t.DataParser.TRANSFORM in e&&this._parseTransform(e[t.DataParser.TRANSFORM],s.transform,this._armature.scale),s},r.prototype._parsePath=function(e,i){var n=e[t.DataParser.VERTICES],a=r._getNumber(e,t.DataParser.VERTEX_COUNT,0),s=this._floatArray.length,o=this._intArray.length;if(i.vertices.offset=o,this._intArray.length+=2,this._intArray[o+0]=a,this._intArray[o+2]=s,t.DataParser.WEIGHTS in e){var h=e[t.DataParser.WEIGHTS],l=e[t.DataParser.BONES],u=l.length,c=Math.floor(h.length-a)/2,p=this._intArray.length,f=this._floatArray.length,d=this._armature.sortedBones,m=t.BaseObject.borrowObject(t.WeightData);for(m.count=c,m.offset=p,this._intArray.length+=2+u+a+c,this._intArray[p+0]=u,this._intArray[p+1]=f,S=0;S<u;S++){var g=l[S],y=this._rawBones[g];m.addBone(y),this._intArray[p+2+S]=d.indexOf(y)}this._floatArray.length+=3*c,S=0;for(var _=0,v=0,b=p+2+u,T=f;S<c;S++){var x=h[_++];this._intArray[b++]=x;for(var D=0;D<x;D++){var $=h[_++],E=h[_++],w=n[v++],A=n[v++];this._intArray[b++]=l.indexOf($),this._floatArray[T++]=E,this._floatArray[T++]=w,this._floatArray[T++]=A}}i.vertices.weight=m}else{this._floatArray.length+=n.length;for(var S=0,O=n.length;S<O;++S)this._floatArray[s+S]=n[S]}},r.prototype._parsePivot=function(e,i){if(t.DataParser.PIVOT in e){var n=e[t.DataParser.PIVOT];i.pivot.x=r._getNumber(n,t.DataParser.X,0),i.pivot.y=r._getNumber(n,t.DataParser.Y,0)}else i.pivot.x=.5,i.pivot.y=.5},r.prototype._parseMesh=function(e,i){var r=e[t.DataParser.VERTICES],n=e[t.DataParser.UVS],a=e[t.DataParser.TRIANGLES],s=Math.floor(r.length/2),o=Math.floor(a.length/3),h=this._floatArray.length,l=h+2*s,u=this._intArray.length,c=this._skin.name+"_"+this._slot.name+"_"+i.name;i.vertices.offset=u,this._intArray.length+=4+3*o,this._intArray[u+0]=s,this._intArray[u+1]=o,this._intArray[u+2]=h;for(var p=0,f=3*o;p<f;++p)this._intArray[u+4+p]=a[p];for(this._floatArray.length+=2*s+2*s,p=0,f=2*s;p<f;++p)this._floatArray[h+p]=r[p],this._floatArray[l+p]=n[p];if(t.DataParser.WEIGHTS in e){var d=e[t.DataParser.WEIGHTS],m=e[t.DataParser.SLOT_POSE],g=e[t.DataParser.BONE_POSE],y=this._armature.sortedBones,_=new Array,v=Math.floor(g.length/7),b=this._floatArray.length,T=Math.floor(d.length-s)/2,x=this._intArray.length,D=t.BaseObject.borrowObject(t.WeightData);for(D.count=T,D.offset=x,_.length=v,this._intArray.length+=2+v+s+T,this._intArray[x+1]=b,p=0;p<v;++p){var $=g[7*p],E=this._rawBones[$];D.addBone(E),_[p]=$,this._intArray[x+2+p]=y.indexOf(E)}this._floatArray.length+=3*T,this._helpMatrixA.copyFromArray(m,0),p=0;for(var w=0,A=x+2+v,S=b;p<s;++p){var O=2*p,C=this._intArray[A++]=d[w++],P=this._floatArray[h+O],R=this._floatArray[h+O+1];this._helpMatrixA.transformPoint(P,R,this._helpPoint),P=this._helpPoint.x,R=this._helpPoint.y;for(var M=0;M<C;++M){$=d[w++];var I=_.indexOf($);this._helpMatrixB.copyFromArray(g,7*I+1),this._helpMatrixB.invert(),this._helpMatrixB.transformPoint(P,R,this._helpPoint),this._intArray[A++]=I,this._floatArray[S++]=d[w++],this._floatArray[S++]=this._helpPoint.x,this._floatArray[S++]=this._helpPoint.y}}i.vertices.weight=D,this._weightSlotPose[c]=m,this._weightBonePoses[c]=g}},r.prototype._parseMeshGlue=function(t,e){},r.prototype._parseBoundingBox=function(e){var i=null,n=0;switch(n=t.DataParser.SUB_TYPE in e&&"string"==typeof e[t.DataParser.SUB_TYPE]?t.DataParser._getBoundingBoxType(e[t.DataParser.SUB_TYPE]):r._getNumber(e,t.DataParser.SUB_TYPE,n)){case 0:i=t.BaseObject.borrowObject(t.RectangleBoundingBoxData);break;case 1:i=t.BaseObject.borrowObject(t.EllipseBoundingBoxData);break;case 2:i=this._parsePolygonBoundingBox(e)}return null!==i&&(i.color=r._getNumber(e,t.DataParser.COLOR,0),0!==i.type&&1!==i.type||(i.width=r._getNumber(e,t.DataParser.WIDTH,0),i.height=r._getNumber(e,t.DataParser.HEIGHT,0))),i},r.prototype._parsePolygonBoundingBox=function(e){var i=t.BaseObject.borrowObject(t.PolygonBoundingBoxData);if(t.DataParser.VERTICES in e){var r=this._armature.scale,n=e[t.DataParser.VERTICES],a=i.vertices;t.DragonBones.webAssembly?a.resize(n.length,0):a.length=n.length;for(var s=0,o=n.length;s<o;s+=2){var h=n[s]*r,l=n[s+1]*r;t.DragonBones.webAssembly?(a.set(s,h),a.set(s+1,l)):(a[s]=h,a[s+1]=l),0===s?(i.x=h,i.y=l,i.width=h,i.height=l):(h<i.x?i.x=h:h>i.width&&(i.width=h),l<i.y?i.y=l:l>i.height&&(i.height=l))}i.width-=i.x,i.height-=i.y}else console.warn("Data error.\n Please reexport DragonBones Data to fixed the bug.");return i},r.prototype._parseAnimation=function(e){var i=t.BaseObject.borrowObject(t.AnimationData);if(i.frameCount=Math.max(r._getNumber(e,t.DataParser.DURATION,1),1),i.playTimes=r._getNumber(e,t.DataParser.PLAY_TIMES,1),i.duration=i.frameCount/this._armature.frameRate,i.fadeInTime=r._getNumber(e,t.DataParser.FADE_IN_TIME,0),i.scale=r._getNumber(e,t.DataParser.SCALE,1),i.name=r._getString(e,t.DataParser.NAME,t.DataParser.DEFAULT_NAME),0===i.name.length&&(i.name=t.DataParser.DEFAULT_NAME),i.frameIntOffset=this._frameIntArray.length,i.frameFloatOffset=this._frameFloatArray.length,i.frameOffset=this._frameArray.length,this._animation=i,t.DataParser.FRAME in e){var n=e[t.DataParser.FRAME],a=n.length;if(a>0)for(var s=0,o=0;s<a;++s){var h=n[s];this._parseActionDataInFrame(h,o,null,null),o+=r._getNumber(h,t.DataParser.DURATION,1)}}if(t.DataParser.Z_ORDER in e&&(this._animation.zOrderTimeline=this._parseTimeline(e[t.DataParser.Z_ORDER],null,t.DataParser.FRAME,1,!1,!1,0,this._parseZOrderFrame)),t.DataParser.BONE in e)for(var l=0,u=e[t.DataParser.BONE];l<u.length;l++){var c=u[l];this._parseBoneTimeline(c)}if(t.DataParser.SURFACE in e)for(var p=0,f=e[t.DataParser.SURFACE];p<f.length;p++){c=f[p];var d=r._getString(c,t.DataParser.NAME,"");this._surface=this._armature.getBone(d),null!==this._surface&&(null!==(S=this._parseTimeline(c,null,t.DataParser.FRAME,50,!1,!0,0,this._parseSurfaceFrame))&&this._animation.addSurfaceTimeline(this._surface,S),this._surface=null)}if(t.DataParser.SLOT in e)for(var m=0,g=e[t.DataParser.SLOT];m<g.length;m++)c=g[m],this._parseSlotTimeline(c);if(t.DataParser.FFD in e)for(var y=0,_=e[t.DataParser.FFD];y<_.length;y++){c=_[y];var v=r._getString(c,t.DataParser.SKIN,t.DataParser.DEFAULT_NAME),b=r._getString(c,t.DataParser.SLOT,""),T=r._getString(c,t.DataParser.NAME,"");0===v.length&&(v=t.DataParser.DEFAULT_NAME),this._slot=this._armature.getSlot(b),this._mesh=this._armature.getMesh(v,b,T),null!==this._slot&&null!==this._mesh&&(null!==(S=this._parseTimeline(c,null,t.DataParser.FRAME,22,!1,!0,0,this._parseSlotFFDFrame))&&this._animation.addSlotTimeline(this._slot,S),this._slot=null,this._mesh=null)}if(t.DataParser.IK in e)for(var x=0,D=e[t.DataParser.IK];x<D.length;x++){c=D[x];var $=r._getString(c,t.DataParser.NAME,""),E=this._armature.getConstraint($);null!==E&&null!==(S=this._parseTimeline(c,null,t.DataParser.FRAME,30,!0,!1,2,this._parseIKConstraintFrame))&&this._animation.addConstraintTimeline(E,S)}if(t.DataParser.ANIMATION in e)for(var w=0,A=e[t.DataParser.ANIMATION];w<A.length;w++){c=A[w];var S,O=r._getString(c,t.DataParser.NAME,"");null!==(S=this._parseTimeline(c,null,t.DataParser.FRAME,40,!0,!1,2,this._parseAnimationFrame))&&this._animation.addAnimationTimeline(O,S)}return this._actionFrames.length>0&&(this._animation.actionTimeline=this._parseTimeline(null,this._actionFrames,"",0,!1,!1,0,this._parseActionFrame),this._actionFrames.length=0),this._animation=null,i},r.prototype._parseTimeline=function(e,n,a,s,o,h,l,u){if(null!==e&&a.length>0&&a in e&&(n=e[a]),null===n)return null;var c=n.length;if(0===c)return null;var p=this._frameIntArray.length,f=this._frameFloatArray.length,d=t.BaseObject.borrowObject(t.TimelineData),m=this._timelineArray.length;if(this._timelineArray.length+=5+c,null!==e?(this._timelineArray[m+0]=Math.round(100*r._getNumber(e,t.DataParser.SCALE,1)),this._timelineArray[m+1]=Math.round(100*r._getNumber(e,t.DataParser.OFFSET,0))):(this._timelineArray[m+0]=100,this._timelineArray[m+1]=0),this._timelineArray[m+2]=c,this._timelineArray[m+3]=l,this._timelineArray[m+4]=o?p-this._animation.frameIntOffset:h?f-this._animation.frameFloatOffset:0,this._timeline=d,d.type=s,d.offset=m,1===c)d.frameIndicesOffset=-1,this._timelineArray[m+5+0]=u.call(this,n[0],0,0)-this._animation.frameOffset;else{var g=this._animation.frameCount+1,y=this._data.frameIndices,_=0;t.DragonBones.webAssembly?(_=y.size(),y.resize(_+g,0)):(_=y.length,y.length+=g),d.frameIndicesOffset=_;for(var v=0,b=0,T=0,x=0;v<g;++v){if(T+x<=v&&b<c){var D=n[b];T=v,x=b===c-1?this._animation.frameCount-T:D instanceof i?this._actionFrames[b+1].frameStart-T:r._getNumber(D,t.DataParser.DURATION,1),this._timelineArray[m+5+b]=u.call(this,D,T,x)-this._animation.frameOffset,b++}t.DragonBones.webAssembly?y.set(_+v,b-1):y[_+v]=b-1}}return this._timeline=null,d},r.prototype._parseBoneTimeline=function(e){var i,n=this._armature.getBone(r._getString(e,t.DataParser.NAME,""));null!==n&&(this._bone=n,this._slot=this._armature.getSlot(this._bone.name),t.DataParser.TRANSLATE_FRAME in e&&null!==(i=this._parseTimeline(e,null,t.DataParser.TRANSLATE_FRAME,11,!1,!0,2,this._parseBoneTranslateFrame))&&this._animation.addBoneTimeline(n,i),t.DataParser.ROTATE_FRAME in e&&null!==(i=this._parseTimeline(e,null,t.DataParser.ROTATE_FRAME,12,!1,!0,2,this._parseBoneRotateFrame))&&this._animation.addBoneTimeline(n,i),t.DataParser.SCALE_FRAME in e&&null!==(i=this._parseTimeline(e,null,t.DataParser.SCALE_FRAME,13,!1,!0,2,this._parseBoneScaleFrame))&&this._animation.addBoneTimeline(n,i),t.DataParser.FRAME in e&&null!==(i=this._parseTimeline(e,null,t.DataParser.FRAME,10,!1,!0,6,this._parseBoneAllFrame))&&this._animation.addBoneTimeline(n,i),this._bone=null,this._slot=null)},r.prototype._parseSlotTimeline=function(e){var i=this._armature.getSlot(r._getString(e,t.DataParser.NAME,""));if(null!==i){this._slot=i;var n;null!==(n=t.DataParser.DISPLAY_FRAME in e?this._parseTimeline(e,null,t.DataParser.DISPLAY_FRAME,20,!1,!1,0,this._parseSlotDisplayFrame):this._parseTimeline(e,null,t.DataParser.FRAME,20,!1,!1,0,this._parseSlotDisplayFrame))&&this._animation.addSlotTimeline(i,n);var a;null!==(a=t.DataParser.COLOR_FRAME in e?this._parseTimeline(e,null,t.DataParser.COLOR_FRAME,21,!0,!1,1,this._parseSlotColorFrame):this._parseTimeline(e,null,t.DataParser.FRAME,21,!0,!1,1,this._parseSlotColorFrame))&&this._animation.addSlotTimeline(i,a),this._slot=null}},r.prototype._parseFrame=function(t,e,i){var r=this._frameArray.length;return this._frameArray.length+=1,this._frameArray[r+0]=e,r},r.prototype._parseTweenFrame=function(e,i,n){var a=this._parseFrame(e,i,n);if(n>0)if(t.DataParser.CURVE in e){var s=n+1;this._helpArray.length=s,this._samplingEasingCurve(e[t.DataParser.CURVE],this._helpArray),this._frameArray.length+=2+this._helpArray.length,this._frameArray[a+1]=2,this._frameArray[a+2]=s;for(var o=0;o<s;++o)this._frameArray[a+3+o]=Math.round(1e4*this._helpArray[o])}else{var h=-2;t.DataParser.TWEEN_EASING in e&&(h=r._getNumber(e,t.DataParser.TWEEN_EASING,-2)),-2===h?(this._frameArray.length+=1,this._frameArray[a+1]=0):0===h?(this._frameArray.length+=1,this._frameArray[a+1]=1):h<0?(this._frameArray.length+=2,this._frameArray[a+1]=3,this._frameArray[a+2]=Math.round(100*-h)):h<=1?(this._frameArray.length+=2,this._frameArray[a+1]=4,this._frameArray[a+2]=Math.round(100*h)):(this._frameArray.length+=2,this._frameArray[a+1]=5,this._frameArray[a+2]=Math.round(100*h-100))}else this._frameArray.length+=1,this._frameArray[a+1]=0;return a},r.prototype._parseActionFrame=function(t,e,i){var r=this._frameArray.length,n=t.actions.length;this._frameArray.length+=2+n,this._frameArray[r+0]=e,this._frameArray[r+0+1]=n;for(var a=0;a<n;++a)this._frameArray[r+0+2+a]=t.actions[a];return r},r.prototype._parseZOrderFrame=function(e,i,r){var n=this._parseFrame(e,i,r);if(t.DataParser.Z_ORDER in e){var a=e[t.DataParser.Z_ORDER];if(a.length>0){for(var s=this._armature.sortedSlots.length,o=new Array(s-a.length/2),h=new Array(s),l=0;l<o.length;++l)o[l]=0;for(var u=0;u<s;++u)h[u]=-1;for(var c=0,p=0,f=0,d=a.length;f<d;f+=2){for(var m=a[f],g=a[f+1];c!==m;)o[p++]=c++;h[c+g]=c++}for(;c<s;)o[p++]=c++;this._frameArray.length+=1+s,this._frameArray[n+1]=s;for(var y=s;y--;)-1===h[y]?this._frameArray[n+2+y]=o[--p]||0:this._frameArray[n+2+y]=h[y]||0;return n}}return this._frameArray.length+=1,this._frameArray[n+1]=0,n},r.prototype._parseBoneAllFrame=function(e,i,n){this._helpTransform.identity(),t.DataParser.TRANSFORM in e&&this._parseTransform(e[t.DataParser.TRANSFORM],this._helpTransform,1);var a=this._helpTransform.rotation;0!==i&&(0===this._prevClockwise?a=this._prevRotation+t.Transform.normalizeRadian(a-this._prevRotation):((this._prevClockwise>0?a>=this._prevRotation:a<=this._prevRotation)&&(this._prevClockwise=this._prevClockwise>0?this._prevClockwise-1:this._prevClockwise+1),a=this._prevRotation+a-this._prevRotation+t.Transform.PI_D*this._prevClockwise)),this._prevClockwise=r._getNumber(e,t.DataParser.TWEEN_ROTATE,0),this._prevRotation=a;var s=this._parseTweenFrame(e,i,n),o=this._frameFloatArray.length;return this._frameFloatArray.length+=6,this._frameFloatArray[o++]=this._helpTransform.x,this._frameFloatArray[o++]=this._helpTransform.y,this._frameFloatArray[o++]=a,this._frameFloatArray[o++]=this._helpTransform.skew,this._frameFloatArray[o++]=this._helpTransform.scaleX,this._frameFloatArray[o++]=this._helpTransform.scaleY,this._parseActionDataInFrame(e,i,this._bone,this._slot),s},r.prototype._parseBoneTranslateFrame=function(e,i,n){var a=this._parseTweenFrame(e,i,n),s=this._frameFloatArray.length;return this._frameFloatArray.length+=2,this._frameFloatArray[s++]=r._getNumber(e,t.DataParser.X,0),this._frameFloatArray[s++]=r._getNumber(e,t.DataParser.Y,0),a},r.prototype._parseBoneRotateFrame=function(e,i,n){var a=r._getNumber(e,t.DataParser.ROTATE,0)*t.Transform.DEG_RAD;0!==i&&(0===this._prevClockwise?a=this._prevRotation+t.Transform.normalizeRadian(a-this._prevRotation):((this._prevClockwise>0?a>=this._prevRotation:a<=this._prevRotation)&&(this._prevClockwise=this._prevClockwise>0?this._prevClockwise-1:this._prevClockwise+1),a=this._prevRotation+a-this._prevRotation+t.Transform.PI_D*this._prevClockwise)),this._prevClockwise=r._getNumber(e,t.DataParser.CLOCK_WISE,0),this._prevRotation=a;var s=this._parseTweenFrame(e,i,n),o=this._frameFloatArray.length;return this._frameFloatArray.length+=2,this._frameFloatArray[o++]=a,this._frameFloatArray[o++]=r._getNumber(e,t.DataParser.SKEW,0)*t.Transform.DEG_RAD,s},r.prototype._parseBoneScaleFrame=function(e,i,n){var a=this._parseTweenFrame(e,i,n),s=this._frameFloatArray.length;return this._frameFloatArray.length+=2,this._frameFloatArray[s++]=r._getNumber(e,t.DataParser.X,1),this._frameFloatArray[s++]=r._getNumber(e,t.DataParser.Y,1),a},r.prototype._parseSurfaceFrame=function(e,i,n){var a=this._frameFloatArray.length,s=this._parseTweenFrame(e,i,n),o=e[t.DataParser.VERTICES],h=r._getNumber(e,t.DataParser.OFFSET,0),l=this._surface.vertices.length/2,u=0,c=0;this._frameFloatArray.length+=2*l;for(var p=0;p<2*l;p+=2)u=p<h||p-h>=o.length?0:o[p-h],c=p+1<h||p+1-h>=o.length?0:o[p+1-h],this._frameFloatArray[a+p]=u,this._frameFloatArray[a+p+1]=c;if(0===i){var f=this._frameIntArray.length;this._frameIntArray.length+=5,this._frameIntArray[f+0]=0,this._frameIntArray[f+1]=this._frameFloatArray.length-a,this._frameIntArray[f+2]=this._frameFloatArray.length-a,this._frameIntArray[f+3]=0,this._frameIntArray[f+4]=a-this._animation.frameFloatOffset,this._timelineArray[this._timeline.offset+3]=f-this._animation.frameIntOffset}return s},r.prototype._parseSlotDisplayFrame=function(e,i,n){var a=this._parseFrame(e,i,n);return this._frameArray.length+=1,t.DataParser.VALUE in e?this._frameArray[a+1]=r._getNumber(e,t.DataParser.VALUE,0):this._frameArray[a+1]=r._getNumber(e,t.DataParser.DISPLAY_INDEX,0),this._parseActionDataInFrame(e,i,this._slot.parent,this._slot),a},r.prototype._parseSlotColorFrame=function(e,i,r){var n=this._parseTweenFrame(e,i,r),a=-1;if(t.DataParser.VALUE in e||t.DataParser.COLOR in e){var s=t.DataParser.VALUE in e?e[t.DataParser.VALUE]:e[t.DataParser.COLOR];for(var o in s){this._parseColorTransform(s,this._helpColorTransform),a=this._intArray.length,this._intArray.length+=8,this._intArray[a++]=Math.round(100*this._helpColorTransform.alphaMultiplier),this._intArray[a++]=Math.round(100*this._helpColorTransform.redMultiplier),this._intArray[a++]=Math.round(100*this._helpColorTransform.greenMultiplier),this._intArray[a++]=Math.round(100*this._helpColorTransform.blueMultiplier),this._intArray[a++]=Math.round(this._helpColorTransform.alphaOffset),this._intArray[a++]=Math.round(this._helpColorTransform.redOffset),this._intArray[a++]=Math.round(this._helpColorTransform.greenOffset),this._intArray[a++]=Math.round(this._helpColorTransform.blueOffset),a-=8;break}}a<0&&(this._defaultColorOffset<0&&(this._defaultColorOffset=a=this._intArray.length,this._intArray.length+=8,this._intArray[a++]=100,this._intArray[a++]=100,this._intArray[a++]=100,this._intArray[a++]=100,this._intArray[a++]=0,this._intArray[a++]=0,this._intArray[a++]=0,this._intArray[a++]=0),a=this._defaultColorOffset);var h=this._frameIntArray.length;return this._frameIntArray.length+=1,this._frameIntArray[h]=a,n},r.prototype._parseSlotFFDFrame=function(e,i,n){var a=this._frameFloatArray.length,s=this._parseTweenFrame(e,i,n),o=t.DataParser.VERTICES in e?e[t.DataParser.VERTICES]:null,h=r._getNumber(e,t.DataParser.OFFSET,0),l=this._intArray[this._mesh.vertices.offset+0],u=this._mesh.parent.name+"_"+this._slot.name+"_"+this._mesh.name,c=this._mesh.vertices.weight,p=0,f=0,d=0,m=0;if(null!==c){var g=this._weightSlotPose[u];this._helpMatrixA.copyFromArray(g,0),this._frameFloatArray.length+=2*c.count,d=c.offset+2+c.bones.length}else this._frameFloatArray.length+=2*l;for(var y=0;y<2*l;y+=2)if(null===o?(p=0,f=0):(p=y<h||y-h>=o.length?0:o[y-h],f=y+1<h||y+1-h>=o.length?0:o[y+1-h]),null!==c){var _=this._weightBonePoses[u],v=this._intArray[d++];this._helpMatrixA.transformPoint(p,f,this._helpPoint,!0),p=this._helpPoint.x,f=this._helpPoint.y;for(var b=0;b<v;++b){var T=this._intArray[d++];this._helpMatrixB.copyFromArray(_,7*T+1),this._helpMatrixB.invert(),this._helpMatrixB.transformPoint(p,f,this._helpPoint,!0),this._frameFloatArray[a+m++]=this._helpPoint.x,this._frameFloatArray[a+m++]=this._helpPoint.y}}else this._frameFloatArray[a+y]=p,this._frameFloatArray[a+y+1]=f;if(0===i){var x=this._frameIntArray.length;this._frameIntArray.length+=5,this._frameIntArray[x+0]=this._mesh.vertices.offset,this._frameIntArray[x+1]=this._frameFloatArray.length-a,this._frameIntArray[x+2]=this._frameFloatArray.length-a,this._frameIntArray[x+3]=0,this._frameIntArray[x+4]=a-this._animation.frameFloatOffset,this._timelineArray[this._timeline.offset+3]=x-this._animation.frameIntOffset}return s},r.prototype._parseIKConstraintFrame=function(e,i,n){var a=this._parseTweenFrame(e,i,n),s=this._frameIntArray.length;return this._frameIntArray.length+=2,this._frameIntArray[s++]=r._getBoolean(e,t.DataParser.BEND_POSITIVE,!0)?1:0,this._frameIntArray[s++]=Math.round(100*r._getNumber(e,t.DataParser.WEIGHT,1)),a},r.prototype._parseAnimationFrame=function(e,i,n){var a=this._parseTweenFrame(e,i,n),s=this._frameIntArray.length;return this._frameIntArray.length+=2,this._frameIntArray[s++]=r._getNumber(e,t.DataParser.VALUE,0),this._frameIntArray[s++]=Math.round(100*r._getNumber(e,t.DataParser.WEIGHT,1)),a},r.prototype._parseActionData=function(e,i,n,a){var s=new Array;if("string"==typeof e)(u=t.BaseObject.borrowObject(t.ActionData)).type=i,u.name=e,u.bone=n,u.slot=a,s.push(u);else if(e instanceof Array)for(var o=0,h=e;o<h.length;o++){var l=h[o],u=t.BaseObject.borrowObject(t.ActionData);if(t.DataParser.GOTO_AND_PLAY in l?(u.type=0,u.name=r._getString(l,t.DataParser.GOTO_AND_PLAY,"")):(t.DataParser.TYPE in l&&"string"==typeof l[t.DataParser.TYPE]?u.type=t.DataParser._getActionType(l[t.DataParser.TYPE]):u.type=r._getNumber(l,t.DataParser.TYPE,i),u.name=r._getString(l,t.DataParser.NAME,"")),t.DataParser.BONE in l){var c=r._getString(l,t.DataParser.BONE,"");u.bone=this._armature.getBone(c)}else u.bone=n;if(t.DataParser.SLOT in l){var p=r._getString(l,t.DataParser.SLOT,"");u.slot=this._armature.getSlot(p)}else u.slot=a;var f=null;if(t.DataParser.INTS in l){null===f&&(f=t.BaseObject.borrowObject(t.UserData));for(var d=0,m=l[t.DataParser.INTS];d<m.length;d++){var g=m[d];f.addInt(g)}}if(t.DataParser.FLOATS in l){null===f&&(f=t.BaseObject.borrowObject(t.UserData));for(var y=0,_=l[t.DataParser.FLOATS];y<_.length;y++)g=_[y],f.addFloat(g)}if(t.DataParser.STRINGS in l){null===f&&(f=t.BaseObject.borrowObject(t.UserData));for(var v=0,b=l[t.DataParser.STRINGS];v<b.length;v++)g=b[v],f.addString(g)}u.data=f,s.push(u)}return s},r.prototype._parseTransform=function(e,i,n){i.x=r._getNumber(e,t.DataParser.X,0)*n,i.y=r._getNumber(e,t.DataParser.Y,0)*n,t.DataParser.ROTATE in e||t.DataParser.SKEW in e?(i.rotation=t.Transform.normalizeRadian(r._getNumber(e,t.DataParser.ROTATE,0)*t.Transform.DEG_RAD),i.skew=t.Transform.normalizeRadian(r._getNumber(e,t.DataParser.SKEW,0)*t.Transform.DEG_RAD)):(t.DataParser.SKEW_X in e||t.DataParser.SKEW_Y in e)&&(i.rotation=t.Transform.normalizeRadian(r._getNumber(e,t.DataParser.SKEW_Y,0)*t.Transform.DEG_RAD),i.skew=t.Transform.normalizeRadian(r._getNumber(e,t.DataParser.SKEW_X,0)*t.Transform.DEG_RAD)-i.rotation),i.scaleX=r._getNumber(e,t.DataParser.SCALE_X,1),i.scaleY=r._getNumber(e,t.DataParser.SCALE_Y,1)},r.prototype._parseColorTransform=function(e,i){i.alphaMultiplier=.01*r._getNumber(e,t.DataParser.ALPHA_MULTIPLIER,100),i.redMultiplier=.01*r._getNumber(e,t.DataParser.RED_MULTIPLIER,100),i.greenMultiplier=.01*r._getNumber(e,t.DataParser.GREEN_MULTIPLIER,100),i.blueMultiplier=.01*r._getNumber(e,t.DataParser.BLUE_MULTIPLIER,100),i.alphaOffset=r._getNumber(e,t.DataParser.ALPHA_OFFSET,0),i.redOffset=r._getNumber(e,t.DataParser.RED_OFFSET,0),i.greenOffset=r._getNumber(e,t.DataParser.GREEN_OFFSET,0),i.blueOffset=r._getNumber(e,t.DataParser.BLUE_OFFSET,0)},r.prototype._parseArray=function(t){this._intArray.length=0,this._floatArray.length=0,this._frameIntArray.length=0,this._frameFloatArray.length=0,this._frameArray.length=0,this._timelineArray.length=0},r.prototype._modifyArray=function(){this._intArray.length%Int16Array.BYTES_PER_ELEMENT!=0&&this._intArray.push(0),this._frameIntArray.length%Int16Array.BYTES_PER_ELEMENT!=0&&this._frameIntArray.push(0),this._frameArray.length%Int16Array.BYTES_PER_ELEMENT!=0&&this._frameArray.push(0),this._timelineArray.length%Uint16Array.BYTES_PER_ELEMENT!=0&&this._timelineArray.push(0);var e=this._intArray.length*Int16Array.BYTES_PER_ELEMENT,i=this._floatArray.length*Float32Array.BYTES_PER_ELEMENT,r=this._frameIntArray.length*Int16Array.BYTES_PER_ELEMENT,n=this._frameFloatArray.length*Float32Array.BYTES_PER_ELEMENT,a=this._frameArray.length*Int16Array.BYTES_PER_ELEMENT,s=this._timelineArray.length*Uint16Array.BYTES_PER_ELEMENT,o=e+i+r+n+a+s;if(t.DragonBones.webAssembly){for(var h=t.webAssemblyModule.HEAP16.buffer,l=t.webAssemblyModule._malloc(o),u=new Int16Array(h,l,this._intArray.length),c=new Float32Array(h,l+e,this._floatArray.length),p=new Int16Array(h,l+e+i,this._frameIntArray.length),f=new Float32Array(h,l+e+i+r,this._frameFloatArray.length),d=new Int16Array(h,l+e+i+r+n,this._frameArray.length),m=new Uint16Array(h,l+e+i+r+n+a,this._timelineArray.length),g=0,y=this._intArray.length;g<y;++g)u[g]=this._intArray[g];for(g=0,y=this._floatArray.length;g<y;++g)c[g]=this._floatArray[g];for(g=0,y=this._frameIntArray.length;g<y;++g)p[g]=this._frameIntArray[g];for(g=0,y=this._frameFloatArray.length;g<y;++g)f[g]=this._frameFloatArray[g];for(g=0,y=this._frameArray.length;g<y;++g)d[g]=this._frameArray[g];for(g=0,y=this._timelineArray.length;g<y;++g)m[g]=this._timelineArray[g];t.webAssemblyModule.setDataBinary(this._data,l,e,i,r,n,a,s)}else{var _=new ArrayBuffer(o);for(u=new Int16Array(_,0,this._intArray.length),c=new Float32Array(_,e,this._floatArray.length),p=new Int16Array(_,e+i,this._frameIntArray.length),f=new Float32Array(_,e+i+r,this._frameFloatArray.length),d=new Int16Array(_,e+i+r+n,this._frameArray.length),m=new Uint16Array(_,e+i+r+n+a,this._timelineArray.length),g=0,y=this._intArray.length;g<y;++g)u[g]=this._intArray[g];for(g=0,y=this._floatArray.length;g<y;++g)c[g]=this._floatArray[g];for(g=0,y=this._frameIntArray.length;g<y;++g)p[g]=this._frameIntArray[g];for(g=0,y=this._frameFloatArray.length;g<y;++g)f[g]=this._frameFloatArray[g];for(g=0,y=this._frameArray.length;g<y;++g)d[g]=this._frameArray[g];for(g=0,y=this._timelineArray.length;g<y;++g)m[g]=this._timelineArray[g];this._data.binary=_,this._data.intArray=u,this._data.floatArray=c,this._data.frameIntArray=p,this._data.frameFloatArray=f,this._data.frameArray=d,this._data.timelineArray=m}this._defaultColorOffset=-1},r.prototype.parseDragonBonesData=function(e,i){void 0===i&&(i=1),console.assert(null!==e&&void 0!==e,"Data error.");var n=r._getString(e,t.DataParser.VERSION,""),a=r._getString(e,t.DataParser.COMPATIBLE_VERSION,"");if(t.DataParser.DATA_VERSIONS.indexOf(n)>=0||t.DataParser.DATA_VERSIONS.indexOf(a)>=0){var s=t.BaseObject.borrowObject(t.DragonBonesData);if(s.version=n,s.name=r._getString(e,t.DataParser.NAME,""),s.frameRate=r._getNumber(e,t.DataParser.FRAME_RATE,24),0===s.frameRate&&(s.frameRate=24),t.DataParser.ARMATURE in e){this._data=s,this._parseArray(e);for(var o=0,h=e[t.DataParser.ARMATURE];o<h.length;o++){var l=h[o];s.addArmature(this._parseArmature(l,i))}this._data.binary||this._modifyArray(),t.DataParser.STAGE in e?s.stage=s.getArmature(r._getString(e,t.DataParser.STAGE,"")):s.armatureNames.length>0&&(s.stage=s.getArmature(s.armatureNames[0])),this._data=null}return t.DataParser.TEXTURE_ATLAS in e&&(this._rawTextureAtlases=e[t.DataParser.TEXTURE_ATLAS]),s}return console.assert(!1,"Nonsupport data version: "+n+"\nPlease convert DragonBones data to support version.\nRead more: https://github.com/DragonBones/Tools/"),null},r.prototype.parseTextureAtlasData=function(e,i,n){if(void 0===n&&(n=1),console.assert(void 0!==e),null===e){if(null===this._rawTextureAtlases||0===this._rawTextureAtlases.length)return!1;var a=this._rawTextureAtlases[this._rawTextureAtlasIndex++];return this.parseTextureAtlasData(a,i,n),this._rawTextureAtlasIndex>=this._rawTextureAtlases.length&&(this._rawTextureAtlasIndex=0,this._rawTextureAtlases=null),!0}if(i.width=r._getNumber(e,t.DataParser.WIDTH,0),i.height=r._getNumber(e,t.DataParser.HEIGHT,0),i.scale=1===n?1/r._getNumber(e,t.DataParser.SCALE,1):n,i.name=r._getString(e,t.DataParser.NAME,""),i.imagePath=r._getString(e,t.DataParser.IMAGE_PATH,""),t.DataParser.SUB_TEXTURE in e)for(var s=e[t.DataParser.SUB_TEXTURE],o=0,h=s.length;o<h;++o){var l=s[o],u=i.createTexture();u.rotated=r._getBoolean(l,t.DataParser.ROTATED,!1),u.name=r._getString(l,t.DataParser.NAME,""),u.region.x=r._getNumber(l,t.DataParser.X,0),u.region.y=r._getNumber(l,t.DataParser.Y,0),u.region.width=r._getNumber(l,t.DataParser.WIDTH,0),u.region.height=r._getNumber(l,t.DataParser.HEIGHT,0);var c=r._getNumber(l,t.DataParser.FRAME_WIDTH,-1),p=r._getNumber(l,t.DataParser.FRAME_HEIGHT,-1);c>0&&p>0&&(u.frame=t.TextureData.createRectangle(),u.frame.x=r._getNumber(l,t.DataParser.FRAME_X,0),u.frame.y=r._getNumber(l,t.DataParser.FRAME_Y,0),u.frame.width=c,u.frame.height=p),i.addTexture(u)}return!0},r.getInstance=function(){return null===r._objectDataParserInstance&&(r._objectDataParserInstance=new r),r._objectDataParserInstance},r._objectDataParserInstance=null,r}(t.DataParser);t.ObjectDataParser=e;var i=function(){this.frameStart=0,this.actions=[]};t.ActionFrame=i}(a||(a={})),function(t){var e=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return s(i,e),i.prototype._inRange=function(t,e,i){return e<=t&&t<=i},i.prototype._decodeUTF8=function(t){for(var e,i=0,r="",n=0,a=0,s=0,o=0;t.length>i;){var h=t[i++];if(-1===h)e=0!==a?65533:-1;else if(0===a)this._inRange(h,0,127)?e=h:(this._inRange(h,194,223)?(a=1,o=128,n=h-192):this._inRange(h,224,239)?(a=2,o=2048,n=h-224):this._inRange(h,240,244)&&(a=3,o=65536,n=h-240),n*=Math.pow(64,a),e=null);else if(this._inRange(h,128,191))if(s+=1,n+=(h-128)*Math.pow(64,a-s),s!==a)e=null;else{var l=n,u=o;n=0,a=0,s=0,o=0,e=this._inRange(l,u,1114111)&&!this._inRange(l,55296,57343)?l:h}else n=0,a=0,s=0,o=0,i--,e=h;null!==e&&-1!==e&&(e<=65535?e>0&&(r+=String.fromCharCode(e)):(e-=65536,r+=String.fromCharCode(55296+(e>>10&1023)),r+=String.fromCharCode(56320+(1023&e))))}return r},i.prototype._getUTF16Key=function(t){for(var e=0,i=t.length;e<i;++e)if(t.charCodeAt(e)>255)return encodeURI(t);return t},i.prototype._parseBinaryTimeline=function(e,i,r){void 0===r&&(r=null);var n=null!==r?r:t.BaseObject.borrowObject(t.TimelineData);n.type=e,n.offset=i,this._timeline=n;var a=this._timelineArrayBuffer[n.offset+2];if(1===a)n.frameIndicesOffset=-1;else{var s=0,o=this._animation.frameCount+1,h=this._data.frameIndices;t.DragonBones.webAssembly?(s=h.size(),h.resize(s+o,0)):(s=h.length,h.length+=o),n.frameIndicesOffset=s;for(var l=0,u=0,c=0,p=0;l<o;++l)c+p<=l&&u<a&&(c=this._frameArrayBuffer[this._animation.frameOffset+this._timelineArrayBuffer[n.offset+5+u]],p=u===a-1?this._animation.frameCount-c:this._frameArrayBuffer[this._animation.frameOffset+this._timelineArrayBuffer[n.offset+5+u+1]]-c,u++),t.DragonBones.webAssembly?h.set(s+l,u-1):h[s+l]=u-1}return this._timeline=null,n},i.prototype._parseVertices=function(e,i){i.offset=e[t.DataParser.OFFSET];var r=this._intArrayBuffer[i.offset+3];if(r>=0){var n=t.BaseObject.borrowObject(t.WeightData),a=this._intArrayBuffer[i.offset+0],s=this._intArrayBuffer[r+0];n.offset=r;for(var o=0;o<s;++o){var h=this._intArrayBuffer[r+2+o];n.addBone(this._rawBones[h])}for(var l=r+2+s,u=0,c=(o=0,a);o<c;++o){var p=this._intArrayBuffer[l++];u+=p,l+=p}n.count=u,i.weight=n}},i.prototype._parseMesh=function(t,e){this._parseVertices(t,e.vertices)},i.prototype._parsePath=function(t,e){this._parseVertices(t,e.vertices)},i.prototype._parseAnimation=function(e){var i=t.BaseObject.borrowObject(t.AnimationData);i.frameCount=Math.max(t.ObjectDataParser._getNumber(e,t.DataParser.DURATION,1),1),i.playTimes=t.ObjectDataParser._getNumber(e,t.DataParser.PLAY_TIMES,1),i.duration=i.frameCount/this._armature.frameRate,i.fadeInTime=t.ObjectDataParser._getNumber(e,t.DataParser.FADE_IN_TIME,0),i.scale=t.ObjectDataParser._getNumber(e,t.DataParser.SCALE,1),i.name=t.ObjectDataParser._getString(e,t.DataParser.NAME,t.DataParser.DEFAULT_NAME),0===i.name.length&&(i.name=t.DataParser.DEFAULT_NAME);var r=e[t.DataParser.OFFSET];if(i.frameIntOffset=r[0],i.frameFloatOffset=r[1],i.frameOffset=r[2],this._animation=i,t.DataParser.ACTION in e&&(i.actionTimeline=this._parseBinaryTimeline(0,e[t.DataParser.ACTION])),t.DataParser.Z_ORDER in e&&(i.zOrderTimeline=this._parseBinaryTimeline(1,e[t.DataParser.Z_ORDER])),t.DataParser.BONE in e){var n=e[t.DataParser.BONE];for(var a in n){var s=n[a];t.DragonBones.webAssembly&&(a=this._getUTF16Key(a));var o=this._armature.getBone(a);if(null!==o)for(var h=0,l=s.length;h<l;h+=2){var u=s[h],c=s[h+1],p=this._parseBinaryTimeline(u,c);this._animation.addBoneTimeline(o,p)}}}if(t.DataParser.SURFACE in e)for(var a in n=e[t.DataParser.SURFACE]){s=n[a],t.DragonBones.webAssembly&&(a=this._getUTF16Key(a));var f=this._armature.getBone(a);if(null!==f)for(h=0,l=s.length;h<l;h+=2)u=s[h],c=s[h+1],p=this._parseBinaryTimeline(u,c),this._animation.addSurfaceTimeline(f,p)}if(t.DataParser.SLOT in e)for(var a in n=e[t.DataParser.SLOT]){s=n[a],t.DragonBones.webAssembly&&(a=this._getUTF16Key(a));var d=this._armature.getSlot(a);if(null!==d)for(h=0,l=s.length;h<l;h+=2)u=s[h],c=s[h+1],p=this._parseBinaryTimeline(u,c),this._animation.addSlotTimeline(d,p)}if(t.DataParser.CONSTRAINT in e)for(var a in n=e[t.DataParser.CONSTRAINT]){s=n[a],t.DragonBones.webAssembly&&(a=this._getUTF16Key(a));var m=this._armature.getConstraint(a);if(null!==m)for(h=0,l=s.length;h<l;h+=2)u=s[h],c=s[h+1],p=this._parseBinaryTimeline(u,c),this._animation.addConstraintTimeline(m,p)}if(t.DataParser.ANIMATION in e)for(var a in n=e[t.DataParser.ANIMATION])for(s=n[a],t.DragonBones.webAssembly&&(a=this._getUTF16Key(a)),h=0,l=s.length;h<l;h+=2)u=s[h],c=s[h+1],p=this._parseBinaryTimeline(u,c),this._animation.addAnimationTimeline(a,p);return this._animation=null,i},i.prototype._parseArray=function(e){var i=e[t.DataParser.OFFSET],r=i[1],n=i[3],a=i[5],s=i[7],o=i[9],h=i[11],l=new Int16Array(this._binary,this._binaryOffset+i[0],r/Int16Array.BYTES_PER_ELEMENT),u=new Float32Array(this._binary,this._binaryOffset+i[2],n/Float32Array.BYTES_PER_ELEMENT),c=new Int16Array(this._binary,this._binaryOffset+i[4],a/Int16Array.BYTES_PER_ELEMENT),p=new Float32Array(this._binary,this._binaryOffset+i[6],s/Float32Array.BYTES_PER_ELEMENT),f=new Int16Array(this._binary,this._binaryOffset+i[8],o/Int16Array.BYTES_PER_ELEMENT),d=new Uint16Array(this._binary,this._binaryOffset+i[10],h/Uint16Array.BYTES_PER_ELEMENT);if(t.DragonBones.webAssembly){for(var m=r+n+a+s+o+h,g=t.webAssemblyModule._malloc(m),y=new Uint8Array(this._binary,this._binaryOffset,m/Uint8Array.BYTES_PER_ELEMENT),_=new Uint8Array(t.webAssemblyModule.HEAP16.buffer,g,y.length),v=0,b=y.length;v<b;++v)_[v]=y[v];t.webAssemblyModule.setDataBinary(this._data,g,r,n,a,s,o,h),this._intArrayBuffer=l,this._floatArrayBuffer=u,this._frameIntArrayBuffer=c,this._frameFloatArrayBuffer=p,this._frameArrayBuffer=f,this._timelineArrayBuffer=d}else this._data.binary=this._binary,this._data.intArray=this._intArrayBuffer=l,this._data.floatArray=this._floatArrayBuffer=u,this._data.frameIntArray=this._frameIntArrayBuffer=c,this._data.frameFloatArray=this._frameFloatArrayBuffer=p,this._data.frameArray=this._frameArrayBuffer=f,this._data.timelineArray=this._timelineArrayBuffer=d},i.prototype.parseDragonBonesData=function(t,i){void 0===i&&(i=1),console.assert(null!==t&&void 0!==t&&t instanceof ArrayBuffer,"Data error.");var r=new Uint8Array(t,0,8);if(r[0]!=="D".charCodeAt(0)||r[1]!=="B".charCodeAt(0)||r[2]!=="D".charCodeAt(0)||r[3]!=="T".charCodeAt(0))return console.assert(!1,"Nonsupport data."),null;var n=new Uint32Array(t,8,1)[0],a=new Uint8Array(t,12,n),s=this._decodeUTF8(a),o=JSON.parse(s);return this._binaryOffset=12+n,this._binary=t,e.prototype.parseDragonBonesData.call(this,o,i)},i.getInstance=function(){return null===i._binaryDataParserInstance&&(i._binaryDataParserInstance=new i),i._binaryDataParserInstance},i._binaryDataParserInstance=null,i}(t.ObjectDataParser);t.BinaryDataParser=e}(a||(a={})),function(t){var e=function(){function e(i){void 0===i&&(i=null),this.autoSearch=!1,this._dragonBonesDataMap={},this._textureAtlasDataMap={},this._dragonBones=null,this._dataParser=null,null===e._objectParser&&(e._objectParser=new t.ObjectDataParser),null===e._binaryParser&&(e._binaryParser=new t.BinaryDataParser),this._dataParser=null!==i?i:e._objectParser}return e.prototype._isSupportMesh=function(){return!0},e.prototype._getTextureData=function(t,e){if(t in this._textureAtlasDataMap)for(var i=0,r=this._textureAtlasDataMap[t];i<r.length;i++)if(null!==(h=(o=r[i]).getTexture(e)))return h;if(this.autoSearch)for(var n in this._textureAtlasDataMap)for(var a=0,s=this._textureAtlasDataMap[n];a<s.length;a++){var o,h;if((o=s[a]).autoSearch&&null!==(h=o.getTexture(e)))return h}return null},e.prototype._fillBuildArmaturePackage=function(t,e,i,r,n){var a=null,s=null;if(e.length>0&&e in this._dragonBonesDataMap&&(s=(a=this._dragonBonesDataMap[e]).getArmature(i)),null===s&&(0===e.length||this.autoSearch))for(var o in this._dragonBonesDataMap)if(a=this._dragonBonesDataMap[o],(0===e.length||a.autoSearch)&&null!==(s=a.getArmature(i))){e=o;break}if(null!==s){if(t.dataName=e,t.textureAtlasName=n,t.data=a,t.armature=s,t.skin=null,r.length>0&&(t.skin=s.getSkin(r),null===t.skin&&this.autoSearch))for(var o in this._dragonBonesDataMap){var h=this._dragonBonesDataMap[o].getArmature(r);if(null!==h){t.skin=h.defaultSkin;break}}return null===t.skin&&(t.skin=s.defaultSkin),!0}return!1},e.prototype._buildBones=function(e,i){for(var r=0,n=e.armature.sortedBones;r<n.length;r++){var a=n[r];t.BaseObject.borrowObject(0===a.type?t.Bone:t.Surface).init(a,i)}},e.prototype._buildSlots=function(e,i){var r=e.skin,n=e.armature.defaultSkin;if(null!==r&&null!==n){var a={};for(var s in n.displays){var o=n.getDisplays(s);a[s]=o}if(r!==n)for(var s in r.displays)o=r.getDisplays(s),a[s]=o;for(var h=0,l=e.armature.sortedSlots;h<l.length;h++){var u=l[h],c=u.name in a?a[u.name]:null,p=this._buildSlot(e,u,i);if(p.rawDisplayDatas=c,null!==c){for(var f=new Array,d=0,m=t.DragonBones.webAssembly?c.size():c.length;d<m;++d){var g=t.DragonBones.webAssembly?c.get(d):c[d];null!==g?f.push(this._getSlotDisplay(e,g,null,p)):f.push(null)}p._setDisplayList(f)}p._setDisplayIndex(u.displayIndex,!0)}}},e.prototype._buildConstraints=function(e,i){var r=e.armature.constraints;for(var n in r){var a=r[n];switch(a.type){case 0:var s=t.BaseObject.borrowObject(t.IKConstraint);s.init(a,i),i._addConstraint(s);break;case 1:var o=t.BaseObject.borrowObject(t.PathConstraint);o.init(a,i),i._addConstraint(o);break;default:var h=t.BaseObject.borrowObject(t.IKConstraint);h.init(a,i),i._addConstraint(h)}}},e.prototype._buildChildArmature=function(t,e,i){return this.buildArmature(i.path,null!==t?t.dataName:"","",null!==t?t.textureAtlasName:"")},e.prototype._getSlotDisplay=function(e,i,r,n){var a=null!==e?e.dataName:i.parent.parent.parent.name,s=null;switch(i.type){case 0:var o=i;null===o.texture?o.texture=this._getTextureData(a,i.path):null!==e&&e.textureAtlasName.length>0&&(o.texture=this._getTextureData(e.textureAtlasName,i.path)),s=null!==r&&2===r.type&&this._isSupportMesh()?n.meshDisplay:n.rawDisplay;break;case 2:var h=i;null===h.texture?h.texture=this._getTextureData(a,h.path):null!==e&&e.textureAtlasName.length>0&&(h.texture=this._getTextureData(e.textureAtlasName,h.path)),s=this._isSupportMesh()?n.meshDisplay:n.rawDisplay;break;case 1:var l=i,u=this._buildChildArmature(e,n,i);if(null!==u){if(u.inheritAnimation=l.inheritAnimation,!u.inheritAnimation){var c=l.actions.length>0?l.actions:u.armatureData.defaultActions;if(c.length>0)for(var p=0,f=c;p<f.length;p++){var d=f[p],m=t.BaseObject.borrowObject(t.EventObject);t.EventObject.actionDataToInstance(d,m,n.armature),m.slot=n,n.armature._bufferAction(m,!1)}else u.animation.play()}l.armature=u.armatureData}s=u}return s},e.prototype.parseDragonBonesData=function(t,i,r){void 0===i&&(i=null),void 0===r&&(r=1);for(var n=t instanceof ArrayBuffer?e._binaryParser:this._dataParser,a=n.parseDragonBonesData(t,r);;){var s=this._buildTextureAtlasData(null,null);if(!n.parseTextureAtlasData(null,s,r)){s.returnToPool();break}this.addTextureAtlasData(s,i)}return null!==a&&this.addDragonBonesData(a,i),a},e.prototype.parseTextureAtlasData=function(t,e,i,r){void 0===i&&(i=null),void 0===r&&(r=1);var n=this._buildTextureAtlasData(null,null);return this._dataParser.parseTextureAtlasData(t,n,r),this._buildTextureAtlasData(n,e||null),this.addTextureAtlasData(n,i),n},e.prototype.updateTextureAtlasData=function(t,e){var i=this.getTextureAtlasData(t);if(null!==i)for(var r=0,n=i.length;r<n;++r)r<e.length&&this._buildTextureAtlasData(i[r],e[r])},e.prototype.getDragonBonesData=function(t){return t in this._dragonBonesDataMap?this._dragonBonesDataMap[t]:null},e.prototype.addDragonBonesData=function(t,e){if(void 0===e&&(e=null),(e=null!==e?e:t.name)in this._dragonBonesDataMap){if(this._dragonBonesDataMap[e]===t)return;console.warn("Can not add same name data: "+e)}else this._dragonBonesDataMap[e]=t},e.prototype.removeDragonBonesData=function(t,e){void 0===e&&(e=!0),t in this._dragonBonesDataMap&&(e&&this._dragonBones.bufferObject(this._dragonBonesDataMap[t]),delete this._dragonBonesDataMap[t])},e.prototype.getTextureAtlasData=function(t){return t in this._textureAtlasDataMap?this._textureAtlasDataMap[t]:null},e.prototype.addTextureAtlasData=function(t,e){void 0===e&&(e=null);var i=(e=null!==e?e:t.name)in this._textureAtlasDataMap?this._textureAtlasDataMap[e]:this._textureAtlasDataMap[e]=[];i.indexOf(t)<0&&i.push(t)},e.prototype.removeTextureAtlasData=function(t,e){if(void 0===e&&(e=!0),t in this._textureAtlasDataMap){var i=this._textureAtlasDataMap[t];if(e)for(var r=0,n=i;r<n.length;r++){var a=n[r];this._dragonBones.bufferObject(a)}delete this._textureAtlasDataMap[t]}},e.prototype.getArmatureData=function(t,e){void 0===e&&(e="");var r=new i;return this._fillBuildArmaturePackage(r,e,t,"","")?r.armature:null},e.prototype.clear=function(t){for(var e in void 0===t&&(t=!0),this._dragonBonesDataMap)t&&this._dragonBones.bufferObject(this._dragonBonesDataMap[e]),delete this._dragonBonesDataMap[e];for(var e in this._textureAtlasDataMap){if(t)for(var i=0,r=this._textureAtlasDataMap[e];i<r.length;i++){var n=r[i];this._dragonBones.bufferObject(n)}delete this._textureAtlasDataMap[e]}},e.prototype.buildArmature=function(t,e,r,n){void 0===e&&(e=""),void 0===r&&(r=""),void 0===n&&(n="");var a=new i;if(!this._fillBuildArmaturePackage(a,e||"",t,r||"",n||""))return console.warn("No armature data: "+t+", "+(null!==e?e:"")),null;var s=this._buildArmature(a);return this._buildBones(a,s),this._buildSlots(a,s),this._buildConstraints(a,s),s.invalidUpdate(null,!0),s.advanceTime(0),s},e.prototype.replaceDisplay=function(e,i,r){void 0===r&&(r=-1),r<0&&(r=e.displayIndex),r<0&&(r=0),e.replaceDisplayData(i,r);var n=e.displayList;if(n.length<=r){n.length=r+1;for(var a=0,s=n.length;a<s;++a)n[a]||(n[a]=null)}if(null!==i){var o=e.rawDisplayDatas,h=null;o&&(t.DragonBones.webAssembly?r<o.size()&&(h=o.get(r)):r<o.length&&(h=o[r])),n[r]=this._getSlotDisplay(null,i,h,e)}else n[r]=null;e.displayList=n},e.prototype.replaceSlotDisplay=function(t,e,i,r,n,a){void 0===a&&(a=-1);var s=this.getArmatureData(e,t||"");if(!s||!s.defaultSkin)return!1;var o=s.defaultSkin.getDisplay(i,r);return!!o&&(this.replaceDisplay(n,o,a),!0)},e.prototype.replaceSlotDisplayList=function(e,i,r,n){var a=this.getArmatureData(i,e||"");if(!a||!a.defaultSkin)return!1;var s=a.defaultSkin.getDisplays(r);if(!s)return!1;for(var o=0,h=0,l=t.DragonBones.webAssembly?s.size():s.length;h<l;++h){var u=t.DragonBones.webAssembly?s.get(h):s[h];this.replaceDisplay(n,u,o++)}return!0},e.prototype.replaceSkin=function(e,i,r,n){void 0===r&&(r=!1),void 0===n&&(n=null);for(var a=!1,s=i.parent.defaultSkin,o=0,h=e.getSlots();o<h.length;o++){var l=h[o];if(!(null!==n&&n.indexOf(l.name)>=0)){var u=i.getDisplays(l.name);if(u||(null!==s&&i!==s&&(u=s.getDisplays(l.name)),u)){var c=t.DragonBones.webAssembly?u.size():u.length,p=l.displayList;p.length=c;for(var f=0,d=c;f<d;++f){var m=t.DragonBones.webAssembly?u.get(f):u[f];p[f]=null!==m?this._getSlotDisplay(null,m,null,l):null}a=!0,l.rawDisplayDatas=u,l.displayList=p}else r&&(l.rawDisplayDatas=null,l.displayList=[])}}return a},e.prototype.replaceAnimation=function(e,i,r){void 0===r&&(r=!0);var n=i.defaultSkin;if(null===n)return!1;if(r)e.animation.animations=i.animations;else{var a=e.animation.animations,s={};for(var o in a)s[o]=a[o];for(var o in i.animations)s[o]=i.animations[o];e.animation.animations=s}for(var h=0,l=e.getSlots();h<l.length;h++)for(var u=l[h],c=0,p=0,f=u.displayList;p<f.length;p++){var d=f[p];if(d instanceof t.Armature){var m=n.getDisplays(u.name);if(null!==m&&c<(t.DragonBones.webAssembly?m.size():m.length)){var g=t.DragonBones.webAssembly?m.get(c):m[c];if(null!==g&&1===g.type){var y=this.getArmatureData(g.path,g.parent.parent.parent.name);y&&this.replaceAnimation(d,y,r)}}}c++}return!0},e.prototype.getAllDragonBonesData=function(){return this._dragonBonesDataMap},e.prototype.getAllTextureAtlasData=function(){return this._textureAtlasDataMap},Object.defineProperty(e.prototype,"clock",{get:function(){return this._dragonBones.clock},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dragonBones",{get:function(){return this._dragonBones},enumerable:!0,configurable:!0}),e.prototype.changeSkin=function(t,e,i){return void 0===i&&(i=null),this.replaceSkin(t,e,!1,i)},e.prototype.copyAnimationsToArmature=function(t,e,i,r,n){void 0===i&&(i=""),void 0===r&&(r=""),void 0===n&&(n=!0);var a=this.getArmatureData(e,r);return!!a&&this.replaceAnimation(t,a,n)},e._objectParser=null,e._binaryParser=null,e}();t.BaseFactory=e;var i=function(){this.dataName="",this.textureAtlasName="",this.skin=null};t.BuildArmaturePackage=i}(a||(a={})),function(t){var e=function(e){function r(){var t=null!==e&&e.apply(this,arguments)||this;return t._renderTexture=null,t}return s(r,e),r.toString=function(){return"[class dragonBones.EgretTextureAtlasData]"},r.prototype._onClear=function(){e.prototype._onClear.call(this),this.disposeEnabled&&null!==this._renderTexture&&this._renderTexture.dispose(),this.disposeEnabled=!1,this._renderTexture=null},r.prototype.createTexture=function(){return t.BaseObject.borrowObject(i)},Object.defineProperty(r.prototype,"renderTexture",{get:function(){return this._renderTexture},set:function(t){if(this._renderTexture!==t)if(this._renderTexture=t,null!==this._renderTexture){var e=this._renderTexture.bitmapData,i=this.width>0?this.width:e.width,r=this.height>0?this.height:e.height;for(var n in this.textures){var a=egret.$TextureScaleFactor,s=(h=this.textures[n]).region.width,o=h.region.height;null===h.renderTexture&&(h.renderTexture=new egret.Texture),h.renderTexture.bitmapData=e,h.rotated?h.renderTexture.$initData(h.region.x*a,h.region.y*a,o*a,s*a,0,0,o*a,s*a,i,r,h.rotated):h.renderTexture.$initData(h.region.x*a,h.region.y*a,s*a,o*a,0,0,s*a,o*a,i,r)}}else for(var n in this.textures){var h;(h=this.textures[n]).renderTexture=null}},enumerable:!0,configurable:!0}),r.prototype.dispose=function(){console.warn("已废弃。"),this.returnToPool()},Object.defineProperty(r.prototype,"texture",{get:function(){return console.warn("已废弃。"),this.renderTexture},enumerable:!0,configurable:!0}),r}(t.TextureAtlasData);t.EgretTextureAtlasData=e;var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.renderTexture=null,e}return s(e,t),e.toString=function(){return"[class dragonBones.EgretTextureData]"},e.prototype._onClear=function(){t.prototype._onClear.call(this),this.renderTexture,this.renderTexture=null},e}(t.TextureData);t.EgretTextureData=i}(a||(a={})),function(t){var e=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return s(i,e),Object.defineProperty(i.prototype,"eventObject",{get:function(){return this.data},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"animationName",{get:function(){var t=this.eventObject.animationState;return null!==t?t.name:""},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"armature",{get:function(){return this.eventObject.armature},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"bone",{get:function(){return this.eventObject.bone},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"slot",{get:function(){return this.eventObject.slot},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"animationState",{get:function(){return this.eventObject.animationState},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"frameLabel",{get:function(){return this.eventObject.name},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"sound",{get:function(){return this.eventObject.name},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"movementID",{get:function(){return this.animationName},enumerable:!0,configurable:!0}),i.START=t.EventObject.START,i.LOOP_COMPLETE=t.EventObject.LOOP_COMPLETE,i.COMPLETE=t.EventObject.COMPLETE,i.FADE_IN=t.EventObject.FADE_IN,i.FADE_IN_COMPLETE=t.EventObject.FADE_IN_COMPLETE,i.FADE_OUT=t.EventObject.FADE_OUT,i.FADE_OUT_COMPLETE=t.EventObject.FADE_OUT_COMPLETE,i.FRAME_EVENT=t.EventObject.FRAME_EVENT,i.SOUND_EVENT=t.EventObject.SOUND_EVENT,i.ANIMATION_FRAME_EVENT=t.EventObject.FRAME_EVENT,i.BONE_FRAME_EVENT=t.EventObject.FRAME_EVENT,i.MOVEMENT_FRAME_EVENT=t.EventObject.FRAME_EVENT,i.SOUND=t.EventObject.SOUND_EVENT,i}(egret.Event);t.EgretEvent=e;var i=function(i){function r(){var t=null!==i&&i.apply(this,arguments)||this;return t.debugDraw=!1,t._batchEnabled=!(o.nativeRender||o.bricks),t._childDirty=!0,t._debugDraw=!1,t._armature=null,t._bounds=null,t._debugDrawer=null,t}return s(r,i),r._cleanBeforeRender=function(){},r.prototype.dbInit=function(t){this._armature=t,this._batchEnabled&&(this.$renderNode=new egret.sys.GroupNode,this.$renderNode.cleanBeforeRender=r._cleanBeforeRender)},r.prototype.dbClear=function(){this._armature=null,this._bounds=null,this._debugDrawer=null},r.prototype.dbUpdate=function(){var e=t.DragonBones.debugDraw||this.debugDraw;if(e||this._debugDraw)if(this._debugDraw=e,this._debugDraw){null===this._debugDrawer&&(this._debugDrawer=new egret.Sprite),this._debugDrawer.parent!==this&&this.addChild(this._debugDrawer);var i=this._debugDrawer.graphics;i.clear();for(var r=0,n=this._armature.getBones();r<n.length;r++){var a=n[r];if(0===a.boneData.type){var s=Math.max(a.boneData.length,2),o=a.globalTransformMatrix.tx,h=a.globalTransformMatrix.ty,l=o-2*a.globalTransformMatrix.a,u=h-2*a.globalTransformMatrix.b,c=o+a.globalTransformMatrix.a*s,p=h+a.globalTransformMatrix.b*s,f=o+u-h,d=h+l-o,m=o-u+h,g=h-l+o;i.lineStyle(2,65535,.7),i.moveTo(l,u),i.lineTo(c,p),i.moveTo(f,d),i.lineTo(m,g)}else{var y=a,_=y._boneData,v=_.segmentX,b=_.segmentY,T=y._vertices;i.lineStyle(2,16776960,.7);for(var x=0;x<b;++x)for(var D=0;D<v;++D){var $=2*(D+x*(v+1)),E=T[$],w=T[$+1];i.moveTo(E,w),i.lineTo(T[$+2],T[$+3]),i.moveTo(E,w),i.lineTo(T[$+2*(v+1)],T[$+2*(v+1)+1]),D===v-1&&(i.moveTo(T[$+2],T[$+3]),i.lineTo(T[$+2*(v+2)],T[$+2*(v+2)+1])),x===b-1&&(i.moveTo(T[$+2*(v+1)],T[$+2*(v+1)+1]),i.lineTo(T[$+2*(v+2)],T[$+2*(v+2)+1]))}}}for(var A=0,S=this._armature.getSlots();A<S.length;A++){var O=S[A],C=O.boundingBoxData;if(null!==C){switch(null===(R=this._debugDrawer.getChildByName(O.name))&&((R=new egret.Shape).name=O.name,this._debugDrawer.addChild(R)),R.graphics.clear(),R.graphics.lineStyle(2,16711935,.7),C.type){case 0:R.graphics.drawRect(.5*-C.width,.5*-C.height,C.width,C.height);break;case 1:R.graphics.drawEllipse(.5*-C.width,.5*-C.height,C.width,C.height);break;case 2:T=C.vertices;for(var P=0;P<T.length;P+=2)E=T[P],w=T[P+1],0===P?R.graphics.moveTo(E,w):R.graphics.lineTo(E,w);R.graphics.lineTo(T[0],T[1])}O.updateTransformAndMatrix(),O.updateGlobalTransform(),R.$setMatrix(O.globalTransformMatrix,!1)}else{var R;null!==(R=this._debugDrawer.getChildByName(O.name))&&this._debugDrawer.removeChild(R)}}}else null!==this._debugDrawer&&this._debugDrawer.parent===this&&this.removeChild(this._debugDrawer);!t.isV5&&this._batchEnabled&&this._childDirty&&this.$invalidateContentBounds()},r.prototype.dispose=function(t){void 0===t&&(t=!0),null!==this._armature&&(this._armature.dispose(),this._armature=null)},r.prototype.dispatchDBEvent=function(t,r){var n=egret.Event.create(e,t);n.data=r,i.prototype.dispatchEvent.call(this,n),egret.Event.release(n)},r.prototype.hasDBEventListener=function(t){return this.hasEventListener(t)},r.prototype.addDBEventListener=function(t,e,i){this.addEventListener(t,e,i)},r.prototype.removeDBEventListener=function(t,e,i){this.removeEventListener(t,e,i)},r.prototype.disableBatch=function(){if(this._batchEnabled&&this._armature){for(var t=0,e=this._armature.getSlots();t<e.length;t++){var i=e[t],r=i._deformVertices&&i._deformVertices.verticesData?i.meshDisplay:i.rawDisplay;i.display||r!==i.meshDisplay||(r=i.rawDisplay),r.$renderNode.matrix&&r.$setMatrix(i.globalTransformMatrix,!1),this.addChild(r)}this._batchEnabled=!1,this.$renderNode.cleanBeforeRender=null,this.$renderNode=null,this.armature.invalidUpdate(null,!0)}},Object.defineProperty(r.prototype,"armature",{get:function(){return this._armature},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"animation",{get:function(){return this._armature.animation},enumerable:!0,configurable:!0}),r.prototype.$measureContentBounds=function(e){if(this._batchEnabled&&this._armature){if(this._childDirty){this._childDirty=!1;for(var r=!0,n=new egret.Rectangle,a=0,s=this._armature.getSlots();a<s.length;a++){var o=s[a],h=o.display;if(h&&h.$renderNode&&h.$renderNode.image){var l=h.$renderNode.matrix;if(h===o.meshDisplay){var u=h.$renderNode.vertices;if(!(u&&u.length>0))continue;n.setTo(999999,999999,-999999,-999999);for(var c=0,p=u.length;c<p;c+=2){var f=u[c],d=u[c+1];n.x>f&&(n.x=f),n.width<f&&(n.width=f),n.y>d&&(n.y=d),n.height<d&&(n.height=d)}n.width-=n.x,n.height-=n.y}else{var m=o.displayData;if(!(m&&m instanceof t.ImageDisplayData&&m.texture))continue;var g=m.texture.parent.scale;n.x=0,n.y=0,n.width=m.texture.region.width*g,n.height=m.texture.region.height*g}l.$transformBounds(n);var y=n.x,_=n.y,v=n.x+n.width,b=n.y+n.height;r?(r=!1,e.x=y,e.y=_,e.width=v,e.height=b):(y<e.x&&(e.x=y),_<e.y&&(e.y=_),v>e.width&&(e.width=v),b>e.height&&(e.height=b))}}e.width-=e.x,e.height-=e.y,t.isV5&&(null===this._bounds&&(this._bounds=new egret.Rectangle),this._bounds.copyFrom(e))}else t.isV5&&(null===this._bounds&&(this._bounds=new egret.Rectangle),e.copyFrom(this._bounds));return e}return i.prototype.$measureContentBounds.call(this,e)},r.prototype.hasEvent=function(t){return this.hasDBEventListener(t)},r.prototype.addEvent=function(t,e,i){this.addDBEventListener(t,e,i)},r.prototype.removeEvent=function(t,e,i){this.removeDBEventListener(t,e,i)},r.prototype.advanceTimeBySelf=function(e){this._armature.clock=e?t.EgretFactory.factory.clock:null},r}(egret.DisplayObjectContainer);t.EgretArmatureDisplay=i;var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e}(e);t.Event=r;var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e}(e);t.ArmatureEvent=n;var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e}(e);t.AnimationEvent=a;var h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e}(e);t.FrameEvent=h;var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e}(e);t.SoundEvent=l;var u=function(e){function i(i,r,n){void 0===n&&(n=1);var a=e.call(this)||this;return console.warn("已废弃"),a._onClear(),t.ObjectDataParser.getInstance().parseTextureAtlasData(r,a,n),a.renderTexture=i,a}return s(i,e),i.toString=function(){return"[class dragonBones.EgretTextureAtlas]"},i}(t.EgretTextureAtlasData);t.EgretTextureAtlas=u;var c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e}(u);t.EgretSheetAtlas=c;var p=function(){function e(){}return e.getInstance=function(){return console.warn("已废弃"),t.EgretFactory.factory.soundEventManager},e}();t.SoundEventManager=p;var f=function(){console.warn("已废弃")};t.AnimationCacheManager=f}(a||(a={})),function(t){var e=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.transformUpdateEnabled=!1,t._armatureDisplay=null,t._renderDisplay=null,t._colorFilter=null,t}return s(i,e),i.toString=function(){return"[class dragonBones.EgretSlot]"},i.prototype.init=function(i,r,n,a){e.prototype.init.call(this,i,r,n,a),t.isV5?this._updateTransform=this._updateTransformV5:this._updateTransform=this._updateTransformV4},i.prototype._onClear=function(){e.prototype._onClear.call(this),this._armatureDisplay=null,this._renderDisplay=null,this._colorFilter=null},i.prototype._initDisplay=function(t,e){},i.prototype._disposeDisplay=function(t,e){},i.prototype._onUpdateDisplay=function(){if(this._armatureDisplay=this._armature.display,this._renderDisplay=null!==this._display?this._display:this._rawDisplay,t.isV5&&this._armatureDisplay._batchEnabled&&(this._renderDisplay!==this._rawDisplay||this._renderDisplay.$renderNode instanceof egret.sys.BitmapNode||(this._renderDisplay.$renderNode=new egret.sys.BitmapNode)),this._armatureDisplay._batchEnabled)if(this._renderDisplay!==this._rawDisplay&&this._renderDisplay!==this._meshDisplay)this._armatureDisplay.disableBatch();else{var e=this._renderDisplay.$renderNode;e.matrix||(e.matrix=new egret.Matrix)}},i.prototype._addDisplay=function(){this._armatureDisplay._batchEnabled?this._armatureDisplay.$renderNode.addNode(this._renderDisplay.$renderNode):this._armatureDisplay.addChild(this._renderDisplay)},i.prototype._replaceDisplay=function(t){var e=t;if(this._armatureDisplay._batchEnabled){var i=this._armatureDisplay.$renderNode.drawData;i[i.indexOf(e.$renderNode)]=this._renderDisplay.$renderNode}else this._armatureDisplay.addChild(this._renderDisplay),this._armatureDisplay.swapChildren(this._renderDisplay,e),this._armatureDisplay.removeChild(e)},i.prototype._removeDisplay=function(){if(this._armatureDisplay._batchEnabled){var t=this._armatureDisplay.$renderNode.drawData;t.splice(t.indexOf(this._renderDisplay.$renderNode),1)}else this._renderDisplay.parent.removeChild(this._renderDisplay)},i.prototype._updateZOrder=function(){if(this._armatureDisplay._batchEnabled)this._armatureDisplay.$renderNode.drawData[this._zOrder]=this._renderDisplay.$renderNode;else{if(this._armatureDisplay.getChildIndex(this._renderDisplay)===this._zOrder)return;this._armatureDisplay.addChildAt(this._renderDisplay,this._zOrder)}},i.prototype._updateVisible=function(){var t=this._parent.visible&&this._visible;this._armatureDisplay._batchEnabled?this._renderDisplay.$renderNode.alpha=t?1:0:this._renderDisplay.visible=t},i.prototype._updateBlendMode=function(){switch(this._blendMode){case 0:this._renderDisplay.blendMode=egret.BlendMode.NORMAL;break;case 1:this._renderDisplay.blendMode=egret.BlendMode.ADD;break;case 5:this._renderDisplay.blendMode=egret.BlendMode.ERASE}this._armatureDisplay._batchEnabled&&(this._renderDisplay.$renderNode.blendMode=egret.sys.blendModeToNumber(this._renderDisplay.blendMode))},i.prototype._updateColor=function(){if(1!==this._colorTransform.redMultiplier||1!==this._colorTransform.greenMultiplier||1!==this._colorTransform.blueMultiplier||0!==this._colorTransform.redOffset||0!==this._colorTransform.greenOffset||0!==this._colorTransform.blueOffset||0!==this._colorTransform.alphaOffset){null===this._colorFilter&&(this._colorFilter=new egret.ColorMatrixFilter);var t=this._colorFilter.matrix;t[0]=this._colorTransform.redMultiplier,t[6]=this._colorTransform.greenMultiplier,t[12]=this._colorTransform.blueMultiplier,t[18]=this._colorTransform.alphaMultiplier,t[4]=this._colorTransform.redOffset,t[9]=this._colorTransform.greenOffset,t[14]=this._colorTransform.blueOffset,t[19]=this._colorTransform.alphaOffset,this._colorFilter.matrix=t,this._armatureDisplay._batchEnabled&&((i=this._renderDisplay.$renderNode).filter=this._colorFilter,i.alpha=1);var e=this._renderDisplay.filters;e||(e=[]),e.indexOf(this._colorFilter)<0&&e.push(this._colorFilter),this._renderDisplay.filters=e,this._renderDisplay.alpha=1}else{var i;this._armatureDisplay._batchEnabled&&((i=this._renderDisplay.$renderNode).filter=null,i.alpha=this._colorTransform.alphaMultiplier),this._renderDisplay.filters=null,this._renderDisplay.alpha=this._colorTransform.alphaMultiplier}},i.prototype._updateFrame=function(){var e=null!==this._deformVertices&&this._display===this._meshDisplay?this._deformVertices.verticesData:null,i=this._textureData;if(this._displayIndex>=0&&null!==this._display&&null!==i){if(null!==this._armature.replacedTexture&&null!==this._rawDisplayDatas&&this._rawDisplayDatas.indexOf(this._displayData)>=0){var r=i.parent;null===this._armature._replaceTextureAtlasData?((r=t.BaseObject.borrowObject(t.EgretTextureAtlasData)).copyFrom(i.parent),r.renderTexture=this._armature.replacedTexture,this._armature._replaceTextureAtlasData=r):r=this._armature._replaceTextureAtlasData,i=r.getTexture(i.name)}if(null!==i.renderTexture){if(null!==e){var n=e.data,a=n.intArray,s=n.floatArray,o=a[e.offset+0],h=a[e.offset+1],l=a[e.offset+2];l<0&&(l+=65536);var u=l+2*o,c=this._armature._armatureData.scale,p=this._renderDisplay,f=p.$renderNode;f.uvs.length=2*o,f.vertices.length=2*o,f.indices.length=3*h;for(var d=0,m=2*o;d<m;++d)f.vertices[d]=s[l+d]*c,f.uvs[d]=s[u+d];for(d=0;d<3*h;++d)f.indices[d]=a[e.offset+4+d];if(this._armatureDisplay._batchEnabled){var g=i.renderTexture,y=this._renderDisplay.$renderNode;if(egret.sys.RenderNode.prototype.cleanBeforeRender.call(y),y.image=g.bitmapData,t.isV5)y.drawMesh(g.$bitmapX,g.$bitmapY,g.$bitmapWidth,g.$bitmapHeight,g.$offsetX,g.$offsetY,g.textureWidth,g.textureHeight),y.imageWidth=g.$sourceWidth,y.imageHeight=g.$sourceHeight;else{var _=g;y.drawMesh(_._bitmapX,_._bitmapY,_._bitmapWidth,_._bitmapHeight,_._offsetX,_._offsetY,_.textureWidth,_.textureHeight),y.imageWidth=_._sourceWidth,y.imageHeight=_._sourceHeight}this._blendModeDirty=!0,this._colorDirty=!0}p.texture=i.renderTexture,p.anchorOffsetX=this._pivotX,p.anchorOffsetY=this._pivotY,p.$updateVertices(),t.isV5||p.$invalidateTransform();var v=null!==e.weight,b=0!==this._parent._boneData.type;(v||b)&&this._identityTransform()}else{c=i.parent.scale*this._armature._armatureData.scale;var T=(i.rotated?i.region.height:i.region.width)*c,x=(i.rotated?i.region.width:i.region.height)*c,D=this._renderDisplay;g=i.renderTexture,D.texture=g,this._armatureDisplay._batchEnabled?(y=this._renderDisplay.$renderNode,egret.sys.RenderNode.prototype.cleanBeforeRender.call(y),y.image=g.bitmapData,t.isV5?(y.drawImage(g.$bitmapX,g.$bitmapY,g.$bitmapWidth,g.$bitmapHeight,g.$offsetX,g.$offsetY,T,x),y.imageWidth=g.$sourceWidth,y.imageHeight=g.$sourceHeight):(_=g,y.drawImage(_._bitmapX,_._bitmapY,_._bitmapWidth,_._bitmapHeight,_._offsetX,_._offsetY,T,x),y.imageWidth=_._sourceWidth,y.imageHeight=_._sourceHeight),this._blendModeDirty=!0,this._colorDirty=!0):(D.width=T,D.height=x),D.anchorOffsetX=this._pivotX,D.anchorOffsetY=this._pivotY}return void(this._visibleDirty=!0)}}this._armatureDisplay._batchEnabled&&(this._renderDisplay.$renderNode.image=null);var $=this._renderDisplay;$.texture=null,$.x=0,$.y=0,$.visible=!1},i.prototype._updateMesh=function(){var e=this._armature._armatureData.scale,i=this._deformVertices.vertices,r=this._deformVertices.bones,n=this._deformVertices.verticesData,a=n.weight,s=i.length>0&&n.inheritDeform,o=this._renderDisplay,h=o.$renderNode;if(null!==a){var l=(A=n.data).intArray,u=A.floatArray,c=l[n.offset+0],p=l[a.offset+1];p<0&&(p+=65536);for(var f=0,d=0,m=a.offset+2+r.length,g=p,y=0;f<c;++f){for(var _=l[m++],v=0,b=0,T=0;T<_;++T){var x=r[l[m++]];if(null!==x){var D=x.globalTransformMatrix,$=u[g++],E=u[g++]*e,w=u[g++]*e;s&&(E+=i[y++],w+=i[y++]),v+=(D.a*E+D.c*w+D.tx)*$,b+=(D.b*E+D.d*w+D.ty)*$}}h.vertices[d++]=v,h.vertices[d++]=b}o.$updateVertices(),t.isV5||o.$invalidateTransform()}else if(s){var A,S=0!==this._parent._boneData.type,O=(l=(A=n.data).intArray,u=A.floatArray,c=l[n.offset+0],l[n.offset+2]);O<0&&(O+=65536),f=0;for(var C=2*c;f<C;f+=2){var P=u[O+f]*e+i[f],R=u[O+f+1]*e+i[f+1];S?(D=this._parent._getGlobalTransformMatrix(P,R),h.vertices[f]=D.a*P+D.c*R+D.tx,h.vertices[f+1]=D.b*P+D.d*R+D.ty):(h.vertices[f]=P,h.vertices[f+1]=R)}o.$updateVertices(),t.isV5||o.$invalidateTransform()}this._armatureDisplay._batchEnabled&&(this._armatureDisplay._childDirty=!0)},i.prototype._updateGlueMesh=function(){},i.prototype._updateTransform=function(){throw new Error},i.prototype._identityTransform=function(){if(this._armatureDisplay._batchEnabled){this._armatureDisplay._childDirty=!0;var t=this._renderDisplay.$renderNode.matrix;t.a=1,t.b=0,t.c=0,t.d=1,t.tx=0,t.ty=0}else egret.$TempMatrix.identity(),this._renderDisplay.$setMatrix(egret.$TempMatrix,this.transformUpdateEnabled)},i.prototype._updateTransformV4=function(){var t=this.globalTransformMatrix;if(this._armatureDisplay._batchEnabled)this._armatureDisplay._childDirty=!0,(e=this._renderDisplay.$renderNode.matrix).a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e.tx=this.globalTransformMatrix.tx-(this.globalTransformMatrix.a*this._pivotX+this.globalTransformMatrix.c*this._pivotY),e.ty=this.globalTransformMatrix.ty-(this.globalTransformMatrix.b*this._pivotX+this.globalTransformMatrix.d*this._pivotY);else if(this.transformUpdateEnabled)this._renderDisplay.$setMatrix(t,!0);else{var e;(e=this._renderDisplay.$DisplayObject[6]).a=this.globalTransformMatrix.a,e.b=this.globalTransformMatrix.b,e.c=this.globalTransformMatrix.c,e.d=this.globalTransformMatrix.d,e.tx=this.globalTransformMatrix.tx,e.ty=this.globalTransformMatrix.ty,this._renderDisplay.$removeFlags(8),this._renderDisplay.$invalidatePosition()}},i.prototype._updateTransformV5=function(){var t=this.globalTransformMatrix;if(this._armatureDisplay._batchEnabled){this._armatureDisplay._childDirty=!0;var e=this._renderDisplay.$renderNode.matrix;e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e.tx=this.globalTransformMatrix.tx-(this.globalTransformMatrix.a*this._pivotX+this.globalTransformMatrix.c*this._pivotY),e.ty=this.globalTransformMatrix.ty-(this.globalTransformMatrix.b*this._pivotX+this.globalTransformMatrix.d*this._pivotY)}else this._renderDisplay.$setMatrix(t,this.transformUpdateEnabled)},i}(t.Slot);t.EgretSlot=e}(a||(a={})),function(t){t.isV5=Number(egret.Capabilities.engineVersion.substr(0,3))>=5.1;var e=function(e){function i(r){void 0===r&&(r=null);var n=e.call(this,r)||this;if(null===i._dragonBonesInstance){var a=new t.EgretArmatureDisplay;i._dragonBonesInstance=new t.DragonBones(a),i._time=.001*egret.getTimer(),egret.startTick(i._clockHandler,i)}return n._dragonBones=i._dragonBonesInstance,n}return s(i,e),i._clockHandler=function(t){var e=(t*=.001)-this._time;return i._dragonBonesInstance.advanceTime(e),this._time=t,!1},Object.defineProperty(i,"factory",{get:function(){return null===i._factory&&(i._factory=new i),i._factory},enumerable:!0,configurable:!0}),i.prototype._isSupportMesh=function(){return"webgl"===egret.Capabilities.renderMode||egret.Capabilities.runtimeType===egret.RuntimeType.NATIVE||(console.warn("Canvas can not support mesh, please change renderMode to webgl."),!1)},i.prototype._buildTextureAtlasData=function(e,i){if(null!==e)if(i instanceof egret.Texture)e.renderTexture=i;else{var r=new egret.Texture;r.bitmapData=new egret.BitmapData(i),e.disposeEnabled=!0,e.renderTexture=r}else e=t.BaseObject.borrowObject(t.EgretTextureAtlasData);return e},i.prototype._buildArmature=function(e){var i=t.BaseObject.borrowObject(t.Armature),r=new t.EgretArmatureDisplay;return i.init(e.armature,r,r,this._dragonBones),i},i.prototype._buildSlot=function(e,i,r){var n=t.BaseObject.borrowObject(t.EgretSlot);return n.init(i,r,new egret.Bitmap,new egret.Mesh),n},i.prototype.buildArmatureDisplay=function(t,e,i,r){void 0===e&&(e=""),void 0===i&&(i=""),void 0===r&&(r="");var n=this.buildArmature(t,e||"",i||"",r||"");return null!==n?(this._dragonBones.clock.add(n),n.display):null},i.prototype.getTextureDisplay=function(t,e){void 0===e&&(e=null);var i=this._getTextureData(null!==e?e:"",t);if(null!==i&&null!==i.renderTexture){var r=i.renderTexture,n=new egret.Bitmap(r);return n.width=r.textureWidth*i.parent.scale,n.height=r.textureHeight*i.parent.scale,n}return null},Object.defineProperty(i.prototype,"soundEventManager",{get:function(){return this._dragonBones.eventManager},enumerable:!0,configurable:!0}),Object.defineProperty(i,"clock",{get:function(){return i.factory.clock},enumerable:!0,configurable:!0}),i.prototype.addSkeletonData=function(t,e){void 0===e&&(e=null),console.warn("已废弃"),this.addDragonBonesData(t,e)},i.prototype.getSkeletonData=function(t){return console.warn("已废弃"),this.getDragonBonesData(t)},i.prototype.removeSkeletonData=function(t){console.warn("已废弃"),this.removeDragonBonesData(t)},i.prototype.addTextureAtlas=function(t,e){void 0===e&&(e=null),console.warn("已废弃"),this.addTextureAtlasData(t,e)},i.prototype.getTextureAtlas=function(t){return console.warn("已废弃"),this.getTextureAtlasData(t)},i.prototype.removeTextureAtlas=function(t){console.warn("已废弃"),this.removeTextureAtlasData(t)},i.prototype.buildFastArmature=function(t,e,i){return void 0===e&&(e=""),void 0===i&&(i=""),console.warn("已废弃"),this.buildArmature(t,e||"",i||"")},i.prototype.dispose=function(){console.warn("已废弃"),this.clear()},i._time=0,i._dragonBonesInstance=null,i._factory=null,i}(t.BaseFactory);t.EgretFactory=e}(a||(a={})),function(t){var e=new egret.Rectangle,i=new egret.Matrix,r={};function n(t,e){for(var i=0,r=t.length;i<r;++i){var n=t[i];if(n.name===e)return n}return null}function a(e,i){void 0===i&&(i=null);var a={movieName:e,groupName:i};if(function(t){if(t.groupName&&(a=r[t.groupName])&&(i=n(a.movie||a.animation,t.movieName)))return t.groupConfig=a,t.movieConfig=i,!0;if(!t.groupName)for(var e in r){var i,a=r[e];if(!t.groupName&&(i=n(a.movie||a.animation,t.movieName)))return t.groupName=e,t.groupConfig=a,t.movieConfig=i,!0}return!1}(a)){var s=new l(a);return s.clock=t.EgretFactory.factory.clock,s}return console.warn("No movie named: "+e),null}t.hasMovieGroup=function(t){return t in r},t.addMovieGroup=function(t,e,i){if(void 0===i&&(i=null),!t)throw new Error;var n=new egret.ByteArray(t);n.endian=egret.Endian.LITTLE_ENDIAN,n.position=8;var a=JSON.parse(n.readUTF());a.offset=n.position,a.arrayBuffer=t,a.textures=[];var s=a.offset%4;s&&(a.offset+=4-s);for(var o=0,h=a.position.length;o<h;o+=3)switch(o/3){case 1:a.displayFrameArray=new Int16Array(a.arrayBuffer,a.offset+a.position[o],a.position[o+1]/a.position[o+2]);break;case 2:a.rectangleArray=new Float32Array(a.arrayBuffer,a.offset+a.position[o],a.position[o+1]/a.position[o+2]);break;case 3:a.transformArray=new Float32Array(a.arrayBuffer,a.offset+a.position[o],a.position[o+1]/a.position[o+2]);break;case 4:a.colorArray=new Int16Array(a.arrayBuffer,a.offset+a.position[o],a.position[o+1]/a.position[o+2])}if(i=i||a.name,r[i]&&console.warn("Replace group: "+i),r[i]=a,e instanceof Array)for(o=0,h=e.length;o<h;++o){var l=e[o];a.textures.push(l)}else a.textures.push(e)},t.removeMovieGroup=function(t){r[t]&&delete r[t]},t.removeAllMovieGroup=function(){for(var t in r)delete r[t]},t.buildMovie=a,t.getMovieNames=function(t){var e=r[t];if(e){for(var i=[],n=e.movie||e.animation,a=0,s=n.length;a<s;++a)i.push(n[a].name);return i}return console.warn("No group named: "+t),null};var o=function(t){function e(e){var i=t.call(this,e)||this;return i.name="",i.slotName="",i.clipName="",i}return s(e,t),Object.defineProperty(e.prototype,"armature",{get:function(){return this.movie},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bone",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"animationState",{get:function(){return{name:this.clipName}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"frameLabel",{get:function(){return this.name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"movementID",{get:function(){return this.clipName},enumerable:!0,configurable:!0}),e.START="start",e.LOOP_COMPLETE="loopComplete",e.COMPLETE="complete",e.FRAME_EVENT="frameEvent",e.SOUND_EVENT="soundEvent",e}(egret.Event);t.MovieEvent=o;var h=function(t){function e(e){var i=t.call(this)||this;return i.displayIndex=-1,i.colorIndex=-1,i.transformIndex=-1,i.rawDisplay=new egret.Bitmap,i.childMovies={},i.displayConfig=null,i.childMovie=null,i.colorFilter=null,i.display=i.rawDisplay,i.config=e,i.rawDisplay.name=i.config.name,i.config.blendMode||(i.config.blendMode=0),i}return s(e,t),e.prototype.dispose=function(){this.rawDisplay=null,this.childMovies=null,this.config=null,this.displayConfig=null,this.display=null,this.childMovie=null,this.colorFilter=null},e}(egret.HashObject),l=function(r){function n(t){var e=r.call(this)||this;e.timeScale=1,e.clipTimeScale=1,e._batchEnabled=!0,e._isLockDispose=!1,e._isDelayDispose=!1,e._isStarted=!1,e._isPlaying=!1,e._isReversing=!1,e._isCompleted=!1,e._playTimes=0,e._time=0,e._currentTime=0,e._currentPlayTimes=0,e._cacheFrameIndex=0,e._frameSize=0,e._cacheRectangle=null,e._clock=null,e._currentFrameConfig=null,e._clipNames=[],e._slots=[],e._childMovies=[],e._groupConfig=t.groupConfig,e._config=t.movieConfig,e._batchEnabled=!(e._config.isNested||e._config.hasChildAnimation),e._batchEnabled&&(e.$renderNode=new egret.sys.GroupNode,e.$renderNode.cleanBeforeRender=n._cleanBeforeRender),e._clipNames.length=0;for(var i=0,a=e._config.clip.length;i<a;++i)e._clipNames.push(e._config.clip[i].name);for(i=0,a=e._config.slot.length;i<a;++i){var s=new h(e._config.slot[i]);e._updateSlotBlendMode(s),e._slots.push(s),e._batchEnabled?e.$renderNode.addNode(s.rawDisplay.$renderNode):e.addChild(s.rawDisplay)}return e._frameSize=2*e._slots.length,e.name=e._config.name,e.play(),e.advanceTime(1e-6),e.stop(),e}return s(n,r),n._cleanBeforeRender=function(){},n.prototype._configToEvent=function(t,e){e.movie=this,e.clipName=this._clipConfig.name,e.name=t.name,e.slotName=t.slot||""},n.prototype._onCrossFrame=function(e){for(var i=0,r=e.actionAndEvent.length;i<r;++i){var n=e.actionAndEvent[i];if(n)switch(n.type){case 11:if(t.EgretFactory.factory.soundEventManager.hasEventListener(o.SOUND_EVENT)){var a=egret.Event.create(o,o.SOUND_EVENT);this._configToEvent(n,a),t.EgretFactory.factory.soundEventManager.dispatchEvent(a),egret.Event.release(a)}break;case 10:if(this.hasEventListener(o.FRAME_EVENT)){var s=egret.Event.create(o,o.FRAME_EVENT);this._configToEvent(n,s),this.dispatchEvent(s),egret.Event.release(s)}break;case 0:if(n.slot){var h=this._getSlot(n.slot);h&&h.childMovie&&h.childMovie.play(n.name)}else this.play(n.name)}}},n.prototype._updateSlotBlendMode=function(t){var e="";switch(t.config.blendMode){case 0:e=egret.BlendMode.NORMAL;break;case 1:e=egret.BlendMode.ADD;break;case 5:e=egret.BlendMode.ERASE}e&&(this._batchEnabled?t.display.$renderNode.blendMode=egret.sys.blendModeToNumber(e):t.display.blendMode=e)},n.prototype._updateSlotColor=function(t,e,i,r,n,a,s,o,h){if(1!==i||1!==r||1!==n||0!==s||0!==o||0!==h||0!==a){t.colorFilter||(t.colorFilter=new egret.ColorMatrixFilter);var l=t.colorFilter.matrix;if(l[0]=i,l[6]=r,l[12]=n,l[18]=e,l[4]=s,l[9]=o,l[14]=h,l[19]=a,t.colorFilter.matrix=l,this._batchEnabled)t.display.$renderNode.filter=t.colorFilter,t.display.$renderNode.alpha=1;else{var u=t.display.filters;u||(u=[]),u.indexOf(t.colorFilter)<0&&u.push(t.colorFilter),t.display.filters=u,t.display.$setAlpha(1)}}else t.colorFilter&&(t.colorFilter=null),this._batchEnabled?(t.display.$renderNode.filter=null,t.display.$renderNode.alpha=e):(t.display.filters=null,t.display.$setAlpha(e))},n.prototype._updateSlotDisplay=function(e){var i=e.display||e.rawDisplay,r=e.childMovie;if(e.displayIndex>=0)if(e.displayConfig=this._groupConfig.display[e.displayIndex],1===e.displayConfig.type){var n=e.displayConfig.name in e.childMovies?e.childMovies[e.displayConfig.name]:null;n||(n=a(e.displayConfig.name,this._groupConfig.name))&&(e.childMovies[e.displayConfig.name]=n),n?(e.display=n,e.childMovie=n):(e.display=e.rawDisplay,e.childMovie=null)}else e.display=e.rawDisplay,e.childMovie=null;else e.displayConfig=null,e.display=e.rawDisplay,e.childMovie=null;if(e.display!==i&&(i&&(this.addChild(e.display),this.swapChildren(e.display,i),this.removeChild(i)),this._updateSlotBlendMode(e)),e.display===e.rawDisplay)if(e.displayConfig&&null!==e.displayConfig.regionIndex&&void 0!==e.displayConfig.regionIndex){if(!e.displayConfig.texture){var s=this._groupConfig.textures[e.displayConfig.textureIndex||0],o=4*e.displayConfig.regionIndex,h=this._groupConfig.rectangleArray[o],l=this._groupConfig.rectangleArray[o+1],u=this._groupConfig.rectangleArray[o+2],c=this._groupConfig.rectangleArray[o+3];e.displayConfig.texture=new egret.Texture,e.displayConfig.texture.bitmapData=s.bitmapData,e.displayConfig.texture.$initData(h,l,Math.min(u,s.textureWidth-h),Math.min(c,s.textureHeight-l),0,0,Math.min(u,s.textureWidth-h),Math.min(c,s.textureHeight-l),s.textureWidth,s.textureHeight)}if(this._batchEnabled){var p=e.displayConfig.texture,f=e.rawDisplay.$renderNode;if(egret.sys.RenderNode.prototype.cleanBeforeRender.call(e.rawDisplay.$renderNode),f.image=p.bitmapData,t.isV5)f.drawImage(p.$bitmapX,p.$bitmapY,p.$bitmapWidth,p.$bitmapHeight,p.$offsetX,p.$offsetY,p.textureWidth,p.textureHeight),f.imageWidth=p._sourceWidth,f.imageHeight=p._sourceHeight;else{var d=p;f.drawImage(d._bitmapX,d._bitmapY,d._bitmapWidth,d._bitmapHeight,d._offsetX,d._offsetY,p.textureWidth,p.textureHeight),f.imageWidth=d._sourceWidth,f.imageHeight=d._sourceHeight}}else e.rawDisplay.visible=!0,e.rawDisplay.$setBitmapData(e.displayConfig.texture)}else this._batchEnabled?e.rawDisplay.$renderNode.image=null:(e.rawDisplay.visible=!1,e.rawDisplay.$setBitmapData(null));e.childMovie!==r&&(r&&(r.stop(),this._childMovies.slice(this._childMovies.indexOf(r),1)),e.childMovie&&(this._childMovies.indexOf(e.childMovie)<0&&this._childMovies.push(e.childMovie),e.config.action?e.childMovie.play(e.config.action):e.childMovie.play(e.childMovie._config.action)))},n.prototype._getSlot=function(t){for(var e=0,i=this._slots.length;e<i;++e){var r=this._slots[e];if(r.config.name===t)return r}return null},n.prototype.$render=function(){this._batchEnabled||r.prototype.$render.call(this)},n.prototype.$updateRenderNode=function(){this._batchEnabled||r.prototype.$updateRenderNode.call(this)},n.prototype.$measureContentBounds=function(t){this._batchEnabled&&this._cacheRectangle?t.setTo(this._cacheRectangle.x,this._cacheRectangle.y,this._cacheRectangle.width-this._cacheRectangle.x,this._cacheRectangle.height-this._cacheRectangle.y):r.prototype.$measureContentBounds.call(this,t)},n.prototype.$doAddChild=function(t,e,i){return this._batchEnabled?(console.warn("Can not add child."),null):r.prototype.$doAddChild.call(this,t,e,i)},n.prototype.$doRemoveChild=function(t,e){return this._batchEnabled?(console.warn("Can not remove child."),null):r.prototype.$doRemoveChild.call(this,t,e)},n.prototype.dispose=function(){if(this._isLockDispose)this._isDelayDispose=!0;else{if(this._clock&&this._clock.remove(this),this._slots)for(var t=0,e=this._slots.length;t<e;++t)this._slots[t].dispose();this._isPlaying=!1,this._cacheRectangle=null,this._clock=null,this._groupConfig=null,this._config=null,this._clipConfig=null,this._currentFrameConfig=null,this._clipArray=null,this._clipNames=null,this._slots=null,this._childMovies=null}},n.prototype.advanceTime=function(r){if(this._isPlaying){this._isLockDispose=!0,r<0&&(r=-r),r*=this.timeScale,this._time+=r*this.clipTimeScale;var n=this._clipConfig.duration,a=n*this._playTimes,s=this._time,h=this._currentPlayTimes;if(this._playTimes>0&&(s>=a||s<=-a)?(this._isCompleted=!0,h=this._playTimes,s=s<0?0:n):(this._isCompleted=!1,s<0?(h=Math.floor(-s/n),s=n- -s%n):(h=Math.floor(s/n),s%=n),this._playTimes>0&&h>this._playTimes&&(h=this._playTimes)),this._currentTime===s)return;var l=Math.floor(s*this._clipConfig.cacheTimeToFrameScale);if(this._cacheFrameIndex!==l){this._cacheFrameIndex=l;var u=this._groupConfig.displayFrameArray,c=this._groupConfig.transformArray,p=this._groupConfig.colorArray,f=!0,d=!1,m=!1,g=this._cacheRectangle;this._cacheRectangle=this._clipConfig.cacheRectangles[this._cacheFrameIndex],this._batchEnabled&&!this._cacheRectangle&&(m=!0,this._cacheRectangle=new egret.Rectangle,this._clipConfig.cacheRectangles[this._cacheFrameIndex]=this._cacheRectangle);for(var y=0,_=this._slots.length;y<_;++y){var v=this._slots[y],b=this._frameSize*this._cacheFrameIndex+2*y;b>=this._clipArray.length&&(b=this._frameSize*(this._cacheFrameIndex-1)+2*y);var T=2*this._clipArray[b];if(T>=0){var x=u[T],D=8*u[T+1],$=6*this._clipArray[b+1],E=!1;if(v.displayIndex!==x&&(v.displayIndex=x,E=!0,this._updateSlotDisplay(v)),(v.colorIndex!==D||E)&&(v.colorIndex=D,v.colorIndex>=0?this._updateSlotColor(v,.01*p[D],.01*p[D+1],.01*p[D+2],.01*p[D+3],p[D+4],p[D+5],p[D+6],p[D+7]):this._updateSlotColor(v,1,1,1,1,0,0,0,0)),d=!0,v.transformIndex!==$&&(v.transformIndex=$,this._batchEnabled?((w=v.display.$renderNode.matrix)||(w=v.display.$renderNode.matrix=new egret.Matrix),w.a=c[$],w.b=c[$+1],w.c=c[$+2],w.d=c[$+3],w.tx=c[$+4],w.ty=c[$+5]):(i.a=c[$],i.b=c[$+1],i.c=c[$+2],i.d=c[$+3],i.tx=c[$+4],i.ty=c[$+5],v.display.$setMatrix(i))),this._batchEnabled&&m&&v.displayConfig){var w=v.display.$renderNode.matrix;e.x=0,e.y=0,e.width=v.displayConfig.texture.textureWidth,e.height=v.displayConfig.texture.textureHeight,w.$transformBounds(e),f?(f=!1,this._cacheRectangle.x=e.x,this._cacheRectangle.width=e.x+e.width,this._cacheRectangle.y=e.y,this._cacheRectangle.height=e.y+e.height):(this._cacheRectangle.x=Math.min(this._cacheRectangle.x,e.x),this._cacheRectangle.width=Math.max(this._cacheRectangle.width,e.x+e.width),this._cacheRectangle.y=Math.min(this._cacheRectangle.y,e.y),this._cacheRectangle.height=Math.max(this._cacheRectangle.height,e.y+e.height))}}else-1!==v.displayIndex&&(v.displayIndex=-1,this._updateSlotDisplay(v))}this._cacheRectangle&&(d&&m&&f&&g&&(this._cacheRectangle.x=g.x,this._cacheRectangle.y=g.y,this._cacheRectangle.width=g.width,this._cacheRectangle.height=g.height),t.isV5||this.$invalidateContentBounds())}if(this._isCompleted&&(this._isPlaying=!1),!this._isStarted&&(this._isStarted=!0,this.hasEventListener(o.START))){var A=egret.Event.create(o,o.START);A.movie=this,A.clipName=this._clipConfig.name,A.name="",A.slotName="",this.dispatchEvent(A)}this._isReversing=this._currentTime>s&&this._currentPlayTimes===h,this._currentTime=s;var S=this._clipConfig.frame?this._clipConfig.frame.length:0;if(S>0){var O=Math.floor(this._currentTime*this._config.frameRate),C=this._groupConfig.frame[this._clipConfig.frame[O]];if(this._currentFrameConfig!==C)if(S>1){var P=this._currentFrameConfig;if(this._currentFrameConfig=C,!P){var R=Math.floor(this._currentTime*this._config.frameRate);P=this._groupConfig.frame[this._clipConfig.frame[R]],this._isReversing||(this._currentTime<=P.position||this._currentPlayTimes!==h)&&(P=this._groupConfig.frame[P.prev])}if(this._isReversing)for(;P!==C;)this._onCrossFrame(P),P=this._groupConfig.frame[P.prev];else for(;P!==C;)P=this._groupConfig.frame[P.next],this._onCrossFrame(P)}else this._currentFrameConfig=C,this._currentFrameConfig&&this._onCrossFrame(this._currentFrameConfig)}if(this._currentPlayTimes!==h){if(this._currentPlayTimes=h,this.hasEventListener(o.LOOP_COMPLETE)){var M=egret.Event.create(o,o.LOOP_COMPLETE);M.movie=this,M.clipName=this._clipConfig.name,M.name="",M.slotName="",this.dispatchEvent(M),egret.Event.release(M)}if(this._isCompleted&&this.hasEventListener(o.COMPLETE)){var I=egret.Event.create(o,o.COMPLETE);I.movie=this,I.clipName=this._clipConfig.name,I.name="",I.slotName="",this.dispatchEvent(I),egret.Event.release(I)}}}this._isLockDispose=!1,this._isDelayDispose&&this.dispose()},n.prototype.play=function(t,e){if(void 0===t&&(t=null),void 0===e&&(e=-1),t){for(var i=null,r=0,n=this._config.clip.length;r<n;++r){var a=this._config.clip[r];a.name===t&&(i=a)}i?(this._clipConfig=i,this._clipArray=new Int16Array(this._groupConfig.arrayBuffer,this._groupConfig.offset+this._groupConfig.position[0]+this._clipConfig.p,this._clipConfig.s/this._groupConfig.position[2]),this._clipConfig.cacheRectangles||(this._clipConfig.cacheRectangles=[]),this._isPlaying=!0,this._isStarted=!1,this._isCompleted=!1,this._playTimes=e<0||e!=e?this._clipConfig.playTimes:e,this._time=0,this._currentTime=0,this._currentPlayTimes=0,this._cacheFrameIndex=-1,this._currentFrameConfig=null,this._cacheRectangle=null,this.clipTimeScale=1/this._clipConfig.scale):console.warn("No clip in movie.",this._config.name,t)}else this._clipConfig?this._isPlaying||this._isCompleted?this.play(this._clipConfig.name,this._playTimes):this._isPlaying=!0:this._config.action&&this.play(this._config.action,e)},n.prototype.stop=function(){this._isPlaying=!1},n.prototype.gotoAndPlay=function(t,e,i){void 0===t&&(t=null),void 0===i&&(i=-1),(e%=this._clipConfig.duration)<0&&(e+=this._clipConfig.duration),this.play(t,i),this._time=e,this._currentTime=e},n.prototype.gotoAndStop=function(t,e){void 0===t&&(t=null),(e%=this._clipConfig.duration)<0&&(e+=this._clipConfig.duration),this.play(t,1),this._time=e,this._currentTime=e,this.advanceTime(.001),this.stop()},n.prototype.hasClip=function(t){for(var e=0,i=this._config.clip.length;e<i;++e)if(this._config.clip[e].name===t)return!0;return!1},Object.defineProperty(n.prototype,"isPlaying",{get:function(){return this._isPlaying&&!this._isCompleted},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isComplete",{get:function(){return this._isCompleted},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"currentTime",{get:function(){return this._currentTime},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"totalTime",{get:function(){return this._clipConfig?this._clipConfig.duration:0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"currentPlayTimes",{get:function(){return this._currentPlayTimes},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"playTimes",{get:function(){return this._playTimes},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"groupName",{get:function(){return this._groupConfig.name},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"clipName",{get:function(){return this._clipConfig?this._clipConfig.name:""},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"clipNames",{get:function(){return this._clipNames},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"clock",{get:function(){return this._clock},set:function(t){if(this._clock!==t){var e=this._clock;e&&e.remove(this),this._clock=t,this._clock&&this._clock.add(this)}},enumerable:!0,configurable:!0}),n.prototype.advanceTimeBySelf=function(e){this.clock=e?t.EgretFactory.clock:null},Object.defineProperty(n.prototype,"display",{get:function(){return this},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"animation",{get:function(){return this},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"armature",{get:function(){return this},enumerable:!0,configurable:!0}),n.prototype.getAnimation=function(){return this},n.prototype.getArmature=function(){return this},n.prototype.getDisplay=function(){return this},n.prototype.hasAnimation=function(t){return this.hasClip(t)},n.prototype.invalidUpdate=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},Object.defineProperty(n.prototype,"lastAnimationName",{get:function(){return this.clipName},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"animationNames",{get:function(){return this.clipNames},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"animationList",{get:function(){return this.clipNames},enumerable:!0,configurable:!0}),n}(egret.DisplayObjectContainer);t.Movie=l}(a||(a={})),window.dragonBones=a},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){return!!function(t){var e=t.el||window.document.querySelector("body");if(!window.document.createElement("canvas").getContext("webgl"))return console.error("当前浏览器版本不支持webgl，请升级或切换浏览器"),e.innerHTML="当前浏览器版本不支持webgl，请升级或切换浏览器",!1;if(window.document.getElementById("egret-player"))return console.error("id为：“egret-player” 的场景挂载元素已经被占用！"),!1;var i=window.document.createElement("div");i.setAttribute("style","width: "+t.width+"px;height: "+t.height+"px; position: absolute; z-index: -1;right: 0px;bottom: 0px"),i.setAttribute("id","egret-player");var r=window.document.createElement("div");return r.setAttribute("style","margin: auto;width: "+t.width+"px;height: "+t.height+"px;"),r.setAttribute("class","egret-player"),r.setAttribute("data-entry-class","EgretMain"),r.setAttribute("data-orientation","auto"),r.setAttribute("data-scale-mode","showAll"),r.setAttribute("data-frame-rate","30"),r.setAttribute("data-content-width",t.width+""),r.setAttribute("data-content-height",t.height+""),r.setAttribute("data-multi-fingered","2"),r.setAttribute("data-show-fps","false"),r.setAttribute("data-show-log","false"),r.setAttribute("data-show-fps-style","x:0,y:0,size:12,textColor:0xffffff,bgAlpha:0.9"),i.appendChild(r),e.appendChild(i),!0}(t)&&(egret.runEgret({renderMode:"webgl",audioType:0,calculateCanvasScaleFactor:function(t){var e=t.backingStorePixelRatio||t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return(window.devicePixelRatio||1)/e}}),!0)}},function(t,e,i){"use strict";var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var a=i(8),s=i(9),o=i(10),h=i(11),l=function(t){function e(e){var i=t.call(this)||this;return i.animList=[],i.delayTime=0,i.runTime=0,i.addEventListener(egret.Event.ADDED_TO_STAGE,function(){i.doStart(e)},i),i}return n(e,t),e.prototype.doStart=function(t,e){this.initConfig=t,this.initDinoConfig(),this.initConfig.showLoading&&(this.loading=new o.default,this.loading.show()),this._loadResources(),e&&this.stage.setContentSize(this.initConfig.width,this.initConfig.height)},e.prototype._loadResources=function(){"string"==typeof this.initConfig.resources?(RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig(this.initConfig.resources,this.initConfig.resRootPath)):(this.resourcesArrHttp=this.initConfig.resources,this.preLoad()),egret.ImageLoader.crossOrigin="anonymous"},e.prototype.preLoad=function(){var t=new a.default("preload");if(this.resourcesArrHttp.length>0){for(var e=this.resourcesArrHttp,i=0;i<e.length;i++){switch(e[i].url=e[i].url.replace(this.initConfig.resRootPath,""),e[i].type="dbbin"===e[i].type?"bin":e[i].type,e[i].type){case"json":e[i].name="dino_json";break;case"bin":e[i].name="dino_bin";break;case"image":e[i].name="dino_image"}t.createResourcesItem({name:e[i].name,type:e[i].type,url:e[i].url})}RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("defaultRes.json",this.initConfig.resRootPath,t.getConfig())}else this.initConfig.errorHandle({msg:"没有配置预加载资源"})},e.prototype.onConfigComplete=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.loadGroup("preload")},e.prototype.onResourceLoadComplete=function(t){"preload"===t.groupName?(RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),this.createGameScene()):(!this.initConfig.errorHandle||this.initConfig.errorHandle({msg:"资源加载失败"}),!this.initConfig.complete||this.initConfig.complete(!1))},e.prototype.onResourceLoadError=function(t){!this.initConfig.errorHandle||this.initConfig.errorHandle({msg:"资源加载失败"}),!this.initConfig.complete||this.initConfig.complete(!1),this.initConfig.showLoading&&this.loading.remove()},e.prototype.createGameScene=function(){var t=this,e=RES.getRes("dino_bin"),i=RES.getRes("dino_json"),r=RES.getRes("dino_image");this._factory=new dragonBones.EgretFactory,this._factory.parseDragonBonesData(e),this._factory.parseTextureAtlasData(i,r),this.baseBonesDataName=this.initConfig.dragonboneName||(e.armature?e.armature[0].name:"Armature"),this._armatureDisplay=this._factory.buildArmatureDisplay(this.baseBonesDataName);var n=this.initConfig.initSkinData||null;this.dinoReplaceSkin=new h.default(n,function(){t.animationNames=t._armatureDisplay.animation.animationNames||[],t.initConfig.initAnimNames.normalAnim=-1!==t.animationNames.indexOf(t.initConfig.initAnimNames.normalAnim)?t.initConfig.initAnimNames.normalAnim:"global_standard",t.setDinoPosition(),t._armatureDisplay.touchEnabled=!0,t.showDinoInPage(t.initConfig.positionConfig),t.initConfig.showLoading&&t.loading.remove(),t.touchHelper=new s.default(t.stage,"touchHander",t),t.touchHelper.enableTouch(),n&&(!t.initConfig.complete||t.initConfig.complete(!0))},this),n||!this.initConfig.complete||this.initConfig.complete(!0)},e.prototype.initDinoConfig=function(){this.initConfig.turnRound=this.initConfig.turnRound||!1,this.initConfig.showLoading=this.initConfig.showLoading||!1,this.initConfig.isAgreeClick=this.initConfig.isAgreeClick||!1,this.initConfig.scale=this.initConfig.scale||.3,this.initConfig.centrePoint=this.initConfig.centrePoint&&2===this.initConfig.centrePoint.length?this.initConfig.centrePoint:[this.initConfig.width/2,this.initConfig.height/2],this.initConfig.errorHandle=this.initConfig.errorHandle||function(t){},this.initConfig.tapHandle=this.initConfig.tapHandle||function(t){},this.initConfig.positionConfig=this.initConfig.positionConfig||{"z-index":1}},e.prototype.showDinoInPage=function(t){var e,i=this.initConfig.width+"px",r=this.initConfig.height+"px",n=window.document.getElementById("egret-player"),a="";for(var s in t){switch(s){case"z-index":e=t["z-index"]||-1;break;case"left":e=t.left||0;break;case"top":e=t.top||0;break;case"right":e=t.right||0;break;case"bottom":e=t.bottom||0}a+=s+":"+e+";"}a+="position: absolute; overflow: hidden;width: "+i+"; height: "+r+";",n.setAttribute("style",a)},e.prototype.setDinoPosition=function(){this._armatureDisplay.x=this.initConfig.centrePoint[0],this._armatureDisplay.y=this.initConfig.centrePoint[1],this.initConfig.turnRound?this._armatureDisplay.scaleX=-this.initConfig.scale:this._armatureDisplay.scaleX=this.initConfig.scale,this._armatureDisplay.scaleY=this.initConfig.scale},e.prototype.touchHander=function(t,e){switch(t){case"moveToLeft":if(this.filterAnimName(this.initConfig.initAnimNames.toLeftAnim)&&this.initConfig.isAgreeClick){if(!this.isAgreeDoAnim())return void this.initConfig.tapHandle("click");this._armatureDisplay.animation.fadeIn(this.initConfig.initAnimNames.toLeftAnim,.3,1),this._armatureDisplay.addEventListener(dragonBones.EventObject.COMPLETE,this.playComplete,this),this.initConfig.tapHandle("moveToLeft")}break;case"moveToRight":if(this.filterAnimName(this.initConfig.initAnimNames.toRightAnim)&&this.initConfig.isAgreeClick){if(!this.isAgreeDoAnim())return void this.initConfig.tapHandle("click");this._armatureDisplay.animation.fadeIn(this.initConfig.initAnimNames.toRightAnim,.3,1),this._armatureDisplay.addEventListener(dragonBones.EventObject.COMPLETE,this.playComplete,this),this.initConfig.tapHandle("moveToRight")}break;case"click":this.onClickFun(e)}},e.prototype.onClickFun=function(t){if(this._armatureDisplay.armature.getSlot("head_boundingBox").containsPoint((t.stageX-this.initConfig.centrePoint[0])/this.initConfig.scale,(t.stageY-this.initConfig.centrePoint[1])/this.initConfig.scale)){if(!this.initConfig.isAgreeClick||!this.filterAnimName(this.initConfig.initAnimNames.clickHeadAnim)||!this.isAgreeDoAnim())return void this.initConfig.tapHandle("click");this._armatureDisplay.animation.fadeIn(this.initConfig.initAnimNames.clickHeadAnim,.3,1),this._armatureDisplay.addEventListener(dragonBones.EventObject.COMPLETE,this.playComplete,this),this.initConfig.tapHandle("clickHead")}else if(this._armatureDisplay.armature.getSlot("body_boundingBox").containsPoint((t.stageX-this.initConfig.centrePoint[0])/this.initConfig.scale,(t.stageY-this.initConfig.centrePoint[1])/this.initConfig.scale)){if(!this.initConfig.isAgreeClick||!this.filterAnimName(this.initConfig.initAnimNames.clickBodyAnim)||!this.isAgreeDoAnim())return void this.initConfig.tapHandle("click");this._armatureDisplay.animation.fadeIn(this.initConfig.initAnimNames.clickBodyAnim,.3,1),this._armatureDisplay.addEventListener(dragonBones.EventObject.COMPLETE,this.playComplete,this),this.initConfig.tapHandle("clickBody")}},e.prototype.isAgreeDoAnim=function(){return 0===this.animList.length&&this._armatureDisplay.animation.isPlaying&&this._armatureDisplay.animation.lastAnimationName===this.initConfig.initAnimNames.normalAnim},e.prototype.playComplete=function(){this._armatureDisplay.animation.play(this.initConfig.initAnimNames.normalAnim),this._armatureDisplay.hasEventListener(dragonBones.EventObject.COMPLETE)&&this._armatureDisplay.removeEventListener(dragonBones.EventObject.COMPLETE,this.playComplete,this)},e.prototype.play=function(t){-1===this.animationNames.indexOf(t)&&this.initConfig.errorHandle({msg:"骨骼动画列表内不存在该动作："+t}),this._armatureDisplay.animation.play(t)},e.prototype.playOnce=function(t,e,i){-1===this.animationNames.indexOf(t)&&this.initConfig.errorHandle({msg:"骨骼动画列表内不存在该动作："+t}),this.completeFn=i||function(){},e&&e>0?(this._armatureDisplay.animation.play(t),this.myTimer=new egret.Timer(e),this.myTimer.addEventListener(egret.TimerEvent.TIMER,this.playOnceComplete,this),this.myTimer.start()):(this._armatureDisplay.animation.play(t,1),this._armatureDisplay.addEventListener(dragonBones.EventObject.COMPLETE,this.playOnceComplete,this))},e.prototype.playOnceComplete=function(){this.clearAnim(!1),this.completeFn()},e.prototype.initAnimList=function(t){for(var e=0;e<t.length;e++)this.filterAnimName(t[e].animName)&&this.animList.push(t[e])},e.prototype.filterAnimName=function(t){return!!this&&(this.animationNames=this.animationNames||[],-1!==this.animationNames.indexOf(t)||(!this._armatureDisplay||this._armatureDisplay.animation.play(this.initConfig.initAnimNames.normalAnim),this.initConfig.errorHandle({msg:"骨骼动画列表内不存在该动作："+t}),!1))},e.prototype.playAnimList=function(t,e){0!==this.animList.length&&(this.itemCompleteFn=e||function(){},this.delayTime=t[0].delayTime||0,this.runTime=t[0].runTime||0,this.runTime?(this._armatureDisplay.animation.play(t[0].animName),this.myTimer=new egret.Timer(this.runTime),this.myTimer.addEventListener(egret.TimerEvent.TIMER,this.playItemCompleteFn,this),this.myTimer.start()):(this._armatureDisplay.animation.play(t[0].animName,1),this._armatureDisplay.addEventListener(dragonBones.EventObject.COMPLETE,this.playItemCompleteFn,this)))},e.prototype.onTimer=function(){this.myTimer.removeEventListener(egret.TimerEvent.TIMER,this.onTimer,this),this.myTimer.stop(),this.playAnimList(this.animList,this.itemCompleteFn)},e.prototype.playItemCompleteFn=function(){this.clearAnim(!1),this._armatureDisplay.animation.play(this.initConfig.initAnimNames.normalAnim),this.itemCompleteFn(this.animList[0]),this.animList.shift(),0!==this.animList.length&&(this.delayTime?(this.myTimer=new egret.Timer(this.delayTime),this.myTimer.addEventListener(egret.TimerEvent.TIMER,this.onTimer,this),this.myTimer.start()):this.playAnimList(this.animList,this.itemCompleteFn))},e.prototype.loopRandomAnim=function(t,e){this.initConfig.initAnimNames.loopAnim=t,this.loopTimer=this.loopTimer||new egret.Timer(e),this.loopTimer.addEventListener(egret.TimerEvent.TIMER,this.onLoopTimer,this),this.loopTimer.start()},e.prototype.clearLoopRandomAnim=function(){this.loopTimer&&this.loopTimer.hasEventListener(egret.TimerEvent.TIMER)&&(this.loopTimer.removeEventListener(egret.TimerEvent.TIMER,this.onLoopTimer,this),this.loopTimer.stop())},e.prototype.onLoopTimer=function(){this.isAgreeDoAnim()&&(this._armatureDisplay.animation.play(this.initConfig.initAnimNames.loopAnim,1),this._armatureDisplay.addEventListener(dragonBones.EventObject.COMPLETE,this.loopTimerComplete,this),this.loopTimer.stop())},e.prototype.loopTimerComplete=function(){this.playComplete(),this.loopTimer.start()},e.prototype.clearAnim=function(t){this._armatureDisplay.animation.play(this.initConfig.initAnimNames.normalAnim),t&&(this.animList=[]),this._armatureDisplay.hasEventListener(dragonBones.EventObject.COMPLETE)&&(this._armatureDisplay.removeEventListener(dragonBones.EventObject.COMPLETE,this.playOnceComplete,this),this._armatureDisplay.removeEventListener(dragonBones.EventObject.COMPLETE,this.playItemCompleteFn,this)),this.myTimer&&this.myTimer.hasEventListener(egret.TimerEvent.TIMER)&&(this.myTimer.removeEventListener(egret.TimerEvent.TIMER,this.playOnceComplete,this),this.myTimer.removeEventListener(egret.TimerEvent.TIMER,this.playItemCompleteFn,this),this.myTimer.stop())},e.prototype.replaceSkin=function(t,e){this.dinoReplaceSkin._replaceSkin(t,e)},e.prototype.removeSkin=function(t){this.dinoReplaceSkin._removeSkin(t)},e}(egret.DisplayObjectContainer);e.default=l},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t){this.groups=[],this.resources=[],this.types=["image","json","text","xml","sheet","font","bin","sound"],this.groups.push({keys:"",name:t})}return t.prototype.createResourcesItem=function(t){-1!==this.types.indexOf(t.type)?(this.groups[0].keys+=t.name+",",this.resources.push(t)):console.error("文件类型配置错误")},t.prototype.getConfig=function(){return this.groups[0].keys=this.groups[0].keys.slice(0,-1),JSON.stringify({groups:this.groups,resources:this.resources})},t}();e.default=r},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e,i){this.displayObject=t,this.handerFnName=e,this.targetContext=i}return t.prototype.enableTouch=function(){this.displayObject.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this._touchHelper,this),this.displayObject.addEventListener(egret.TouchEvent.TOUCH_END,this._touchHelper,this)},t.prototype.disableTouch=function(){this.displayObject.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this._touchHelper,this),this.displayObject.removeEventListener(egret.TouchEvent.TOUCH_END,this._touchHelper,this)},t.prototype._touchHelper=function(t){switch(t.stopPropagation(),t.type){case egret.TouchEvent.TOUCH_BEGIN:this.touchPointX=t.stageX;break;case egret.TouchEvent.TOUCH_END:this.touchPointX-t.stageX>5?this.targetContext[this.handerFnName]("moveToLeft"):t.stageX-this.touchPointX>5?this.targetContext[this.handerFnName]("moveToRight"):this.targetContext[this.handerFnName]("click",t)}},t}();e.default=r},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(){this.createLoading()}return t.prototype.createLoading=function(){this.parentNode=document.getElementById("egret-player");var t=document.createElementNS("http://www.w3.org/2000/svg","svg"),e=document.createElementNS("http://www.w3.org/2000/svg","path"),i=document.createElementNS("http://www.w3.org/2000/svg","animateTransform");t.setAttribute("style","position: absolute;width:50%;height:50%;left:25%;top:25%;"),t.setAttribute("viewBox","0 0 100 100"),t.setAttribute("xmlns","http://www.w3.org/2000/svg"),t.setAttribute("preserveAspectRatio","xMidYMid"),e.setAttribute("stroke","none"),e.setAttribute("d","M10 50A40 40 0 0 0 90 50A40 42 0 0 1 10 50"),e.setAttribute("fill","#fcb711"),e.setAttribute("transform","rotate(311.095 50 51)"),i.setAttribute("attributeName","transform"),i.setAttribute("type","rotate"),i.setAttribute("calcMode","linear"),i.setAttribute("values","0 50 51;360 50 51"),i.setAttribute("keyTimes","0;1"),i.setAttribute("dur","1s"),i.setAttribute("begin","0s"),i.setAttribute("repeatCount","indefinite"),e.appendChild(i),t.appendChild(e),this.loadingNode=t},t.prototype.show=function(){!this.parentNode||this.parentNode.appendChild(this.loadingNode)},t.prototype.remove=function(){!this.parentNode||this.parentNode.removeChild(this.loadingNode)},t}();e.default=r},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e,i){var r=this;this._loadCount=0,this._suitConfigs=[],this._resources=[],this._resourceMap={},this.nowData={},this.errorItems=[],this.errorUrls=[],this.baseDino=i,t?(this.initData=t,this._InitLoadResources(this.initData),this._loadResources(function(t){t&&r._onStart(r.initData),e()})):e()}return t.prototype._onStart=function(t){var e;for(var i in t)if(-1===this.errorItems.indexOf(i)){for(var r=void 0,n=void 0,a=void 0,s=0;s<t[i].length&&!(e=-1!==this.errorUrls.indexOf(t[i][s].url));s++)switch(t[i][s].type){case"json":n=t[i][s].url;break;case"image":a=t[i][s].url;break;case"bin":case"dbbin":r=t[i][s].url}e||(this._resourceMap[r].hasParse||(this.baseDino._factory.parseDragonBonesData(this._resourceMap[r].data),this._resourceMap[r].hasParse=!0),this._resourceMap[n].hasParse||this._resourceMap[a].hasParse||(this.baseDino._factory.parseTextureAtlasData(this._resourceMap[n].data,this._resourceMap[a].data),this._resourceMap[n].hasParse=this._resourceMap[a].hasParse=!0))}for(var o=0,h=this._suitConfigs;o<h.length;o++){var l=h[o],u=this.baseDino._factory.getArmatureData(l);u?this.baseDino._factory.replaceSkin(this.baseDino._armatureDisplay.armature,u.defaultSkin):this.baseDino.initConfig.errorHandle({msg:"皮肤资源出错了"})}},t.prototype._InitLoadResources=function(t){this.errorItems=[],this.errorUrls=[],this._resources=[];var e=["HEAD_PARTS","FACE_PARTS","HAND_PARTS","BODY_PARTS","LEG_PARTS"];for(var i in t)if(this.isArray(t[i]))if(-1!==e.indexOf(i)&&t[i]&&3===t[i].length)for(var r=0;r<t[i].length;r++)switch(t[i][r].type){case"json":this._resources.push(i+"|&&|"+t[i][r].url+"|&&|TYPE_JSON|&&|name");break;case"image":this._resources.push(i+"|&&|"+t[i][r].url+"|&&|TYPE_IMAGE");break;case"bin":case"dbbin":this._resources.push(i+"|&&|"+t[i][r].url+"|&&|TYPE_BIN")}else this.errorItems.push(i),console.warn("该皮肤资源没有对应的部位：",i),this.baseDino.initConfig.errorHandle({msg:"该皮肤资源没有对应的部位: "+i})},t.prototype.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)},t.prototype._loadResources=function(t){var e=this;if(this._loadCount=this._resources.length,0!==this._loadCount){this._suitConfigs=[];for(var i=function(i){var n=i.split("|&&|");if(r._resourceMap[n[1]]){if(n[3]){var a=r._resourceMap[n[1]].data;r._suitConfigs.push(a.name),r.nowData[n[0]]=a.name}r._loadCount--,0===r._loadCount&&(!t||t(!0))}else RES.getResByUrl(n[1],function(i,r,a){a?(e._resourceMap[r]={hasParse:!1,data:i},n[3]&&(e._suitConfigs.push(i.name),e.nowData[n[0]]=i.name)):(e.errorUrls.push(r),console.warn("皮肤资源加载出错了"),e.baseDino.initConfig.errorHandle({msg:"皮肤资源加载出错了"})),e._loadCount--,0===e._loadCount&&(!t||t(!0))},r,RES.ResourceItem[n[2]])},r=this,n=0,a=this._resources;n<a.length;n++)i(a[n])}else!t||t(!1)},t.prototype._replaceSkin=function(t,e){var i=this;this._InitLoadResources(t),this._loadResources(function(r){r&&i._onStart(t),!e||e()})},t.prototype._removeSkin=function(t){for(var e=0;e<t.length;e++)this.nowData[t[e]]?delete this.nowData[t[e]]:(console.warn("当前骨骼数据中没有"+t[e]+"部分的皮肤"),this.baseDino.initConfig.errorHandle({msg:"当前骨骼数据中没有"+t[e]+"部分的皮肤"}));for(var i in this.baseDino._factory.replaceSkin(this.baseDino._armatureDisplay.armature,this.baseDino._factory.getArmatureData(this.baseDino.baseBonesDataName).defaultSkin),this.nowData){var r=this.baseDino._factory.getArmatureData(this.nowData[i]);this.baseDino._factory.replaceSkin(this.baseDino._armatureDisplay.armature,r.defaultSkin)}},t.prototype._removeAllSkins=function(){this.baseDino._factory.replaceSkin(this.baseDino._armatureDisplay.armature,this.baseDino._factory.getArmatureData(this.baseDino.baseBonesDataName).defaultSkin),this.nowData={}},t}();e.default=r}]);