<template lang="jade">
  transition(enterActiveClass="animated fadeIn",leaveActiveClass="animated fadeOut")
    .motivate-task-notice
      .close-all(@click.stop="closeMe",v-if="noticeType === 'notice-poster'")
      // 定向激励报名通告
      .notice-wrapper-box(v-if="noticeType === 'notice-message'")
        .little-dinosaur
        .notice-close(@click.stop="closeMe")
        p.notice-title 你的挑战任务
        .notice-content-box
          .notice-content
            p(:style="noticeContentStyle") {{noticeText}}
          .notice-btns
            .notice-button(@click.stop="closeMe") 我再想想
            .notice-button.notice-button-receive(@click.stop="doAgree") 接受邀请
      // 定向激励海报通告
      .notice-poster-wrapper(v-if="noticeType === 'notice-poster'")
        .img-box
          img(:src="posterImgSrc")
          p {{noticeText}}
        .notice-button.notice-button-receive(@click.stop="doAgree") 接受挑战
</template>

<script>
  // 激励任务的通告
  import vkButton from '../../common/vk_button.vue'
  import {getStrLength} from '../../../utils/_untils'
  export default {
    name: "motivate_task_notice",
    data() {
      return {
      }
    },
    props: {
      noticeType: {
        type: String,
        default() {
          return 'notice-message'
        }
      },
      noticeText: {
        type: String,
        default() {
          return ''
        }
      },
      posterImgSrc: {
        type: String,
        default() {
          return ''
        }
      }
    },
    computed: {
      noticeContentStyle: function() {
        if (this.noticeType === 'notice-message') {
          let len = getStrLength(this.noticeText)
          let styleObj = null
          switch(true) {
          case len > 30 && len <= 90:
            //大于一行小于三行
            styleObj = {'text-align': 'left'}
            break
          case len > 90:
            //超过三行
            styleObj = {'text-align': 'left', height: '100px', overflow: 'auto'}
            break
          default:
            styleObj = {'text-align': 'center'}
            break
          }
          return styleObj
        } else {
          return {'text-align': 'center'}
        }
      }
    },
    components: {
      vkButton
    },
    methods: {
      closeMe() {
        this.$playSound("click")
        this.$emit('closeIt', {flag: false, type: this.noticeType === 'notice-message' ? 1 : 2}) 
      },
      doAgree() {
        this.$playSound("click")
        this.$emit('closeIt', {flag: true, type: this.noticeType === 'notice-message' ? 1 : 2})
      }
    }
  }
</script>

<style lang="stylus" scoped>

.motivate-task-notice
  position: fixed
  left: 0
  top: 0
  z-index: 110
  width: 100vw
  height: 100vh
  background: rgba(0, 0, 0, .7)
  
  .close-all
    position: absolute
    top: 50px
    right: 60px
    width: 40px
    height: 40px
    background: url("../../../img/hot_activity/close-white-icon@2x.png") no-repeat
    background-size: 100% 100%
    cursor: pointer
    z-index: 300
  
  .notice-poster-wrapper
    position: absolute
    margin: -315px auto auto auto
    left: 0
    right: 0
    top: 50%
    bottom: 0
    width: 900px
    
    .img-box
      width: 100%
      height: 570px
      position: relative
      overflow: hidden
      img
        dispaly: block
        width: 100% 
      p 
        width: 100%
        position: absolute
        left: 0
        bottom: 15px
        text-align: center
        line-height: 33px
        font-size: 24px
        color: #ffffff
    
    .notice-button
      margin: 5px auto
    
  .notice-wrapper-box
    position: absolute
    margin: auto
    left: 0
    right: 0
    top: 0
    bottom: 0
    width: 475px
    height: 330px
    background: #A18EE3
    border-radius: 20px
    
    .little-dinosaur
      position: absolute
      left: (@width / 2 - 130)
      top: -85px
      width: 260px
      height: 100px
      background: url(../../../img/gift/dialog-dino-sweet-happy.png)
      background-size: 100% 100%
    
    .notice-close
      position: absolute
      top: -20px
      right: -10px
      width: 40px
      height: 40px
      border-radius: 50%
      background: url(../../../img/common/closed.png)
      background-size: 100% 100%
      cursor: pointer
      
    .notice-title
      padding: 20px 0 21px
      font-size: 24px
      line-height: 24px
      color: #FFFFFF
      text-align: center
      
    .notice-content-box
      box-sizing: border-box
      margin: 0 auto
      width: 445px
      height: 250px
      background: #FFFFFF
      border-radius: 20px
      border: 5px solid #9886D7
      
      .notice-content 
        display: flex
        display: -webkit-flex
        align-items: center
        justify-content: center
        -webkit-align-items: center
        -webkit-justify-content: center
        width: 100%
        height: 170px
        overflow: hidden
        
        p 
          padding: 0 22px 
          text-align: center
          font-size: 24px
          color: #666666
          line-height: 33px
          word-break: break-word
          white-space: pre-wrap
        
      .notice-btns
        display: flex
        display: -webkit-flex
        justify-content: center
        -webkit-justify-content: center
        
      .notice-button
        width: 142px
        
  .notice-button
    width: 150px
    height: 50px
    background: url(../../../img/hot_activity/hot_activity_button_receive.png)
    background-size: 100% 100%
    text-align: center
    color: #ffffff
    font-size: 22px
    line-height: 50px
    cursor: pointer

    &:hover
      opacity: 0.8
  
  .notice-button-receive
    background: url(../../../img/hot_activity/hot_activity_button.png)
    background-size: 100% 100%
    margin-left: 48px
</style>