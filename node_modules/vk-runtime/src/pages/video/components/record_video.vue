/**
* 视频组件
* Created by lihongbin on 2017/5/26.
*/
<template lang="jade">
  .video-content(ref="videoContent",:class="this.state.fullScreen?'content-full-screen':''")
    .video-panel(@mouseenter="video.soundShow=false")
      .video-mask
        .video-net-error(v-show="video.show==1")
          img(src="../../../img/common/net-error.png")
        .video-net-info(v-show="video.show==1") 网络连接好像有点问题，是否重新尝试？
        .video-btn-reload(@click="reload",v-show="video.show==1") 刷新重试
      video.video-player(:class="this.state.fullScreen?'video-full-screen':''",ref="vkVideo",v-show="video.show!=1",preload="auto",
      @error="error",:src="videoSrc",@ended="playEnd",@timeupdate="timeline",
      @waiting="videoWaiting",@loadedmetadata="loadedMetaData",@canplay="canPlay")
      .video-loading(v-show="video.show==0")
    .video-console(v-show="video.show!=1&&video.fullConsole",ref="videoConsole",:class="this.state.fullScreen?'video-console-full':''",@mouseenter="video.soundShow=false")
      .video-btn(@click="play()", :class="state.playBtnState")
      .video-time-start {{video.timeStart}}
      .video-time-line(@click="clickTimeLine($event)",ref="vtimeline",@mouseenter="video.soundShow=false")
        .vsl-over(ref="timeOver")
        .vsl-line(ref="timeLine")
          .vsl-loading(ref="timeLoading")
          .vsl-cricle(class="animated pulse",ref="timeBtn",@mousedown="scrollTimeStart($event)")
        .video-record-line
          .video-record-dot(v-for="(item,index) in recordInfo", :id="'record-dot-' + index")
            .video-record-trips(
            class="animated fadeIn",
            )
              p 可以录音哦
      .video-btn-full-screen.video-btn(@click="fullScreen()",:class="this.state.fullScreen?'video-btn-small-screen':'video-btn-full-screen'")
      .video-btn-sound(@mouseleave="video.soundShow=false")
        .video-sound-line(ref="soundLine",v-show="video.soundShow")
          .video-sound-cricle(ref="soundBtn",@mousedown="scrollSound($event)")
          .video-sound-over(ref="soundOver")
        .video-sound-muted.video-btn(:class="state.soundBtnState",@click="audioMuted()",@mouseenter="video.soundShow=true")
      .video-time-end {{video.timeEnd}}
    record-layer(
    :isFullScreen ="state.fullScreen",
    @stopRecord="startPlay",
    v-show="showLayer",
    :recordIndex="recordIndex",
    :recordInfo="recordInfo",
    :showScoreView="showScoreView",
    :showErrorScoreView="showErrorScoreView",
    :materialId = "materialId",
    @showRecordingLayer="showRecordingLayer",
    @closeRecordingLayer="closeRecordingLayer"
    )
    fullPageLoading(v-if="isFullPageLoadingShow",:loadingText="loadingText")
</template>
<script>
  import axios from "axios"
  import cookies from 'cookies-js'
  import dragonUtils from '../../../utils/_dragon.js'
  const pad = (val) => {
    val = Math.floor(val)
    if (val < 10) {
      return '0' + val
    }
    return val + ''
  }
  const timeParse = (sec) => {
    let min = 0
    min = Math.floor(sec / 60)
    sec = sec - min * 60
    return pad(min) + ':' + pad(sec)
  }
  import recordLayer from "./vk_record_layer.vue"
  import fullPageLoading from "../../common/vk_turn_page_loading.vue"
  export default {
    name: "recordVedio",
    data: function () {
      return {
        isShowRecordTrips: false,
        showScoreView: false,//评分页面
        showErrorScoreView: false,//评分页面失败
        loadingText: "正在评分中....",
        isFullPageLoadingShow: false,//评分详情
        timeRocd: 0,
        recordIndex: 0,//录音索引
        recordData: [],
        $video: null,
        recodtripsPosition: 0,
        video: {
          //播放按钮状态
          timeEnd: "00:00",
          timeStart: "00:00",
          vol: 0.5,
          show: 0,//0:loading 1:net error 2:player
          fullConsole: true,
          sto: null,//定时关闭状态
          soundShow: false
        },
        report: {
          currentSecond: 0,
          reportInterval: 0
        },
        state: {
          playBtnState: "play",
          fullScreen: false,
          soundBtnState: "invalid",
          isCompleted: false,
          isPlayed: false,
          timeLineChanging: false
        },
        showLayer: false,
        isVideoPageReady: false
      }
    },
    components: {
      recordLayer,
      fullPageLoading
    },
    beforeDestroy: function () {
      this.isVideoPageReady = false
      window.clearInterval(this.report.reportInterval)
      this.report.reportInterval = null
    },
    mounted() {
      //初始化video
      this.$video = this.$refs.vkVideo
      if (!this.$video.canPlayType('video/mp4; codecs="avc1.4D401E, mp4a.40.2"')) {
        alert("浏览器不支持该视频，可以更换浏览器为谷歌浏览器")
      }
      this.isVideoPageReady = true
    },
    destroyed(){
      clearInterval(this.timeRocd)
    },
    props: {
      recordInfo: {
        type: Array,
        default: () => {
          return []
        }
      },
      videoPauseTriger: {
        type: Number,
        required: false
      },
      autoPlay: {
        type: Boolean,
        required: false,
        default: false
      },
      videoSrc: {
        type: String,
        required: false,
        default: ""
      },
      source: {
        type: String,
        required: true,
        default: "this"
      },
      materialId: {
        type: String,
        required: true,
        default: ""
      },
      //视频播放结束事件 默认重新播放
      playEndAction: {
        type: Function,
        required: false,
        default: function () {

        }
      }
    },
    watch: {
      //切换视频时
      videoSrc: function (n, o) {
        if (n) {
          this.state.playBtnState = "play"
          this.video.show = 0
          this.state.isCompleted = false
          this.state.isPlayed = false
          if (!this.autoPlay) {
            this.backStart()
          }
        } else {
          this.video.show = 0
        }
      },
      videoPauseTriger: function (n) {
        this.pauseVideo()
      }

    },
    methods: {
      //add by luomingzong
      //关闭打分的遮罩版
      closeRecordingLayer(preload){
        this.showLayer = true
        this.isFullPageLoadingShow = false
        //评分成功
        if (preload.haveScore) {
          this.showScoreView = true
          this.showErrorScoreView = false
        } else {
          this.showErrorScoreView = true
          this.showScoreView = false
        }
      },
      //显示打分的遮罩版
      showRecordingLayer(){
        this.showLayer = false
        this.isFullPageLoadingShow = true
      },
      /**
       * @description 设置录音节点的位置
       */
      setRecordDotPosition(){
        let length = this.recordInfo.length
        let allTime = this.$video.duration * 1000
        for (let i = 0; i < length; i++) {
          let dot = document.getElementById('record-dot-' + i)
          let dotTime = this.recordInfo[i].startTime
          dot.style.left = (dotTime / allTime) * 100 + '%'
        }
      },
      //获取录音数据
      startPlay(){
        this.state.playBtnState == "stop"
        this.showLayer = false
        this.play()
        //开始侦听录音点
        setTimeout(() => {
          this.startUpLookUpRecord()
        }, 1500)
      },
      startUpLookUpRecord(){
        this.timeRocd = setInterval(() => {
          this.checkoutRecordData()
        }, 15)
      },
      vsmHover() {
        this.video.soundShow = true
      },
      //加载完元数据了的时候
      loadedMetaData() {
        this.video.timeEnd = timeParse(this.$video.duration)
        this.setCurrentSound(this.video.vol)
        this.setRecordDotPosition()
        this.startUpLookUpRecord()
      },
      canPlay() {
        if (this.autoPlay && this.state.playBtnState == "play") {
          this.play()
        }
        this.video.show = 2//加载完成显示播放器
        // 如果左右误差不超过500ms 那么确定录音
        this.dragRecordCheckout()
      },
      //拖动滑动块的录音检车 保证成功率
      dragRecordCheckout(){
        let time = parseInt(this.$video.currentTime * 1000)
        let length = this.recordInfo.length
        for (let i = 0; i < length; i++) {
          let recordDataTime = this.recordInfo[i].startTime
          if (Math.abs(time - recordDataTime) < 1500) {
            this.pauseVideo()
            this.showLayer = true
            this.recordIndex = i
            clearInterval(this.timeRocd)
            break
          }
        }
      },
      videoWaiting() {
        this.video.show = 0
      },
      //播放结束
      playEnd() {
        this.state.playBtnState = "play"
        this.lineCurrentWidth(0)
        this.setCurrentTime(0)
        this.playEndAction()
        //只有播放结束才会停止上报
        this.stopReport()
      },
      pauseVideo() {
        this.$video.pause()
        this.state.playBtnState = "play"
      },
      sendReportData(){
        let self = this
        let formData = new FormData()

        formData.append('studentId', Number(cookies.get("studentId")))
        formData.append('videoId', Number(self.materialId))
        formData.append('totalTime', Math.floor(self.$video.duration))
        formData.append('processTime', self.report.currentSecond)

        /* 
          0 PC浏览器 （默认）
          1 PC-APP客户端
        **/
        if (dragonUtils.isOnDragonClient()) {
          formData.append('source', 1)
        }else{
          formData.append('source', 0)
        }

        //console.log(formData)
        axios.post("/rest/learninggw/api/pc/studentBehavior/videoPoint",formData).then(res => {
          if (res.data.code == 200) {
            //console.log("success")
            //console.log("test heart report! finish")
          }
        }).catch((err) => {
          // 发送报告错误处理
          //this.$showToast("BI 打点失败了")
          
        })
      },
      startReport() {
        let self = this
        let timeInterval = 30 * 1000 //interval 30sec
        if(self.isVideoPageReady){
          window.clearInterval(self.report.reportInterval)
          self.sendReportData()
          self.report.reportInterval = window.setInterval(function() {
            self.report.currentSecond = Math.ceil(self.$video.currentTime)
            self.sendReportData()
          }, timeInterval)
        }
      },
      stopReport() {
        let self = this
        window.clearInterval(self.report.reportInterval)
        self.report.reportInterval = null
        self.report.currentSecond = Math.floor(self.$video.duration)
        self.sendReportData()
      },
      //播放
      play() {
        if (this.state.playBtnState == "play") {
          //解决safari不能自动播放的问题，在safari上就不自动播放了
          this.$video.play().catch((error) => {
            this.state.playBtnState = "play"
            this.state.isPlayed = false

            //chrome等无法自动播放的浏览器会多发送一次 processTime 0
            window.clearInterval(this.report.reportInterval)
            this.report.reportInterval = null
            return
          })
          this.state.playBtnState = "stop"
          //是否播放了，只记一次
          if (!this.state.isPlayed) {
            this.state.isPlayed = true
            sa.track('learning_click', {
              'click_id': 'pc_learning_' + this.source + '_video_played',
              'material_id': Number(this.materialId)
            })
          }
          sa.track('learning_click', {
            'click_id': 'pc_learning_' + this.source + '_video_play',
            'material_id': Number(this.materialId)
          })
          this.startReport()
          return
        }
        if (this.state.playBtnState == "stop") {
          this.$video.pause()
          this.state.playBtnState = "play"
          sa.track('learning_click', {
            'click_id': 'pc_learning_' + this.source + '_video_pause',
            'material_id': Number(this.materialId)
          })
          return
        }
      },
      //刷新重试
      reload() {
        sa.track('learning_click', {
          'click_id': 'pc_learning_' + this.source + '_video_reload',
          'material_id': Number(this.materialId)
        })
        window.location.reload()
      },
      consoleShow(e) {
        this.video.fullConsole = true
        clearTimeout(this.video.sto)
        this.video.sto = setTimeout(() => {
          this.video.fullConsole = false
        }, 3000)
      },
      //全屏
      fullScreen() {
        if (!this.state.fullScreen) {
          sa.track('learning_click', {
            'click_id': 'pc_learning_video_fullscreen'
          })
          var navigatorName = "Microsoft Internet Explorer"
          if (navigator.appName == navigatorName) {
            var WsShell = new ActiveXObject('WScript.Shell')
            WsShell.SendKeys('{F11}')
          } else {
            var de = this.$refs.videoContent
            if (de.requestFullscreen) {
              de.requestFullscreen()
            } else if (de.mozRequestFullScreen) {
              de.mozRequestFullScreen()
            } else if (de.webkitRequestFullScreen) {
              de.webkitRequestFullScreen()
            } else if (de.msRequestFullscreen) {
              de.msRequestFullscreen()
            }
          }
          this.state.fullScreen = true
          //监控屏幕变化，为了在用户点击esc时可以触发smallscreen
          setTimeout(() => {
            window.onresize = () => {
              if (this.state.fullScreen) {
                this.smallScreen()
              }
            }
          }, 1000)
          document.body.addEventListener("mousemove", this.consoleShow)
        } else {
          this.smallScreen()
        }
      },
      smallScreen() {
        sa.track('learning_click', {
          'click_id': 'pc_learning_video_smallscreen'
        })
        var navigatorName = "Microsoft Internet Explorer"
        if (navigator.appName == navigatorName) {
          var WsShell = new ActiveXObject('WScript.Shell')
          WsShell.SendKeys('{esc}')
        } else {
          if (document.exitFullscreen) {
            document.exitFullscreen()
          } else if (document.mozCancelFullScreen) {
            document.mozCancelFullScreen()
          } else if (document.webkitCancelFullScreen) {
            document.webkitCancelFullScreen()
          } else if (document.msExitFullscreen) {
            document.msExitFullscreen()
          }
        }

        clearTimeout(this.video.sto)
        document.body.removeEventListener("mousemove", this.consoleShow)
        this.video.fullConsole = true
        this.state.fullScreen = false
        window.onresize = null
      },
      //点击进度条的快速跳转
      clickTimeLine(e) {
        const timesX = e.clientX
        const lineX = this.$refs.vtimeline.getBoundingClientRect().left
        const tl = timesX - lineX
        const trtc = tl / (this.$refs.vtimeline.clientWidth - 310)
        if (trtc > 1) {
          return
        }
        this.$video.currentTime = this.$video.duration * trtc
        this.lineCurrentWidth(trtc * 100)
      },

      //点击滑块拖动事件
      scrollTimeStart(e) {
        var timesX = 0
        var w = 0, over, line
        timesX = e.clientX
        var timeOver = this.$refs.timeOver
        var timeLine = this.$refs.timeLine
        w = timeOver.clientWidth + timeLine.clientWidth
        over = timeOver.style.width ? timeOver.style.width : 0
        line = timeLine.style.width ? timeLine.style.width : 100
        this.$refs.videoConsole.onmousemove = window.onmousemove = (e) => {
          var cx = ((e.clientX - timesX) / w) * 100
          over = (over + "").replace("\%", "")
          line = (line + "").replace("\%", "")
          var ocx = (parseInt(over) + cx)
          if ((ocx > 0 && ocx < 100) || ocx == 0 || ocx == 100) {
            this.lineCurrentWidth(ocx)
            this.setCurrentTime(ocx)
          }
        }
        this.$refs.videoConsole.onmouseup = () => {
          this.$refs.videoConsole.onmousemove = null
          window.onmousemove = null
          this.$refs.videoConsole.onmouseup = null
        }
        window.onmouseup = () => {
          this.$refs.videoConsole.onmousemove = null
          window.onmousemove = null
          window.onmouseup = null
        }
      },
      //调节音量
      scrollSound(e) {
        var y = e.clientY
        var vol = this.video.vol
        this.$refs.soundBtn.onmousemove = window.onmousemove = (e) => {
          var cy = ((y - e.clientY) / 160)
          var ccy = cy + vol
          if ((ccy) > 0 && (ccy) < 1) {
            this.setCurrentSound(ccy)
          }
        }
        this.$refs.soundLine.onmouseleave = () => {
          this.$refs.soundBtn.onmousemove = null
          window.onmousemove = null
        }

        this.$refs.videoConsole.onmouseenter = () => {
          this.$refs.soundBtn.onmousemove = null
          window.onmousemove = null
        }

        this.$refs.vtimeline.onmouseenter = () => {
          this.$refs.soundBtn.onmousemove = null
          window.onmousemove = null
        }
        this.$refs.soundBtn.onmouseup = new Function('this.onmousemove=null')
        window.onmouseup = new Function('this.onmousemove=null')
      },
      //时间线改变 每秒刷一次 保证性能
      timeline() {
        if (this.state.timeLineChanging) {
          return
        }
        this.state.timeLineChanging = true
        setTimeout(() => {
          this.state.timeLineChanging = false
        }, 1000)
        this.video.show = 2//加载完成显示播放器
        const percent = (this.$video.currentTime / this.$video.duration) * 100
        this.lineCurrentWidth(percent)
      },
      //检查录音时间线，是否显示录音 该函数不放在timeupdate中去检测，timeupdate为（250ms-16ms）误差比较大
      checkoutRecordData(){
        let time = parseInt(this.$video.currentTime * 1000)
        let length = this.recordInfo.length
        for (let i = 0; i < length; i++) {
          let recordDataTime = this.recordInfo[i].startTime
          if ((time - recordDataTime) < 25 && (time - recordDataTime) > 0) {
            this.pauseVideo()
            this.showLayer = true
            this.recordIndex = i
            clearInterval(this.timeRocd)
            break
          }
        }
      },
      //进度条各项宽度
      lineCurrentWidth(percent) {
        if (this.$refs.timeOver == undefined || this.$refs.timeLine == undefined || percent > 100) {
          return
        }
        //缓冲进度条
        var buffered = this.$video.buffered
        var end = 0
        if (buffered.length != 0) {
          end = buffered.end(buffered.length - 1)
        }

        this.$refs.timeOver.style.width = percent + "%"
        //缓冲条left
        this.$refs.timeLine.style.width = (100 - percent) + "%"
        if (percent == 0) {
          this.$refs.timeLoading.style.width = 0
        } else {
          if (this.$refs.timeLoading.clientWidth < this.$refs.timeLine.clientWidth) {
            //缓冲条宽度 end 缓冲位置计算有延迟，为了不让缓冲条越界，所以做了该限制
            this.$refs.timeLoading.style.width = ((end / this.$video.duration) * (this.$refs.vtimeline.clientWidth - 310) - this.$refs.timeOver.clientWidth) + "px"
          } else {
            this.$refs.timeLoading.style.width = this.$refs.timeLine.clientWidth + "px"
          }
        }
        this.video.timeStart = timeParse(this.$video.currentTime)
        //90%完成率打点
        if (percent > 90 && !this.state.isCompleted) {
          this.state.isCompleted = true
          sa.track('learning_click', {
            'click_id': 'pc_learning_' + this.source + '_video_completed',
            'material_id': Number(this.materialId)
          })
        }
      },
      //静音
      audioMuted() {
        if (this.state.soundBtnState == "muted") {
          sa.track('learning_click', {
            'click_id': 'pc_learning_video_invalid'
          })
          this.state.soundBtnState = "invalid"
          this.$video.muted = false
          this.video.soundShow = true
          this.$video.volume = this.video.vol
          if (this.$video.volume < 0.05) {
            this.$video.volume = 0.5
          }
          this.setCurrentSound(this.$video.volume)
          return
        }
        if (this.state.soundBtnState == "invalid") {
          sa.track('learning_click', {
            'click_id': 'pc_learning_video_muted'
          })
          this.state.soundBtnState = "muted"
          this.$video.muted = true
          this.setCurrentSound(0)
          return
        }
      },
      setCurrentTime(percent) {
        if (percent != 0) {
          this.$video.currentTime = this.$video.duration * (percent / 100)
          this.video.timeStart = timeParse(this.$video.currentTime)
        } else {
          this.video.timeStart = timeParse(0)
        }
      },
      error() {
        this.video.show = 1
      },
      //设置当前声音
      setCurrentSound(vol) {
        if (this.$refs.soundBtn == undefined) {
          return
        }
        this.$refs.soundBtn.style.top = (160 * (1 - vol)) + "px"
        this.$refs.soundOver.style.height = (160 * vol) + "px"
        if (vol != 0) {
          this.$video.volume = vol
          this.video.vol = vol
        }
        // 滑动到底部时为静音
        if (vol < 0.05) {
          this.state.soundBtnState = "muted"
          this.$video.muted = true
        } else {
          this.state.soundBtnState = "invalid"
          this.$video.muted = false
        }
      },
      //回到刚开始
      backStart() {
        this.setCurrentTime(0)
        this.report.currentSecond = 0
        this.lineCurrentWidth(0)
        this.$video.pause()
        this.state.playBtnState = "play"
      }
    }
  }
</script>
<style lang="stylus" scoped>
  *
    box-sizing: border-box
    -moz-user-select: none
    -webkit-user-select: none
    -ms-user-select: none
    -khtml-user-select: none
    user-select: none
    -webkit-font-smoothing: antialiased

  video::-webkit-media-controls-enclosure {
    /*禁用播放器控制栏的样式*/
    display: none !important;
  }

  .video-content
    position: relative
    width: 100%
    height: 100%
    padding: 20px 20px 12px 20px
    background-color: #4e2c8d
    border: solid #8561ed 4px
    border-radius: 25px
    .video-panel
      height: 100%
      text-align: center
      margin-bottom: -84px
      padding-bottom: 89px
      .video-mask
        float: left
        width: 100%
        height: 100%
        margin-right: -100%
        padding: 15%
        border-radius: 20px
        background-color: #311b70
        .video-btn-reload
          width: 200px
          height: 56px
          margin: 10px auto
          cursor: pointer
          color: #FFFFFF
          line-height: 56px
          cursor: pointer
          background: url("../../../img/major_extension/orage-button-normal.png") center no-repeat
          &:hover
            background: url("../../../img/major_extension/orage-button-hover.png") center no-repeat
          &:active
            background: url("../../../img/major_extension/orage-button-pressed.png") center no-repeat
        .video-net-error
          width: 100%
          height: 80%
          img
            height: 100%
        .video-net-info
          color: #b396ff
          margin-top: 20px
      .video-player
        padding: 10px
        height: 100%
        width: 100%
        margin: auto
      .video-full-screen
        position: absolute
        top: 0
        left: 0
        bottom: 0
        right: 0
        z-index: 10
      .video-loading
        position: absolute
        top: 0
        width: 100%
        height: 80%
        background: url("../../../img/major_extension/video-loading1.png") center no-repeat
        background-size: auto 30%
        animation: vLoad 400ms infinite
    .video-console
      position: absolute
      height: 44px
      width: 100%
      padding-right: 40px
      margin-top: 28px
      font-size: 18px
      color: #FFFFFF
      > div
        float left
      .video-btn
        width: 44px
        height: 44px
        cursor: pointer
        background-size: 100%
      .stop
        background-image: url("../../../img/major_extension/video-stop@2x.png")
        &:hover
          background-image: url("../../../img/major_extension/video-stop-hover.png")
        &:active
          background-image: url("../../../img/major_extension/video-stop-selected@2x.png")
      .play
        background-image: url("../../../img/major_extension/play-normal@2x.png")
        &:hover
          background-image: url("../../../img/major_extension/play-hover.png")
        &:active
          background-image url("../../../img/major_extension/play-selected.png")
      .video-time-start
        width: 50px
        line-height: 44px
        margin-left: 20px
      .video-time-line
        position: relative
        height: 8px
        width: 100%
        margin: 18px -310px 18px 20px
        padding-right: 310px
        div
          float: left
        .vsl-over
          height: 8px
          width: 0
          border-top-left-radius: 5px
          border-bottom-left-radius: 5px
          background-color: #ff6600
        /*transition:width 1s ease 0s;*/
        .vsl-line
          position: relative
          width: 100%
          height: 8px
          border-bottom-right-radius: 5px
          border-top-right-radius: 5px
          background-color: #36185c
          .vsl-loading
            position: absolute
            height: 8px
            width: 0px
            border-radius: 5px
            background-color: rgba(0, 0, 0, 0.5)
          .vsl-cricle
            float: left
            height: 20px
            width: 20px
            border-radius: 50%
            background-color: #FFFFFF
            margin-top: -6px
            margin-left: -10px
            cursor: pointer
            &:hover
              height: 25px
              width: 25px
              margin-top: -8.5px
              margin-left: -12.5px
      .video-time-end
        float: right
        width: 50px
        line-height: 44px
      .video-btn-sound
        float: right
        position: relative
        width: 44px
        height: 234px
        margin-left: 10px
        margin-top: -191px
        text-align: center
        .video-sound-muted
          position: absolute
          bottom: 0
        .invalid
          background-image: url("../../../img/major_extension/sound-invalid@2x.png")
          &:hover
            background-image: url("../../../img/major_extension/sound-invalid-hover@2x.png")
          &:active
            background-image: url("../../../img/major_extension/sound-invalid-click@2x.png")
        .muted
          background-image: url("../../../img/major_extension/sound-stop.png")
          &:hover
            background-image: url("../../../img/major_extension/sound-stop-hover.png")
          &:active
            background-image: url("../../../img/major_extension/sound-stop-click.png")
        .video-sound-line
          position: relative
          height 193px
          width 36px
          text-align: center
          margin: 0 auto 0px auto
          background-image: url("../../../img/major_extension/sound-line.png")
          background-repeat: no-repeat
          .video-sound-over
            z-index: 10
            position: absolute
            bottom: 25px
            width: 8px
            margin: 0 14px
            background-color: #ff6600
            border-bottom-right-radius: 6px
            border-bottom-left-radius: 6px
          .video-sound-cricle
            z-index: 11
            position: absolute
            width: 18px
            height: 18px
            margin-left: 9px
            background-color: #FFFFFF
            border-radius: 50%
            cursor: pointer
      .video-btn-full-screen
        float: right
        margin-left: 10px
        background-image: url("../../../img/major_extension/fullscreen-normal.png")
        &:hover
          background-image: url("../../../img/major_extension/fullscreen-hover.png")
        &:active
          background-image: url("../../../img/major_extension/fullscreen-click.png")
      .video-btn-small-screen
        float: right
        margin-lef: 10px
        background-image: url("../../../img/major_extension/smallscreen-normal.png")
        &:hover
          background-image: url("../../../img/major_extension/smallscreen-hover.png")
    .video-console-full
      z-index: 100
      position: absolute
      left: 0
      right: 0
      bottom: 0
      background-color: rgba(78, 44, 141, 0.6)
      padding: 20px 40px
      height: 84px

  .content-full-screen
    border: solid 0 #000000
    border-radius: 0
    background-color: #311b70
    padding: 0

  //add by luomingzhong
  .video-record-line
    position: relative
    top: -8px
    width: 100%
    height: 100%
    background: transparent

  .video-record-dot
    position: absolute
    top: 2px
    width: 4px
    height: 4px
    background: #fff
    border-radius: 4px
    &:hover
      top: 0px
      width: 8px
      height: 8px
      border-radius: 4px
      transform: translate(-2px, 0)
      .video-record-trips
        display: block
        animation-name: fadeIn

  .video-record-trips
    display: none
    position: absolute
    top: -45px
    left: -46px
    width: 100px
    height: 39px
    font-size: 14px;
    background: url(../../../img/video/pre-recorder-trips@2x.png) no-repeat
    background-size: 100px 39px
    animation-name: fadeOut
    p
      text-align: center
      padding-top: 12px

  @keyframes vLoad
    0%
      background-image: url("../../../img/major_extension/video-loading1.png")
    100%
      background-image: url("../../../img/major_extension/video-loading2.png")
</style>
