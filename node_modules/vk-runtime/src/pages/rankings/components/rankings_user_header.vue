<template lang="jade">
  .rankings-user-header-wrapper(v-if="item.rank", :class="{'rankings-user-header-wrapper-margin': item.rank === 1,'slideInDown': doAnimated, 'animated': true}", @click.stop="doClick(item.rank)")
    .user-header-image(:class="['user-header-image-num-' + item.rank]")
      img.header-img(src="../../../img/common/avatar/boy_1.png",v-if="!item.avatarUrl && (item.avatar == 'default'|| !item.avatar)")
      img.header-img(src="../../../img/common/avatar/boy_1.png",v-if="!item.avatarUrl && item.avatar=='boy_1'")
      img.header-img(src="../../../img/common/avatar/boy_2.png",v-if="!item.avatarUrl && item.avatar=='boy_2'")
      img.header-img(src="../../../img/common/avatar/boy_3.png",v-if="!item.avatarUrl && item.avatar=='boy_3'")
      img.header-img(src="../../../img/common/avatar/boy_4.png",v-if="!item.avatarUrl && item.avatar=='boy_4'")
      img.header-img(src="../../../img/common/avatar/girl_1.png",v-if="!item.avatarUrl && item.avatar=='girl_1'")
      img.header-img(src="../../../img/common/avatar/girl_2.png",v-if="!item.avatarUrl && item.avatar=='girl_2'")
      img.header-img(src="../../../img/common/avatar/girl_3.png",v-if="!item.avatarUrl && item.avatar=='girl_3'")
      img.header-img(src="../../../img/common/avatar/girl_4.png",v-if="!item.avatarUrl && item.avatar=='girl_4'")
      img.header-img(:src="item.avatarUrl", v-if="item.avatarUrl")
      .user-header-hat
    .user-name
      span(ref="userName", :class="{'text-color': item.isSelf}") {{item.studentName}}
    .user-stone-score(v-if="item.eggshellNumber") 
      .user-stone {{item.eggshellNumber}}
        .stone-icon
      .user-score {{item.totalScore}}分
    .user-score-one(v-if="!item.eggshellNumber") {{item.totalScore}}分
</template>
<script>
  export default {
    props: {
      item: {
        type: Object,
        default() {
          return {}
        }
      },
      doAnimated: {
        type: Boolean,
        default: false
      }
    },
    methods: {
      doClick(num) {
        let detailData = {
          top: this.$refs.userName.getBoundingClientRect().top + 10,
          isSelf: this.item.isSelf,
          data: this.item.onlineClassIndicators ? this.item.onlineClassIndicators.slice() : this.item.isSelf ? [] : [{
            doHomeworkScore: this.item.homeworkTotalScore || 0,
            doPreviewScore: this.item.preClassTotalScore || 0,
            classroomScore: this.item.classPerformanceTotalScore || 0
          }],
          studentInfo: {
            studentId: this.item.studentId,
            studentName: this.item.studentName || '',
            ageGroup: this.item.ageGroup || '',
            city: this.item.city || '',
            levelTitle: this.item.unitName || '',
            hasClass: this.item.hasClass || false
          }
        }
        if (num === 3) {
          detailData.left = this.$refs.userName.getBoundingClientRect().left
          detailData.isNormal = false
        } else {
          //常规布局
          detailData.right = this.$refs.userName.getBoundingClientRect().right
          detailData.isNormal = true
        }
        this.$emit('showDetail', detailData)
      }
    }
  }
</script>
<style lang="stylus" scoped>
.text-color
  color: rgba(255,203,0,1)
  font-weight: bold

.rankings-user-header-wrapper-margin
  margin: 0 31px

.rankings-user-header-wrapper
  width: 150px

  .user-header-image
    position: relative
    border-radius: 100%
    margin: 17px auto 0

    .header-img
      display: block
      width: 100%
      height: 100%
      border-radius: 100%

  .user-header-image-num-2, .user-header-image-num-3
    width: 80px
    height: 80px

    .user-header-hat
      position: absolute
      left: 20px
      top: -17px
      width: 40px
      height: 19px

  .user-header-image-num-1
    width: 100px
    height: 100px
    border:4px solid #FDFF81
    margin: 27px auto 0

    .user-header-hat
      position: absolute
      left: 30px
      top: -27px
      width: 40px
      height: 29px
      background-image: url("../../../img/rankings/crown1@2x.png")
      background-repeat: no-repeat
      background-size: 100% 100%

  .user-header-image-num-2
    border:4px solid rgba(189,232,249,1)

    .user-header-hat
      background-image: url("../../../img/rankings/crown2@2x.png")
      background-repeat: no-repeat
      background-size: 100% 100%

  .user-header-image-num-3
    border:4px solid #F1C268

    .user-header-hat
      background-image: url("../../../img/rankings/crown3@2x.png")
      background-repeat: no-repeat
      background-size: 100% 100%

  .user-name
    width: 100%
    height: 20px
    font-size: 18px
    color: #fff
    line-height: 20px
    text-align: center
    margin: 8px 0 7px
    text-overflow: ellipsis
    white-space: nowrap
    overflow: hidden
    
  .user-stone-score
    display: flex 
    display: -webkit-flex
    align-items: center
    justify-content: space-between
    -webkit-align-items: center
    -webkit-justify-content: space-between

    .user-stone, .user-score
      display: flex 
      display: -webkit-flex
      align-items: center
      justify-content: center
      -webkit-align-items: center
      -webkit-justify-content: center
      width: 73px
      height: 26px
      background: rgba(129,105,243,0.4)
      font-size: 14px
      color: rgba(255,255,255, 0.8)

    .user-stone
      border-radius: 31px 0 0 31px

      .stone-icon
        width: 24px
        height: 24px
        margin-left: 4px
        background: url("../../../img/rankings/energy_store@2x.png") no-repeat
        background-size: 100% 100%

    .user-score
      border-radius: 0 31px 31px 0
    
  .user-score-one
    display: flex 
    display: -webkit-flex
    align-items: center
    justify-content: center
    -webkit-align-items: center
    -webkit-justify-content: center
    width: 80px
    height: 26px
    background:rgba(255,255,255, 0.2)
    border-radius: 13px
    color: #fff
    font-size: 14px
    margin: 0 auto
</style>

