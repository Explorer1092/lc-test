<template lang="jade">
  .gift-wrapper
    fullPageLoading(v-if="isFullPageLoadingShow")
    top-part(:title_cn="title_chinese", :title_eng="title_english", :isAbsoluteFix="true")
    .user-guide-mask(v-if="isShowUserGuideMask", @click="closeDialog")
    .diamond-entry-container
      .diamond-entry-button.clearfix(@click="goToBillPage")
        img(src="../../img/gift/gift-exchange@2x.png")
        .label 能量石记录
    .secret-container
      .secret-button(@click="openSecret")
        img.secret-move(src="../../img/gift/secret.png")
        .label 兑换须知
    .main-container
      .filter-container
        .filter-item(@click="filter(0, 0)", :class="{active: minEgg == 0}")
          img.diamond-icon(src="../../img/gift/green-diamond.png")
          span All
        .filter-item(@click="filter(1, 999)", :class="{active: minEgg == 1}")
          img.diamond-icon(src="../../img/gift/green-diamond.png")
          span 1-999
        .filter-item(@click="filter(1000, 2999)", :class="{active: minEgg == 1000}")
          img.diamond-icon(src="../../img/gift/green-diamond.png")
          span 1000-2999
        .filter-item(@click="filter(3000, 4999)", :class="{active: minEgg == 3000}")
          img.diamond-icon(src="../../img/gift/green-diamond.png")
          span 3000-4999
        .filter-item(@click="filter(5000, 0)", :class="{active: minEgg == 5000}")
          img.diamond-icon(src="../../img/gift/green-diamond.png")
          span 5000以上
      //宝石数量的容器 by added luomingzhong
      .gem-container
        img.gem-ico(src="../../img/gift/big_diamond.png")
        span {{studentOwnDiamondsNum}}
      .list-container
        .none-list-holder(v-if="!giftDataList.length")
          img.none-img(src="../../img/gift/empty@2x.png")
          p 这个价位暂时没有礼物，Dino会尽快补货的
        .list-item(v-if="giftDataList.length", v-for="item in giftDataList", @click.stop="showExchangeConfirm(item.id)")
          .list-item-content
            .left
              img(v-if="item.imgUrl", :src="item.imgUrl", @error="loadingImageError")
              img(v-else, src="../../img/gift/gift_not_load.png")
            .right
              .gift-name {{item.name || '礼物'}}
              .cost-diamond-part
                span 兑换价：
                .diamond-costs
                  img(src="../../img/gift/green-diamond.png")
                  span {{item.eggshellNumber}}
              .deal-button.grey(@click.stop="diamondNotEnoughAlert", v-if="studentOwnDiamondsNum < item.eggshellNumber" ) 能量石不足
              .deal-button(v-else, @click.stop="showExchangeConfirm(item.id)") 兑换礼物
      pager(v-if="giftDataList.length", :totalPage="totalPage", :currentPageNumber="currentPageNum", @jumpToPageEvent="getListDataByPageNum")
      .info-dialog-container(v-if="isExchangeConfimDialogShow")
        .info-dialog-close-btn(@click="closeDialog")
        .info-dialog
          .info-dialog-title 兑换礼物确认
          .info-dialog-white-board
            .info-dialog-left
              vk-swipe(:showLabel.sync="showLabel")
                vk-swipe-item(v-for="(link,key,index) in bigImgUrls" v-bind:key="index")
                  img.vk-swipe-item-img(:src="link")
            .info-dialog-right
              .info-rows
                .info-left 礼品名称
                .info-right {{goodsDetailData.name}}
              .info-rows
                .info-left 所需宝石
                .info-right
                  img(src="../../img/gift/green-diamond.png")
                  span {{goodsDetailData.eggshellNumber}} 个
              .info-rows
                .info-left.float   礼品简介    
                .info-right.desc
                  p(v-for="item in description") {{item}}
              .button-box
                .dialog-btn.cancel(@click="closeDialog('EXCHANGE_CANCEL')") 再想想
                .dialog-btn.gray(v-if="goodsDetailData.eggshellNumber > studentOwnDiamondsNum") 能量石不足
                .dialog-btn.gray(v-else-if="goodsDetailData.stock <= 0") 卖光了
                .dialog-btn.ok(
                :class="{gray:isCanClick}",
                @click="doExchange",
                v-else) 就要这个
      vkDialogSecret(:showDialog="isSecretDialogShow", @closeIt="closeDialog", :secretDialogType="'gift_exchange'")          
    vkDialog(v-show="alertDialog", @rightBtnEvent="closeDialog", :title="alertTitle", :contentText="alertContent",:rightButtonText="aletRightButtonText",:mood="mood")
    img.hiddenDom(src="../../img/gift/gift_not_load.png", v-show="false", ref="defaultImg")
</template>
<style lang="stylus" scoped>
  *
    -moz-user-select: none
    -webkit-user-select: none
    -ms-user-select: none
    -khtml-user-select: none
    user-select: none
    -webkit-font-smoothing: antialiased
    -webkit-touch-callout: none

  .clearfix:before, .clearfix:after
    display: table
    content: ""

  .clearfix:after
    clear: both

  .hiddenDom
    width: 0
    height: 0
    display: hidden

  .gift-wrapper
    width: 100%
    height: 100%
    position: relative
    
    .info-dialog-container
      position: absolute
      z-index: 22
      top: 50%
      left: 50%
      margin-top: -265px
      margin-left: -400px
      .info-dialog-close-btn
        position: absolute
        top: -10px
        right: -10px
        display: inline-block
        width: 40px
        height: 40px
        background-image: url(../../img/common/close-btn-sprite.png)
        background-repeat: no-repeat
        background-position: 0 0
        background-size: 150px
        cursor: pointer
        &:hover
          background-position: -55px 0
        &:active
          background-position: -110px 0

      .info-dialog
        display: inline-block
        width: 800px
        height: 520px
        box-sizing: border-box
        background-color: #a18ee3
        border-radius: 18px
        box-shadow: 3px 2px 14px 0 #36185c
        text-align: center
        .info-dialog-title
          width: 93%
          height: 25px
          line-height: 25px
          margin: 17px auto 16px auto
          text-align: center
          font-size: 24px
          color: #fff
          overflow: hidden
          white-space: nowrap
          text-overflow: ellipsis
        .info-dialog-white-board
          width: 770px
          height: 440px
          padding: 20px 20px
          border-radius: 18px
          background-color: #fff
          display: inline-block
          border: solid 5px #9a8dc5
          text-align: left
          box-sizing: border-box
          .button-box
            position: absolute
            bottom: 20px
            left: 20px
            margin: 24px 0 0 0
            text-align: center
            .dialog-btn
              background-size: 150px
              width: 150px
              height: 50px
              line-height: 50px
              text-align: center
              display: inline-block
              vertical-align: middle
              box-sizing: border-box
              color: #ffffff
              cursor: pointer
              font-size: 22px
              &.gray
                background-image url(../../img/gift/gift-list-button-disable@2x.png)
                background-size 150px
                cursor not-allowed
              &.cancel
                background-image url(../../img/gift/gift-list-button-cancel@2x.png)
                margin-right: 20px
                &:hover
                  opacity: 0.7
              &.ok
                background-image url(../../img/gift/gift-list-button-ok@2x.png)
                &:hover
                  opacity: 0.7
    .user-guide-mask
      width: 100%
      height: 100%
      position: fixed
      top: 0
      left: 0
      right: 0
      bottom: 0
      background: #000
      background-color: rgba(0, 0, 0, 0.6)
      z-index: 10
    .diamond-entry-container
      position: absolute
      top: 31px
      right: 184px
      z-index: 9
      .diamond-entry-button
        padding: 0 16px 0 51px
        box-sizing: border-box
        cursor: pointer
        &:hover
          img
            animation: shake 0.3s
        img
          width: 36px
          height: 36px
          float: left
          position: absolute
          top: -5px
          left: 40px
        .label
          height: 26px
          display: inline-block
          line-height: 26px
          border-bottom-right-radius: 35px;
          border-top-right-radius: 35px;
          background-color: rgba(225, 225, 225, 0.2)
          color: #ffffff
          box-sizing: border-box
          padding: 0 10px 0 32px
          cursor: pointer
          font-size: 14px
          &:hover
            background-color: rgba(225, 225, 225, 0.4)
    .secret-container
      position: absolute
      top: 31px
      right: 40px
      z-index: 9
      &:hover
        img
          animation: shake 0.3s
          animation-direction: alternate
          animation-timing-function: ease-in-out
      .secret-button
        img
          position: absolute
          top: -4px
          left: -8px
          width: 36px
          height: 36px

        .label
          width: 100px
          height: 26px
          display: inline-block
          line-height: 26px
          border-radius: 35px
          background-color: rgba(225, 225, 225, 0.2)
          color: #ffffff
          box-sizing: border-box
          padding: 0 0 0 32px
          cursor: pointer
          font-size: 14px
          &:hover
            background-color: rgba(225, 225, 225, 0.4)
    .main-container
      width: 940px
      height: 550px
      position: absolute
      display: inline-block
      top: 50%
      left: 50%
      margin: -239px 0 0 -470px
      .filter-container
        border-radius: 100px
        background-color: rgba(0, 0, 0, 0.2)
        display: inline-block
        box-sizing: border-box
        font-size: 18px
        padding: 7px 7px
        .filter-item:last-child
          margin: 0 0 0 0
        .filter-item
          position: relative
          color: #ffffff
          background-color: rgba(225, 225, 225, 0.2)
          box-sizing: border-box
          padding: 0 10px 0 4px
          border-radius: 100px
          float: left
          margin: 0 7px 0 0
          cursor: pointer
          font-size: 16px
          &:hover
            background-color: rgba(225, 225, 225, 0.4)
          &.active
            background-color: #a061fd
        .diamond-icon
          width: 26px
          height: 26px
          float: left
        span
          float: left
          line-height: 26px
      .gem-container
        position: absolute
        top: 5px
        right: 17px
        height: 36px
        width: 100px
        img
          position: absolute
          width: 36px
          height: 36px
        span
          position: absolute
          left: 40px
          top: 8px
          font-size: 18px
          color: #39f6f3
      .list-container
        margin: 20px -20px 20px 0
        height: 440px
        .none-list-holder
          postition: relative
          text-align: center
          margin-top: 40px
          img.none-img
            width: 280px
            height: 280px
            margin-bottom: 20px
          p
            color: #b396ff
            font-size: 26px
        .list-item
          box-sizing: border-box
          width: 300px
          height: 200px
          margin: 0 20px 20px 0
          background-image: url(../../img/gift/item_bg.png)
          background-size: 100% 100%
          background-repeat: no-repeat
          display: inline-block
          vertical-align: middle
          position: relative
          border-radius: 30px
          border: solid 6px rgb(133, 97, 237)
          transition: all 0.3s
          cursor: pointer
          &:hover
            border: solid 6px rgb(57, 246, 243)
          .target-high-light
            position: absolute
            background-image: url(../../img/gift/highlight-kuang.png)
            background-size: 100% 100%
            background-repeat: no-repeat
            top: 0px
            left: 0px
            width: 100%
            height: 100%
          .left
            position: absolute
            left: 15px
            top: 41px
            width: 110px
            height: 110px
            text-align: center
            img
              width: 110px
              height: 110px
              margin-bottom: 6px
            .inventory
              font-size: 12px
              width: 100px
              height: 30px
              border-radius: 100px
              background-color: rgba(0, 0, 0, 0.2)
              color: #a093af
              line-height: 30px
              box-sizing: border-box
              text-align: center
              display: inline-block
          .right
            position: absolute
            left: 133px
            top: 17px
            width: 133px
            overflow: hidden
            .gift-name
              position: relative
              width: 100%
              height: 42px
              overflow: hidden
              font-size: 16px
              color: #fff
              line-height: 21px
              font-weight: 400
              word-break: break-all
              text-align: justify
              padding-top: 26px
              display: -webkit-box
              -webkit-box-orient: vertical
              -webkit-line-clamp: 2
              text-overflow: ellipsis
            .gift-price
              width: 100%
              font-size: 14px
              color: #fff
              margin-bottom: 3px
              overflow: hidden
            .cost-diamond-part
              overflow: hidden
              margin-bottom: 8px
              margin-top: 5px
              & > span
                color: #fff
                float: left
                font-size: 14px
                position: relative
                top: 5px
              .diamond-costs
                float: left
                img
                  float: left
                  width: 26px
                  height: 26px
                span
                  float: left
                  color: #39f6f3
                  font-size: 17px
                  height: 26px
                  line-height: 26px
                  width: 50px
                  overflow: hidden
            .deal-button
              width: 123px
              height: 31px
              background-image: url('../../img/gift/gift_spirit.png')
              background-size: 400px 268px
              background-position: 0 0
              color: #ffffff
              text-align: center
              line-height: 30px
              font-size: 14px
              cursor: pointer
              margin-top: 10px
              &:hover
                background-position: -125px 0
              &:active
                background-position: -251px 0
              &.grey
                background-position: 0px -218px
                cursor: not-allowed

            .set-target-button
              width: 121px
              height: 25px
              background-image: url('../../img/gift/gift_spirit.png')
              background-size: 400px
              background-position: 0px -33px
              color: #ffffff
              text-align: center
              line-height: 24px
              font-size: 16px
              cursor: pointer
              &:hover
                background-position: -125px -33px
              &:active
                background-position: -251px -33px
            .target-setted
              font-size: 16px
              width: 120px
              height: 24px
              line-height: 24px
              border-radius: 100px
              background-color: rgba(0, 0, 0, 0.2)
              color: #ff6600
              box-sizing: border-box
              text-align: center
      .pager-container
        width: 100%
        text-align: center
        .pager
          display: inline-block
          margin: 0 auto
          .page-button
            float: left
            width: 36px
            height: 36px
            line-height: 36px
            border-radius: 100px
            background-color: rgba(225, 255, 225, 0.15)
            color: #ffffff
            text-align: center
            font-size: 18px
            cursor: pointer
            margin: 0 20px 0 0
            &.previous
              margin: 0 40px 0 0
            &.next
              margin: 0 0 0 20px
            &.first
              width: 76px
              height: 36px
              margin: 0 20px 0 0
            &.last
              width: 76px
              height: 36px
              margin: 0 0 0 20px
            &:hover
              background-color: rgba(225, 255, 225, 0.3)
            &.active
              transform: scale(1.1)
              background-color: #a061fd

  //add by 罗明忠
  .info-dialog-left
    float: left
    width: 360px
    height: 400px

  .info-dialog-right
    position: relative
    float: right
    width: 360px
    height 390px
    & > .info-rows
      display table
      padding-bottom 20px
      width: 100%
      min-height 20px
      font-size: 16px
      line-height: 1.25
      text-align: left
    color: #777

  .info-left
    display table-cell
    width: 70px
    padding: 0 20px
    vertical-align: middle
    &.float
      display: block
      float: left

  .info-right
    width: 240px
    vertical-align: middle
    color: #555
    & > p
      display: block
      line-height: 1.5
    img
      width: 22px
      height: 22px
      padding-right: 4px
      vertical-align: middle

  .vk-swipe-item-img
    width: 360px
    height: 360px
    border-radius: 20px

  .desc
    height: 220px
    float: left
    text-align: left
    overflow: scroll

  @keyframes shake
    0%
      transform: rotate(0deg)
    25%
      transform: rotate(7deg)
    50%
      transform: rotate(0deg)
    75%
      transform: rotate(-7deg)
    100%
      transform: rotate(0deg)

  @keyframes Move
    0%
      transform: translateY(20px)
    100%
      transform: translateY(0px)
</style>
<script>
  import axios from 'axios'
  import cookies from 'cookies-js'
  import formUrlEncoded from 'form-urlencoded'
  import utils from '../../utils/_untils.js'
  import TopPart from '../common/top_part.vue'
  import fullPageLoading from "../common/vk_turn_page_loading.vue"
  import pager from '../common/vk_pager.vue'
  import vkDialog from '../common/vk_dialog.vue'
  import vkSwipe from './components/swipe.vue'
  import vkSwipeItem from './components/swipe_item.vue'
  import vkDialogSecret from '../common/vk_dialog_secret.vue'
  import productDefaultImg from "../../img/gift/product-default@2x.png"
  export default {
    data() {
      return {
        mood: 'lose',
        showLabel: false,
        title_chinese: '能量石兑换站',
        title_english: 'Gift Center',
        timeouts: [],
        isShowUserGuideMask: false, // 半透明黑色蒙层，每次弹框需开启
        isFullPageLoadingShow: false, // loading遮挡层
        totalPage: 1,
        giftDataList: [],
        isExchangeConfimDialogShow: false, //兑换确认弹框
        isUpdateConfimDialogShow: false, //更换目标弹框
        isSecretDialogShow: false, //夺宝秘笈弹框
        alertDialog: false, //alert弹框
        minEgg: 0,
        maxEgg: 0,
        alertTitle: '',
        alertContent: '',
        aletRightButtonText: '确定',
        exchangeId: null,
        goodsDetailData: {},
        bigImgUrls: [],
        currentPageNum: 1,
        isReloadList: false,
        studentOwnDiamondsNum: '',
        isCanClick: false,
        description: []
      }
    },
    props: [],
    mounted() {
      this.getListDataByPageNum(1)
    },
    beforeDestroy() {
      for (let i = 0; i < this.timeouts.length; i++) {
        clearTimeout(this.timeouts[i])
      }
    },
    filters: {
      /**@author luomingzhong 是否应该放到全局呢？shoud update
       * [fixed description]该过滤是用来保存几位小数，
       * @param  {[string]} value       [传进的字符串]
       * @param  {Number} [decimal=2] [默认保存两位小数]
       * @return {[string]}             [返回过滤的字符]
       */
      fixed(value, decimal = 2){
        if (!value) return ''
        value = Math.floor(value)
        //value = (parseFloat(value)).toFixed(decimal);
        return value
      }
    },
    methods: {
      loadingImageError(e) {
        e.target.src = this.$refs.defaultImg.src
      },
      diamondNotEnoughAlert() {
        this.alertTitle = '能量石不足'
        this.alertContent = '宝贝你的能量石不够！<br>多上几节课获得更多能量石！'
        this.alertDialog = true
        this.isShowUserGuideMask = true
      },
      negativeAlert(title, content, alertBtnfunc) {
        this.alertTitle = title ? title : 'sorry!'
        this.alertContent = content ? content : '网络异常！'
        this.isFullPageLoadingShow = false
        this.isExchangeConfimDialogShow = false
        this.isShowUserGuideMask = true
        this.alertDialog = true
      },
      inventoryNotEnoughAlert() {
        this.alertTitle = '太抢手，被定完了'
        this.alertContent = '这个礼物太抢手，刚刚被订完了！<br>还有很多有趣的礼物，不如再选另一个？'
        this.alertDialog = true
        this.isShowUserGuideMask = true
        this.aletRightButtonText = '好的'
      },
      showExchangeConfirm(id) {
        this.exchangeId = id
        this.getDetail(id)
        //增加商品id
        utils.giftShopClickEvent(4, 2, this.exchangeId)
        sa.track('learning_click', {
          'click_id': 'pc_learning_gift_exchange_clcik_buy_product_button'
        })
      },
      filter(from, to) {
        switch (from) {
        //打点
        case 0:
          utils.giftShopClickEvent(3, 1)
          break
        case 1:
          utils.giftShopClickEvent(3, 2)
          break
        case 1000:
          utils.giftShopClickEvent(3, 3)
          break
        case 3000:
          utils.giftShopClickEvent(3, 4)
          break
        case 5000:
          utils.giftShopClickEvent(3, 5)
          break
        default:
          utils.giftShopClickEvent(3, 1)
          break
        }
        this.minEgg = from
        this.maxEgg = to
        this.$nextTick(() => {
          this.getListDataByPageNum(1)
        })
        sa.track('learning_click', {
          'click_id': `pc_learning_gift_exchange_click_filter_${from}_price`
        })
      },
      openSecret() {
        this.isShowUserGuideMask = !this.isShowUserGuideMask
        this.isSecretDialogShow = true
      },
      closeDialog(opt) {
        this.mood = "lose"
        this.isExchangeConfimDialogShow = false
        this.isUpdateConfimDialogShow = false
        this.isSecretDialogShow = false
        this.alertDialog = false
        this.isShowUserGuideMask = !this.isShowUserGuideMask
        if (this.isReloadList == true) {
          this.getListDataByPageNum(this.currentPageNum)
        }
        this.isReloadList = false
        if (opt == "EXCHANGE_CANCEL") {
          utils.giftShopClickEvent(4, 4, this.exchangeId)
        }
      },
      goToBillPage() {
        this.$router.push({path: '/diamond_bill'})
        this.$playSound("click")
        sa.track('learning_click', {
          'click_id': 'pc_learning_gift_exchange_click_bill_button'
        })
      },
      /**
       * 接口
       */
      getDetail(id) {
        axios.get('/rest/learninggw/api/pc/eshop/goods/detail', {
          params: {
            id: this.exchangeId
          }
        })
          .then((res) => {
            if (res.data.code == 200) {
              this.goodsDetailData = res.data.data
              if (res.data.data.description) {
                this.description = res.data.data.description.split("&")
              }
              if (res.data.data.bigImgUrls)
                this.bigImgUrls = res.data.data.bigImgUrls.split(";")
              else {
                this.bigImgUrls = productDefaultImg.split(";")
              }
              this.isExchangeConfimDialogShow = true
              this.isShowUserGuideMask = true
            } else {
              this.negativeAlert()
            }
          })
          .catch((err) => {
            this.negativeAlert()
          })
      },
      //获取礼物列表
      getListDataByPageNum(pageNum) {
        // this.isFullPageLoadingShow = true
        let _params = {
          studentId: cookies.get('studentId'),
          limit: 6,
          currentPage: pageNum
        }

        if (this.minEgg != 0 && this.maxEgg != 0) {
          _params['minEggshellNumber'] = this.minEgg
          _params['maxEggshellNumber'] = this.maxEgg
        } else if (this.minEgg != 0 && this.maxEgg == 0) {
          _params['minEggshellNumber'] = this.minEgg
        }

        axios.get('/rest/learninggw/api/pc/eshop/goods/list', {
          params: _params
        })
          .then((res) => {
            if (res.data.code == 200) {
              this.studentOwnDiamondsNum = res.data.data.ownEggshellNumber
              if (res.data.data.page.data.length) {
                this.currentPageNum = pageNum
                this.giftDataList = res.data.data.page.data
                this.totalPage = res.data.data.page.totalPages
                // this.isFullPageLoadingShow = false
              } else {
                //礼物列表数组为空
                this.giftDataList = 0
                // this.isFullPageLoadingShow = false
                this.currentPageNum = pageNum
                // this.negativeAlert('Notice!', '没有发现礼物，请换一个筛选条件。')
              }
            } else {
              this.negativeAlert()
            }
          })
          .catch((err) => {
            this.negativeAlert()
          })
      },
      //创建订单（兑换礼物）
      doExchange() {
        let _params = {
          studentId: cookies.get('studentId'),
          parentId: cookies.get('parentId')
        }
        let parentId = cookies.get('parentId')
        let isPad = cookies.get("isFromApp")
        if (isPad) {
          parentId = cookies.get('mbparentid')
        }
        if (!this.isCanClick) {
          this.isCanClick = true
          this.isFullPageLoadingShow = true
          axios.post('/rest/learninggw/api/pc/eshop/order/createEshopOrder', {
            studentId: cookies.get('studentId'),
            parentId: parentId,
            eshopGoodsList: [
              {
                eshopGoodsId: this.exchangeId,
                eshopGoodsCount: 1
              }
            ]
          }).then((res) => {
            this.isCanClick = false
            this.isFullPageLoadingShow = true
            switch (res.data.code) {
            case 200:
              this.mood = "happy"
              this.negativeAlert('兑换成功', '兑换成功！<br>别忘了让爸爸妈妈在手机上确认订单哦！')
              this.timeouts.push(setTimeout(() => {
                this.getListDataByPageNum(this.currentPageNum)
              }, 2000))
              break
            case 497:
            case 498:
            case 499:
              this.negativeAlert('Sorry!', '此礼物太抢手，刚刚被订完了！<br>还有更多有趣的礼物，您再挑选一下吧！')
              this.isReloadList = true
              break
            case 494:
              this.negativeAlert('Sorry!', '您的能量石不够了！上课可以获得更多能量石哦！')
              this.isReloadList = true
              break
            case 486:
              this.negativeAlert('Sorry!', '兑换该礼物超过限制次数')
              this.isReloadList = true
              break
            case 485:
              this.negativeAlert('Sorry!', '请勿频繁重复下单<br/>稍后再试')
              this.isReloadList = true
              break
            case 488:
            case 484:
            case 495:
              this.negativeAlert('Sorry!', '系统繁忙<br/>稍后再试')
              tihs.isReloadList = true
              break
            case 482:
              this.negativeAlert('Sorry!', '收货地址不完整<br/>请补全收货地址')
              this.isReloadList = true
              break
            default:
              this.negativeAlert()
              this.isReloadList = true
            }
          })
            .catch((err) => {
              this.isFullPageLoadingShow = true
              this.isCanClick = false
              this.negativeAlert()
            })
        }
        utils.giftShopClickEvent(4, 3, this.exchangeId)
      }
    },
    components: {
      TopPart,
      fullPageLoading,
      pager,
      vkDialog,
      vkSwipe,
      vkSwipeItem,
      vkDialogSecret
    }
  }
</script>
