<template lang="jade">
  //滑动文本组件
  .slide-text(@mouseenter="textEnter",@mouseout="textOut")
    .slide-text-inner(ref="textInner")
      | {{text}}
</template>
<script>
  import Velocity from 'velocity-animate'
  export default {
    data: function () {
      return {
        animationEnter: false,
        animationOut: false,
        timeout: null
      }
    },
    props: [
      'text', 'isAutoSlide'
    ],
    components: {},
    computed: {},
    beforeDestroy: function () {
      clearTimeout(this.timeout)
    },
    mounted () {
      this.initData()
    },
    methods: {
      initData(){
        if (this.isAutoSlide) {
          this.timeout = setTimeout(() => {
            if (this.$refs.textInner) {
              var textWidth = this.$refs.textInner.scrollWidth - this.$refs.textInner.clientWidth
              this.isVelocity = Velocity(this.$refs.textInner, {marginLeft: -textWidth}, {
                container: this.$refs.textInner, duration: 3000, loop: true, mobileHA: false
              })
            }
          }, 2000)
        }
      },
      textEnter(){
        if (!this.animationEnter && !this.isAutoSlide) {
          this.animationEnter = true
          if (this.$refs.textInner) {
            var textWidth = this.$refs.textInner.scrollWidth - this.$refs.textInner.clientWidth
            Velocity(this.$refs.textInner, {marginLeft: -textWidth}, {
              container: this.$refs.textInner, duration: 1000, mobileHA: false,
              complete: () => {
                this.animationEnter = false
              }
            })
          }
        }
      },
      textOut() {
        if (!this.animationOut && !this.isAutoSlide) {
          this.animationOut = true
          Velocity(this.$refs.textInner, {marginLeft: 0}, {
            container: this.$refs.textInner, duration: 1000, mobileHA: false,
            complete: () => {
              this.animationOut = false
            }
          })
        }
      }
    }
  }
</script>

<style lang="stylus" scoped>
  .slide-text
    overflow: hidden
    white-space: nowrap
    cursor: pointer
  .slide-text-inner
    -webkit-touch-callout text 
    -webkit-user-select text 
    -khtml-user-select text 
    -moz-user-select text 
    -ms-user-select text
    user-select text
    -webkit-touch-callout default
</style>
