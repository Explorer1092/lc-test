<template lang="jade">
  .pager-container
    .pager.clearfix
      .page-button.first(@click="currentPage == 1 ? showFirstPageToast() : jumpTo(1)", :class="{disabled: currentPage == 1}") 首页
      .page-button.previous(@click=" currentPage - 1 >= 1 ? jumpTo( currentPage - 1 ) : showFirstPageToast()", :class="{disabled: currentPage == 1}") <
      .page-button(v-for = "(pageNum, index) in pages",
                   :class = "{active: currentPage == pageNum}",
                   @click="jumpTo(pageNum)") {{pageNum}}
      .page-button.next(@click=" currentPage + 1 <= totalPage ? jumpTo( currentPage + 1 ) : showLastPageToast()", :class="{disabled: currentPage == totalPage}") >
      .page-button.last(@click="currentPage == totalPage ? showLastPageToast() : jumpTo(totalPage)", :class="{disabled: currentPage == totalPage}") 尾页
</template>
<script>
/**
 * 翻页控件 by gaoyasong
 * 
 * 必传字段：totalPage
 * 选填字段：currentPageNumber -- 引入外部页码，默认为1
 *         maxPageButtonShow -- 展示几个页码按钮，建议设置奇数
 * 
 **/ 
export default {
  data: function () {
    return {
      currentPage: 1
    }
  },
  props: {
    totalPage: {
      type: Number,
      default: 1,
      required: true
    },
    currentPageNumber: {
      type: Number,
      default: 1
    },
    maxPageButtonShow: {
      type: Number,
      default: 5,
      validator: function (value) {
        if( value % 2 == 0) {
          //eslint-disable-next-line no-console
          console.log('[warning] 建议 "maxPageButtonShow" 设置为奇数')
        }
        return value % 2 != 0
      }
    }
  },
  watch: {
    currentPageNumber(curVal, oldVal) {
      this.currentPage = curVal
    }
  },
  created() {
    this.currentPage = this.currentPageNumber
  },
  components: {},
  computed: {
    pages() {
      let output = [],
        margin = Math.floor(this.maxPageButtonShow / 2)
      if( this.totalPage > this.maxPageButtonShow ) {
        let i = 1, max = this.maxPageButtonShow
        if(this.currentPage > 3 && this.currentPage < this.totalPage - margin ) {
          i = this.currentPage - margin
          max = this.currentPage + margin
        } else if( this.currentPage >= this.totalPage - margin ) {
          i = this.totalPage - this.maxPageButtonShow + 1
          max = this.totalPage
        }
        for( i; i <= max; i++ ) {
          output.push(i)
        }
      } else {
        for( let i = 1; i <= this.totalPage; i++ ) {
          output.push(i)
        }
      }
      return output
    }
  },
  mounted () {
  },
  methods: {
    jumpTo(pageNum) {
      this.currentPage = pageNum
      this.$emit('jumpToPageEvent', pageNum)
    },
    showLastPageToast() {
      return
    },
    showFirstPageToast() {
      return
    }
  }
}
</script>

<style lang="stylus" scoped>
  .pager-container
    width: 100%
    text-align: center
    .pager
      display: inline-block
      margin: 0 auto
      .page-button
        float: left
        width: 36px
        height: 36px
        line-height: 36px
        border-radius: 100px
        background-color: rgba(225,255,225,0.15)
        color: #ffffff
        text-align: center
        font-size: 18px
        cursor: pointer
        margin: 0 20px 0 0
        &.previous
          margin: 0 40px 0 0
          &.disabled
            color: #a26bb1
            cursor: not-allowed
            &:hover
              background-color: rgba(225,255,225,0.15)
        &.next
          margin: 0 0 0 20px
          &.disabled
            color: #a26bb1
            cursor: not-allowed
            &:hover
              background-color: rgba(225,255,225,0.15)
        &.first
          width: 76px
          height: 36px
          margin: 0 20px 0 0
          &.disabled
            color: #a26bb1
            cursor: not-allowed
            &:hover
              background-color: rgba(225,255,225,0.15)
        &.last
          width: 76px
          height: 36px
          margin: 0 0 0 20px
          &.disabled
            color: #a26bb1
            cursor: not-allowed
            &:hover
              background-color: rgba(225,255,225,0.15)
        &:hover
          background-color: rgba(225,255,225,0.3)
        &.active
          transform: scale(1.1)
          background-color: #a061fd

</style>