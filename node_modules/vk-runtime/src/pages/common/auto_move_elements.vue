<template lang="jade">
  .auto-move-element-container#j-move-el-box(v-show = "showAutoMoveElement")
    img.j-move-target.rocket(src="../../img/rocket13@1x.gif")
    img.j-move-target.fire_up(src="../../img/fire_to_up.png")
    img.j-move-target.fire_down(src="../../img/fire_to_down.png")
    img.j-move-target.fire_up_2(src="../../img/fire_to_up.png")
    img.j-move-target.rocket(src="../../img/rocket13@1x.gif")
    img.j-move-target.fire_up(src="../../img/fire_to_up.png")
    img.j-move-target.fire_down(src="../../img/fire_to_down.png")
    img.j-move-target.rocket_3(src="../../img/rocket13@1x.gif")
    img.j-move-target.fire_down(src="../../img/fire_to_down.png")
    img.j-move-target.rocket_2(src="../../img/rocket13@1x.gif")
    img.j-move-target.rocket(src="../../img/rocket13@1x.gif")
</template>
<script>
  import utils from '../../utils/_untils.js'
  export default {
    data: function () {
      return {}
    },
    props: ['showAutoMoveElement'], //此动画开关
    components: {},
    mounted() {
      if (this.showAutoMoveElement) {
        this.autoMove()
      }
    },
    methods: {
      autoMove() {
        var moveTargetCollection = document.getElementsByClassName('j-move-target'),
          flag = true,
          eachMovementIntervalTime = 2500,
          movementTotalTime = eachMovementIntervalTime * moveTargetCollection.length

        move(moveTargetCollection)
        setInterval(function () {
          move(moveTargetCollection)
        }, movementTotalTime + 5000)
        function move(moveTargetCollection) {
          each(moveTargetCollection, function (i, item) {
            item.style.transition = ''
            utils.removeClass(item, 'move')
            setTimeout(function () {
              item.style.transition = 'all 10s'
              item.className += " move"
            }, eachMovementIntervalTime * (parseInt(i) + 1))
          })
        }

        function each(obj, fn) {
          if (typeof obj === 'object') {
            var j = null
            for (j in obj) {
              if (obj.hasOwnProperty(j))
                if (fn.call(obj[j], j, obj[j]) == false)
                  break
            }
          }
        }
      }
    },
    watch: {
      showAutoMoveElement(curVal, oldVal) {
        this.showAutoMoveElements = curVal
      }
    }
  }
</script>

<style lang="stylus" scoped>
  .auto-move-element-container
    position: relative
    height: 100%
    z-index: -1
    overflow: hidden
    .rocket
      width: 80px
      position: absolute
      top: 102%
      left: 300px
      z-index: -1
      &.move
        width: 40px
        top: -400px
        left: 3000px
    .rocket_2
      width: 80px
      position: absolute
      top: 101%
      left: 3000px
      z-index: -1
      &.move
        width: 40px
        top: -200px
        left: 4000px
    .rocket_3
      width: 80px
      position: absolute
      top: 101%
      left: 4000px
      z-index: -1
      &.move
        width: 40px
        top: -400px
        left: 5000px
    .fire_up
      width: 69px
      position: absolute
      top: 101%
      left: 2200px
      z-index: -1
      &.move
        width: 6.9px
        top: -400px
        left: 3800px
    .fire_up_2
      width: 69px
      position: absolute
      top: 101%
      left: 3000px
      z-index: -1
      &.move
        width: 6.9px
        top: -400px
        left: 4500px
    .fire_down
      width: 90px
      position: absolute
      top: -300px
      left: 3000px
      z-index: -1
      &.move
        width: 9px
        top: 110%
        left: 1000px
</style>
