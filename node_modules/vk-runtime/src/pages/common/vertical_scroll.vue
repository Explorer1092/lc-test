<template lang="jade">
  .vertical-scroll-container(ref="vsContainer", @mousewheel="userSrollDown($event)", @DOMMouseScroll="userSrollDown($event)", @scroll="onScroll")
    .vertical-scroll-box(:style="{ 'margin-top': marginT }")
      slot
    arrow(@arrowClick="windowScoll", :leftEnd = "isAtLeftEnd", :rightEnd = "isAtRightEnd")
</template>
<script>
  import arrow from './arrow.vue'

  export default {
    data: function () {
      return {
        isAtLeftEnd: true,
        isAtRightEnd: false,
        flag: 0 
      }
    },
    props:['marginT'],
    components: {
      arrow
    },
    updated: function() {
      if(!this.flag) {
        this.flag++
        this.initArrow()
      }
    },
    mounted () {
    },
    methods: {
      userSrollDown(e) {
        this.$el.scrollLeft += e.deltaY || e.detail * 5
      },
      initArrow() {
        if( this.$el.scrollWidth > window.innerWidth ) {
          this.isAtRightEnd = false
        } else {
          this.isAtRightEnd = true
        }
      },
      onScroll() {
        if (this.$el.scrollLeft == 0) {
          this.isAtLeftEnd = true
        } else {
          this.isAtLeftEnd = false
        }
        if (this.$el.scrollLeft >= this.$el.scrollWidth - window.innerWidth) {
          this.isAtRightEnd = true
        } else {
          this.isAtRightEnd = false
        }
      },
      windowScoll(direction) {
        let moveDistance = window.innerWidth / 3
        Velocity(this.$el, "scroll", {
          axis: "x",
          container: this.$el,
          duration: 300,
          offset: direction == 'right' ? moveDistance : 0 - moveDistance
        })
      }
    }
  }
</script>
<style lang="stylus" scoped>
  .vertical-scroll-container
    height: 100%
    margin: 0 auto
    text-align: center
    overflow-x: auto
    .vertical-scroll-box
      white-space: nowrap
      position: relative
      top: 50%
</style>