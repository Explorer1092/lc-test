<template lang="jade">
  .down-app-layer(v-if="isShow")
    .down-dialog
      .down-dialog-img
      .down-dialog-content
        p.down-dialog-header-text Notice
        p.down-dialog-content-text(v-html="tripsContent")
        .down-app-no-download-button(@click="closeLayer") 下次再说
        .down-app-down-button(@click="downApp") 下载客户端
        input(type="checkbox" for="no-trips" v-model="isChecked" v-if="isShowTrips")
        span#no-trips(v-if="isShowTrips") 不再提示
</template>
<script>
  export default {
    name: 'downApp',
    data(){
      return {
        isChecked: false,
        isShow: true
      }
    },
    props: {
      tripsContent: {
        type: String,
        default: ''
      },
      isShowTrips: {
        type: Boolean,
        default: true
      }
    },
    watch: {
      isChecked(newValue, oldValue){
        if (newValue) {
          localStorage.setItem("isShow", "false")
        } else {
          localStorage.setItem("isShow", "true")
        }
      }
    },
    methods: {
      isShowRecordLayer(){
        let agent = navigator.userAgent
        if (agent.indexOf("VIPKID") > -1) {
          this.isShow = false
        } else if (this.isShowTrips == false) {
          this.isShow = true
        } else if (localStorage.getItem("isShow") == "false") {
          this.isShow = false
        }
      },
      closeLayer(){
        this.isShow = false
      },
      downApp(){
        let agent = navigator.userAgent
        if (agent.indexOf('Mac OS') > -1) {
          location.href = "https://www.vipkid.com.cn/downloads/parent_client/mac/latest"
        } else {
          location.href = "https://www.vipkid.com.cn/downloads/parent_client/win/latest"
        }
      }
    },
    mounted(){
      this.isShowRecordLayer()
    }
  }
</script>
<style lang="stylus" scoped>
  .down-app-layer
    position: absolute
    top: 0
    left: 0
    right: 0
    bottom: 0
    background: rgba(0, 0, 0, .6)
    z-index: 100

  .down-dialog
    position: absolute
    left: 50%
    top: 50%
    margin-left: -240px
    margin-top: -230px
    height: 461px
    width: 480px

  .down-dialog-img
    position: absolute
    left: 110px
    width: 260px
    height: 100px
    background: url("../../img/video/pre-record-dialog-header-logo@2x.png") no-repeat
    background-size: 260px 100px
    z-index: 20

  .down-dialog-content
    position: absolute
    top: 86px
    width: 480px
    height: 375px
    background: url(../../img/video/pre-record-dialog@2x.png) no-repeat
    background-size: 480px 375px

  .down-dialog-header-text
    margin-top: 20px
    height: 50px
    width: 100%
    color: #fff
    font-family: PingFangSC
    font-size: 24px
    text-align: center
    background: #A18EE3

  .down-dialog-content-text
    position: absolute
    top: 170px
    left: 7%
    width: 86%
    color: #666
    font-size: 20px
    line-height: 1.4
    text-align: center

  .down-app-no-download-button
    position: absolute
    top: 254px
    left: 75px
    width: 140px
    height: 40px
    font-size: 18px
    font-family: PingFangSC
    line-height: 40px
    text-align: center
    color: #fff
    background: url(../../img/video/pre-record-next-trips@2x.png) no-repeat
    background-size: 140px 40px

  .down-app-down-button
    position: absolute
    top: 254px
    right: 75px
    width: 140px
    height: 40px
    font-size: 18px
    font-family: PingFangSC
    line-height: 40px
    text-align: center
    color: #fff
    background: url(../../img/video/pre-record-down-app-button@2x.png) no-repeat
    background-size: 140px 40px

  input
    position: absolute
    left: 202px
    top: 313px
    -webkit-appearance: none
    width: 22px
    height: 22px
    border: 0
    background: #e5e0e0
    &:checked
      background: url(../../img/video/pre-record-checked@2x.png) no-repeat
      background-size: 22px 22px

  #no-trips
    position: absolute
    top: 319px
    left: 225px
    color: #999
    font-size: 14px
</style>
