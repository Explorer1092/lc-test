<template lang="jade">
   .cards-preview
     .cards-preview-img
       img.cards-preview-img-con(:src="selectedCardObj.cardImg",ref="big_card_img")
     .cards-preview-con(ref="big_card_text")
       img.cards-preview-con-header(v-if="selectedTeacher.avatar",:src="selectedTeacher.avatar")
       img.cards-preview-con-header(v-if="!selectedTeacher.avatar",src="../../../img/greeting_cards/user_imag@2x.png")
       p.cards-preview-con-name(:title="selectedTeacher.showName") {{selectedTeacher.showName?selectedTeacher.showName:'teacher'}}
       p.cards-preview-con-call Hi,{{selectedTeacher.showName?selectedTeacher.showName:'XX'}}
       p.cards-preview-con-main(v-html="giving") 
     .cards-preview-exit
       img.cards-preview-exit-shadow(src="../../../img/greeting_cards/shadow.png")
     .cards-preview-arrest(@click="doChecked")
       .cards-preview-arrest-checkbox
         .cards-preview-arrest-checkbox-checked(v-show="grantStatus=='GRANTED'")
       .trips 授权使用贺卡
</template>

<script>
export default {
  data(){
    return {
    }
  },
  props:{
    giving:{
      type: String,
      default: ""
    },
    selectedTeacher:{
      type: Object,
      default: function(){
        return {}
      }
    },
    selectedCardObj:{
      type: Object,
      default: function(){
        return {}
      }
    },
    grantStatus:{
      type: String,
      default: "CANCEL_GRANT"
    },
    grantStatsIng:{
      type: Boolean,
      default: false
    }
  },
  watch:{
    // 监听是否更改贺卡
    selectedCardObj:function(){
      this.$nextTick(() => {
        Velocity(this.$refs.big_card_img, {
          opacity: 1
        },
        {
          duration: 800,
          easing: 'spring',
          begin:()=>{
            this.$refs.big_card_img.className="cards-preview-img-con cards-preview-img-con-animation"
            this.$refs.big_card_text.className="cards-preview-con cards-preview-con-animation"
          },
          complete:()=>{
            this.$refs.big_card_img.className="cards-preview-img-con"
            this.$refs.big_card_text.className="cards-preview-con"
          }
        })
      })
    }
  },
  methods: {
    doChecked() {
      if(this.grantStatsIng == true){
        this.$showToast("请保证间隔时间")
        return
      }
      let status = 'GRANTED'
      if(this.grantStatus == "GRANTED"){
        status = "CANCEL_GRANT"
      }else{
        status = "GRANTED"
      }
      this.$emit("setGrantStatus",{"isChecked": status})
    }
  }
}
</script>

<style lang="stylus" scoped>
.cards-preview
  position: relative
  width: 375px
  height: 528px
  color: #fff
  // 卡片图
  .cards-preview-img
    position: absolute
    z-index: 1
    width: 375px
    height: 520px
    overflow: hidden
    .cards-preview-img-con
      width: 375px
      height: 520px
    .cards-preview-img-con-animation
      animation: fadeOutUp .4s ease .1s 1 both
      @keyframes fadeOutUp
        from
          margin-top: 50px
          opacity: 0
        to
          margin-top: 0px
          opacity: 1
  .cards-preview-con-animation
    animation: fadeOutIn .4s ease .3s 1 both
    @keyframes fadeOutIn
      from
        opacity: 0
      to
        opacity: 1
  // 卡片内容
  .cards-preview-con
    position: absolute
    top: 109px
    left: 46px
    z-index: 2
    width: 283px
    height: 220px
    @media  only screen and (min-device-width : 768px) and (max-device-width : 1024px) and (orientation : landscape)
      left: 47px
    .cards-preview-con-header
      position: absolute
      left: 50%
      width: 52px
      height: 52px
      margin-left: -26px
      border-radius: 50%
    .cards-preview-con-name
      width: 283px
      height: 28px
      line-height: 28px
      margin-top: 60px
      font-size: 20px
      text-align: center
      overflow: hidden
      text-overflow: ellipsis
      white-space: nowrap
    .cards-preview-con-call
      width: 283px
      height: 22px
      line-height: 22px
      font-size: 16px
    .cards-preview-con-main
      width: 283px
      height: 122px
      line-height: 20px
      margin-top: 6px
      white-space: pre-wrap
      word-wrap: break-word
      word-break: break-all
      
   // 卡片出口
  .cards-preview-exit
    display: inline-block
    position: absolute
    top: 510px
    left: -6px
    width: 390px
    height: 26px
    background:url("../../../img/greeting_cards/exit.png") bottom no-repeat
    .cards-preview-exit-shadow
      width: 373px
      height: 16px
      margin: 9px 0 0 9px
  .cards-preview-arrest
    position: absolute
    top: 540px
    width: 281px
    height: 20px
    line-height: 20px
    margin: 10px 0 0 128px
    font-size: 16px
    display: flex
    align-items: center
    justify-content: flex-start
    cursor: pointer
    .cards-preview-arrest-checkbox
      box-sizing: border-box
      width: 14px
      height: 14px
      border-radius: 5px
      border: 2px solid rgba(255,255,255,0.8)
      margin-right: 10px
      display: flex
      align-items: center
      justify-content: center
     .cards-preview-arrest-checkbox-checked
       width: 6px
       height: 6px
       background: rgba(255,102,0,0.8)
       border-radius: 5px
   
      
</style>

