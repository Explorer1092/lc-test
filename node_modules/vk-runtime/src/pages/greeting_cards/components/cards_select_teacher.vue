<template lang="jade">
  .cards-select-teacher
    .cards-select-teacher-title 选择老师
    .cards-select-teacher-list
      .cards-select-teacher-list-con(ref="teacherCon",@scroll="listScrollListener")
        .cards-select-teacher-list-each(v-for="(item,index) in teacherList" ,@click="selectTeacher(item)")
          img.cards-select-teacher-list-each-header(v-if="item.avatar",:src="item.avatar",:class="selectId==item.id?'selected-header':''")
          img.cards-select-teacher-list-each-header(v-if="!item.avatar",src="../../../img/greeting_cards/user_imag@2x.png",:class="selectId==item.id?'selected-header':''")
          p.cards-select-teacher-list-each-name(:title="item.showName",:class="selectId==item.id?'selected-name':''") {{item.showName}}
        .isAll
          p(v-show="(teacherTotalPages != 0) && (teacherTotalPages <= pageNum)") 暂无更多！
          p(v-show="isLoadingTeacher") 正在加载中  
      .cards-select-teacher-list-default(v-show="isReqSuccess && teacherList.length<=0")
          span
          .cards-select-teacher-list-default-p
            p 你还没有上过课，请爸爸妈妈先约一位老师上课吧～
      .cards-select-teacher-list-default(v-show="!isReqSuccess && teacherList.length<=0")
          span
          .cards-select-teacher-list-default-p
            p 数据好像出了点问题，请稍后再来试试～
</template>
<style lang="stylus" scoped>
.cards-select-teacher-con
  .cards-select-teacher-title
    width: 810px
    height: 28px
    line-height: 28px
    margin-top: 12px
    font-size: 20px
    color: #fff
    text-align: center
  .cards-select-teacher-list
    width: 695px
    height: 430px
    margin: 10px
    padding: 10px 48px
    background:url("../../../img/greeting_cards/select_teacher_bg.png") no-repeat
    .cards-select-teacher-list-con
      width: 650px
      height: 330px
      margin: 20px 0 0 49px
      overflow-y: auto
      &::-webkit-scrollbar
          width: 8px
          height: 8px
          -webkit-border-radius: 4px
          -moz-border-radius: 4px
          border-radius: 4px
      &::-webkit-scrollbar-track
          background: rgba(0, 0, 0, 0)
      &::-webkit-scrollbar-thumb
          background: rgba(0, 0, 0, 0.1)
          border-radius: 4px
      .isAll
        width: 610px
        height: 30px
        line-height: 30px
        text-align: center
        clear: both
        color: #f60
      .cards-select-teacher-list-each
        position: relative
        display: inline-block
        float: left
        width: 108px
        height: 138px
        margin: 20px 44px 10px 44px
        cursor: pointer
        .cards-select-teacher-list-each-header
          width: 100px
          height: 100px
          border: 4px solid #eaeae7
          border-radius: 50%
        .cards-select-teacher-list-each-name
          height: 28px
          width: 108px
          margin-top: 10px
          text-align: center
          color: #555555
          font-size: 20px
          overflow: hidden
          white-space: nowrap
          text-overflow: ellipsis
        .selected-header
          border: 4px solid #FF6600
        .selected-name
          color: #FF6600

    .cards-select-teacher-list-default
      position: absolute
      width: 500px
      height: 300px
      top: 80px
      left: 50%
      margin-left: -250px
      span
        display: block
        width: 252px
        height: 180px
        background: url("../../../img/greeting_cards/none.png")
        background-size: 100% 100%
        margin: 50px auto 0 auto 
      .cards-select-teacher-list-default-p
        position: absolute
        left: 0
        top: 250px
        bottom: 40px
        width: 100%
        color: #555555
        font-size: 20px
        p
          color: #f60
          font-size: 18px
          line-height: 24px
          text-align: center
</style>

<script>
export default {
  data() {
    return {
      selectId:this.selectedTeacherId?this.selectedTeacherId :0, // 选中的教师id
      state: true //定义是否触发教师列表请求的回调函数的状态
    }
  },
  props:{
    // 教师列表
    teacherList: {
      type: Array,
      default: function(){
        return []
      }
    },
    selectedTeacherId:{
      type: Number,
      default: 0
    },
    // 教师列表总页数
    teacherTotalPages:{
      type:Number,
      default:0
    },
    // 是否进行加载中
    isLoadingTeacher:{
      type:Boolean,
      default: false
    },
    //教师列表请求状态
    isReqSuccess:{
      type:Boolean,
      default: true
    },
    pageNum:{
      type: Number,
      default: 0 
    }
  },
  methods: {
    selectTeacher(obj){
      this.selectId = obj.id
      this.$emit("selectTeacherId",obj)
    },
    // 滚动条到达底部
    listScrollListener() {
      let teacherCon = this.$refs.teacherCon
      let scrollTop = teacherCon.scrollTop
      let clientHeight = teacherCon.clientHeight
      let scrollHeight = teacherCon.scrollHeight
      if (scrollHeight-scrollTop - 10 <= clientHeight) {
        if (this.state) {
          this.state = false
          this.$emit("getTeacherList",this.changeFlag)
        }
      }
    },
    changeFlag(state) {
      this.state = state
    }
  }
}
</script>
