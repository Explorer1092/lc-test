<template lang="jade">
  .me-index-content
    .me-index-title
      .mit-cn {{title.cn}}
      .mit-en {{title.en}}
    .net-error(v-show="netErrorShow")
      netError
    .me-index-back(@click="goToBack")
    .me-index-list(v-if="channels.length!=0")
      .me-index-item
        img(class="iconImg",src="../../img/major_extension/vietualFieldTrip@3x.png",:style="channels[0].status==status['locked']?{opacity:0.5}:{}",@click="channels[0].status==status['locked']?null:goToDetail(0)")
        .me-item-lock(v-if="channels[0].status==status['locked']")
          .lockTip(:style="lockTipShow[0]?{opacity:1}:{opacity:0}") {{lockTip}}
          img(class="lockImg",@click="lockClick($event,0)",src="../../img/major_extension/list-lock@3x.png")
        .mii-title-en {{channels[0].pcShowNameEN}}
          img(class="icon-new animated zoomIn infinite",v-if="channels[0].status==status['new']",src="../../img/major_extension/icon-new.png")
        .mii-title-cn {{channels[0].pcShowNameCH}}
      .me-index-item
        img(class="iconImg",src="../../img/major_extension/learningExtension@3x.png",:style="channels[1].status==status['locked']?{opacity:0.5}:{}",@click="channels[1].status==status['locked']?null:goToDetail(1)")
        .me-item-lock(v-if="channels[1].status==status['locked']")
          .lockTip(:style="lockTipShow[1]?{opacity:1}:{opacity:0}") {{lockTip}}
          img(class="lockImg",@click="lockClick($event,1)",src="../../img/major_extension/list-lock@3x.png")
        .mii-title-en {{channels[1].pcShowNameEN}}
          img(class="icon-new animated zoomIn infinite",v-if="channels[1].status==status['new']",src="../../img/major_extension/icon-new.png")
        .mii-title-cn {{channels[1].pcShowNameCH}}
      .me-index-item
        img(class="iconImg",src="../../img/major_extension/softSkills@3x.png",:style="channels[2].status==status['locked']?{opacity:0.5}:{}",@click="channels[2].status==status['locked']?null:goToDetail(2)")
        .me-item-lock(v-if="channels[2].status==status['locked']")
          .lockTip(:style="lockTipShow[2]?{opacity:1}:{opacity:0}") {{lockTip}}
          img(class="lockImg",@click="lockClick($event,2)",src="../../img/major_extension/list-lock@3x.png")
        .mii-title-en {{channels[2].pcShowNameEN}}
          img(class="icon-new animated zoomIn infinite",v-if="channels[2].status==status['new']",src="../../img/major_extension/icon-new.png")
        .mii-title-cn {{channels[2].pcShowNameCH}}
</template>
<script>
import axios from 'axios'
import cookies from 'cookies-js'
import netError from '../common/vk_net_error.vue'
import untils from '../../utils/_untils.js'
export default {
  data: function () {
    return {
      lockTip: "完成每个学习周期可以获得新拓展内容哦~",
      lockTipShow: [false, false, false],
      staticImgShow: false,
      netErrorShow: false,
      status: {
        locked: 1,
        unlocked: 2,
        new: 3
      },
      title: {
        en: "Major Course Extension",
        cn: "主修拓展"
      },
      channels: []
    }
  },
  components: {
    netError
  },
  computed: {},
  mounted() {
    this.getList()
  },
  methods: {
    //去往详情页面，拓展视频
    goToDetail(index) {
      this.$playSound("click")
      sa.track('learning_click', { 'click_id': 'pc_learning_major_extension_index_list_' + this.channels[index].bizCode + '_' + this.channels[index].status })
      this.$router.push({ name: 'majorExtensionPath', params: { bizCode: this.channels[index].bizCode } })
    },
    goToBack() {
      this.$playSound("click")
      sa.track('learning_click', { 'click_id': 'pc_learning_major_extension_index_back' })
      untils.gotoFirstPage()
    },
    lockClick(e, index) {
      this.$playSound("click")
      sa.track('learning_click', { 'click_id': 'pc_learning_major_extension_index_list_' + this.channels[index].bizCode + '_' + this.channels[index].status })
      this.lockTipShow.splice(index, 1, true)
      e.target.onmouseleave = () => {
        this.lockTipShow.splice(index, 1, false)
        e.target.onmouseleave = null
      }
    },
    getList() {
      axios.get('/rest/learninggw/api/pc/material/getMaterialsByStudentID', {
        params: {
          sid: cookies.get("studentId")
        }
      }).then((res) => {
        if (res.data.code == 200) {
          this.channels = res.data.data
        }
      })
        .catch((error) => {
          this.netErrorShow = true
        })
    }
  }
}
</script>

<style lang="stylus" scoped>
  *
    box-sizing: border-box
    -moz-user-select: none
    -webkit-user-select: none
    -ms-user-select: none
    -khtml-user-select: none
    user-select: none
    -webkit-font-smoothing: antialiased
    font-weight: 300
    -webkit-touch-callout: none
  .me-index-content
    width: 100%
    height: 100%
    text-align: center
    color: #ffffff
    .net-error
      width: 30%
      margin: auto
    .me-index-back
      position: absolute
      height: 58px
      width: 58px
      top: 20px
      left: 40px
      cursor: pointer
      background: url("../../img/common/back.png") no-repeat center
      &:hover
        background: url("../../img/common/back-hover.png") no-repeat center
      &:active
        background: url("../../img/common/back-pressed.png") no-repeat center
    .me-index-title
      padding-top: 12px
      .mit-cn
        font-size: 34px
        line-height: 45px
      .mit-en
        font-size: 24px
        line-height: 27px
    .me-index-list
      margin-top: 86px
      .me-index-item
        position: relative
        float: left
        width 33.3%
        text-align: center
        img.iconImg
          width: 65%
          cursor: pointer
          transition: width .1s
          &:hover
            width: 75%
        .me-item-lock
          position: absolute
          width: 100%
          height: 100%
          top: 0
          text-align: center
          img.lockImg
            width: 15%
            top: 30%
            left: 42.5%
            cursor: pointer
          .lockTip
            height: 75px
            width: 240px
            margin: auto
            padding: 9px 21px 22px 21px
            background: url("../../img/major_extension/tip_bg.png") no-repeat center
            color: #555555
            transition: opacity 1s
            margin-top: 15%
        .mii-title-en
          margin-top: 48px
          font-size: 22px
          .icon-new
            margin: -30px -20px 0 0
        .mii-title-cn
          margin-top 5px
          font-size: 16px
</style>
