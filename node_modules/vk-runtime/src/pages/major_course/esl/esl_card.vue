<template lang="jade">
  .esl-card
    .esl-card-item(v-if="cardData.isLocked", :class="'cardIndex-' + cardIndex")
      .esl-card-base
      .esl-card-sequence {{cardData.sequence}}
    .esl-card-item(v-else, :class="'cardIndex-' + cardIndex")
      img.esl-shape-light(v-if="cardData.letCardShining", src="../../../img/major/esl_card_shape_light.png")
      .esl-card-base(:class="{'gold': cardData.letCardShining}")
      .esl-card-sequence(:class="{'gold': cardData.letCardShining}") {{cardData.sequence}}
      .esl-card-bg
        slide-text.esl-card-title(:text="cardData.detailTitle")
        .esl-teacher-head-box
          img.esl-teacher-head-img(v-if="cardData.detailAvatar", :src="cardData.detailAvatar")
          img.esl-teacher-head-img(v-else, src="../../../img/major/default_teacher.png")
        .esl-left-info-box(@click="openDetailTrigger")
          .date-time(:class="{'align-middle': !cardData.pathAchievement.achievementType}")
            .date {{cardData.detailTimeString.split(' ')[0]}}
            .time {{cardData.detailTimeString.split(' ')[1]}}
          .card-star(v-if="cardData.pathAchievement.achievementType == 'STAR'", :class="'star-' + cardData.pathAchievement.star")
          .text(v-else-if="cardData.pathAchievement.achievementType == 'COLORTEXT'")
            span {{cardData.pathAchievement.title}}
            span.score {{ cardData.pathAchievement.status == 1 ? cardData.pathAchievement.colorText : '--' }}
          .right-wrong(v-else-if="cardData.pathAchievement.achievementType == 'HOMEWORK'")
            .rw-icon(:class="cardData.pathAchievement.status == 0 ? 'right-off' : 'right-on' ")
            span.num {{cardData.pathAchievement.status == 0 ? '--' : cardData.pathAchievement.homeworkRight}}
            .rw-icon(:class="cardData.pathAchievement.status == 0 ? 'wrong-off' : 'wrong-on' ")
            span.num {{cardData.pathAchievement.status == 0 ? '--' : cardData.pathAchievement.homeworkWrong}}
          .left-button.grey(v-if="cardData.pathButtonList[0].buttonStatus == 'GRAY'", @click.stop="") {{cardData.pathButtonList[0].buttonText}}
          .left-button(v-else, @click.stop="courseButtonHandler(cardData.pathButtonList[0])") {{cardData.pathButtonList[0].buttonText}}
        .esl-right-video-box
          .esl-video-title {{cardData.aiVideoClass.title}}
          .esl-video-img-box
            img.esl-video-img(v-if="cardData.aiVideoClass.coverUrl", :src="cardData.aiVideoClass.coverUrl")
            img.esl-video-img(v-else, src="../../../img/index/pre_bg.png")
          .right-button.grey(v-if="cardData.aiVideoClass.buttonStatus == 'GRAY'") {{cardData.aiVideoClass.buttonText}}
          .right-button.grey-alert(v-else-if="cardData.aiVideoClass.buttonStatus == 'GRAY_ALERT'", @click.stop="popAlert('直播课结束后才可查看哦~')") {{cardData.aiVideoClass.buttonText}}
          .right-button(v-else, @click.stop="courseButtonHandler(cardData.aiVideoClass)") {{cardData.aiVideoClass.buttonText}}
</template>
<script>
  import Vue from 'vue'
  import axios from 'axios'
  import cookies from 'cookies-js'
  import utils from '../../../utils/_untils.js'
  import slideText from '../../common/vk_slide_text.vue'
  import Course from '../../common/course/Course.js'

  export default {
    data() {
      return {
        isBubbleHintShow: false
      }
    },
    props: [
      'cardIndex',
      'cardData'
    ],
    components: {
      slideText
    },
    mounted() {
    },
    methods: {
      openDetailTrigger() {
        this.$emit("detailTrigger")
      },
      courseButtonHandler(buttonData) {
        Course.courseButtonClick({
          type: buttonData.buttonFunction,
          clickId: buttonData.clickId + '_path_card',
          buttonExtra: buttonData.buttonExtra,
          onlineClassId: this.cardData.onlineClassId,
          lessonId: this.cardData.lessonId,
          courseId: this.cardData.courseId, 
          curriculumVersion: this.cardData.curriculumVersion,
          lessonNum: this.cardData.lessonNumber.match(/\d+/g)[0]
        })
      },
      popAlert(alertText) {
        this.$showToast(alertText)
      },
      ballBubbleHintShow() {
        this.isBubbleHintShow = true
      },
      ballBubbleHintHide() {
        this.isBubbleHintShow = false
      }
    }
  }
</script>

<style lang="stylus" scoped>
  .esl-shape-light
    position: absolute
    top: -20px
    left: -16px
    width: 324px
    height: 309px

  .esl-right-video-box
    position: absolute
    top: 63px
    left: 172px

  .esl-video-title
    position: absolute
    top: 11px
    left: 0px
    width: 97px
    font-size: 14px
    color: #555555

  .esl-video-img-box
    position: absolute
    top: 44px
    left: 9px
    width: 84px
    height: 64px
    border-radius: 5px
    background-color: #DDCFF3
  .esl-video-img
    position: absolute
    top: 2px
    left: 2px
    width: 80px
    height: 60px
    border-radius: 5px
  .right-button
    position: absolute
    top: 120px
    left: 4px
    width: 90px
    height: 30px
    background-image: url("../../../img/major/class_button_purple2@2x.png")
    background-repeat: no-repeat
    background-size: 100% 100%
    font-size: 14px
    line-height: 30px
    text-align: center
    cursor: pointer
    color: #fff
    &:hover
      opacity: 0.7
    &.grey
      background-image: url("../../../img/major/grey_button.png")
      cursor: not-allowed
      &:hover
        opacity: 1
    &.grey-alert
      background-image: url("../../../img/major/grey_button.png")
      cursor: default
      &:hover
        opacity: 1

  .esl-card-item
    position: absolute
    width: 290px
    height: 320px
    z-index: 9
    &.cardIndex-1
      top: 60px
      left: 50px
    &.cardIndex-2
      top: 154px
      left: 440px
    &.cardIndex-3
      top: 60px
      left: 827px
    &.cardIndex-4
      top: 153px
      left: 1220px
    &.cardIndex-5
      top: 60px
      left: 1609px
    &.cardIndex-6
      top: 60px
      left: 1999px
    &.cardIndex-7
      top: 153px
      left: 2391px
    &.cardIndex-8
      top: 60px
      left: 2780px
    &.cardIndex-9
      top: 154px
      left: 3171px
    &.cardIndex-10
      top: 58px
      left: 3562px
    .esl-card-bg
      position: absolute
      left: 50%
      margin-left: -140px
      width: 280px
      height: 263px
      background-image: url("../../../img/major/esl-card-bg.png")
      background-repeat: no-repeat
      background-size: 100% 100%

      .esl-left-info-box
        position: absolute
        top: 76px
        left: 14px
        width: 151px
        height: 157px
        cursor: pointer
        border-radius: 24px
        .date-time
          position: absolute
          top: 10px
          left: -5px
          width: 155px
          color: #8F5ED9
          font-size: 18px
          &.align-middle
            top: 29px
          .time
            font-weight: 800
        .card-star
          position: absolute
          top: 66px
          left: 1px
          display: inline-block
          width: 148px
          height: 24px
          background-image: url("../../../img/card_collection.png")
          background-size: 617px
          background-repeat: no-repeat
          &.star-5
            background-position: 0 -293px
          &.star-4
            background-position: 0 -319px
          &.star-3
            background-position: 0 -344px
          &.star-2
            background-position: 0 -369px
          &.star-1
            background-position: 0 -394px
          &.star-0
            background-position: 0 -418px
        .text
          position: absolute
          top: 68px
          left: -5px
          font-size: 16px
          width: 155px
        .right-wrong
          position: absolute
          top: 68px
          left: 21px
          .num
            display: inline-block
            vertical-align: middle
            width: 20px
            margin-right: 12px
          .rw-icon
            width: 24px
            height: 24px
            display: inline-block
            vertical-align: middle
            background-image: url("../../../img/major/right_wrong_icon.png")
            background-size: 48px
            background-repeat: no-repeat
            margin-right: 3px
            &.right-on
              background-position: -24px -24px
            &.right-off
              background-position: 0px -24px
            &.wrong-on
              background-position: -24px 0px
            &.wrong-off
              background-position: 0px 0px

        .left-button
          position: absolute
          top: 107px
          left: 50%
          margin-left: -45px
          width: 90px
          height: 30px
          background-image: url("../../../img/major/class_button_purple2@2x.png")
          background-repeat: no-repeat
          background-size: 100% 100%
          font-size: 14px
          line-height: 30px
          text-align: center
          cursor: pointer
          color: #fff
          &:hover
            opacity: 0.7
          &.grey
            background-image: url("../../../img/major/grey_button.png")
            cursor: not-allowed
            &:hover
              opacity: 1
        .score
          color: #FAA215
          margin-left: 6px
      .esl-teacher-head-box
        position: absolute
        top: 27px
        left: 11px
        width: 50px
        height: 50px
        border-radius: 99px
        background-color: #fff
      .esl-teacher-head-img
        position: absolute
        top: 1px
        left: 1px
        width: 48px
        height: 48px
        border-radius: 99px
      .esl-card-title
        position: absolute
        left: 61px
        top: 15px
        width: 170px
        font-size: 18px
        color: #fff
        text-align: center

    .esl-card-sequence
      position: absolute
      top: 270px
      left: 120px
      width: 50px
      color: #fff
      font-size: 24px
      text-shadow: 0px 0px 2px #C082DD
      &.gold
        text-shadow: 0px 0px 2px #F7BB66

    .esl-card-base
      position: absolute
      width: 54px
      height: 54px
      background-image: url("../../../img/major/esl-card-base-normal.png")
      background-repeat: no-repeat
      background-size: 100% 100%
      bottom: 0
      left: 50%
      margin-left: -27px
      &.gold
        background-image: url("../../../img/major/esl-card-base-gold.png")
        &:before
          content: ''
          position: absolute
          top: -50px
          left: -110px
          z-index: -1
          width: 278px
          height: 102px
          background-image: url("../../../img/major/golden-light.png")
          background-repeat: no-repeat
          background-size: 100% 100%
</style>
