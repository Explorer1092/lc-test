import cookies from 'cookies-js'

let isFromApp = cookies.get('isFromApp')

function isOldVipkidClient() {
  var match = navigator.userAgent.match(/vipkid\/(\d+).(\d+)/i)
  return (match && parseInt(match[2]) < 2 && parseInt(match[1]) == 1) ? true : false
}

function isVipkidClient() {
  var match = navigator.userAgent.match(/vipkid\/(\d+).(\d+)/i)
  return (match && parseInt(match[2]) >= 3 && parseInt(match[1]) >= 1) || (match && parseInt(match[1]) >= 2) ? true : false
}

function isFromAppClient() {
  return !!isFromApp
}

function getDeviceType() {
  if (isOldVipkidClient() || isVipkidClient()) {
    return 2
  } else if (isFromApp) {
    return 3
  } else {
    return 1
  }
}

function getQueryString(name) {
  var result = location.search.match(new RegExp("[\?\&]" + name + "=([^\&]+)", "i"))
  if (result == null || result.length < 1) {
    return ""
  }
  return decodeURIComponent(result[1])
}

export {
  isOldVipkidClient,
  isVipkidClient,
  isFromAppClient,
  getDeviceType,
  getQueryString
}
