<template lang="jade">
  .homework-header
    a.back-btn(@click="backBtnEvent", v-show="!isIpad && !isOldVipkid", href="javascript:void(0);")
    h1.pc-big-title(v-show="!isIpad") {{bigTitle + ' &nbsp; ' + subTitle}}
    h1.ipad-big-title(v-show="isIpad") {{bigTitle}}
    h1.ipad-sub-title(v-show="isIpad") {{subTitle}}
    a.mini-work-btn(@click.stop="switchMiniHomework", v-if="isShowNhwButton && switchminishow && hasminihomework && !isIpad && !isActivity && !homeworkresultshow")
    a.standard-work-btn(@click.stop="switchStandardHomework", v-if="isShowNhwButton && hasstandard && !isIpad && !isActivity && !homeworkresultshow")
    //- a.page-help(v-show="!isVipkid && !isIpad && !isActivity && commonproblemshow && !homeworkresultshow" href="/homework/help" target="_blank")
    a.page-feedback(v-show="!isVipkid && !isIpad && !isActivity && commonproblemshow && !homeworkresultshow", :href="`/homework/help/?homeworkid=${homeworkid}&type=${type}`", target="_blank")
</template>
<script>
  import axios from 'axios'
  import cookies from 'cookies-js'
  import { isFromAppClient, isOldVipkidClient, isVipkidClient, getQueryString } from './_toolsFunction.js'
  import dragonUtils from '../../../utils/_dragon.js'
  const HOMEWORK_TYPE = {
    PRECLASS: 1,
    HOMEWORK: 2,
    ACTIVITY: 3
  }
  
  export default {
    // homeworkresultshow字段 问题反馈和常见问题，显示是相反的
    data() {
      return {
        isIpad: isFromAppClient(),
        isOldVipkid: isOldVipkidClient(),
        isVipkid: isVipkidClient(),
        isActivity: false,
        isShowNhwButton: true,
        type: 2,
        version: 1,
        backUrl: ''
      }
    },
    props: ['bigTitle', 'subTitle', 'switchminishow', 'commonproblemshow', 'homeworkresultshow', 'fromUrlProp', 'hasstandard', 'hasminihomework', 'homeworkid', 'lessonId'],
    components: {
    },
    watch: {
      type(curVal, oldVal) {
        this.isActivity = (this.type == 3)
      }
    },
    mounted() {
      let params = location.pathname.split('/')
      if (params[2] == 'activity') {
        this.type = 3
      } else {
        this.type = this.$route.params.type * 1
      }
      if(getQueryString('curriculumVersion')) {
        this.version = getQueryString('curriculumVersion')
      } else {
        this.version = '1'
      }
      //mini/standard和SL对掉后，mini/standard跳到SL就不再显示右上角nhw入口了,所以，mini/standard跳SL的时候带上一个参数fromnhw=1，这里就隐藏掉右上角nhw入口
      if (location.search.indexOf('fromnhw') > -1) {
        this.isShowNhwButton = false
      }
      if (document.location.origin) {
        this.backUrl = encodeURIComponent(document.location.origin)
      } else {
        //兼容IE10-
        this.backUrl = encodeURIComponent(document.location.protocol + '//' + window.location.hostname)
      }

    },
    methods: {
      backBtnEvent() {
        this.$router.push(this.fromUrlProp)
      },
      feedbackShow() {
        this.$emit('emit-feedbackshow')
      },
      switchMiniHomework() {
        window.location.replace('//' + window.location.hostname.replace('lc','nhw') + `/v2.0/index.html?deviceType=1&studentId=${cookies.get('studentId')}&lessonId=${this.lessonId}&curriculumVersion=${this.version}&platform=2&scene=2&product=MINI&back_url=${this.backUrl}`) //回lc首页 @back_url 用于作业端返回
      },
      switchStandardHomework() {
        window.location.replace('//' + window.location.hostname.replace('lc','nhw') + `/v2.0/index.html?deviceType=1&studentId=${cookies.get('studentId')}&lessonId=${this.lessonId}&curriculumVersion=${this.version}&platform=2&scene=2&product=STANDARD&back_url=${this.backUrl}`) //回lc首页 @back_url 用于作业端返回
      }
    }
  }
</script>

<style lang="stylus" scoped>
.homework-header
    padding: 13px 0 3px
    position: relative
  .back-btn
    position: absolute
    margin-left: 20px
    top: 10px
    width: 58px
    height: 58px
    cursor: pointer
    background: url("//fe-static.vipkid.com.cn/learning/src/img/summercamp_button_collection-4702ea2f0371e8f3740565c787a05060.png") no-repeat
    background-position: -116px -108px
    background-size: 400px
    &:hover
      background-position: -58px -108px
    &:focus
      background-position: -174px -108px
  .pc-big-title
    color: #fff
    font-size: 28px
    text-align: center
    line-height: 58px
  .ipad-big-title
    color: #fff
    font-size: 28px
    text-align: center
    padding-bottom: 10px
  .ipad-sub-title
    color: #fff
    font-size: 28px
    text-align: center
  .standard-work-btn
    position: absolute
    top: 9px
    right: 95px
    width: 50px
    height: 50px
    background: url("../../../img/homework/standard-h-work@2x.png") no-repeat center
    background-size: 50px 50px
    cursor: pointer
  .mini-work-btn
    position: absolute
    top: 9px
    right: 95px
    width: 50px
    height: 50px
    background: url("../../../img/homework/mini-h-work@2x.png") no-repeat center
    background-size: 50px 50px
    cursor: pointer
  .page-help
    position: absolute
    top: 9px
    right: 95px
    width: 50px
    height: 50px
    background: url("../../../img/homework/question.png") no-repeat center
    background-size: 50px 50px
  .page-feedback
    position: absolute
    top: 10px
    right: 25px
    width: 50px
    height: 50px
    background: url("../../../img/homework/feedback-icon.png") no-repeat center
    background-size: 50px 50px
    span
      display: none
      position: absolute
      left: -96px
      top: 12px
      width: 96px
      height: 24px
      background: url("../../../img/homework/bubble.png") no-repeat center
      background-size: 96px 24px
      color: #fff
      font-size: 12px
      line-height: 24px
      padding-left: 21px
    &:hover
      span
        display: block
                  
</style>
