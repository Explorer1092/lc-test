<template lang="jade">
  .bg
    .comics-img-1(v-if="showIndex === 0")
      img.main-img(src='../../../img/dino_comics/pic_hd_1@2x.png')
    .comics-img-2.animated.fadeInDown(v-if="showIndex === 1")
      img.main-img(src='../../../img/dino_comics/pic_hd_2@2x.png')
      img.part-img-1.animated.fadeInRight(v-if="showIndexPart === 1", src='../../../img/dino_comics/pic_hd_2-1@2x.png')
    .comics-img-3.animated.fadeInLeft(v-if="showIndex === 2")
      img.main-img(src='../../../img/dino_comics/pic_hd_3@2x.png')
    .comics-img-4.animated.fadeInLeft(v-if="showIndex === 3")
      img.part-img-3(src='../../../img/dino_comics/pic_hd_4-1@2x.png')
      img.main-img.animated.fadeInRight(v-if="showIndexPart === 3", src='../../../img/dino_comics/pic_hd_4@2x.png')
    .comics-img-5.animated.fadeInUp(v-if="showIndex === 4")
      img.main-img(src='../../../img/dino_comics/pic_hd_5@2x.png')
    .next
      .next-img.animated.pulse.infinite(v-show="isShow",@click.stop="checkImageIndex") 继 续
</template>
<script>
  import axios from 'axios'
  import cookies from 'cookies-js'
  import formurlencoded from "form-urlencoded"
  export default {
    data: function () {
      return {
        showIndex: -1,
        showIndexPart: 0,
        timer: null,
        isShow:false
      }
    },
    props: {
    },
    computed: {},
    created () {
      this.sendAdoptPet()
    },
    mounted () {
      this.checkImageIndex()
    },
    methods: {
      sendAdoptPet () {
        //发送领养
        axios.post("/rest/learninggw/api/pet/homepage/adoptPet",
          formurlencoded({
            studentId: cookies.get("studentId")
          })
        ).then((res) => {
          if (res.data.code === 200 && res.data.data === 1) { //eslint-disable-line
          } else {
            this.$emit('adoptPetError')
          }
        }).catch(() => {
          this.$emit('adoptPetError')
        })
      },
      checkImageIndex() {
        this.isShow = false
        this.clearAllTimeout()
        // this.showIndex = this.showIndex === 4 ? 4 : this.showIndex + 1
        this.showIndex = this.showIndex+1
        if(this.showIndex > 4){
          //跳转到dino房间
          this.showIndexPart = this.showIndex
          this.$router.push('/dino_home')
          return
        }else{
          this.timer = setTimeout(() => {
            this.isShow = true
            this.showIndexPart = this.showIndex
            this.timer = null
          }, 3000)
        }
      },
      clearAllTimeout() {
        if (this.timer) {
          clearTimeout(this.timer)
          this.timer = null
        }
      }
    },
    beforeDestroy() {
      this.clearAllTimeout()
    }
  }
</script>


<style lang="stylus" scoped>
  .bg
    width: 100%
    height: 100%
    background-color: #000
    position: relative
    .comics-img-1, .comics-img-2, .comics-img-3, .comics-img-4, .comics-img-5
      position: absolute
      left: 50%
      top: 50%
      margin-top: -450px
      margin-left: -600px
      height: 900px
      width: 1200px

      img
        display: block

      .main-img
        position: absolute
        left: 0
        top: 0
        height: 900px
        width: 1200px

      .part-img-1
        position: absolute
        right: 25px
        top: 107px
        height: 770px
        width: 410px

      .part-img-2
        position: absolute
        right: 374px
        top: 237px
        height: 252px
        width: 454px

      .part-img-3
        position: absolute
        left: 15px
        top: 0px
        height: 900px
        width: 801px
        z-index: 2
    .next
      position: absolute
      left: 50%
      top: 50%
      margin-top: -450px
      margin-left: -600px
      height: 900px
      width: 1200px
      .next-img
        position: absolute
        bottom: 15px
        right: 15px
        width: 110px
        height: 53px
        line-height: 53px
        color: #ffffff
        font-size: 22px
        text-align: center
        background: no-repeat url("../../../img/dino_comics/next.png")
        background-size: 100% 100%
        cursor: pointer

  @media screen and (max-width: 1900px)
    .bg
      .comics-img-1, .comics-img-2, .comics-img-3, .comics-img-4, .comics-img-5
        position: absolute
        margin-top: -338px
        margin-left: -450px
        height: 676px
        width: 900px
        .main-img
          left: 0
          top: 0
          height: 676px
          width: 900px
        .part-img-1
          width: 308px
          height: 584px
          right: 20px
          top: 75px
        .part-img-2
          height: 189px
          width: 340px
          right: 283px
          top: 178px
        .part-img-3
          left: 10px
          top: 0px
          height: 676px
          width: 600px
      .next
        position: absolute
        left: 50%
        top: 50%
        margin-top: -338px
        margin-left: -450px
        height: 676px
        width: 900px



</style>
