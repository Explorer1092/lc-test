<template lang="jade">
  .header
    .backtohome(:class="{'up-to-top': isOnIpadApp}",:style="isOnIpadApp?{top:'21px',left:'21px'}:''",@click="goBack()")
    .title_hd(:class="{absolute_fix: isAbsoluteFix}",v-show="ifShow")
      h1.theme-title.theme-title-ch {{title_cn}}
      h1.theme-title.theme-title-en {{title_eng}}
</template>
<script>
  import cookies from 'cookies-js'
  import untils from '../../../utils/_untils.js'
  export default {
    data() {
      return {
        isOnIpadApp: false
      }
    },
    props: {
      title_eng: {
        default: "",
        type: String
      },
      title_cn: {
        default: "",
        type: String
      },
      gobackurl: {
        default: "",
        type: String
      },
      isAbsoluteFix: {
        default: false,
        type: Boolean
      },
      mark: {
        default: "",
        type: String
      },
      ifShow: {
        default: true,
        type: Boolean
      },
      showDialog: {
        default: false,
        type: Boolean
      },
      isRedirect: {
        default: false,
        type: Boolean
      }
    },
    mounted() {
      this.isOnIpadApp = (cookies.get('isFromApp') === '1')
    },
    methods: {
      goBack() {
        this.$playSound("click")
        if(this.$route.path.indexOf('pd_upload')> -1
          || this.$route.path.indexOf('video_upload')> -1
          || this.$route.path.match(/unit_show_time\/.*\/upload/g)){
          this.$emit("backConfirm")
          return
        }
        if (this.mark) {
          sa.track('learning_click', {'click_id': 'pc_learning_digital_' + this.mark + '_return'})
        }
        if (this.isOnIpadApp) {
          if(history.state && this.gobackurl != '/'){
            if (this.isRedirect) {
              window.location.href = this.gobackurl
            } else {
              history.go(-1)
            }
          }else{
            this.loadURL('vkappbridge://history/back')
          }
          return
        }
        if (this.gobackurl) {
          if (this.gobackurl === '/') {
            untils.gotoFirstPage()
          }else{
            if (this.isRedirect) {
              window.location.href = this.gobackurl
            } else {
              this.$router.push({path:`${this.gobackurl}`})
            }
          }
        } else {
          window.history.back()
        }
      },
      loadURL(url) {
        var iFrame
        iFrame = document.createElement("iframe")
        iFrame.setAttribute("src", url)
        iFrame.setAttribute("style", "display:none;")
        document.body.appendChild(iFrame)
        //把它从dom上移除掉
        iFrame.parentNode.removeChild(iFrame)
        iFrame = null
      }
    }
  }
</script>
<style lang="stylus" scoped>
  button_collection_width = 400px
  .header
    font-size: 10px
    .backtohome
      width: 58px
      height: 58px
      position: fixed
      top: 20px
      left: 40px
      cursor: pointer
      background: url("../../../img/summercamp_button_collection.png") no-repeat;
      background-position: -116px -108px
      background-size: button_collection_width
      z-index: 9
      &:hover
        background-position: -58px -108px
      &:active
        background-position: -174px -108px
      &.up-to-top
        z-index: 999
    .title_hd
      position: fixed
      top: 18px
      left: 0
      right: 0
      z-index: 8
      -webkit-font-smoothing: antialiased
      &.absolute_fix
        position: absolute
    .theme-title
      margin: 0
      text-align: center
      color: #fff
      margin-bottom: 5px
    .theme-title-ch
      font-size: 36px
    .theme-title-en
      font-size: 24px
      letter-spacing: 0.1em
      font-weight: 300
</style>
