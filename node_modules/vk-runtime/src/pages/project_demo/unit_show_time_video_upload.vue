<template lang="jade">
  .unit-show-time-main
    .back-plants
      .plant-1
      .plant-2
      .plant-3
      .plant-4
      .plant-5
      .plant-6
    loading(v-if="fullPageLoading")
    pd-rule(:show="rule", @closeRule="closeRule", :type="ruleType", :acid="acid", @agree="agree")
    upload-status(v-show="uploading", :progress="progress", @uploadingClick="uploadingClick", :fail="fail", :text="uploadText")
    .back-mask(v-show="preview", @click="closePreview")
    pd-back(:title_cn="title", @backConfirm="backConfirm")
    dialog-box(v-show="showDialog", :title="backObj.title", :tips="backObj.tips", @dialogClick="dialogClick")
    .dino-tips(v-show="dinoTips")
      span {{errorMsg}}
    //- 第一次上传作品显示奖励
    bong-package(v-if="isShowBong",:number="addImpelsNumber",@boxClose="closeBox")
    .unit-activity-container(v-show="videoURL")
      .big-tv
        .unit-tv-antenna
        .unit-tv-title
          span 个人作品
        .unit-tv-screen
          ust-video-play(:playData="playData",videoSize="big",:isShowVote="isShowVote",class="unit-media")
        .unit-tv-bottom
          .rope
          .info-box
            .author {{studentName}}
            .title {{activityName}}
      .unit-bottom
        .join(@click="joinPD",:class="videoURL && haveAgree && canJoin ? 'active': ''")
            p(v-show="!iconLoading") 确认上传
            img.icon-loading(src="../../img/readers/loading.gif", v-show="iconLoading")
          .agreement
            i(@click="haveAgree=!haveAgree", :class="{'active': haveAgree}")
            span 我已阅读并同意
              a(@click.prevent="rule=!rule") 《VIPKID上传协议》

      //- .null(v-if="!unitList.length")
      //-   .dino
      //-     .dino-null
      //-     .text 这里还什么都没有
    //- .net-mask(v-show="netError")
    //-   net-error(@errorReload="errorReload")
</template>
<script>
  import axios from 'axios'
  import pdBack from './components/pd_back.vue'
  import pdRule from "./components/rule.vue"
  import uploadStatus from "./components/upload_status.vue"
  import videoBox from './components/video_box.vue'
  import ustVideoPlay from './components/ust_video_play.vue'
  import dialogBox from "./components/dialog.vue"
  import bongPackage from "./components/bong_package.vue"
  import UPLOAD from "./js/upload.js"
  import VideoFunc from './js/video.js'
  import cookies from "cookies-js"
  import loading from '../common/vk_loading.vue'
  export default {
    mixins: [UPLOAD.ipad(), UPLOAD.pc(),VideoFunc.index()],
    data(){
      return {
        fullPageLoading: false,
        iconLoading: false, // iconLoding 图标标识变量
        haveAgree: false, //是否已经同意协议
        title: '上传作品',
        rule: false, // 协议弹窗 显示否
        ruleType: "join", // 协议类型
        acid: 48, // acid值
        videoURL: '',
        resourceId: this.$route.query.resourceId,
        unlockStatus: parseInt(this.$route.query.unlockStatus),
        partitionId: this.$route.query.partitionId,
        videoId: 0,
        imgSrc: "",
        audioScores: '',
        enName: cookies.get("userName") || "本人",
        studentName: cookies.get("userName") || "本人",
        detail: null,
        activityName: '',
        activityTheme: '',
        activityType: '',
        // 播放数据
        playData: {
          unlockStatus: parseInt(this.$route.query.unlockStatus),
          url: '',
          coverImage: '',
          vote: 0,
          isJustUploaded: false
        },
        showDialog: false,
        dinoTips: false,
        backObj: {
          title: "退出提示",
          tips: "宝贝还差一步就完成上传啦！确定要退出吗？"
        },
        timestamp :  new Date().getTime(),
        canJoin: false,
        isOverlay: 2, // 1:有遮罩 2:无遮罩
        frameId: "",
        refreshUrl: window.location.href.replace('/user_shoot', ''),
        isShowBong: false,
        isPlayButtonShow: false,
        uploading: false,
        preview: false,
        progress: "0%",
        fail: false,
        uploadText: "作品上传中...",
        addImpelsNumber: 5,
        // 是否显示播放器上面的投票
        isShowVote: false,
        loading: true,
        netError: false,
        errorMsg: '糟糕！网络链接出现问题'
      }
    },
    components: {
      pdBack,
      pdRule,
      uploadStatus,
      bongPackage,
      videoBox,
      ustVideoPlay,
      // awardBox,
      dialogBox,
      loading
    },
    mounted() {
      // console.log('进入确认上传页面', window.location.href)
      this.timestamp = new Date().getTime()

      this.checkAgreement() // 检查该学生是否同意过“用户协议”

      this.fullPageLoading = false

      // 获取大赛详情
      this.initDetailData()

      // 如果从cookie拿不到userName, 则从服务端拿
      if (!cookies.get("userName") || cookies.get("userName") === "null") {
        this.getStudentName()
      } else {
        this.name = cookies.get("userName") + "的作品"
      }

      /* iPad App 兼容
       * iPad App webview
       * ipad App交互文档见: http://wiki.vipkid.com.cn/pages/viewpage.action?pageId=33134090
       */
      if (cookies.get('isFromApp')) {
        if (this.$route.params.isUserShoot) {
          // iPad原生用户拍摄模式
          //开启满屏loading
          this.fullPageLoading = true

          //初始化用户拍摄模式
          this.initVKAppBridgeInUserShootMode()

          //调起 iPad App 的 FileUpload
          this.dispatchForIpad(`vkappbridge://fileupload/ust?product=ust&vframe_enable=1&activity_id=${this.$route.params.pdId}&refresh_url=${this.refreshUrl}`)

        }

        this.heartBeat()

        setInterval(() => {

          this.heartBeat()

        }, 5000)

      }
    },
    watch: {
    },
    methods: {
      initDetailData() {
        this.getDetailByPid(this.$route.params.pdId, resp => {
          let result = resp.data
          if (result.code == 100022) {
            this.netError = true
            this.errorMsg = result.msg
          } else {
            this.detail = result.data
            this.activityName = result.data.name
            this.activityTheme = result.data.theme
            this.activityType = result.data.activityType
          }
        })
      },
      getDetailByPid(activityId,callback) {
        axios.get(`/rest/activity/api/activity/user/activity/getActivityDetailByActivityId/${activityId}`)
          .then((res) => {
            callback(res)
          })
          .catch((res) => {
            this.netError = true
            this.fullPageLoading = false
            callback(res)
          })
      },
      heartBeat() {
        this.dispatchForIpad('vkappbridge://ipadcommon/postHeartbeat')
      },
      getQueryString(name) {
        var result = location.search.match(new RegExp("[\?\&]" + name + "=([^\&]+)", "i"))
        if (result == null || result.length < 1) {
          return ""
        }
        return result[1]
      },
      initVKAppBridgeInUserShootMode() {
        window.VKAppBridge = {}
        window.VKAppBridge['receiveFromNative'] = (iosRes) => {
          let data = JSON.parse(iosRes)
          switch(data.data.code) {
          case 0:
            // console.log('拍摄完成')
            this.fullPageLoading = false
            this.videoURL = data.data.video_url
            this.playData.url = this.videoURL
            this.isOverlay = 2 // 不需要叠加相框
            this.frameId = "" // 没有相框就没有id
            this.imgSrc = data.data.cover_url // 此时cover_url是undefined, JSON.stringify会把undefined的字段除去。逻辑是：不需要封面图，后端会合成封面图。
            this.playData.coverImage = this.imgSrc
            //
            this.playData.isJustUploaded = true
            this.audioScores = data.data.audio_scores
            // console.log('native返回了视频信息',this.playData, data)
            this.$nextTick(() => {
              this.confirmVideoWithFrameOnIpad()
            })
            break
          case 5:
            // 这里用重定向切换到iPad本地选择视频模式: initVKAppBridgeInChooseVideoMode
            // window.location.href = `/video_upload/${this.$route.params.pdId}`
            let activityType = this.getQueryString('activityType')
            // this.$router.push({path: `/work_wall/upload/${this.$route.params.pdId}/${activityType}`})
            this.$router.go(-1)
            break
          case 1:
            window.history.back()
            sa.track("learning_click", {click_id:"pc_learning-effect_ust_UnitShowTimeVideoUpload_ipad_user_cancel_photo_shot"})
            break
          case 2:
            this.$showToast("网络异常，请保证网络畅通")
            break
          case 3:
            this.$showToast("网络异常，请保证网络畅通")
            break
          case 4:
            this.$showToast("用户未授权相机功能")
            break
          }
        }
        this.dispatchForIpad('vkappbridge://__bridge_ready__')
      },
      getStudentName() {
        axios.get(`/rest/activity/api/activity/user/activity/getStudentByStudentId`).then(res => {
          this.studentName = res.data.data.englishName
          this.name = this.studentName + "的作品"
        })
      },
      joinPD() {
        sa.track('learning_click', {
          'click_id': 'pc_learning-effect_ust_UnitShowTimeVideoUpload_comfirmUpload'
        })
        // 没上传作品 提示上传作品
        if (!this.videoURL) {
          this.$showToast("还没有上传视频，请先上传视频")
          return
        }
        // 没勾选协议 提示勾选协议
        if (!this.haveAgree) {
          this.$showToast("请您先同意《VIPKID 上传协议》，即可成功参赛")
          return
        }
        // canJoin 是最终控制状态
        if (!this.canJoin) {
          return
        }
        // 置为交互中状态
        this.iconLoading = true // iconloding 显示
        this.canJoin = false // 参赛按钮 不可点击
        this.$playSound("click")
        // 确认协议
        // console.log('确认协议')
        axios.post(`/rest/activity/api/activity/user/activity/setActivityStudentRulesRecordAgree`).then((res) => {
          if (res.data.code === 0) {
            // console.log('当前作品状态', this.unlockStatus)
            // 同意协议的记录 存储成功
            if (res.data.data) {
              if (this.unlockStatus === 0) {
                this.exit(
                  () => {
                    this.join()
                  }
                )
              } else {
                this.join()
              }
            } else {
              this.$showToast("协议未上传成功，请重新确认")
              window.alert('res.data.data', JSON.stringify(res))
              this.haveAgree = false // 协议置为未勾选
              this.iconLoading = false // iconLoding 消失
              this.canJoin = true // 放行
            }
          } else {
            this.$showToast("协议未上传成功，请重新确认")
            window.alert('res.data.code', JSON.stringify(res))
            this.haveAgree = false // 协议置为未勾选
            this.iconLoading = false // iconLoding 消失
            this.canJoin = true // 放行
          }
        }).catch((err) => {
          this.$showToast("协议未上传成功，请重新确认")
          window.alert('err', JSON.stringify(err))
          this.haveAgree = false // 协议置为未勾选
          this.iconLoading = false // iconLoding 消失
          this.canJoin = true // 放行
        })
      },
      exit(callback) {
        // console.log('退赛之前的作品', this.$route.params.videoId)
        sa.track('learning_click', {'click_id': 'pc_learning-effect_ust_UnitShowTimeVideoUpload_mySubmission_recalled_confirm'})
        return axios.post(`/rest/activity/api/activity/user/resource/exitActivityByResourceId/${this.$route.query.resourceId}`)
          .then((res) => {
            // console.log(res)
            if (res.data.code === 0) {
              // console.log('退赛成功')
              callback(res)
            }else{
              this.dinoTips = true
              this.showDialog = false
              this.errorMsg = '作品状态异常'
              setTimeout(()=>{
                this.dinoTips = false
              },2500)
            }
          })
          .catch((err) => {
          })
      },
      join() {
        // console.log('参赛', this.videoId)
        sa.track("learning_click", {
          click_id:"pc_learning-effect_ust_UnitShowTimeVideoUpload_upload_submissionConfirmed"
        })
        axios.post(`/rest/activity/api/activity/user/resource/signUpByResourceIdAndActivityId/${this.videoId}/${this.$route.params.pdId}`).then(res => {
          // console.log(res)
          if (res.data.code === 0) {
            // console.log('参赛成功')
            // 如果是第一次上传，则展示奖励
            // console.log('作品状态', this.unlockStatus)
            // 如果data里面有值，则说明是要发奖励
            if (res.data.data && res.data.data.prizeNum) {
              // console.log('第一次上传，展示奖励')
              this.addImpelsNumber = res.data.data.prizeNum
              this.isShowBong = true
            } else {
              // console.log('已上传过，直接跳转首页')
              this.$router.replace(`/unit_show_time/level2/${this.$route.params.pdId}?unlockStatus=0`)
            }
            // this.$router.replace({
            //   path: `/pd_video/${this.videoId}/${this.$route.params.pdId}`
            // })
          } else {
            this.$showToast(res.data.msg)
            setTimeout(() => {
              //由于 /project_detail 页面是keepalive，此处用重定向防止页面数据不刷新
              window.location.replace(`/project_detail/${this.$route.params.pdId}`)
            }, 2000)
          }
        })
          .catch(err => {
            this.iconLoading = false // iconLoding 消失
            this.canJoin = true // 参赛按钮 active
          })
      },
      // 获取是否同意过协议信息 data:true代表同意过
      checkAgreement() {
        axios.get(`/rest/activity/api/activity/user/activity/getActivityStudentRulesRecord`).then(res => {
          if (res.data.data) {
            this.haveAgree = true
          }
        })
      },
      closePreview() {
        this.isPlayButtonShow = true // 预览视频时的播放按钮
        this.preview = false
        this.videoURL = ""
        this.videoId = ""
        // this.$refs.file.value = ""
        this.imgSrc = ""
      },
      backConfirm() {
        this.showDialog = true
      },
      dialogClick(key) {
        this.$playSound("click")
        if (key === "cancel") {
          this.showDialog = false
        } else {
          if (this.gobackurl) {
            this.$router.push(this.gobackurl)
          } else {
            window.history.back()
          }
        }
      },
      confirmVideoWithFrameOnIpad() {
        // console.log('获取上传的视频信息', this.$route.params.pdId)
        axios.post("/rest/activity/api/activity/user/upload/uploadComplete",
          JSON.stringify({
            mp4: true,
            videoUrl: this.videoURL,
            coverImage: this.imgSrc,
            activityId: this.$route.params.pdId,
            activityType: this.activityType,
            partitionId: this.$route.query.partitionId,
            name: this.studentName + "的作品",
            resourceType: 1, // 视频为1, 图片为0
            isOverlay: this.isOverlay,
            frameId: this.frameId,
            audioScores: this.audioScores
          }),
          { headers: { "Content-Type": "application/json" } }
        )
          .then(res => {
            // console.log('获取视频参数成功', res)
            // ipad端 视频是否符合参赛标准的验证
            if (res.data && res.data.code === 0) {
              this.fail = false
              this.preview = true
              this.uploading = false
              this.videoId = res.data.data.id
              // console.log('视频ID', this.videoId)
              this.canJoin = true
            } else {
              this.fail = false
              this.uploading = true
              this.progress = "Oops!"
              if (res.data && res.data.code === 100027) {
                this.uploadText = "抱歉，该视频已经参加过其他大赛，请您另选一个视频参赛哦！"
              } else if (res.data && res.data.code === 100032) {
                this.uploadText = "抱歉，该视频已被其他用户上传参赛，请您另选一个视频参赛哦！"
              } else if (res.data && res.data.code === 100033) {
                this.uploadText = "抱歉，该视频之前上传过但并未通过审核，请您另选一个视频参赛哦！"
              } else {
                this.uploadText = "上传失败"
              }
            }
          })
          .catch(err => {
            this.fail = true
            this.uploading = true
            this.progress = "Oops!"
            this.uploadText = "上传失败"
          })
      },
      dispatchForIpad(src) {
        let _iframe = document.createElement('iframe')
        _iframe.setAttribute('src', src)
        _iframe.setAttribute('style', 'display:none;')
        document.body.appendChild(_iframe)
        _iframe.parentNode.removeChild(_iframe)
        _iframe = null
      },
      uploadingClick(i) {
        this.$playSound("click")
        if (i === 0) {
          sa.track("learning_click", {
            click_id:
              "pc_learning-effect_ust_UnitShowTimeVideoUpload_upload_canceledByUser"
          })
          // 只有刷新才能打断上传
          window.location.reload(true)
        } else {
          window.location.reload(true)
        }
      },
      onClickPlayBtn(){
        this.fullscreenPlay(this.$refs['tv'])
        // this.$refs.video2.play()
        // this.isPlayButtonShow = false
        // this.isVideoImgShow = false
        // this.$refs.video2.addEventListener('ended', () => {
        //   this.isPlayButtonShow = true
        // })
      },
      // 关闭协议
      closeRule(key) {
        if (key) {
          this.rule = false
        }
      },
      agree() {
        this.haveAgree = true
        this.rule = false
      },
      //关闭弹窗
      closeBox(){
        this.isShowBong = false
        this.$router.replace(`/unit_show_time/level2/${this.$route.params.pdId}?unlockStatus=0`)
      },
      errorReload(){
        this.$playSound("click")
        setTimeout(() => {
          window.location.reload()
        }, 500)
      }
    }
  }
</script>

<style lang="stylus" scoped>
@import './css/ust.styl'
  *
    box-sizing: border-box
    -moz-user-select: none
    -webkit-user-select: none
    -ms-user-select: none
    -khtml-user-select: none
    user-select: none
    -webkit-font-smoothing: antialiased
  .unit-show-time-main
    background:linear-gradient(180deg,rgba(53,0,133,1) 0%,rgba(86,52,162,1) 100%)
    color: #fff
    text-align: center
    .dino-tips
      position: absolute
      font-size: 14px
      width: 370px
      height: 110px
      left: 50%
      top: 50%
      transform: translate(-50%,-50%)
      -webkit-transform: translate(-50%, -50%)
      background: url("../../img/project_demo/dino_tips.png")
      background-size: 100% 100%
      color: #000
      span
        display: inline-block
        margin-left: 100px
        width: 260px
        margin-top: 50px
        font-size: 20px
  .back-plants
    position: fixed
    top: 0
    left: 0
    width: 100%
    height: 100%
    .plant-1
      position: absolute
      top: 540px
      left: 588px
      width: 50px
      height: 49px
      background: url("../../img/project_demo/unit_show_time/An asteroid@2x.png") no-repeat
      background-size: 49px
    .plant-2
      position: absolute
      top: 77px
      left: 127px
      width: 92px
      height: 90px
      background: url("../../img/project_demo/unit_show_time/An asteroid@2x.png") no-repeat
      background-size: 92px
    .plant-3
      position: absolute
      top: 510px
      right: 40px
      width: 80px
      height: 79px
      background: url("../../img/project_demo/unit_show_time/Planets in@2x.png") no-repeat
      background-size: 80px
    .plant-4
      position: absolute
      top: 102px
      left: 812px
      width: 300px
      height: 250px
      background: url("../../img/project_demo/unit_show_time/planets@2x.png") no-repeat
      background-size: 300px
    .plant-5
      position: absolute
      top: 456px
      right: 860px
      width: 300px
      height: 250px
      background: url("../../img/project_demo/unit_show_time/planets@2x.png") no-repeat
      background-size: 300px
    .plant-6
      position: absolute
      top: 0
      left: 50%
      margin-left: -300px
      width: 600px
      height: 169px
      background: url("../../img/project_demo/unit_show_time/Semicircle background@2x.png") no-repeat
      background-size: 600px
      -webkit-filter: blur(7px)
      -moz-filter: blur(7px)
      -o-filter: blur(7px)
      -ms-filter: blur(7px)
      filter: blur(7px)
  .all-unit
    position: fixed
    z-index: 10
    top: 24px
    right: 24px
    width: 159px
    height: 52px
    border-radius: 26px
    border: 6px solid #a687ea
    background-color: #2c026c
    .icon
    .icon-tv
      display: inline-block
      vertical-align: middle
      width: 32px
      height: 33px
      margin-left: 1px
      background: url("../../img/project_demo/unit_show_time/All the work@2x.png")
      background-size: 32px
    span
      font-size: 18px
      line-height: 40px
      margin-left: 10px
      vertical-align: middle

  .unit-activity-container
    width: 100%
    height: 100%
    text-align: center
    position: absolute
    top: 0
    left: 0
    // transform: translate(-50%, -50%)
    // -webkit-transform: translate(-50%, -50%)
    .big-tv
      width: 610px
      margin: 0 auto
      margin-top: 144px
      position: relative
      .unit-tv-antenna
        width: 237px
        height: 49px
        margin: 0 auto
        margin-bottom: -20px
        background: url("../../img/project_demo/unit_show_time/Antenna big@2x.png") no-repeat
        background-size: 237px
      .unit-tv-title
        position: absolute
        z-index: 2
        top: 10px
        left: 50%
        margin-left: -100px
        width: 200px
        height: 50px
        text-align: center
        background: rgba(160,89,197,1)
        box-shadow: -6px -6px 0px 0px rgba(141,65,182,1) inset
        border-radius: 27px
        border: 5px solid #B077CE
        span
          line-height: 43px
          font-family:PingFangSC-Semibold;
          font-size: 20px
          font-weight: 600
      .unit-tv-screen
        width: 100%
        height: auto
        border: 8px solid #A687EA
        border-radius: 36px
        background:rgba(217,217,217,1);
        overflow: hidden
        -webkit-transform: translateZ(0)
        -moz-transform: translateZ(0)
        transform: translateZ(0)
        .unit-media
          position: relative
          width: 100%
          height: auto
          .unit-video
            width: 100%
            height: auto
          .video-play-cover
            position: absolute
            top: 0
            left: 0
            width: 100%
            height: 100%
            .unit-cover-img
              width: 100%
              height: 100%
            .play-btn
              position: absolute
              top: 50%
              left: 50%
              width: 57px
              height: 57px
              transform: translate(-50%, -50%)
              -webkit-transform: translate(-50%, -50%)
              background-image: url("../../img/project_demo/unit_show_time/Playing small@2x.png")
              background-repeat: no-repeat
              background-size: 57px
              &.locked
                background-image: url("../../img/project_demo/unit_show_time/lock@2x.png")
          .unit-vote
            position: absolute
            right: 20px
            bottom: 20px
            width: 68px
            height: 26px
            text-align: center
            border-radius: 13px
            font-size: 14px
            font-weight: 600
            line-height: 26px
            background: rgba(0,0,0,0.4)
      .unit-tv-bottom
        position: relative
        .rope
          position: absolute
          z-index: -2
          right: -35px
          top: -70px
          width: 100px
          height: 100px
          border-radius: 50px
          border: 6px solid #B077CE
          &:before
            display: block
            position: absolute
            content: ''
            top: 0
            left: -6px
            width: 50%
            height: 100%
            background-color: #4D279B;
        .info-box
          margin-top: 20px;
          display: flex;
          align-items: center;
          flex-wrap: nowrap;
          justify-content: flex-start;
          width: 100%;
          height: 59px;
          background: #a059c5;
          box-shadow: -8px -8px 0px 0px #8d41b6 inset;
          border-radius: 32px;
          border: 6px solid #b077ce;
          .author
            min-width: 157px
            height: 59px
            line-height: 45px
            background: rgba(143,64,184,1)
            border-radius: 34px
            border: 7px solid #B077CE
            margin-left: -7px
          .title
            font-size: 22px
            font-weight: 600
            margin: 0 auto
    .unit-bottom
      position: relative
      z-index: 1
      padding-top: 1px
      .join
        position: relative
        width: 200px
        height: 50px
        background: url('../../img/project_demo/unjoin.png') no-repeat
        background-size: 100% 100%
        margin: 4vh auto
        font-size: 20px
        line-height: 50px
        cursor: pointer
        ust-btn: 25px
        &.active
          background: url('../../img/project_demo/join.png') no-repeat
          background-size: 100% 100%
        img.icon-loading
          position: absolute
          left: 50%
          top: 50%
          transform: translate(-50%, -50%)
      .agreement
        i
          display: inline-block
          width: 20px
          height: 20px
          background: white
          border-radius: 12px
          border: 2px solid rgba(255, 102, 0, 1)
          &.active
            background: rgba(255, 102, 0, 1) url('../../img/project_demo/checkmark.png') no-repeat 0 0 / 16px 16px
            border-color: rgba(0, 0, 0, 0.5)
        span
          display: inline-block
          vertical-align: bottom
          width: 228px
          height: 19px
          line-height: 19px
          margin-left: 7px
          font-size: 14px
          font-family: MicrosoftYaHei
          color: rgba(179, 150, 255, 1)
          & > a
            text-decoration: underline
  .null
    width: 100%
    height: 100%
    position: absolute
    top: 0
    .dino
      width: 300px
      height: 300px
      margin: 0 auto
      position: absolute
      top: 50%
      left: 50%
      transform: translate(-50%,-50%)
      .dino-null
        width: 300px
        height: 300px
        background: transparent url("../../img/project_demo/null.png") no-repeat
        background-size: 100% 100%
      .text
        font-size: 24px
        margin-top: 50px
        text-align: center
        color: #fff
  .net-mask
    width: 100%
    height: 100%
    position: absolute
    top: 0
    left: 0
    background: rgba(0,0,0,0.6)
  .pd-container
    height: 100%
    width: 100%
    overflow: hidden
    padding-top: 14%
  .activity-title
    width: 200px
    height: 30px
    margin-left: 100px
    margin-top: 6px
    text-align: center
    color: #fdfb92
    line-height: 32px
    font-weight: 700
    text-shadow: 0px .6px 0px #f79325
  .activity-cover
    width: 258px
    height: 164px
    margin-left: 70px
    margin-top: 28px
    img
      width: 260px
      height: 165px
      border-radius: 35px
  .activity-status
    width: 70px
    height: 30px
    position: absolute
    left: 40%
    bottom: 90px
    &.ing
      background: url("../../img/project_demo/ing.png") no-repeat
      background-size: 100% 100%
    &.end
      background: url("../../img/project_demo/end.png") no-repeat
      background-size: 100% 100%
    &.pre
      background: url("../../img/project_demo/nostart.png") no-repeat
      background-size: 100% 100%
  .activity-desc
    width: 190px
    height: 50px
    margin: 0 auto
    margin-top: 40px
    font-size: 12px
    color: #fff
    text-align: center
    line-height: 24px
    .num
      span.cup
        display: inline-block
        width: 14px
        height: 10px
        background: red
        position: static
        background: url("../../img/project_demo/cup.png") no-repeat
        background-size: 100% 100%
        margin-right: 3px
  @keyframes blurAnimate
    0%
      transform: scale(1.05, 1.05)
    100%
      transform: scale(1.1, 1.1)
  @keyframes jump
    0%
      top: 0
    50%
      top: 100px
    100%
      top: 0
  @keyframes shrink
    0%
      width:90px
      height: 60px
      background: rgba(120,120,120,.3)
    65%
      width: 10px
      height: 5px
      margin-left: -5px
      background: rgba(120,120,120,.3)
      box-shadow: 0 0 25px 20px rgba(20,20,20,.3)
    100%
      width: 90px
      height:60px
      background: rgba(120,120,120,.1)
      box-shadow: 0 0 25px 20px rgba(20,20,20,.1)
</style>

