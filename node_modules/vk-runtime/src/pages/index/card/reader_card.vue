<template lang="jade">
  //绘本
  .reader-content
    transition-group(enter-active-class="animated fadeInDown")
      .panel-face(key="1",v-show="currentPanelState=='face'")
        .book-hd
          .book-shadow
          img.reader-book(:src="config.bookCoverUrl+'?imageView2/2/w/127/h/180'",@error="errorImg")
        vk-btn.reader-btn(:type="'lg-'+backButtonState[config.bookButton]",:text="config.bookButtonText",
        :isNewTab="false",:link="`/dgl/digitalLibrary/detail/${config.bookId}/${config.bookCode}`",clickId="homepage_btn_pre")
        vk-progress(:pps="pps")
      back-card(key="2",v-if="currentPanelState=='back'",:config="config")
</template>
<script>
  import vkBtn from "../../common/vk_button.vue"
  import backCard from "./back_card.vue"
  import vkProgress from "../components/progress.vue"
  import cookies from "cookies-js"
  var noImg = require("../../../img/index/pre_bg.png")
  export default {
    data: function () {
      return {
        pps: [
          {
            name: "读绘本",
            state: "use"//disable:灰色 use：可预习 used：预习完
          },
          {
            name: "上课",
            state: "disable"//disable:灰色 use：可预习 used：预习完
          }
        ],
        //        HIDE(0,"不显示"),
        //        LOCK(1,"不可用"),
        //        UNLOCK(2, "可用"),
        //        FINISH_UNLOCK(3, "完成并继续可用"),
        //        FINISH_LOCK(4, "完成但不可用");
        backButtonState: ['hide', 'disable', 'enable', 'enable', 'disable']
      }
    },
    components: {
      vkBtn, vkProgress, backCard
    },
    props: [
      'config', 'currentPanelState'
    ],
    computed: {},
    mounted () {
      this.initState()
    },
    watch: {
      config: function (n, o) {
        this.initState()
      }
    },
    methods: {
      initState() {
        if (this.config.bookStatus == 1) {
          this.pps[0].state = "used"
        }
        if (this.config.classroomButton > 2) {
          this.pps[1].state = "used"
        }
      },
      errorImg(e){
        e.target.src = noImg
      }
    }
  }
</script>

<style lang="stylus" scoped>
  .reader-content
    position: relative
    text-align: center
    padding-top: 25px
  .book-hd
    position relative
    width: 117px
    height: 135px
    display: inline-block
    margin: 13px auto 20px
    border-radius: 4px
    .book-shadow
      position: absolute
      top: 0
      left: 0
      z-index: 1
      width: 100%
      height: 100%
      border-radius: 4px
      box-shadow: inset 5px -5px 0 0 #e0e0e0, inset -5px 0px 0 0 rgba(255, 255, 255, 0.3)
    .reader-book
      width: 100%
      height: 100%
      border-radius: 4px
      background: url("../../../img/coursewarefail.png") center no-repeat
      background-size: auto 80%

  .reader-btn
    margin: 7px auto 20px auto

</style>
