<template lang="jade">
  .panel-back
    .circle.circle-1
    .circle.circle-2
    .circle.circle-3
    .btns
      template(v-for="(pbButton,index) in pbButtons")
        vk-btn.animated.fadeInDown.pb-btn(v-if="pbButton.btnType == 'READ_BOOK'",
        :type="'white-line-'+pbButton.state",:key="index",
        :text="pbButton.buttonText",
        :style="'animation-delay:'+(index*100)/1000+'s'", :alertText="alertText(pbButton.buttonExtra)",:clickFun="goBookDetail(pbButton.buttonExtra.bookId,pbButton.buttonExtra.bookCode)")
        vk-btn.animated.fadeInDown.pb-btn(v-else,
        :type="'white-line-'+pbButton.state",:key="index",
        :text="pbButton.buttonText",
        :style="'animation-delay:'+(index*100)/1000+'s'",:clickFun="buttonClick(pbButton.btnType,pbButton.clickId,pbButton.buttonExtra,pbButton.buttonStatus)", :alertText="alertText(pbButton.buttonExtra)")
</template>
<script>
  //背部卡片映射
  //        "backButtonList": [{
  //          "buttonText": "预习",
  //          "buttonStatus": "HIGH",
  //          "buttonFunction": "PRE",
  //          "clickid": "esl_pre_video",
  //          "buttonExtra": null
  //        }, {
  //          "buttonText": "查看课件",
  //          "buttonStatus": "HIGH",
  //          "buttonFunction": "COURSEWARE",
  //          "clickid": "esl_courseware",
  //          "buttonExtra": null
  //        }, {
  //          "buttonText": "做作业",
  //          "buttonStatus": "GRAY",
  //          "buttonFunction": "AFTER",
  //          "clickid": "esl_homework",
  //          "buttonExtra": null
  //        }, {
  //          "buttonText": "已下课",
  //          "buttonStatus": "GRAY",
  //          "buttonFunction": "MAJOR_CLASSROOM_FINISH",
  //          "clickid": "esl_enter_classroom",
  //          "buttonExtra": null
  //        }, {
  //          "buttonText": "复习资料",
  //          "buttonStatus": "GRAY",
  //          "buttonFunction": "PDF",
  //          "clickid": "esl_pdf_back",
  //          "buttonExtra": null
  //        }]
  import vkBtn from "../../common/vk_button.vue"
  import dragonUtils from '../../../utils/_dragon.js'
  import Vue from "vue"
  import axios from 'axios'
  import cookies from "cookies-js"
  import Course from "../../common/course/Course"
  import {BACK_BUTTON_MAP} from "../../common/course/courseEnum"
  export default {
    data: function () {
      return {
      }
    },
    components: {
      vkBtn
    },
    props: ['config'],
    computed: {
      pbButtons: function () {
        let bbl = this.config.backButtonList
        let pbB = []
        for (let b of bbl) {
          let o = new Object()
          o.state = BACK_BUTTON_MAP[b.buttonStatus]
          o.buttonText = b.buttonText
          o.btnType = b.buttonFunction
          o.clickId = b.clickid
          o.buttonExtra = b.buttonExtra
          o.buttonStatus = b.buttonStatus
          pbB.push(o)
        }
        return pbB
      }
    },
    methods: {
      buttonClick(type, clickId, buttonExtra, buttonStatus) {
        return () => {
          Course.courseButtonClick({
            cardType: this.config.cardType,
            type: type,
            onlineClassId: this.config.onlineClassId,
            lessonNum: this.config.lessonNumber,
            lessonId: this.config.lessonId,
            clickId: clickId + "_back",
            courseId: this.config.courseId,
            curriculumVersion: this.config.curriculumVersion,
            buttonExtra: buttonExtra,
            bookType: this.config.bookType,
            buttonStatus: buttonStatus
          })
        }
      },
      // 读绘本
      goBookDetail(bookId,bookCode) {
        return ()=>{
          this.$router.push({path: `/dgl/digitalLibrary/detail/${bookId}/${bookCode}`})
        }
      },
      alertText(buttonExtra){
        
        if(buttonExtra && buttonExtra.alertText){
          return buttonExtra.alertText
        }else{
          return ""
        }
        
      }
    }
  }
</script>

<style lang="stylus" scoped>

  .pb-btn
    margin: 15px auto

  .panel-back
    position: relative
    padding-top: 10px
    text-align: center
    height: 280px

  .btns
    position: relative
    margin: 20px auto
    width: 140px
    z-index: 2

  .circle
    position: absolute
    border-radius: 50%
    background-color: rgba(0, 0, 0, 0.05)

  .circle-1
    z-index: 1
    left: -10px
    top: 50px
    height: 100px
    width: 100px

  .circle-2
    z-index: 2
    left: 250px
    top: 50px
    height: 50px
    width: 50px

  .circle-3
    z-index: 3
    left: 230px
    top: 200px
    height: 80px
    width: 80px


</style>
