<template lang="jade">
  .gift_animate_wrap
    .move-aircraft-wrap(:class="aircraftClassName")
      img.move-aricraft(v-if="imgConfig.aircraftImgSrc",:src="imgConfig.aircraftImgSrc")
    .move-pet-wrap(v-if="imgConfig.isShowPet", ref="petWrap")
      img.move-pet(v-if="imgConfig.petImgSrc!=''",ref="pet", :src="imgConfig.petImgSrc")
</template>
<script>
  import Velocity from 'velocity-animate'
  import axios from 'axios'
  import cookies from 'cookies-js'
  export default {
    data: function () {
      return {
        timeouts: [],
        aircraftClassName: '',
        aircraftStartPointIndex: ''
      }
    },
    props: {
      imgConfig: {
        type: Object,
        required: false,
        default: {}
      }
    },
    mounted(){
      this.aircraftMove()
      this.animationPet()
    },
    deactivated() {
      clearTimeout(this.timeouts)
    },
    methods: {
      aircraftMove() {
        let currentIndex = parseInt(Math.random() * 1000 % 4) + 1
        if (this.aircraftStartPointIndex != currentIndex) {
          this.aircraftStartPointIndex = currentIndex
          if (this.imgConfig.aircraftImgSrc) {
            if (this.imgConfig.aircraftImgDirection == 0) {
              this.aircraftClassName = 'start-point-' + currentIndex
            } else {
              this.aircraftClassName = 'start-point-vertical-' + currentIndex
            }
            this.timeouts = setTimeout(() => {
              this.aircraftMove()
            }, 5500)
          }
        } else {
          this.aircraftMove()
        }
      },
      animationPet() {
        if (this.imgConfig.isShowPet) {
          if (this.imgConfig.petImgSrc) {
            let a = window.innerWidth + 100
            Velocity(this.$refs.petWrap, {translateX: 0 - a, rotateZ: 360}, {
              duration: 50000,
              easing: [0, 0, 1, 1],
              loop: true
            })
            Velocity(this.$refs.pet, {translateY: -100, rotateZ: 360}, {
              duration: 20000,
              easing: [0, 0, 1, 1],
              loop: true
            })
          }
        }
      }
    }
  }
</script>

<style lang="stylus" scoped>
  .gift_animate_wrap
    width: 100%
    position: fixed
    height: 100%
    top: 0
    bottom: 0
    right: 0
    left: 0
    z-index: 1
    .move-aircraft-wrap
      will-change: left
      position: absolute
      width: 100px
      opacity: 0.8
      &.start-point-1
        top: 300px
        left: -200px
        animation: startPoint1 5s linear
        transform: rotate(-23deg) rotateY(180deg)
        animation-fill-mode: forwards
      &.start-point-2
        bottom: -200px
        left: 1000px
        animation: startPoint2 5s linear
        transform: rotate(33deg)
        animation-fill-mode: forwards
      &.start-point-3
        bottom: -200px
        right: 1000px
        animation: startPoint3 5s linear
        transform: rotate(-33deg) rotateY(180deg)
        animation-fill-mode: forwards
      &.start-point-4
        top: 300px
        right: -200px
        animation: startPoint4 5s linear
        transform: rotate(23deg)
        animation-fill-mode: forwards
      &.start-point-vertical-1
        top: 300px
        left: -200px
        animation: startPoint1Vertical 5s linear
        transform: rotate(60deg) rotateY(180deg)
        animation-fill-mode: forwards
      &.start-point-vertical-2
        bottom: -200px
        left: 1000px
        animation: startPoint2Vertical 5s linear
        transform: rotate(-50deg)
        animation-fill-mode: forwards
      &.start-point-vertical-3
        bottom: -200px
        right: 1000px
        animation: startPoint3Vertical 5s linear
        transform: rotate(60deg) rotateY(180deg)
        animation-fill-mode: forwards
      &.start-point-vertical-4
        top: 300px
        right: -200px
        animation: startPoint4Vertical 5s linear
        transform: rotate(-50deg)
        animation-fill-mode: forwards
      .move-aricraft
        display: inline-block
        width: 100px
        height: 100px
    .move-pet-wrap
      will-change: left
      position: absolute
      bottom: 0px
      right: -100px
      width: 100px
      height: 100px
      .move-pet
        display: inline-block
        width: 100px
        height: 100px

  @keyframes startPoint1
    to
      transform: translate3D(1500px, -500px, 0) rotate(-23deg) rotateY(180deg) scale(0.7)

  @keyframes startPoint2
    to
      transform: translate3D(-1200px, -800px, 0) rotate(33deg) scale(0.7)

  @keyframes startPoint3
    to
      transform: translate3D(1200px, -800px, 0) rotate(-33deg) rotateY(180deg) scale(0.7)

  @keyframes startPoint4
    to
      transform: translate3D(-1500px, -500px, 0) rotate(23deg) scale(0.7)

  @keyframes startPoint1Vertical
    to
      transform: translate3D(1500px, -500px, 0) rotate(60deg) rotateY(180deg) scale(0.7)

  @keyframes startPoint2Vertical
    to
      transform: translate3D(-1200px, -800px, 0) rotate(-50deg) scale(0.7)

  @keyframes startPoint3Vertical
    to
      transform: translate3D(1200px, -800px, 0) rotate(60deg) rotateY(180deg) scale(0.7)

  @keyframes startPoint4Vertical
    to
      transform: translate3D(-1500px, -500px, 0) rotate(-50deg) scale(0.7)
</style>
