<template lang="jade">
  .app
    keep-alive
      router-view.app-container(:hashbang="true",:history="true",v-if="$route.meta.keepAlive")
    transition(@leave="leaveAnimation")
      router-view.animated.fadeInRight.app-container(:hashbang="true",:history="true",v-if="!$route.meta.keepAlive")
</template>
<script>
import cookies from 'cookies-js'
import utils from './utils/_untils.js'
export default {
  name: "app",
  methods: {
    leaveAnimation(e, done) {
      e.className = e.className.replace("fadeInRight", "bounceOutRight")
      setTimeout(() => {
        done()
      }, 500)
    },
    // 发送心跳
    heartBeat() {
      utils.dispatchForIpad("vkappbridge://ipadcommon/postHeartbeat")
    },
    // 初始化心跳
    initVKAppBridgeHeartBeat() {
      if (cookies.get("isFromApp")) {
        utils.dispatchForIpad("vkappbridge://__bridge_ready__ ")
        setTimeout(() => {
          this.heartBeat()
        }, 220)
        setInterval(() => {
          this.heartBeat()
        }, 5000)
      }
    }
  },
  mounted() {
    this.initVKAppBridgeHeartBeat()
  }
}
</script>
<style lang='stylus'>
@import './assets/cssreset-min.css'
@import './assets/animate.css'
@import './assets/icon.css'
@css {
  html {
    filter: unquote('progid:DXImageTransform.Microsoft.gradient( startColorstr=' #433798 ', endColorstr=' #7f2891 ',GradientType=0 )')
  }
}
* 
  -webkit-touch-callout: none /* iOS Safari */
  -webkit-user-select: none /* Chrome/Safari/Opera */
  -khtml-user-select: none /* Konqueror */
  -moz-user-select: none /* Firefox */
  -ms-user-select: none /* Internet Explorer/Edge */
  user-select: none
  -webkit-tap-highlight-color:rgba(0, 0, 0, 0) /* 点击禁止透明背景 */
img
  -webkit-user-drag: none  /* 禁止拖动 */
.app
  position: relative
  height: 100%
  width: 100%
.app-container
  position: absolute
  top: 0
  left: 0
  right: 0
  bottom: 0
  animation-duration: 0.5s
</style>