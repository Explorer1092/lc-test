# 纯前端的文件推送

## 样例

```javascript

// 引入模块
import filepush  from 'fe-filepush';
let upload = new filepush({
  // 七牛 阿里
  accessKey: '97e8a64d15559dxx',
  secretKey: '80f099f9b5394bb4b74f610b3b3ee1xx',
  client: 'vfe-basic-service',
  path: 'vfe-static/parent/test/' + (new Date()).valueOf()
});

// 取得文件
let files = document.getElementById('test').files;
// 将文件添加到待传队列
upload.addfiles(Array.from(files));
// 文件开始上传
upload.submit( function(err, data){
  console.log(err, data)
}, function(file, progressEvent){
  // 上传进度回调
  console.log(file, progressEvent)
});

```

# 功能说明

## 实例化
```javascript

// 从http://vos.vipkid.com.cn申请 公钥、私钥
// 工单系统 http://monkey.int.vipkid.com.cn/ticket/worksheet/51/task/create/ 
let upload = new filepush({
  // 七牛 阿里
  accessKey: '97e8a64d15559dxx', 
  secretKey: '80f099f9b5394bb4b74f610b3b3ee1xx',
  client: 'vfe-basic-service',  
  path: 'vfe-static/parent/test/'
});

```
#### 参数说明(Parameters)

|名称| 类型 | 描述 |
|:---|---|---|
| accessKey | string(加密串) | 公钥 |
| secretKey | string(加密串) | 私钥 |
| client | string | 当前所在产品线 如：`vfe-basic-service 1.0.0` |
| path | string | 文件要上传的路径【公钥私钥中已经授权的路径】 |


## 添加文件
```javascript
// 可一次上传多个文件

// 取得文件filesA
let filesA = document.getElementById('test').files;
// 将文件添加到待传队列
upload.addfiles(Array.from(filesA));

// 取得文件filesB
let filesB = document.getElementById('test').files;
// 将文件添加到待传队列
upload.addfiles(Array.from(filesB));
```

#### 参数说明(Parameters)

|函数名称| 参数 | 描述 |
|:---|---|---|
| addfiles | Array, fileObject | 为上传队列中添加文件 |

### `重命名文件`
```
// 为file对象添加一个`属性` fullname

files = Array.from(files).map((item, index)=>{
    item['fullname'] = 'vfe-static/parent/test/' + (new Date()).valueOf() + item.name
    return item;
});

```


## 上传文件及回调

```javascript
// 文件开始上传
upload.submit( function(err, data){
  console.log(err, data)
}, function(`file`, progressEvent){
  // 上传进度回调
  console.log(`file`, progressEvent)
});

```
#### 参数说明(Parameters)

|函数名称| 参数 | 描述 |
|:---|---|---|
| addfiles | `callback`,`progress` | 上传的回调，上传进度的回调 |

|函数名称| 参数 | 描述 |
|:---|---|---|
| callback | err, data | 上传失败的信息，上传成功的信息 |
| progress | file, progressEvent | file对象，原生的progressEvent |


**`file对象说明：如果文件起过4M文件分被拆分为多个file。同时上传，会有多progressEvent对象`**

#### progressEvent说明
|属性| 描述 |
|:---|---|
| ProgressEvent.loaded | 已经上传成功的数据  |
| ProgressEvent.total | 要上传的数据的总和 |



## 模块大小[未压缩]

![image](/uploads/9bac4db05538e122495f3028fad5c728/image.png)